function nb(r,s){for(var u=0;u<s.length;u++){const g=s[u];if(typeof g!="string"&&!Array.isArray(g)){for(const _ in g)if(_!=="default"&&!(_ in r)){const S=Object.getOwnPropertyDescriptor(g,_);S&&Object.defineProperty(r,_,S.get?S:{enumerable:!0,get:()=>g[_]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))g(_);new MutationObserver(_=>{for(const S of _)if(S.type==="childList")for(const z of S.addedNodes)z.tagName==="LINK"&&z.rel==="modulepreload"&&g(z)}).observe(document,{childList:!0,subtree:!0});function u(_){const S={};return _.integrity&&(S.integrity=_.integrity),_.referrerPolicy&&(S.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?S.credentials="include":_.crossOrigin==="anonymous"?S.credentials="omit":S.credentials="same-origin",S}function g(_){if(_.ep)return;_.ep=!0;const S=u(_);fetch(_.href,S)}})();var sb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rv(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Bv={exports:{}},Hd={},Fv={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lc=Symbol.for("react.element"),ab=Symbol.for("react.portal"),ob=Symbol.for("react.fragment"),lb=Symbol.for("react.strict_mode"),ub=Symbol.for("react.profiler"),cb=Symbol.for("react.provider"),hb=Symbol.for("react.context"),db=Symbol.for("react.forward_ref"),pb=Symbol.for("react.suspense"),fb=Symbol.for("react.memo"),mb=Symbol.for("react.lazy"),__=Symbol.iterator;function gb(r){return r===null||typeof r!="object"?null:(r=__&&r[__]||r["@@iterator"],typeof r=="function"?r:null)}var Ov={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nv=Object.assign,Vv={};function Ol(r,s,u){this.props=r,this.context=s,this.refs=Vv,this.updater=u||Ov}Ol.prototype.isReactComponent={};Ol.prototype.setState=function(r,s){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,s,"setState")};Ol.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function Uv(){}Uv.prototype=Ol.prototype;function jm(r,s,u){this.props=r,this.context=s,this.refs=Vv,this.updater=u||Ov}var $m=jm.prototype=new Uv;$m.constructor=jm;Nv($m,Ol.prototype);$m.isPureReactComponent=!0;var v_=Array.isArray,jv=Object.prototype.hasOwnProperty,Zm={current:null},$v={key:!0,ref:!0,__self:!0,__source:!0};function Zv(r,s,u){var g,_={},S=null,z=null;if(s!=null)for(g in s.ref!==void 0&&(z=s.ref),s.key!==void 0&&(S=""+s.key),s)jv.call(s,g)&&!$v.hasOwnProperty(g)&&(_[g]=s[g]);var l=arguments.length-2;if(l===1)_.children=u;else if(1<l){for(var N=Array(l),F=0;F<l;F++)N[F]=arguments[F+2];_.children=N}if(r&&r.defaultProps)for(g in l=r.defaultProps,l)_[g]===void 0&&(_[g]=l[g]);return{$$typeof:Lc,type:r,key:S,ref:z,props:_,_owner:Zm.current}}function yb(r,s){return{$$typeof:Lc,type:r.type,key:s,ref:r.ref,props:r.props,_owner:r._owner}}function qm(r){return typeof r=="object"&&r!==null&&r.$$typeof===Lc}function _b(r){var s={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(u){return s[u]})}var x_=/\/+/g;function xf(r,s){return typeof r=="object"&&r!==null&&r.key!=null?_b(""+r.key):s.toString(36)}function hd(r,s,u,g,_){var S=typeof r;(S==="undefined"||S==="boolean")&&(r=null);var z=!1;if(r===null)z=!0;else switch(S){case"string":case"number":z=!0;break;case"object":switch(r.$$typeof){case Lc:case ab:z=!0}}if(z)return z=r,_=_(z),r=g===""?"."+xf(z,0):g,v_(_)?(u="",r!=null&&(u=r.replace(x_,"$&/")+"/"),hd(_,s,u,"",function(F){return F})):_!=null&&(qm(_)&&(_=yb(_,u+(!_.key||z&&z.key===_.key?"":(""+_.key).replace(x_,"$&/")+"/")+r)),s.push(_)),1;if(z=0,g=g===""?".":g+":",v_(r))for(var l=0;l<r.length;l++){S=r[l];var N=g+xf(S,l);z+=hd(S,s,u,N,_)}else if(N=gb(r),typeof N=="function")for(r=N.call(r),l=0;!(S=r.next()).done;)S=S.value,N=g+xf(S,l++),z+=hd(S,s,u,N,_);else if(S==="object")throw s=String(r),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return z}function Hh(r,s,u){if(r==null)return r;var g=[],_=0;return hd(r,g,"","",function(S){return s.call(u,S,_++)}),g}function vb(r){if(r._status===-1){var s=r._result;s=s(),s.then(function(u){(r._status===0||r._status===-1)&&(r._status=1,r._result=u)},function(u){(r._status===0||r._status===-1)&&(r._status=2,r._result=u)}),r._status===-1&&(r._status=0,r._result=s)}if(r._status===1)return r._result.default;throw r._result}var Oi={current:null},dd={transition:null},xb={ReactCurrentDispatcher:Oi,ReactCurrentBatchConfig:dd,ReactCurrentOwner:Zm};function qv(){throw Error("act(...) is not supported in production builds of React.")}It.Children={map:Hh,forEach:function(r,s,u){Hh(r,function(){s.apply(this,arguments)},u)},count:function(r){var s=0;return Hh(r,function(){s++}),s},toArray:function(r){return Hh(r,function(s){return s})||[]},only:function(r){if(!qm(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};It.Component=Ol;It.Fragment=ob;It.Profiler=ub;It.PureComponent=jm;It.StrictMode=lb;It.Suspense=pb;It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xb;It.act=qv;It.cloneElement=function(r,s,u){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var g=Nv({},r.props),_=r.key,S=r.ref,z=r._owner;if(s!=null){if(s.ref!==void 0&&(S=s.ref,z=Zm.current),s.key!==void 0&&(_=""+s.key),r.type&&r.type.defaultProps)var l=r.type.defaultProps;for(N in s)jv.call(s,N)&&!$v.hasOwnProperty(N)&&(g[N]=s[N]===void 0&&l!==void 0?l[N]:s[N])}var N=arguments.length-2;if(N===1)g.children=u;else if(1<N){l=Array(N);for(var F=0;F<N;F++)l[F]=arguments[F+2];g.children=l}return{$$typeof:Lc,type:r.type,key:_,ref:S,props:g,_owner:z}};It.createContext=function(r){return r={$$typeof:hb,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:cb,_context:r},r.Consumer=r};It.createElement=Zv;It.createFactory=function(r){var s=Zv.bind(null,r);return s.type=r,s};It.createRef=function(){return{current:null}};It.forwardRef=function(r){return{$$typeof:db,render:r}};It.isValidElement=qm;It.lazy=function(r){return{$$typeof:mb,_payload:{_status:-1,_result:r},_init:vb}};It.memo=function(r,s){return{$$typeof:fb,type:r,compare:s===void 0?null:s}};It.startTransition=function(r){var s=dd.transition;dd.transition={};try{r()}finally{dd.transition=s}};It.unstable_act=qv;It.useCallback=function(r,s){return Oi.current.useCallback(r,s)};It.useContext=function(r){return Oi.current.useContext(r)};It.useDebugValue=function(){};It.useDeferredValue=function(r){return Oi.current.useDeferredValue(r)};It.useEffect=function(r,s){return Oi.current.useEffect(r,s)};It.useId=function(){return Oi.current.useId()};It.useImperativeHandle=function(r,s,u){return Oi.current.useImperativeHandle(r,s,u)};It.useInsertionEffect=function(r,s){return Oi.current.useInsertionEffect(r,s)};It.useLayoutEffect=function(r,s){return Oi.current.useLayoutEffect(r,s)};It.useMemo=function(r,s){return Oi.current.useMemo(r,s)};It.useReducer=function(r,s,u){return Oi.current.useReducer(r,s,u)};It.useRef=function(r){return Oi.current.useRef(r)};It.useState=function(r){return Oi.current.useState(r)};It.useSyncExternalStore=function(r,s,u){return Oi.current.useSyncExternalStore(r,s,u)};It.useTransition=function(){return Oi.current.useTransition()};It.version="18.3.1";Fv.exports=It;var et=Fv.exports;const Gv=Rv(et),wb=nb({__proto__:null,default:Gv},[et]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bb=et,Sb=Symbol.for("react.element"),Tb=Symbol.for("react.fragment"),kb=Object.prototype.hasOwnProperty,Eb=bb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ib={key:!0,ref:!0,__self:!0,__source:!0};function Wv(r,s,u){var g,_={},S=null,z=null;u!==void 0&&(S=""+u),s.key!==void 0&&(S=""+s.key),s.ref!==void 0&&(z=s.ref);for(g in s)kb.call(s,g)&&!Ib.hasOwnProperty(g)&&(_[g]=s[g]);if(r&&r.defaultProps)for(g in s=r.defaultProps,s)_[g]===void 0&&(_[g]=s[g]);return{$$typeof:Sb,type:r,key:S,ref:z,props:_,_owner:Eb.current}}Hd.Fragment=Tb;Hd.jsx=Wv;Hd.jsxs=Wv;Bv.exports=Hd;var Me=Bv.exports,Hv={exports:{}},pn={},Xv={exports:{}},Kv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function s(Ge,pt){var yt=Ge.length;Ge.push(pt);e:for(;0<yt;){var Ut=yt-1>>>1,Ft=Ge[Ut];if(0<_(Ft,pt))Ge[Ut]=pt,Ge[yt]=Ft,yt=Ut;else break e}}function u(Ge){return Ge.length===0?null:Ge[0]}function g(Ge){if(Ge.length===0)return null;var pt=Ge[0],yt=Ge.pop();if(yt!==pt){Ge[0]=yt;e:for(var Ut=0,Ft=Ge.length,Dt=Ft>>>1;Ut<Dt;){var lr=2*(Ut+1)-1,tn=Ge[lr],hi=lr+1,rn=Ge[hi];if(0>_(tn,yt))hi<Ft&&0>_(rn,tn)?(Ge[Ut]=rn,Ge[hi]=yt,Ut=hi):(Ge[Ut]=tn,Ge[lr]=yt,Ut=lr);else if(hi<Ft&&0>_(rn,yt))Ge[Ut]=rn,Ge[hi]=yt,Ut=hi;else break e}}return pt}function _(Ge,pt){var yt=Ge.sortIndex-pt.sortIndex;return yt!==0?yt:Ge.id-pt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var S=performance;r.unstable_now=function(){return S.now()}}else{var z=Date,l=z.now();r.unstable_now=function(){return z.now()-l}}var N=[],F=[],pe=1,he=null,ie=3,Ie=!1,Pe=!1,Ce=!1,Ne=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ce(Ge){for(var pt=u(F);pt!==null;){if(pt.callback===null)g(F);else if(pt.startTime<=Ge)g(F),pt.sortIndex=pt.expirationTime,s(N,pt);else break;pt=u(F)}}function Te(Ge){if(Ce=!1,ce(Ge),!Pe)if(u(N)!==null)Pe=!0,ki($e);else{var pt=u(F);pt!==null&&Zr(Te,pt.startTime-Ge)}}function $e(Ge,pt){Pe=!1,Ce&&(Ce=!1,re(We),We=-1),Ie=!0;var yt=ie;try{for(ce(pt),he=u(N);he!==null&&(!(he.expirationTime>pt)||Ge&&!Ar());){var Ut=he.callback;if(typeof Ut=="function"){he.callback=null,ie=he.priorityLevel;var Ft=Ut(he.expirationTime<=pt);pt=r.unstable_now(),typeof Ft=="function"?he.callback=Ft:he===u(N)&&g(N),ce(pt)}else g(N);he=u(N)}if(he!==null)var Dt=!0;else{var lr=u(F);lr!==null&&Zr(Te,lr.startTime-pt),Dt=!1}return Dt}finally{he=null,ie=yt,Ie=!1}}var Ye=!1,it=null,We=-1,qt=5,at=-1;function Ar(){return!(r.unstable_now()-at<qt)}function Br(){if(it!==null){var Ge=r.unstable_now();at=Ge;var pt=!0;try{pt=it(!0,Ge)}finally{pt?ci():(Ye=!1,it=null)}}else Ye=!1}var ci;if(typeof ee=="function")ci=function(){ee(Br)};else if(typeof MessageChannel<"u"){var Dr=new MessageChannel,Qr=Dr.port2;Dr.port1.onmessage=Br,ci=function(){Qr.postMessage(null)}}else ci=function(){Ne(Br,0)};function ki(Ge){it=Ge,Ye||(Ye=!0,ci())}function Zr(Ge,pt){We=Ne(function(){Ge(r.unstable_now())},pt)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Ge){Ge.callback=null},r.unstable_continueExecution=function(){Pe||Ie||(Pe=!0,ki($e))},r.unstable_forceFrameRate=function(Ge){0>Ge||125<Ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):qt=0<Ge?Math.floor(1e3/Ge):5},r.unstable_getCurrentPriorityLevel=function(){return ie},r.unstable_getFirstCallbackNode=function(){return u(N)},r.unstable_next=function(Ge){switch(ie){case 1:case 2:case 3:var pt=3;break;default:pt=ie}var yt=ie;ie=pt;try{return Ge()}finally{ie=yt}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Ge,pt){switch(Ge){case 1:case 2:case 3:case 4:case 5:break;default:Ge=3}var yt=ie;ie=Ge;try{return pt()}finally{ie=yt}},r.unstable_scheduleCallback=function(Ge,pt,yt){var Ut=r.unstable_now();switch(typeof yt=="object"&&yt!==null?(yt=yt.delay,yt=typeof yt=="number"&&0<yt?Ut+yt:Ut):yt=Ut,Ge){case 1:var Ft=-1;break;case 2:Ft=250;break;case 5:Ft=1073741823;break;case 4:Ft=1e4;break;default:Ft=5e3}return Ft=yt+Ft,Ge={id:pe++,callback:pt,priorityLevel:Ge,startTime:yt,expirationTime:Ft,sortIndex:-1},yt>Ut?(Ge.sortIndex=yt,s(F,Ge),u(N)===null&&Ge===u(F)&&(Ce?(re(We),We=-1):Ce=!0,Zr(Te,yt-Ut))):(Ge.sortIndex=Ft,s(N,Ge),Pe||Ie||(Pe=!0,ki($e))),Ge},r.unstable_shouldYield=Ar,r.unstable_wrapCallback=function(Ge){var pt=ie;return function(){var yt=ie;ie=pt;try{return Ge.apply(this,arguments)}finally{ie=yt}}}})(Kv);Xv.exports=Kv;var Cb=Xv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pb=et,dn=Cb;function Le(r){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+r,u=1;u<arguments.length;u++)s+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yv=new Set,mc={};function So(r,s){Ml(r,s),Ml(r+"Capture",s)}function Ml(r,s){for(mc[r]=s,r=0;r<s.length;r++)Yv.add(s[r])}var $s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wf=Object.prototype.hasOwnProperty,zb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w_={},b_={};function Mb(r){return Wf.call(b_,r)?!0:Wf.call(w_,r)?!1:zb.test(r)?b_[r]=!0:(w_[r]=!0,!1)}function Ab(r,s,u,g){if(u!==null&&u.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return g?!1:u!==null?!u.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function Db(r,s,u,g){if(s===null||typeof s>"u"||Ab(r,s,u,g))return!0;if(g)return!1;if(u!==null)switch(u.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function Ni(r,s,u,g,_,S,z){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=g,this.attributeNamespace=_,this.mustUseProperty=u,this.propertyName=r,this.type=s,this.sanitizeURL=S,this.removeEmptyString=z}var ui={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){ui[r]=new Ni(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var s=r[0];ui[s]=new Ni(s,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){ui[r]=new Ni(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){ui[r]=new Ni(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){ui[r]=new Ni(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){ui[r]=new Ni(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){ui[r]=new Ni(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){ui[r]=new Ni(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){ui[r]=new Ni(r,5,!1,r.toLowerCase(),null,!1,!1)});var Gm=/[\-:]([a-z])/g;function Wm(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var s=r.replace(Gm,Wm);ui[s]=new Ni(s,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var s=r.replace(Gm,Wm);ui[s]=new Ni(s,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var s=r.replace(Gm,Wm);ui[s]=new Ni(s,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){ui[r]=new Ni(r,1,!1,r.toLowerCase(),null,!1,!1)});ui.xlinkHref=new Ni("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){ui[r]=new Ni(r,1,!1,r.toLowerCase(),null,!0,!0)});function Hm(r,s,u,g){var _=ui.hasOwnProperty(s)?ui[s]:null;(_!==null?_.type!==0:g||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(Db(s,u,_,g)&&(u=null),g||_===null?Mb(s)&&(u===null?r.removeAttribute(s):r.setAttribute(s,""+u)):_.mustUseProperty?r[_.propertyName]=u===null?_.type===3?!1:"":u:(s=_.attributeName,g=_.attributeNamespace,u===null?r.removeAttribute(s):(_=_.type,u=_===3||_===4&&u===!0?"":""+u,g?r.setAttributeNS(g,s,u):r.setAttribute(s,u))))}var Ws=Pb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xh=Symbol.for("react.element"),pl=Symbol.for("react.portal"),fl=Symbol.for("react.fragment"),Xm=Symbol.for("react.strict_mode"),Hf=Symbol.for("react.profiler"),Jv=Symbol.for("react.provider"),Qv=Symbol.for("react.context"),Km=Symbol.for("react.forward_ref"),Xf=Symbol.for("react.suspense"),Kf=Symbol.for("react.suspense_list"),Ym=Symbol.for("react.memo"),va=Symbol.for("react.lazy"),ex=Symbol.for("react.offscreen"),S_=Symbol.iterator;function Hu(r){return r===null||typeof r!="object"?null:(r=S_&&r[S_]||r["@@iterator"],typeof r=="function"?r:null)}var _r=Object.assign,wf;function rc(r){if(wf===void 0)try{throw Error()}catch(u){var s=u.stack.trim().match(/\n( *(at )?)/);wf=s&&s[1]||""}return`
`+wf+r}var bf=!1;function Sf(r,s){if(!r||bf)return"";bf=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(F){var g=F}Reflect.construct(r,[],s)}else{try{s.call()}catch(F){g=F}r.call(s.prototype)}else{try{throw Error()}catch(F){g=F}r()}}catch(F){if(F&&g&&typeof F.stack=="string"){for(var _=F.stack.split(`
`),S=g.stack.split(`
`),z=_.length-1,l=S.length-1;1<=z&&0<=l&&_[z]!==S[l];)l--;for(;1<=z&&0<=l;z--,l--)if(_[z]!==S[l]){if(z!==1||l!==1)do if(z--,l--,0>l||_[z]!==S[l]){var N=`
`+_[z].replace(" at new "," at ");return r.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",r.displayName)),N}while(1<=z&&0<=l);break}}}finally{bf=!1,Error.prepareStackTrace=u}return(r=r?r.displayName||r.name:"")?rc(r):""}function Lb(r){switch(r.tag){case 5:return rc(r.type);case 16:return rc("Lazy");case 13:return rc("Suspense");case 19:return rc("SuspenseList");case 0:case 2:case 15:return r=Sf(r.type,!1),r;case 11:return r=Sf(r.type.render,!1),r;case 1:return r=Sf(r.type,!0),r;default:return""}}function Yf(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case fl:return"Fragment";case pl:return"Portal";case Hf:return"Profiler";case Xm:return"StrictMode";case Xf:return"Suspense";case Kf:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case Qv:return(r.displayName||"Context")+".Consumer";case Jv:return(r._context.displayName||"Context")+".Provider";case Km:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Ym:return s=r.displayName||null,s!==null?s:Yf(r.type)||"Memo";case va:s=r._payload,r=r._init;try{return Yf(r(s))}catch{}}return null}function Rb(r){var s=r.type;switch(r.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=s.render,r=r.displayName||r.name||"",s.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yf(s);case 8:return s===Xm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function Ra(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function tx(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Bb(r){var s=tx(r)?"checked":"value",u=Object.getOwnPropertyDescriptor(r.constructor.prototype,s),g=""+r[s];if(!r.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var _=u.get,S=u.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return _.call(this)},set:function(z){g=""+z,S.call(this,z)}}),Object.defineProperty(r,s,{enumerable:u.enumerable}),{getValue:function(){return g},setValue:function(z){g=""+z},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function Kh(r){r._valueTracker||(r._valueTracker=Bb(r))}function rx(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var u=s.getValue(),g="";return r&&(g=tx(r)?r.checked?"true":"false":r.value),r=g,r!==u?(s.setValue(r),!0):!1}function Sd(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Jf(r,s){var u=s.checked;return _r({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??r._wrapperState.initialChecked})}function T_(r,s){var u=s.defaultValue==null?"":s.defaultValue,g=s.checked!=null?s.checked:s.defaultChecked;u=Ra(s.value!=null?s.value:u),r._wrapperState={initialChecked:g,initialValue:u,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function ix(r,s){s=s.checked,s!=null&&Hm(r,"checked",s,!1)}function Qf(r,s){ix(r,s);var u=Ra(s.value),g=s.type;if(u!=null)g==="number"?(u===0&&r.value===""||r.value!=u)&&(r.value=""+u):r.value!==""+u&&(r.value=""+u);else if(g==="submit"||g==="reset"){r.removeAttribute("value");return}s.hasOwnProperty("value")?em(r,s.type,u):s.hasOwnProperty("defaultValue")&&em(r,s.type,Ra(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(r.defaultChecked=!!s.defaultChecked)}function k_(r,s,u){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var g=s.type;if(!(g!=="submit"&&g!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+r._wrapperState.initialValue,u||s===r.value||(r.value=s),r.defaultValue=s}u=r.name,u!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,u!==""&&(r.name=u)}function em(r,s,u){(s!=="number"||Sd(r.ownerDocument)!==r)&&(u==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+u&&(r.defaultValue=""+u))}var ic=Array.isArray;function kl(r,s,u,g){if(r=r.options,s){s={};for(var _=0;_<u.length;_++)s["$"+u[_]]=!0;for(u=0;u<r.length;u++)_=s.hasOwnProperty("$"+r[u].value),r[u].selected!==_&&(r[u].selected=_),_&&g&&(r[u].defaultSelected=!0)}else{for(u=""+Ra(u),s=null,_=0;_<r.length;_++){if(r[_].value===u){r[_].selected=!0,g&&(r[_].defaultSelected=!0);return}s!==null||r[_].disabled||(s=r[_])}s!==null&&(s.selected=!0)}}function tm(r,s){if(s.dangerouslySetInnerHTML!=null)throw Error(Le(91));return _r({},s,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function E_(r,s){var u=s.value;if(u==null){if(u=s.children,s=s.defaultValue,u!=null){if(s!=null)throw Error(Le(92));if(ic(u)){if(1<u.length)throw Error(Le(93));u=u[0]}s=u}s==null&&(s=""),u=s}r._wrapperState={initialValue:Ra(u)}}function nx(r,s){var u=Ra(s.value),g=Ra(s.defaultValue);u!=null&&(u=""+u,u!==r.value&&(r.value=u),s.defaultValue==null&&r.defaultValue!==u&&(r.defaultValue=u)),g!=null&&(r.defaultValue=""+g)}function I_(r){var s=r.textContent;s===r._wrapperState.initialValue&&s!==""&&s!==null&&(r.value=s)}function sx(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rm(r,s){return r==null||r==="http://www.w3.org/1999/xhtml"?sx(s):r==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Yh,ax=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,u,g,_){MSApp.execUnsafeLocalFunction(function(){return r(s,u,g,_)})}:r}(function(r,s){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=s;else{for(Yh=Yh||document.createElement("div"),Yh.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Yh.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;s.firstChild;)r.appendChild(s.firstChild)}});function gc(r,s){if(s){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=s;return}}r.textContent=s}var ac={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fb=["Webkit","ms","Moz","O"];Object.keys(ac).forEach(function(r){Fb.forEach(function(s){s=s+r.charAt(0).toUpperCase()+r.substring(1),ac[s]=ac[r]})});function ox(r,s,u){return s==null||typeof s=="boolean"||s===""?"":u||typeof s!="number"||s===0||ac.hasOwnProperty(r)&&ac[r]?(""+s).trim():s+"px"}function lx(r,s){r=r.style;for(var u in s)if(s.hasOwnProperty(u)){var g=u.indexOf("--")===0,_=ox(u,s[u],g);u==="float"&&(u="cssFloat"),g?r.setProperty(u,_):r[u]=_}}var Ob=_r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function im(r,s){if(s){if(Ob[r]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(Le(137,r));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(Le(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(Le(61))}if(s.style!=null&&typeof s.style!="object")throw Error(Le(62))}}function nm(r,s){if(r.indexOf("-")===-1)return typeof s.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sm=null;function Jm(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var am=null,El=null,Il=null;function C_(r){if(r=Fc(r)){if(typeof am!="function")throw Error(Le(280));var s=r.stateNode;s&&(s=Qd(s),am(r.stateNode,r.type,s))}}function ux(r){El?Il?Il.push(r):Il=[r]:El=r}function cx(){if(El){var r=El,s=Il;if(Il=El=null,C_(r),s)for(r=0;r<s.length;r++)C_(s[r])}}function hx(r,s){return r(s)}function dx(){}var Tf=!1;function px(r,s,u){if(Tf)return r(s,u);Tf=!0;try{return hx(r,s,u)}finally{Tf=!1,(El!==null||Il!==null)&&(dx(),cx())}}function yc(r,s){var u=r.stateNode;if(u===null)return null;var g=Qd(u);if(g===null)return null;u=g[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(r=r.type,g=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!g;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(Le(231,s,typeof u));return u}var om=!1;if($s)try{var Xu={};Object.defineProperty(Xu,"passive",{get:function(){om=!0}}),window.addEventListener("test",Xu,Xu),window.removeEventListener("test",Xu,Xu)}catch{om=!1}function Nb(r,s,u,g,_,S,z,l,N){var F=Array.prototype.slice.call(arguments,3);try{s.apply(u,F)}catch(pe){this.onError(pe)}}var oc=!1,Td=null,kd=!1,lm=null,Vb={onError:function(r){oc=!0,Td=r}};function Ub(r,s,u,g,_,S,z,l,N){oc=!1,Td=null,Nb.apply(Vb,arguments)}function jb(r,s,u,g,_,S,z,l,N){if(Ub.apply(this,arguments),oc){if(oc){var F=Td;oc=!1,Td=null}else throw Error(Le(198));kd||(kd=!0,lm=F)}}function To(r){var s=r,u=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,s.flags&4098&&(u=s.return),r=s.return;while(r)}return s.tag===3?u:null}function fx(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function P_(r){if(To(r)!==r)throw Error(Le(188))}function $b(r){var s=r.alternate;if(!s){if(s=To(r),s===null)throw Error(Le(188));return s!==r?null:r}for(var u=r,g=s;;){var _=u.return;if(_===null)break;var S=_.alternate;if(S===null){if(g=_.return,g!==null){u=g;continue}break}if(_.child===S.child){for(S=_.child;S;){if(S===u)return P_(_),r;if(S===g)return P_(_),s;S=S.sibling}throw Error(Le(188))}if(u.return!==g.return)u=_,g=S;else{for(var z=!1,l=_.child;l;){if(l===u){z=!0,u=_,g=S;break}if(l===g){z=!0,g=_,u=S;break}l=l.sibling}if(!z){for(l=S.child;l;){if(l===u){z=!0,u=S,g=_;break}if(l===g){z=!0,g=S,u=_;break}l=l.sibling}if(!z)throw Error(Le(189))}}if(u.alternate!==g)throw Error(Le(190))}if(u.tag!==3)throw Error(Le(188));return u.stateNode.current===u?r:s}function mx(r){return r=$b(r),r!==null?gx(r):null}function gx(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var s=gx(r);if(s!==null)return s;r=r.sibling}return null}var yx=dn.unstable_scheduleCallback,z_=dn.unstable_cancelCallback,Zb=dn.unstable_shouldYield,qb=dn.unstable_requestPaint,Mr=dn.unstable_now,Gb=dn.unstable_getCurrentPriorityLevel,Qm=dn.unstable_ImmediatePriority,_x=dn.unstable_UserBlockingPriority,Ed=dn.unstable_NormalPriority,Wb=dn.unstable_LowPriority,vx=dn.unstable_IdlePriority,Xd=null,gs=null;function Hb(r){if(gs&&typeof gs.onCommitFiberRoot=="function")try{gs.onCommitFiberRoot(Xd,r,void 0,(r.current.flags&128)===128)}catch{}}var Xn=Math.clz32?Math.clz32:Yb,Xb=Math.log,Kb=Math.LN2;function Yb(r){return r>>>=0,r===0?32:31-(Xb(r)/Kb|0)|0}var Jh=64,Qh=4194304;function nc(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Id(r,s){var u=r.pendingLanes;if(u===0)return 0;var g=0,_=r.suspendedLanes,S=r.pingedLanes,z=u&268435455;if(z!==0){var l=z&~_;l!==0?g=nc(l):(S&=z,S!==0&&(g=nc(S)))}else z=u&~_,z!==0?g=nc(z):S!==0&&(g=nc(S));if(g===0)return 0;if(s!==0&&s!==g&&!(s&_)&&(_=g&-g,S=s&-s,_>=S||_===16&&(S&4194240)!==0))return s;if(g&4&&(g|=u&16),s=r.entangledLanes,s!==0)for(r=r.entanglements,s&=g;0<s;)u=31-Xn(s),_=1<<u,g|=r[u],s&=~_;return g}function Jb(r,s){switch(r){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qb(r,s){for(var u=r.suspendedLanes,g=r.pingedLanes,_=r.expirationTimes,S=r.pendingLanes;0<S;){var z=31-Xn(S),l=1<<z,N=_[z];N===-1?(!(l&u)||l&g)&&(_[z]=Jb(l,s)):N<=s&&(r.expiredLanes|=l),S&=~l}}function um(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function xx(){var r=Jh;return Jh<<=1,!(Jh&4194240)&&(Jh=64),r}function kf(r){for(var s=[],u=0;31>u;u++)s.push(r);return s}function Rc(r,s,u){r.pendingLanes|=s,s!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,s=31-Xn(s),r[s]=u}function e2(r,s){var u=r.pendingLanes&~s;r.pendingLanes=s,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=s,r.mutableReadLanes&=s,r.entangledLanes&=s,s=r.entanglements;var g=r.eventTimes;for(r=r.expirationTimes;0<u;){var _=31-Xn(u),S=1<<_;s[_]=0,g[_]=-1,r[_]=-1,u&=~S}}function eg(r,s){var u=r.entangledLanes|=s;for(r=r.entanglements;u;){var g=31-Xn(u),_=1<<g;_&s|r[g]&s&&(r[g]|=s),u&=~_}}var Zt=0;function wx(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var bx,tg,Sx,Tx,kx,cm=!1,ed=[],Ea=null,Ia=null,Ca=null,_c=new Map,vc=new Map,wa=[],t2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function M_(r,s){switch(r){case"focusin":case"focusout":Ea=null;break;case"dragenter":case"dragleave":Ia=null;break;case"mouseover":case"mouseout":Ca=null;break;case"pointerover":case"pointerout":_c.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":vc.delete(s.pointerId)}}function Ku(r,s,u,g,_,S){return r===null||r.nativeEvent!==S?(r={blockedOn:s,domEventName:u,eventSystemFlags:g,nativeEvent:S,targetContainers:[_]},s!==null&&(s=Fc(s),s!==null&&tg(s)),r):(r.eventSystemFlags|=g,s=r.targetContainers,_!==null&&s.indexOf(_)===-1&&s.push(_),r)}function r2(r,s,u,g,_){switch(s){case"focusin":return Ea=Ku(Ea,r,s,u,g,_),!0;case"dragenter":return Ia=Ku(Ia,r,s,u,g,_),!0;case"mouseover":return Ca=Ku(Ca,r,s,u,g,_),!0;case"pointerover":var S=_.pointerId;return _c.set(S,Ku(_c.get(S)||null,r,s,u,g,_)),!0;case"gotpointercapture":return S=_.pointerId,vc.set(S,Ku(vc.get(S)||null,r,s,u,g,_)),!0}return!1}function Ex(r){var s=po(r.target);if(s!==null){var u=To(s);if(u!==null){if(s=u.tag,s===13){if(s=fx(u),s!==null){r.blockedOn=s,kx(r.priority,function(){Sx(u)});return}}else if(s===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function pd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var u=hm(r.domEventName,r.eventSystemFlags,s[0],r.nativeEvent);if(u===null){u=r.nativeEvent;var g=new u.constructor(u.type,u);sm=g,u.target.dispatchEvent(g),sm=null}else return s=Fc(u),s!==null&&tg(s),r.blockedOn=u,!1;s.shift()}return!0}function A_(r,s,u){pd(r)&&u.delete(s)}function i2(){cm=!1,Ea!==null&&pd(Ea)&&(Ea=null),Ia!==null&&pd(Ia)&&(Ia=null),Ca!==null&&pd(Ca)&&(Ca=null),_c.forEach(A_),vc.forEach(A_)}function Yu(r,s){r.blockedOn===s&&(r.blockedOn=null,cm||(cm=!0,dn.unstable_scheduleCallback(dn.unstable_NormalPriority,i2)))}function xc(r){function s(_){return Yu(_,r)}if(0<ed.length){Yu(ed[0],r);for(var u=1;u<ed.length;u++){var g=ed[u];g.blockedOn===r&&(g.blockedOn=null)}}for(Ea!==null&&Yu(Ea,r),Ia!==null&&Yu(Ia,r),Ca!==null&&Yu(Ca,r),_c.forEach(s),vc.forEach(s),u=0;u<wa.length;u++)g=wa[u],g.blockedOn===r&&(g.blockedOn=null);for(;0<wa.length&&(u=wa[0],u.blockedOn===null);)Ex(u),u.blockedOn===null&&wa.shift()}var Cl=Ws.ReactCurrentBatchConfig,Cd=!0;function n2(r,s,u,g){var _=Zt,S=Cl.transition;Cl.transition=null;try{Zt=1,rg(r,s,u,g)}finally{Zt=_,Cl.transition=S}}function s2(r,s,u,g){var _=Zt,S=Cl.transition;Cl.transition=null;try{Zt=4,rg(r,s,u,g)}finally{Zt=_,Cl.transition=S}}function rg(r,s,u,g){if(Cd){var _=hm(r,s,u,g);if(_===null)Rf(r,s,g,Pd,u),M_(r,g);else if(r2(_,r,s,u,g))g.stopPropagation();else if(M_(r,g),s&4&&-1<t2.indexOf(r)){for(;_!==null;){var S=Fc(_);if(S!==null&&bx(S),S=hm(r,s,u,g),S===null&&Rf(r,s,g,Pd,u),S===_)break;_=S}_!==null&&g.stopPropagation()}else Rf(r,s,g,null,u)}}var Pd=null;function hm(r,s,u,g){if(Pd=null,r=Jm(g),r=po(r),r!==null)if(s=To(r),s===null)r=null;else if(u=s.tag,u===13){if(r=fx(s),r!==null)return r;r=null}else if(u===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null);return Pd=r,null}function Ix(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gb()){case Qm:return 1;case _x:return 4;case Ed:case Wb:return 16;case vx:return 536870912;default:return 16}default:return 16}}var Sa=null,ig=null,fd=null;function Cx(){if(fd)return fd;var r,s=ig,u=s.length,g,_="value"in Sa?Sa.value:Sa.textContent,S=_.length;for(r=0;r<u&&s[r]===_[r];r++);var z=u-r;for(g=1;g<=z&&s[u-g]===_[S-g];g++);return fd=_.slice(r,1<g?1-g:void 0)}function md(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function td(){return!0}function D_(){return!1}function fn(r){function s(u,g,_,S,z){this._reactName=u,this._targetInst=_,this.type=g,this.nativeEvent=S,this.target=z,this.currentTarget=null;for(var l in r)r.hasOwnProperty(l)&&(u=r[l],this[l]=u?u(S):S[l]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?td:D_,this.isPropagationStopped=D_,this}return _r(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=td)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=td)},persist:function(){},isPersistent:td}),s}var Nl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ng=fn(Nl),Bc=_r({},Nl,{view:0,detail:0}),a2=fn(Bc),Ef,If,Ju,Kd=_r({},Bc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sg,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ju&&(Ju&&r.type==="mousemove"?(Ef=r.screenX-Ju.screenX,If=r.screenY-Ju.screenY):If=Ef=0,Ju=r),Ef)},movementY:function(r){return"movementY"in r?r.movementY:If}}),L_=fn(Kd),o2=_r({},Kd,{dataTransfer:0}),l2=fn(o2),u2=_r({},Bc,{relatedTarget:0}),Cf=fn(u2),c2=_r({},Nl,{animationName:0,elapsedTime:0,pseudoElement:0}),h2=fn(c2),d2=_r({},Nl,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),p2=fn(d2),f2=_r({},Nl,{data:0}),R_=fn(f2),m2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},y2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _2(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=y2[r])?!!s[r]:!1}function sg(){return _2}var v2=_r({},Bc,{key:function(r){if(r.key){var s=m2[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=md(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?g2[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sg,charCode:function(r){return r.type==="keypress"?md(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?md(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),x2=fn(v2),w2=_r({},Kd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),B_=fn(w2),b2=_r({},Bc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sg}),S2=fn(b2),T2=_r({},Nl,{propertyName:0,elapsedTime:0,pseudoElement:0}),k2=fn(T2),E2=_r({},Kd,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),I2=fn(E2),C2=[9,13,27,32],ag=$s&&"CompositionEvent"in window,lc=null;$s&&"documentMode"in document&&(lc=document.documentMode);var P2=$s&&"TextEvent"in window&&!lc,Px=$s&&(!ag||lc&&8<lc&&11>=lc),F_=" ",O_=!1;function zx(r,s){switch(r){case"keyup":return C2.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mx(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ml=!1;function z2(r,s){switch(r){case"compositionend":return Mx(s);case"keypress":return s.which!==32?null:(O_=!0,F_);case"textInput":return r=s.data,r===F_&&O_?null:r;default:return null}}function M2(r,s){if(ml)return r==="compositionend"||!ag&&zx(r,s)?(r=Cx(),fd=ig=Sa=null,ml=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Px&&s.locale!=="ko"?null:s.data;default:return null}}var A2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function N_(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!A2[r.type]:s==="textarea"}function Ax(r,s,u,g){ux(g),s=zd(s,"onChange"),0<s.length&&(u=new ng("onChange","change",null,u,g),r.push({event:u,listeners:s}))}var uc=null,wc=null;function D2(r){$x(r,0)}function Yd(r){var s=_l(r);if(rx(s))return r}function L2(r,s){if(r==="change")return s}var Dx=!1;if($s){var Pf;if($s){var zf="oninput"in document;if(!zf){var V_=document.createElement("div");V_.setAttribute("oninput","return;"),zf=typeof V_.oninput=="function"}Pf=zf}else Pf=!1;Dx=Pf&&(!document.documentMode||9<document.documentMode)}function U_(){uc&&(uc.detachEvent("onpropertychange",Lx),wc=uc=null)}function Lx(r){if(r.propertyName==="value"&&Yd(wc)){var s=[];Ax(s,wc,r,Jm(r)),px(D2,s)}}function R2(r,s,u){r==="focusin"?(U_(),uc=s,wc=u,uc.attachEvent("onpropertychange",Lx)):r==="focusout"&&U_()}function B2(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Yd(wc)}function F2(r,s){if(r==="click")return Yd(s)}function O2(r,s){if(r==="input"||r==="change")return Yd(s)}function N2(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Yn=typeof Object.is=="function"?Object.is:N2;function bc(r,s){if(Yn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var u=Object.keys(r),g=Object.keys(s);if(u.length!==g.length)return!1;for(g=0;g<u.length;g++){var _=u[g];if(!Wf.call(s,_)||!Yn(r[_],s[_]))return!1}return!0}function j_(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function $_(r,s){var u=j_(r);r=0;for(var g;u;){if(u.nodeType===3){if(g=r+u.textContent.length,r<=s&&g>=s)return{node:u,offset:s-r};r=g}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=j_(u)}}function Rx(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?Rx(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function Bx(){for(var r=window,s=Sd();s instanceof r.HTMLIFrameElement;){try{var u=typeof s.contentWindow.location.href=="string"}catch{u=!1}if(u)r=s.contentWindow;else break;s=Sd(r.document)}return s}function og(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}function V2(r){var s=Bx(),u=r.focusedElem,g=r.selectionRange;if(s!==u&&u&&u.ownerDocument&&Rx(u.ownerDocument.documentElement,u)){if(g!==null&&og(u)){if(s=g.start,r=g.end,r===void 0&&(r=s),"selectionStart"in u)u.selectionStart=s,u.selectionEnd=Math.min(r,u.value.length);else if(r=(s=u.ownerDocument||document)&&s.defaultView||window,r.getSelection){r=r.getSelection();var _=u.textContent.length,S=Math.min(g.start,_);g=g.end===void 0?S:Math.min(g.end,_),!r.extend&&S>g&&(_=g,g=S,S=_),_=$_(u,S);var z=$_(u,g);_&&z&&(r.rangeCount!==1||r.anchorNode!==_.node||r.anchorOffset!==_.offset||r.focusNode!==z.node||r.focusOffset!==z.offset)&&(s=s.createRange(),s.setStart(_.node,_.offset),r.removeAllRanges(),S>g?(r.addRange(s),r.extend(z.node,z.offset)):(s.setEnd(z.node,z.offset),r.addRange(s)))}}for(s=[],r=u;r=r.parentNode;)r.nodeType===1&&s.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<s.length;u++)r=s[u],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var U2=$s&&"documentMode"in document&&11>=document.documentMode,gl=null,dm=null,cc=null,pm=!1;function Z_(r,s,u){var g=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;pm||gl==null||gl!==Sd(g)||(g=gl,"selectionStart"in g&&og(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),cc&&bc(cc,g)||(cc=g,g=zd(dm,"onSelect"),0<g.length&&(s=new ng("onSelect","select",null,s,u),r.push({event:s,listeners:g}),s.target=gl)))}function rd(r,s){var u={};return u[r.toLowerCase()]=s.toLowerCase(),u["Webkit"+r]="webkit"+s,u["Moz"+r]="moz"+s,u}var yl={animationend:rd("Animation","AnimationEnd"),animationiteration:rd("Animation","AnimationIteration"),animationstart:rd("Animation","AnimationStart"),transitionend:rd("Transition","TransitionEnd")},Mf={},Fx={};$s&&(Fx=document.createElement("div").style,"AnimationEvent"in window||(delete yl.animationend.animation,delete yl.animationiteration.animation,delete yl.animationstart.animation),"TransitionEvent"in window||delete yl.transitionend.transition);function Jd(r){if(Mf[r])return Mf[r];if(!yl[r])return r;var s=yl[r],u;for(u in s)if(s.hasOwnProperty(u)&&u in Fx)return Mf[r]=s[u];return r}var Ox=Jd("animationend"),Nx=Jd("animationiteration"),Vx=Jd("animationstart"),Ux=Jd("transitionend"),jx=new Map,q_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fa(r,s){jx.set(r,s),So(s,[r])}for(var Af=0;Af<q_.length;Af++){var Df=q_[Af],j2=Df.toLowerCase(),$2=Df[0].toUpperCase()+Df.slice(1);Fa(j2,"on"+$2)}Fa(Ox,"onAnimationEnd");Fa(Nx,"onAnimationIteration");Fa(Vx,"onAnimationStart");Fa("dblclick","onDoubleClick");Fa("focusin","onFocus");Fa("focusout","onBlur");Fa(Ux,"onTransitionEnd");Ml("onMouseEnter",["mouseout","mouseover"]);Ml("onMouseLeave",["mouseout","mouseover"]);Ml("onPointerEnter",["pointerout","pointerover"]);Ml("onPointerLeave",["pointerout","pointerover"]);So("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));So("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));So("onBeforeInput",["compositionend","keypress","textInput","paste"]);So("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));So("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));So("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Z2=new Set("cancel close invalid load scroll toggle".split(" ").concat(sc));function G_(r,s,u){var g=r.type||"unknown-event";r.currentTarget=u,jb(g,s,void 0,r),r.currentTarget=null}function $x(r,s){s=(s&4)!==0;for(var u=0;u<r.length;u++){var g=r[u],_=g.event;g=g.listeners;e:{var S=void 0;if(s)for(var z=g.length-1;0<=z;z--){var l=g[z],N=l.instance,F=l.currentTarget;if(l=l.listener,N!==S&&_.isPropagationStopped())break e;G_(_,l,F),S=N}else for(z=0;z<g.length;z++){if(l=g[z],N=l.instance,F=l.currentTarget,l=l.listener,N!==S&&_.isPropagationStopped())break e;G_(_,l,F),S=N}}}if(kd)throw r=lm,kd=!1,lm=null,r}function ar(r,s){var u=s[_m];u===void 0&&(u=s[_m]=new Set);var g=r+"__bubble";u.has(g)||(Zx(s,r,2,!1),u.add(g))}function Lf(r,s,u){var g=0;s&&(g|=4),Zx(u,r,g,s)}var id="_reactListening"+Math.random().toString(36).slice(2);function Sc(r){if(!r[id]){r[id]=!0,Yv.forEach(function(u){u!=="selectionchange"&&(Z2.has(u)||Lf(u,!1,r),Lf(u,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[id]||(s[id]=!0,Lf("selectionchange",!1,s))}}function Zx(r,s,u,g){switch(Ix(s)){case 1:var _=n2;break;case 4:_=s2;break;default:_=rg}u=_.bind(null,s,u,r),_=void 0,!om||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(_=!0),g?_!==void 0?r.addEventListener(s,u,{capture:!0,passive:_}):r.addEventListener(s,u,!0):_!==void 0?r.addEventListener(s,u,{passive:_}):r.addEventListener(s,u,!1)}function Rf(r,s,u,g,_){var S=g;if(!(s&1)&&!(s&2)&&g!==null)e:for(;;){if(g===null)return;var z=g.tag;if(z===3||z===4){var l=g.stateNode.containerInfo;if(l===_||l.nodeType===8&&l.parentNode===_)break;if(z===4)for(z=g.return;z!==null;){var N=z.tag;if((N===3||N===4)&&(N=z.stateNode.containerInfo,N===_||N.nodeType===8&&N.parentNode===_))return;z=z.return}for(;l!==null;){if(z=po(l),z===null)return;if(N=z.tag,N===5||N===6){g=S=z;continue e}l=l.parentNode}}g=g.return}px(function(){var F=S,pe=Jm(u),he=[];e:{var ie=jx.get(r);if(ie!==void 0){var Ie=ng,Pe=r;switch(r){case"keypress":if(md(u)===0)break e;case"keydown":case"keyup":Ie=x2;break;case"focusin":Pe="focus",Ie=Cf;break;case"focusout":Pe="blur",Ie=Cf;break;case"beforeblur":case"afterblur":Ie=Cf;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ie=L_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ie=l2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ie=S2;break;case Ox:case Nx:case Vx:Ie=h2;break;case Ux:Ie=k2;break;case"scroll":Ie=a2;break;case"wheel":Ie=I2;break;case"copy":case"cut":case"paste":Ie=p2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ie=B_}var Ce=(s&4)!==0,Ne=!Ce&&r==="scroll",re=Ce?ie!==null?ie+"Capture":null:ie;Ce=[];for(var ee=F,ce;ee!==null;){ce=ee;var Te=ce.stateNode;if(ce.tag===5&&Te!==null&&(ce=Te,re!==null&&(Te=yc(ee,re),Te!=null&&Ce.push(Tc(ee,Te,ce)))),Ne)break;ee=ee.return}0<Ce.length&&(ie=new Ie(ie,Pe,null,u,pe),he.push({event:ie,listeners:Ce}))}}if(!(s&7)){e:{if(ie=r==="mouseover"||r==="pointerover",Ie=r==="mouseout"||r==="pointerout",ie&&u!==sm&&(Pe=u.relatedTarget||u.fromElement)&&(po(Pe)||Pe[Zs]))break e;if((Ie||ie)&&(ie=pe.window===pe?pe:(ie=pe.ownerDocument)?ie.defaultView||ie.parentWindow:window,Ie?(Pe=u.relatedTarget||u.toElement,Ie=F,Pe=Pe?po(Pe):null,Pe!==null&&(Ne=To(Pe),Pe!==Ne||Pe.tag!==5&&Pe.tag!==6)&&(Pe=null)):(Ie=null,Pe=F),Ie!==Pe)){if(Ce=L_,Te="onMouseLeave",re="onMouseEnter",ee="mouse",(r==="pointerout"||r==="pointerover")&&(Ce=B_,Te="onPointerLeave",re="onPointerEnter",ee="pointer"),Ne=Ie==null?ie:_l(Ie),ce=Pe==null?ie:_l(Pe),ie=new Ce(Te,ee+"leave",Ie,u,pe),ie.target=Ne,ie.relatedTarget=ce,Te=null,po(pe)===F&&(Ce=new Ce(re,ee+"enter",Pe,u,pe),Ce.target=ce,Ce.relatedTarget=Ne,Te=Ce),Ne=Te,Ie&&Pe)t:{for(Ce=Ie,re=Pe,ee=0,ce=Ce;ce;ce=dl(ce))ee++;for(ce=0,Te=re;Te;Te=dl(Te))ce++;for(;0<ee-ce;)Ce=dl(Ce),ee--;for(;0<ce-ee;)re=dl(re),ce--;for(;ee--;){if(Ce===re||re!==null&&Ce===re.alternate)break t;Ce=dl(Ce),re=dl(re)}Ce=null}else Ce=null;Ie!==null&&W_(he,ie,Ie,Ce,!1),Pe!==null&&Ne!==null&&W_(he,Ne,Pe,Ce,!0)}}e:{if(ie=F?_l(F):window,Ie=ie.nodeName&&ie.nodeName.toLowerCase(),Ie==="select"||Ie==="input"&&ie.type==="file")var $e=L2;else if(N_(ie))if(Dx)$e=O2;else{$e=B2;var Ye=R2}else(Ie=ie.nodeName)&&Ie.toLowerCase()==="input"&&(ie.type==="checkbox"||ie.type==="radio")&&($e=F2);if($e&&($e=$e(r,F))){Ax(he,$e,u,pe);break e}Ye&&Ye(r,ie,F),r==="focusout"&&(Ye=ie._wrapperState)&&Ye.controlled&&ie.type==="number"&&em(ie,"number",ie.value)}switch(Ye=F?_l(F):window,r){case"focusin":(N_(Ye)||Ye.contentEditable==="true")&&(gl=Ye,dm=F,cc=null);break;case"focusout":cc=dm=gl=null;break;case"mousedown":pm=!0;break;case"contextmenu":case"mouseup":case"dragend":pm=!1,Z_(he,u,pe);break;case"selectionchange":if(U2)break;case"keydown":case"keyup":Z_(he,u,pe)}var it;if(ag)e:{switch(r){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else ml?zx(r,u)&&(We="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(We="onCompositionStart");We&&(Px&&u.locale!=="ko"&&(ml||We!=="onCompositionStart"?We==="onCompositionEnd"&&ml&&(it=Cx()):(Sa=pe,ig="value"in Sa?Sa.value:Sa.textContent,ml=!0)),Ye=zd(F,We),0<Ye.length&&(We=new R_(We,r,null,u,pe),he.push({event:We,listeners:Ye}),it?We.data=it:(it=Mx(u),it!==null&&(We.data=it)))),(it=P2?z2(r,u):M2(r,u))&&(F=zd(F,"onBeforeInput"),0<F.length&&(pe=new R_("onBeforeInput","beforeinput",null,u,pe),he.push({event:pe,listeners:F}),pe.data=it))}$x(he,s)})}function Tc(r,s,u){return{instance:r,listener:s,currentTarget:u}}function zd(r,s){for(var u=s+"Capture",g=[];r!==null;){var _=r,S=_.stateNode;_.tag===5&&S!==null&&(_=S,S=yc(r,u),S!=null&&g.unshift(Tc(r,S,_)),S=yc(r,s),S!=null&&g.push(Tc(r,S,_))),r=r.return}return g}function dl(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function W_(r,s,u,g,_){for(var S=s._reactName,z=[];u!==null&&u!==g;){var l=u,N=l.alternate,F=l.stateNode;if(N!==null&&N===g)break;l.tag===5&&F!==null&&(l=F,_?(N=yc(u,S),N!=null&&z.unshift(Tc(u,N,l))):_||(N=yc(u,S),N!=null&&z.push(Tc(u,N,l)))),u=u.return}z.length!==0&&r.push({event:s,listeners:z})}var q2=/\r\n?/g,G2=/\u0000|\uFFFD/g;function H_(r){return(typeof r=="string"?r:""+r).replace(q2,`
`).replace(G2,"")}function nd(r,s,u){if(s=H_(s),H_(r)!==s&&u)throw Error(Le(425))}function Md(){}var fm=null,mm=null;function gm(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ym=typeof setTimeout=="function"?setTimeout:void 0,W2=typeof clearTimeout=="function"?clearTimeout:void 0,X_=typeof Promise=="function"?Promise:void 0,H2=typeof queueMicrotask=="function"?queueMicrotask:typeof X_<"u"?function(r){return X_.resolve(null).then(r).catch(X2)}:ym;function X2(r){setTimeout(function(){throw r})}function Bf(r,s){var u=s,g=0;do{var _=u.nextSibling;if(r.removeChild(u),_&&_.nodeType===8)if(u=_.data,u==="/$"){if(g===0){r.removeChild(_),xc(s);return}g--}else u!=="$"&&u!=="$?"&&u!=="$!"||g++;u=_}while(u);xc(s)}function Pa(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return r}function K_(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"){if(s===0)return r;s--}else u==="/$"&&s++}r=r.previousSibling}return null}var Vl=Math.random().toString(36).slice(2),ms="__reactFiber$"+Vl,kc="__reactProps$"+Vl,Zs="__reactContainer$"+Vl,_m="__reactEvents$"+Vl,K2="__reactListeners$"+Vl,Y2="__reactHandles$"+Vl;function po(r){var s=r[ms];if(s)return s;for(var u=r.parentNode;u;){if(s=u[Zs]||u[ms]){if(u=s.alternate,s.child!==null||u!==null&&u.child!==null)for(r=K_(r);r!==null;){if(u=r[ms])return u;r=K_(r)}return s}r=u,u=r.parentNode}return null}function Fc(r){return r=r[ms]||r[Zs],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function _l(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(Le(33))}function Qd(r){return r[kc]||null}var vm=[],vl=-1;function Oa(r){return{current:r}}function or(r){0>vl||(r.current=vm[vl],vm[vl]=null,vl--)}function tr(r,s){vl++,vm[vl]=r.current,r.current=s}var Ba={},Ti=Oa(Ba),Ji=Oa(!1),_o=Ba;function Al(r,s){var u=r.type.contextTypes;if(!u)return Ba;var g=r.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===s)return g.__reactInternalMemoizedMaskedChildContext;var _={},S;for(S in u)_[S]=s[S];return g&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=s,r.__reactInternalMemoizedMaskedChildContext=_),_}function Qi(r){return r=r.childContextTypes,r!=null}function Ad(){or(Ji),or(Ti)}function Y_(r,s,u){if(Ti.current!==Ba)throw Error(Le(168));tr(Ti,s),tr(Ji,u)}function qx(r,s,u){var g=r.stateNode;if(s=s.childContextTypes,typeof g.getChildContext!="function")return u;g=g.getChildContext();for(var _ in g)if(!(_ in s))throw Error(Le(108,Rb(r)||"Unknown",_));return _r({},u,g)}function Dd(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Ba,_o=Ti.current,tr(Ti,r),tr(Ji,Ji.current),!0}function J_(r,s,u){var g=r.stateNode;if(!g)throw Error(Le(169));u?(r=qx(r,s,_o),g.__reactInternalMemoizedMergedChildContext=r,or(Ji),or(Ti),tr(Ti,r)):or(Ji),tr(Ji,u)}var Ns=null,ep=!1,Ff=!1;function Gx(r){Ns===null?Ns=[r]:Ns.push(r)}function J2(r){ep=!0,Gx(r)}function Na(){if(!Ff&&Ns!==null){Ff=!0;var r=0,s=Zt;try{var u=Ns;for(Zt=1;r<u.length;r++){var g=u[r];do g=g(!0);while(g!==null)}Ns=null,ep=!1}catch(_){throw Ns!==null&&(Ns=Ns.slice(r+1)),yx(Qm,Na),_}finally{Zt=s,Ff=!1}}return null}var xl=[],wl=0,Ld=null,Rd=0,En=[],In=0,vo=null,Vs=1,Us="";function co(r,s){xl[wl++]=Rd,xl[wl++]=Ld,Ld=r,Rd=s}function Wx(r,s,u){En[In++]=Vs,En[In++]=Us,En[In++]=vo,vo=r;var g=Vs;r=Us;var _=32-Xn(g)-1;g&=~(1<<_),u+=1;var S=32-Xn(s)+_;if(30<S){var z=_-_%5;S=(g&(1<<z)-1).toString(32),g>>=z,_-=z,Vs=1<<32-Xn(s)+_|u<<_|g,Us=S+r}else Vs=1<<S|u<<_|g,Us=r}function lg(r){r.return!==null&&(co(r,1),Wx(r,1,0))}function ug(r){for(;r===Ld;)Ld=xl[--wl],xl[wl]=null,Rd=xl[--wl],xl[wl]=null;for(;r===vo;)vo=En[--In],En[In]=null,Us=En[--In],En[In]=null,Vs=En[--In],En[In]=null}var hn=null,cn=null,dr=!1,Hn=null;function Hx(r,s){var u=Cn(5,null,null,0);u.elementType="DELETED",u.stateNode=s,u.return=r,s=r.deletions,s===null?(r.deletions=[u],r.flags|=16):s.push(u)}function Q_(r,s){switch(r.tag){case 5:var u=r.type;return s=s.nodeType!==1||u.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(r.stateNode=s,hn=r,cn=Pa(s.firstChild),!0):!1;case 6:return s=r.pendingProps===""||s.nodeType!==3?null:s,s!==null?(r.stateNode=s,hn=r,cn=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(u=vo!==null?{id:Vs,overflow:Us}:null,r.memoizedState={dehydrated:s,treeContext:u,retryLane:1073741824},u=Cn(18,null,null,0),u.stateNode=s,u.return=r,r.child=u,hn=r,cn=null,!0):!1;default:return!1}}function xm(r){return(r.mode&1)!==0&&(r.flags&128)===0}function wm(r){if(dr){var s=cn;if(s){var u=s;if(!Q_(r,s)){if(xm(r))throw Error(Le(418));s=Pa(u.nextSibling);var g=hn;s&&Q_(r,s)?Hx(g,u):(r.flags=r.flags&-4097|2,dr=!1,hn=r)}}else{if(xm(r))throw Error(Le(418));r.flags=r.flags&-4097|2,dr=!1,hn=r}}}function ev(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;hn=r}function sd(r){if(r!==hn)return!1;if(!dr)return ev(r),dr=!0,!1;var s;if((s=r.tag!==3)&&!(s=r.tag!==5)&&(s=r.type,s=s!=="head"&&s!=="body"&&!gm(r.type,r.memoizedProps)),s&&(s=cn)){if(xm(r))throw Xx(),Error(Le(418));for(;s;)Hx(r,s),s=Pa(s.nextSibling)}if(ev(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(Le(317));e:{for(r=r.nextSibling,s=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"){if(s===0){cn=Pa(r.nextSibling);break e}s--}else u!=="$"&&u!=="$!"&&u!=="$?"||s++}r=r.nextSibling}cn=null}}else cn=hn?Pa(r.stateNode.nextSibling):null;return!0}function Xx(){for(var r=cn;r;)r=Pa(r.nextSibling)}function Dl(){cn=hn=null,dr=!1}function cg(r){Hn===null?Hn=[r]:Hn.push(r)}var Q2=Ws.ReactCurrentBatchConfig;function Qu(r,s,u){if(r=u.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(Le(309));var g=u.stateNode}if(!g)throw Error(Le(147,r));var _=g,S=""+r;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===S?s.ref:(s=function(z){var l=_.refs;z===null?delete l[S]:l[S]=z},s._stringRef=S,s)}if(typeof r!="string")throw Error(Le(284));if(!u._owner)throw Error(Le(290,r))}return r}function ad(r,s){throw r=Object.prototype.toString.call(s),Error(Le(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r))}function tv(r){var s=r._init;return s(r._payload)}function Kx(r){function s(re,ee){if(r){var ce=re.deletions;ce===null?(re.deletions=[ee],re.flags|=16):ce.push(ee)}}function u(re,ee){if(!r)return null;for(;ee!==null;)s(re,ee),ee=ee.sibling;return null}function g(re,ee){for(re=new Map;ee!==null;)ee.key!==null?re.set(ee.key,ee):re.set(ee.index,ee),ee=ee.sibling;return re}function _(re,ee){return re=Da(re,ee),re.index=0,re.sibling=null,re}function S(re,ee,ce){return re.index=ce,r?(ce=re.alternate,ce!==null?(ce=ce.index,ce<ee?(re.flags|=2,ee):ce):(re.flags|=2,ee)):(re.flags|=1048576,ee)}function z(re){return r&&re.alternate===null&&(re.flags|=2),re}function l(re,ee,ce,Te){return ee===null||ee.tag!==6?(ee=Zf(ce,re.mode,Te),ee.return=re,ee):(ee=_(ee,ce),ee.return=re,ee)}function N(re,ee,ce,Te){var $e=ce.type;return $e===fl?pe(re,ee,ce.props.children,Te,ce.key):ee!==null&&(ee.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===va&&tv($e)===ee.type)?(Te=_(ee,ce.props),Te.ref=Qu(re,ee,ce),Te.return=re,Te):(Te=bd(ce.type,ce.key,ce.props,null,re.mode,Te),Te.ref=Qu(re,ee,ce),Te.return=re,Te)}function F(re,ee,ce,Te){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ce.containerInfo||ee.stateNode.implementation!==ce.implementation?(ee=qf(ce,re.mode,Te),ee.return=re,ee):(ee=_(ee,ce.children||[]),ee.return=re,ee)}function pe(re,ee,ce,Te,$e){return ee===null||ee.tag!==7?(ee=yo(ce,re.mode,Te,$e),ee.return=re,ee):(ee=_(ee,ce),ee.return=re,ee)}function he(re,ee,ce){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=Zf(""+ee,re.mode,ce),ee.return=re,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case Xh:return ce=bd(ee.type,ee.key,ee.props,null,re.mode,ce),ce.ref=Qu(re,null,ee),ce.return=re,ce;case pl:return ee=qf(ee,re.mode,ce),ee.return=re,ee;case va:var Te=ee._init;return he(re,Te(ee._payload),ce)}if(ic(ee)||Hu(ee))return ee=yo(ee,re.mode,ce,null),ee.return=re,ee;ad(re,ee)}return null}function ie(re,ee,ce,Te){var $e=ee!==null?ee.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number")return $e!==null?null:l(re,ee,""+ce,Te);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case Xh:return ce.key===$e?N(re,ee,ce,Te):null;case pl:return ce.key===$e?F(re,ee,ce,Te):null;case va:return $e=ce._init,ie(re,ee,$e(ce._payload),Te)}if(ic(ce)||Hu(ce))return $e!==null?null:pe(re,ee,ce,Te,null);ad(re,ce)}return null}function Ie(re,ee,ce,Te,$e){if(typeof Te=="string"&&Te!==""||typeof Te=="number")return re=re.get(ce)||null,l(ee,re,""+Te,$e);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case Xh:return re=re.get(Te.key===null?ce:Te.key)||null,N(ee,re,Te,$e);case pl:return re=re.get(Te.key===null?ce:Te.key)||null,F(ee,re,Te,$e);case va:var Ye=Te._init;return Ie(re,ee,ce,Ye(Te._payload),$e)}if(ic(Te)||Hu(Te))return re=re.get(ce)||null,pe(ee,re,Te,$e,null);ad(ee,Te)}return null}function Pe(re,ee,ce,Te){for(var $e=null,Ye=null,it=ee,We=ee=0,qt=null;it!==null&&We<ce.length;We++){it.index>We?(qt=it,it=null):qt=it.sibling;var at=ie(re,it,ce[We],Te);if(at===null){it===null&&(it=qt);break}r&&it&&at.alternate===null&&s(re,it),ee=S(at,ee,We),Ye===null?$e=at:Ye.sibling=at,Ye=at,it=qt}if(We===ce.length)return u(re,it),dr&&co(re,We),$e;if(it===null){for(;We<ce.length;We++)it=he(re,ce[We],Te),it!==null&&(ee=S(it,ee,We),Ye===null?$e=it:Ye.sibling=it,Ye=it);return dr&&co(re,We),$e}for(it=g(re,it);We<ce.length;We++)qt=Ie(it,re,We,ce[We],Te),qt!==null&&(r&&qt.alternate!==null&&it.delete(qt.key===null?We:qt.key),ee=S(qt,ee,We),Ye===null?$e=qt:Ye.sibling=qt,Ye=qt);return r&&it.forEach(function(Ar){return s(re,Ar)}),dr&&co(re,We),$e}function Ce(re,ee,ce,Te){var $e=Hu(ce);if(typeof $e!="function")throw Error(Le(150));if(ce=$e.call(ce),ce==null)throw Error(Le(151));for(var Ye=$e=null,it=ee,We=ee=0,qt=null,at=ce.next();it!==null&&!at.done;We++,at=ce.next()){it.index>We?(qt=it,it=null):qt=it.sibling;var Ar=ie(re,it,at.value,Te);if(Ar===null){it===null&&(it=qt);break}r&&it&&Ar.alternate===null&&s(re,it),ee=S(Ar,ee,We),Ye===null?$e=Ar:Ye.sibling=Ar,Ye=Ar,it=qt}if(at.done)return u(re,it),dr&&co(re,We),$e;if(it===null){for(;!at.done;We++,at=ce.next())at=he(re,at.value,Te),at!==null&&(ee=S(at,ee,We),Ye===null?$e=at:Ye.sibling=at,Ye=at);return dr&&co(re,We),$e}for(it=g(re,it);!at.done;We++,at=ce.next())at=Ie(it,re,We,at.value,Te),at!==null&&(r&&at.alternate!==null&&it.delete(at.key===null?We:at.key),ee=S(at,ee,We),Ye===null?$e=at:Ye.sibling=at,Ye=at);return r&&it.forEach(function(Br){return s(re,Br)}),dr&&co(re,We),$e}function Ne(re,ee,ce,Te){if(typeof ce=="object"&&ce!==null&&ce.type===fl&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case Xh:e:{for(var $e=ce.key,Ye=ee;Ye!==null;){if(Ye.key===$e){if($e=ce.type,$e===fl){if(Ye.tag===7){u(re,Ye.sibling),ee=_(Ye,ce.props.children),ee.return=re,re=ee;break e}}else if(Ye.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===va&&tv($e)===Ye.type){u(re,Ye.sibling),ee=_(Ye,ce.props),ee.ref=Qu(re,Ye,ce),ee.return=re,re=ee;break e}u(re,Ye);break}else s(re,Ye);Ye=Ye.sibling}ce.type===fl?(ee=yo(ce.props.children,re.mode,Te,ce.key),ee.return=re,re=ee):(Te=bd(ce.type,ce.key,ce.props,null,re.mode,Te),Te.ref=Qu(re,ee,ce),Te.return=re,re=Te)}return z(re);case pl:e:{for(Ye=ce.key;ee!==null;){if(ee.key===Ye)if(ee.tag===4&&ee.stateNode.containerInfo===ce.containerInfo&&ee.stateNode.implementation===ce.implementation){u(re,ee.sibling),ee=_(ee,ce.children||[]),ee.return=re,re=ee;break e}else{u(re,ee);break}else s(re,ee);ee=ee.sibling}ee=qf(ce,re.mode,Te),ee.return=re,re=ee}return z(re);case va:return Ye=ce._init,Ne(re,ee,Ye(ce._payload),Te)}if(ic(ce))return Pe(re,ee,ce,Te);if(Hu(ce))return Ce(re,ee,ce,Te);ad(re,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"?(ce=""+ce,ee!==null&&ee.tag===6?(u(re,ee.sibling),ee=_(ee,ce),ee.return=re,re=ee):(u(re,ee),ee=Zf(ce,re.mode,Te),ee.return=re,re=ee),z(re)):u(re,ee)}return Ne}var Ll=Kx(!0),Yx=Kx(!1),Bd=Oa(null),Fd=null,bl=null,hg=null;function dg(){hg=bl=Fd=null}function pg(r){var s=Bd.current;or(Bd),r._currentValue=s}function bm(r,s,u){for(;r!==null;){var g=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,g!==null&&(g.childLanes|=s)):g!==null&&(g.childLanes&s)!==s&&(g.childLanes|=s),r===u)break;r=r.return}}function Pl(r,s){Fd=r,hg=bl=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&s&&(Yi=!0),r.firstContext=null)}function zn(r){var s=r._currentValue;if(hg!==r)if(r={context:r,memoizedValue:s,next:null},bl===null){if(Fd===null)throw Error(Le(308));bl=r,Fd.dependencies={lanes:0,firstContext:r}}else bl=bl.next=r;return s}var fo=null;function fg(r){fo===null?fo=[r]:fo.push(r)}function Jx(r,s,u,g){var _=s.interleaved;return _===null?(u.next=u,fg(s)):(u.next=_.next,_.next=u),s.interleaved=u,qs(r,g)}function qs(r,s){r.lanes|=s;var u=r.alternate;for(u!==null&&(u.lanes|=s),u=r,r=r.return;r!==null;)r.childLanes|=s,u=r.alternate,u!==null&&(u.childLanes|=s),u=r,r=r.return;return u.tag===3?u.stateNode:null}var xa=!1;function mg(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qx(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function js(r,s){return{eventTime:r,lane:s,tag:0,payload:null,callback:null,next:null}}function za(r,s,u){var g=r.updateQueue;if(g===null)return null;if(g=g.shared,Lt&2){var _=g.pending;return _===null?s.next=s:(s.next=_.next,_.next=s),g.pending=s,qs(r,u)}return _=g.interleaved,_===null?(s.next=s,fg(g)):(s.next=_.next,_.next=s),g.interleaved=s,qs(r,u)}function gd(r,s,u){if(s=s.updateQueue,s!==null&&(s=s.shared,(u&4194240)!==0)){var g=s.lanes;g&=r.pendingLanes,u|=g,s.lanes=u,eg(r,u)}}function rv(r,s){var u=r.updateQueue,g=r.alternate;if(g!==null&&(g=g.updateQueue,u===g)){var _=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var z={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};S===null?_=S=z:S=S.next=z,u=u.next}while(u!==null);S===null?_=S=s:S=S.next=s}else _=S=s;u={baseState:g.baseState,firstBaseUpdate:_,lastBaseUpdate:S,shared:g.shared,effects:g.effects},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=s:r.next=s,u.lastBaseUpdate=s}function Od(r,s,u,g){var _=r.updateQueue;xa=!1;var S=_.firstBaseUpdate,z=_.lastBaseUpdate,l=_.shared.pending;if(l!==null){_.shared.pending=null;var N=l,F=N.next;N.next=null,z===null?S=F:z.next=F,z=N;var pe=r.alternate;pe!==null&&(pe=pe.updateQueue,l=pe.lastBaseUpdate,l!==z&&(l===null?pe.firstBaseUpdate=F:l.next=F,pe.lastBaseUpdate=N))}if(S!==null){var he=_.baseState;z=0,pe=F=N=null,l=S;do{var ie=l.lane,Ie=l.eventTime;if((g&ie)===ie){pe!==null&&(pe=pe.next={eventTime:Ie,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var Pe=r,Ce=l;switch(ie=s,Ie=u,Ce.tag){case 1:if(Pe=Ce.payload,typeof Pe=="function"){he=Pe.call(Ie,he,ie);break e}he=Pe;break e;case 3:Pe.flags=Pe.flags&-65537|128;case 0:if(Pe=Ce.payload,ie=typeof Pe=="function"?Pe.call(Ie,he,ie):Pe,ie==null)break e;he=_r({},he,ie);break e;case 2:xa=!0}}l.callback!==null&&l.lane!==0&&(r.flags|=64,ie=_.effects,ie===null?_.effects=[l]:ie.push(l))}else Ie={eventTime:Ie,lane:ie,tag:l.tag,payload:l.payload,callback:l.callback,next:null},pe===null?(F=pe=Ie,N=he):pe=pe.next=Ie,z|=ie;if(l=l.next,l===null){if(l=_.shared.pending,l===null)break;ie=l,l=ie.next,ie.next=null,_.lastBaseUpdate=ie,_.shared.pending=null}}while(!0);if(pe===null&&(N=he),_.baseState=N,_.firstBaseUpdate=F,_.lastBaseUpdate=pe,s=_.shared.interleaved,s!==null){_=s;do z|=_.lane,_=_.next;while(_!==s)}else S===null&&(_.shared.lanes=0);wo|=z,r.lanes=z,r.memoizedState=he}}function iv(r,s,u){if(r=s.effects,s.effects=null,r!==null)for(s=0;s<r.length;s++){var g=r[s],_=g.callback;if(_!==null){if(g.callback=null,g=u,typeof _!="function")throw Error(Le(191,_));_.call(g)}}}var Oc={},ys=Oa(Oc),Ec=Oa(Oc),Ic=Oa(Oc);function mo(r){if(r===Oc)throw Error(Le(174));return r}function gg(r,s){switch(tr(Ic,s),tr(Ec,r),tr(ys,Oc),r=s.nodeType,r){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:rm(null,"");break;default:r=r===8?s.parentNode:s,s=r.namespaceURI||null,r=r.tagName,s=rm(s,r)}or(ys),tr(ys,s)}function Rl(){or(ys),or(Ec),or(Ic)}function e0(r){mo(Ic.current);var s=mo(ys.current),u=rm(s,r.type);s!==u&&(tr(Ec,r),tr(ys,u))}function yg(r){Ec.current===r&&(or(ys),or(Ec))}var gr=Oa(0);function Nd(r){for(var s=r;s!==null;){if(s.tag===13){var u=s.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Of=[];function _g(){for(var r=0;r<Of.length;r++)Of[r]._workInProgressVersionPrimary=null;Of.length=0}var yd=Ws.ReactCurrentDispatcher,Nf=Ws.ReactCurrentBatchConfig,xo=0,yr=null,jr=null,Yr=null,Vd=!1,hc=!1,Cc=0,eS=0;function wi(){throw Error(Le(321))}function vg(r,s){if(s===null)return!1;for(var u=0;u<s.length&&u<r.length;u++)if(!Yn(r[u],s[u]))return!1;return!0}function xg(r,s,u,g,_,S){if(xo=S,yr=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,yd.current=r===null||r.memoizedState===null?nS:sS,r=u(g,_),hc){S=0;do{if(hc=!1,Cc=0,25<=S)throw Error(Le(301));S+=1,Yr=jr=null,s.updateQueue=null,yd.current=aS,r=u(g,_)}while(hc)}if(yd.current=Ud,s=jr!==null&&jr.next!==null,xo=0,Yr=jr=yr=null,Vd=!1,s)throw Error(Le(300));return r}function wg(){var r=Cc!==0;return Cc=0,r}function fs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yr===null?yr.memoizedState=Yr=r:Yr=Yr.next=r,Yr}function Mn(){if(jr===null){var r=yr.alternate;r=r!==null?r.memoizedState:null}else r=jr.next;var s=Yr===null?yr.memoizedState:Yr.next;if(s!==null)Yr=s,jr=r;else{if(r===null)throw Error(Le(310));jr=r,r={memoizedState:jr.memoizedState,baseState:jr.baseState,baseQueue:jr.baseQueue,queue:jr.queue,next:null},Yr===null?yr.memoizedState=Yr=r:Yr=Yr.next=r}return Yr}function Pc(r,s){return typeof s=="function"?s(r):s}function Vf(r){var s=Mn(),u=s.queue;if(u===null)throw Error(Le(311));u.lastRenderedReducer=r;var g=jr,_=g.baseQueue,S=u.pending;if(S!==null){if(_!==null){var z=_.next;_.next=S.next,S.next=z}g.baseQueue=_=S,u.pending=null}if(_!==null){S=_.next,g=g.baseState;var l=z=null,N=null,F=S;do{var pe=F.lane;if((xo&pe)===pe)N!==null&&(N=N.next={lane:0,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),g=F.hasEagerState?F.eagerState:r(g,F.action);else{var he={lane:pe,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null};N===null?(l=N=he,z=g):N=N.next=he,yr.lanes|=pe,wo|=pe}F=F.next}while(F!==null&&F!==S);N===null?z=g:N.next=l,Yn(g,s.memoizedState)||(Yi=!0),s.memoizedState=g,s.baseState=z,s.baseQueue=N,u.lastRenderedState=g}if(r=u.interleaved,r!==null){_=r;do S=_.lane,yr.lanes|=S,wo|=S,_=_.next;while(_!==r)}else _===null&&(u.lanes=0);return[s.memoizedState,u.dispatch]}function Uf(r){var s=Mn(),u=s.queue;if(u===null)throw Error(Le(311));u.lastRenderedReducer=r;var g=u.dispatch,_=u.pending,S=s.memoizedState;if(_!==null){u.pending=null;var z=_=_.next;do S=r(S,z.action),z=z.next;while(z!==_);Yn(S,s.memoizedState)||(Yi=!0),s.memoizedState=S,s.baseQueue===null&&(s.baseState=S),u.lastRenderedState=S}return[S,g]}function t0(){}function r0(r,s){var u=yr,g=Mn(),_=s(),S=!Yn(g.memoizedState,_);if(S&&(g.memoizedState=_,Yi=!0),g=g.queue,bg(s0.bind(null,u,g,r),[r]),g.getSnapshot!==s||S||Yr!==null&&Yr.memoizedState.tag&1){if(u.flags|=2048,zc(9,n0.bind(null,u,g,_,s),void 0,null),Jr===null)throw Error(Le(349));xo&30||i0(u,s,_)}return _}function i0(r,s,u){r.flags|=16384,r={getSnapshot:s,value:u},s=yr.updateQueue,s===null?(s={lastEffect:null,stores:null},yr.updateQueue=s,s.stores=[r]):(u=s.stores,u===null?s.stores=[r]:u.push(r))}function n0(r,s,u,g){s.value=u,s.getSnapshot=g,a0(s)&&o0(r)}function s0(r,s,u){return u(function(){a0(s)&&o0(r)})}function a0(r){var s=r.getSnapshot;r=r.value;try{var u=s();return!Yn(r,u)}catch{return!0}}function o0(r){var s=qs(r,1);s!==null&&Kn(s,r,1,-1)}function nv(r){var s=fs();return typeof r=="function"&&(r=r()),s.memoizedState=s.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pc,lastRenderedState:r},s.queue=r,r=r.dispatch=iS.bind(null,yr,r),[s.memoizedState,r]}function zc(r,s,u,g){return r={tag:r,create:s,destroy:u,deps:g,next:null},s=yr.updateQueue,s===null?(s={lastEffect:null,stores:null},yr.updateQueue=s,s.lastEffect=r.next=r):(u=s.lastEffect,u===null?s.lastEffect=r.next=r:(g=u.next,u.next=r,r.next=g,s.lastEffect=r)),r}function l0(){return Mn().memoizedState}function _d(r,s,u,g){var _=fs();yr.flags|=r,_.memoizedState=zc(1|s,u,void 0,g===void 0?null:g)}function tp(r,s,u,g){var _=Mn();g=g===void 0?null:g;var S=void 0;if(jr!==null){var z=jr.memoizedState;if(S=z.destroy,g!==null&&vg(g,z.deps)){_.memoizedState=zc(s,u,S,g);return}}yr.flags|=r,_.memoizedState=zc(1|s,u,S,g)}function sv(r,s){return _d(8390656,8,r,s)}function bg(r,s){return tp(2048,8,r,s)}function u0(r,s){return tp(4,2,r,s)}function c0(r,s){return tp(4,4,r,s)}function h0(r,s){if(typeof s=="function")return r=r(),s(r),function(){s(null)};if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function d0(r,s,u){return u=u!=null?u.concat([r]):null,tp(4,4,h0.bind(null,s,r),u)}function Sg(){}function p0(r,s){var u=Mn();s=s===void 0?null:s;var g=u.memoizedState;return g!==null&&s!==null&&vg(s,g[1])?g[0]:(u.memoizedState=[r,s],r)}function f0(r,s){var u=Mn();s=s===void 0?null:s;var g=u.memoizedState;return g!==null&&s!==null&&vg(s,g[1])?g[0]:(r=r(),u.memoizedState=[r,s],r)}function m0(r,s,u){return xo&21?(Yn(u,s)||(u=xx(),yr.lanes|=u,wo|=u,r.baseState=!0),s):(r.baseState&&(r.baseState=!1,Yi=!0),r.memoizedState=u)}function tS(r,s){var u=Zt;Zt=u!==0&&4>u?u:4,r(!0);var g=Nf.transition;Nf.transition={};try{r(!1),s()}finally{Zt=u,Nf.transition=g}}function g0(){return Mn().memoizedState}function rS(r,s,u){var g=Aa(r);if(u={lane:g,action:u,hasEagerState:!1,eagerState:null,next:null},y0(r))_0(s,u);else if(u=Jx(r,s,u,g),u!==null){var _=Fi();Kn(u,r,g,_),v0(u,s,g)}}function iS(r,s,u){var g=Aa(r),_={lane:g,action:u,hasEagerState:!1,eagerState:null,next:null};if(y0(r))_0(s,_);else{var S=r.alternate;if(r.lanes===0&&(S===null||S.lanes===0)&&(S=s.lastRenderedReducer,S!==null))try{var z=s.lastRenderedState,l=S(z,u);if(_.hasEagerState=!0,_.eagerState=l,Yn(l,z)){var N=s.interleaved;N===null?(_.next=_,fg(s)):(_.next=N.next,N.next=_),s.interleaved=_;return}}catch{}finally{}u=Jx(r,s,_,g),u!==null&&(_=Fi(),Kn(u,r,g,_),v0(u,s,g))}}function y0(r){var s=r.alternate;return r===yr||s!==null&&s===yr}function _0(r,s){hc=Vd=!0;var u=r.pending;u===null?s.next=s:(s.next=u.next,u.next=s),r.pending=s}function v0(r,s,u){if(u&4194240){var g=s.lanes;g&=r.pendingLanes,u|=g,s.lanes=u,eg(r,u)}}var Ud={readContext:zn,useCallback:wi,useContext:wi,useEffect:wi,useImperativeHandle:wi,useInsertionEffect:wi,useLayoutEffect:wi,useMemo:wi,useReducer:wi,useRef:wi,useState:wi,useDebugValue:wi,useDeferredValue:wi,useTransition:wi,useMutableSource:wi,useSyncExternalStore:wi,useId:wi,unstable_isNewReconciler:!1},nS={readContext:zn,useCallback:function(r,s){return fs().memoizedState=[r,s===void 0?null:s],r},useContext:zn,useEffect:sv,useImperativeHandle:function(r,s,u){return u=u!=null?u.concat([r]):null,_d(4194308,4,h0.bind(null,s,r),u)},useLayoutEffect:function(r,s){return _d(4194308,4,r,s)},useInsertionEffect:function(r,s){return _d(4,2,r,s)},useMemo:function(r,s){var u=fs();return s=s===void 0?null:s,r=r(),u.memoizedState=[r,s],r},useReducer:function(r,s,u){var g=fs();return s=u!==void 0?u(s):s,g.memoizedState=g.baseState=s,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:s},g.queue=r,r=r.dispatch=rS.bind(null,yr,r),[g.memoizedState,r]},useRef:function(r){var s=fs();return r={current:r},s.memoizedState=r},useState:nv,useDebugValue:Sg,useDeferredValue:function(r){return fs().memoizedState=r},useTransition:function(){var r=nv(!1),s=r[0];return r=tS.bind(null,r[1]),fs().memoizedState=r,[s,r]},useMutableSource:function(){},useSyncExternalStore:function(r,s,u){var g=yr,_=fs();if(dr){if(u===void 0)throw Error(Le(407));u=u()}else{if(u=s(),Jr===null)throw Error(Le(349));xo&30||i0(g,s,u)}_.memoizedState=u;var S={value:u,getSnapshot:s};return _.queue=S,sv(s0.bind(null,g,S,r),[r]),g.flags|=2048,zc(9,n0.bind(null,g,S,u,s),void 0,null),u},useId:function(){var r=fs(),s=Jr.identifierPrefix;if(dr){var u=Us,g=Vs;u=(g&~(1<<32-Xn(g)-1)).toString(32)+u,s=":"+s+"R"+u,u=Cc++,0<u&&(s+="H"+u.toString(32)),s+=":"}else u=eS++,s=":"+s+"r"+u.toString(32)+":";return r.memoizedState=s},unstable_isNewReconciler:!1},sS={readContext:zn,useCallback:p0,useContext:zn,useEffect:bg,useImperativeHandle:d0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:f0,useReducer:Vf,useRef:l0,useState:function(){return Vf(Pc)},useDebugValue:Sg,useDeferredValue:function(r){var s=Mn();return m0(s,jr.memoizedState,r)},useTransition:function(){var r=Vf(Pc)[0],s=Mn().memoizedState;return[r,s]},useMutableSource:t0,useSyncExternalStore:r0,useId:g0,unstable_isNewReconciler:!1},aS={readContext:zn,useCallback:p0,useContext:zn,useEffect:bg,useImperativeHandle:d0,useInsertionEffect:u0,useLayoutEffect:c0,useMemo:f0,useReducer:Uf,useRef:l0,useState:function(){return Uf(Pc)},useDebugValue:Sg,useDeferredValue:function(r){var s=Mn();return jr===null?s.memoizedState=r:m0(s,jr.memoizedState,r)},useTransition:function(){var r=Uf(Pc)[0],s=Mn().memoizedState;return[r,s]},useMutableSource:t0,useSyncExternalStore:r0,useId:g0,unstable_isNewReconciler:!1};function Gn(r,s){if(r&&r.defaultProps){s=_r({},s),r=r.defaultProps;for(var u in r)s[u]===void 0&&(s[u]=r[u]);return s}return s}function Sm(r,s,u,g){s=r.memoizedState,u=u(g,s),u=u==null?s:_r({},s,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var rp={isMounted:function(r){return(r=r._reactInternals)?To(r)===r:!1},enqueueSetState:function(r,s,u){r=r._reactInternals;var g=Fi(),_=Aa(r),S=js(g,_);S.payload=s,u!=null&&(S.callback=u),s=za(r,S,_),s!==null&&(Kn(s,r,_,g),gd(s,r,_))},enqueueReplaceState:function(r,s,u){r=r._reactInternals;var g=Fi(),_=Aa(r),S=js(g,_);S.tag=1,S.payload=s,u!=null&&(S.callback=u),s=za(r,S,_),s!==null&&(Kn(s,r,_,g),gd(s,r,_))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var u=Fi(),g=Aa(r),_=js(u,g);_.tag=2,s!=null&&(_.callback=s),s=za(r,_,g),s!==null&&(Kn(s,r,g,u),gd(s,r,g))}};function av(r,s,u,g,_,S,z){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(g,S,z):s.prototype&&s.prototype.isPureReactComponent?!bc(u,g)||!bc(_,S):!0}function x0(r,s,u){var g=!1,_=Ba,S=s.contextType;return typeof S=="object"&&S!==null?S=zn(S):(_=Qi(s)?_o:Ti.current,g=s.contextTypes,S=(g=g!=null)?Al(r,_):Ba),s=new s(u,S),r.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=rp,r.stateNode=s,s._reactInternals=r,g&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=_,r.__reactInternalMemoizedMaskedChildContext=S),s}function ov(r,s,u,g){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(u,g),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(u,g),s.state!==r&&rp.enqueueReplaceState(s,s.state,null)}function Tm(r,s,u,g){var _=r.stateNode;_.props=u,_.state=r.memoizedState,_.refs={},mg(r);var S=s.contextType;typeof S=="object"&&S!==null?_.context=zn(S):(S=Qi(s)?_o:Ti.current,_.context=Al(r,S)),_.state=r.memoizedState,S=s.getDerivedStateFromProps,typeof S=="function"&&(Sm(r,s,S,u),_.state=r.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(s=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),s!==_.state&&rp.enqueueReplaceState(_,_.state,null),Od(r,u,_,g),_.state=r.memoizedState),typeof _.componentDidMount=="function"&&(r.flags|=4194308)}function Bl(r,s){try{var u="",g=s;do u+=Lb(g),g=g.return;while(g);var _=u}catch(S){_=`
Error generating stack: `+S.message+`
`+S.stack}return{value:r,source:s,stack:_,digest:null}}function jf(r,s,u){return{value:r,source:null,stack:u??null,digest:s??null}}function km(r,s){try{console.error(s.value)}catch(u){setTimeout(function(){throw u})}}var oS=typeof WeakMap=="function"?WeakMap:Map;function w0(r,s,u){u=js(-1,u),u.tag=3,u.payload={element:null};var g=s.value;return u.callback=function(){$d||($d=!0,Rm=g),km(r,s)},u}function b0(r,s,u){u=js(-1,u),u.tag=3;var g=r.type.getDerivedStateFromError;if(typeof g=="function"){var _=s.value;u.payload=function(){return g(_)},u.callback=function(){km(r,s)}}var S=r.stateNode;return S!==null&&typeof S.componentDidCatch=="function"&&(u.callback=function(){km(r,s),typeof g!="function"&&(Ma===null?Ma=new Set([this]):Ma.add(this));var z=s.stack;this.componentDidCatch(s.value,{componentStack:z!==null?z:""})}),u}function lv(r,s,u){var g=r.pingCache;if(g===null){g=r.pingCache=new oS;var _=new Set;g.set(s,_)}else _=g.get(s),_===void 0&&(_=new Set,g.set(s,_));_.has(u)||(_.add(u),r=wS.bind(null,r,s,u),s.then(r,r))}function uv(r){do{var s;if((s=r.tag===13)&&(s=r.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return r;r=r.return}while(r!==null);return null}function cv(r,s,u,g,_){return r.mode&1?(r.flags|=65536,r.lanes=_,r):(r===s?r.flags|=65536:(r.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(s=js(-1,1),s.tag=2,za(u,s,1))),u.lanes|=1),r)}var lS=Ws.ReactCurrentOwner,Yi=!1;function Bi(r,s,u,g){s.child=r===null?Yx(s,null,u,g):Ll(s,r.child,u,g)}function hv(r,s,u,g,_){u=u.render;var S=s.ref;return Pl(s,_),g=xg(r,s,u,g,S,_),u=wg(),r!==null&&!Yi?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~_,Gs(r,s,_)):(dr&&u&&lg(s),s.flags|=1,Bi(r,s,g,_),s.child)}function dv(r,s,u,g,_){if(r===null){var S=u.type;return typeof S=="function"&&!Mg(S)&&S.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(s.tag=15,s.type=S,S0(r,s,S,g,_)):(r=bd(u.type,null,g,s,s.mode,_),r.ref=s.ref,r.return=s,s.child=r)}if(S=r.child,!(r.lanes&_)){var z=S.memoizedProps;if(u=u.compare,u=u!==null?u:bc,u(z,g)&&r.ref===s.ref)return Gs(r,s,_)}return s.flags|=1,r=Da(S,g),r.ref=s.ref,r.return=s,s.child=r}function S0(r,s,u,g,_){if(r!==null){var S=r.memoizedProps;if(bc(S,g)&&r.ref===s.ref)if(Yi=!1,s.pendingProps=g=S,(r.lanes&_)!==0)r.flags&131072&&(Yi=!0);else return s.lanes=r.lanes,Gs(r,s,_)}return Em(r,s,u,g,_)}function T0(r,s,u){var g=s.pendingProps,_=g.children,S=r!==null?r.memoizedState:null;if(g.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},tr(Tl,un),un|=u;else{if(!(u&1073741824))return r=S!==null?S.baseLanes|u:u,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:r,cachePool:null,transitions:null},s.updateQueue=null,tr(Tl,un),un|=r,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=S!==null?S.baseLanes:u,tr(Tl,un),un|=g}else S!==null?(g=S.baseLanes|u,s.memoizedState=null):g=u,tr(Tl,un),un|=g;return Bi(r,s,_,u),s.child}function k0(r,s){var u=s.ref;(r===null&&u!==null||r!==null&&r.ref!==u)&&(s.flags|=512,s.flags|=2097152)}function Em(r,s,u,g,_){var S=Qi(u)?_o:Ti.current;return S=Al(s,S),Pl(s,_),u=xg(r,s,u,g,S,_),g=wg(),r!==null&&!Yi?(s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~_,Gs(r,s,_)):(dr&&g&&lg(s),s.flags|=1,Bi(r,s,u,_),s.child)}function pv(r,s,u,g,_){if(Qi(u)){var S=!0;Dd(s)}else S=!1;if(Pl(s,_),s.stateNode===null)vd(r,s),x0(s,u,g),Tm(s,u,g,_),g=!0;else if(r===null){var z=s.stateNode,l=s.memoizedProps;z.props=l;var N=z.context,F=u.contextType;typeof F=="object"&&F!==null?F=zn(F):(F=Qi(u)?_o:Ti.current,F=Al(s,F));var pe=u.getDerivedStateFromProps,he=typeof pe=="function"||typeof z.getSnapshotBeforeUpdate=="function";he||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(l!==g||N!==F)&&ov(s,z,g,F),xa=!1;var ie=s.memoizedState;z.state=ie,Od(s,g,z,_),N=s.memoizedState,l!==g||ie!==N||Ji.current||xa?(typeof pe=="function"&&(Sm(s,u,pe,g),N=s.memoizedState),(l=xa||av(s,u,l,g,ie,N,F))?(he||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(s.flags|=4194308)):(typeof z.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=g,s.memoizedState=N),z.props=g,z.state=N,z.context=F,g=l):(typeof z.componentDidMount=="function"&&(s.flags|=4194308),g=!1)}else{z=s.stateNode,Qx(r,s),l=s.memoizedProps,F=s.type===s.elementType?l:Gn(s.type,l),z.props=F,he=s.pendingProps,ie=z.context,N=u.contextType,typeof N=="object"&&N!==null?N=zn(N):(N=Qi(u)?_o:Ti.current,N=Al(s,N));var Ie=u.getDerivedStateFromProps;(pe=typeof Ie=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(l!==he||ie!==N)&&ov(s,z,g,N),xa=!1,ie=s.memoizedState,z.state=ie,Od(s,g,z,_);var Pe=s.memoizedState;l!==he||ie!==Pe||Ji.current||xa?(typeof Ie=="function"&&(Sm(s,u,Ie,g),Pe=s.memoizedState),(F=xa||av(s,u,F,g,ie,Pe,N)||!1)?(pe||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(g,Pe,N),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(g,Pe,N)),typeof z.componentDidUpdate=="function"&&(s.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof z.componentDidUpdate!="function"||l===r.memoizedProps&&ie===r.memoizedState||(s.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||l===r.memoizedProps&&ie===r.memoizedState||(s.flags|=1024),s.memoizedProps=g,s.memoizedState=Pe),z.props=g,z.state=Pe,z.context=N,g=F):(typeof z.componentDidUpdate!="function"||l===r.memoizedProps&&ie===r.memoizedState||(s.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||l===r.memoizedProps&&ie===r.memoizedState||(s.flags|=1024),g=!1)}return Im(r,s,u,g,S,_)}function Im(r,s,u,g,_,S){k0(r,s);var z=(s.flags&128)!==0;if(!g&&!z)return _&&J_(s,u,!1),Gs(r,s,S);g=s.stateNode,lS.current=s;var l=z&&typeof u.getDerivedStateFromError!="function"?null:g.render();return s.flags|=1,r!==null&&z?(s.child=Ll(s,r.child,null,S),s.child=Ll(s,null,l,S)):Bi(r,s,l,S),s.memoizedState=g.state,_&&J_(s,u,!0),s.child}function E0(r){var s=r.stateNode;s.pendingContext?Y_(r,s.pendingContext,s.pendingContext!==s.context):s.context&&Y_(r,s.context,!1),gg(r,s.containerInfo)}function fv(r,s,u,g,_){return Dl(),cg(_),s.flags|=256,Bi(r,s,u,g),s.child}var Cm={dehydrated:null,treeContext:null,retryLane:0};function Pm(r){return{baseLanes:r,cachePool:null,transitions:null}}function I0(r,s,u){var g=s.pendingProps,_=gr.current,S=!1,z=(s.flags&128)!==0,l;if((l=z)||(l=r!==null&&r.memoizedState===null?!1:(_&2)!==0),l?(S=!0,s.flags&=-129):(r===null||r.memoizedState!==null)&&(_|=1),tr(gr,_&1),r===null)return wm(s),r=s.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(s.mode&1?r.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(z=g.children,r=g.fallback,S?(g=s.mode,S=s.child,z={mode:"hidden",children:z},!(g&1)&&S!==null?(S.childLanes=0,S.pendingProps=z):S=sp(z,g,0,null),r=yo(r,g,u,null),S.return=s,r.return=s,S.sibling=r,s.child=S,s.child.memoizedState=Pm(u),s.memoizedState=Cm,r):Tg(s,z));if(_=r.memoizedState,_!==null&&(l=_.dehydrated,l!==null))return uS(r,s,z,g,l,_,u);if(S){S=g.fallback,z=s.mode,_=r.child,l=_.sibling;var N={mode:"hidden",children:g.children};return!(z&1)&&s.child!==_?(g=s.child,g.childLanes=0,g.pendingProps=N,s.deletions=null):(g=Da(_,N),g.subtreeFlags=_.subtreeFlags&14680064),l!==null?S=Da(l,S):(S=yo(S,z,u,null),S.flags|=2),S.return=s,g.return=s,g.sibling=S,s.child=g,g=S,S=s.child,z=r.child.memoizedState,z=z===null?Pm(u):{baseLanes:z.baseLanes|u,cachePool:null,transitions:z.transitions},S.memoizedState=z,S.childLanes=r.childLanes&~u,s.memoizedState=Cm,g}return S=r.child,r=S.sibling,g=Da(S,{mode:"visible",children:g.children}),!(s.mode&1)&&(g.lanes=u),g.return=s,g.sibling=null,r!==null&&(u=s.deletions,u===null?(s.deletions=[r],s.flags|=16):u.push(r)),s.child=g,s.memoizedState=null,g}function Tg(r,s){return s=sp({mode:"visible",children:s},r.mode,0,null),s.return=r,r.child=s}function od(r,s,u,g){return g!==null&&cg(g),Ll(s,r.child,null,u),r=Tg(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function uS(r,s,u,g,_,S,z){if(u)return s.flags&256?(s.flags&=-257,g=jf(Error(Le(422))),od(r,s,z,g)):s.memoizedState!==null?(s.child=r.child,s.flags|=128,null):(S=g.fallback,_=s.mode,g=sp({mode:"visible",children:g.children},_,0,null),S=yo(S,_,z,null),S.flags|=2,g.return=s,S.return=s,g.sibling=S,s.child=g,s.mode&1&&Ll(s,r.child,null,z),s.child.memoizedState=Pm(z),s.memoizedState=Cm,S);if(!(s.mode&1))return od(r,s,z,null);if(_.data==="$!"){if(g=_.nextSibling&&_.nextSibling.dataset,g)var l=g.dgst;return g=l,S=Error(Le(419)),g=jf(S,g,void 0),od(r,s,z,g)}if(l=(z&r.childLanes)!==0,Yi||l){if(g=Jr,g!==null){switch(z&-z){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(g.suspendedLanes|z)?0:_,_!==0&&_!==S.retryLane&&(S.retryLane=_,qs(r,_),Kn(g,r,_,-1))}return zg(),g=jf(Error(Le(421))),od(r,s,z,g)}return _.data==="$?"?(s.flags|=128,s.child=r.child,s=bS.bind(null,r),_._reactRetry=s,null):(r=S.treeContext,cn=Pa(_.nextSibling),hn=s,dr=!0,Hn=null,r!==null&&(En[In++]=Vs,En[In++]=Us,En[In++]=vo,Vs=r.id,Us=r.overflow,vo=s),s=Tg(s,g.children),s.flags|=4096,s)}function mv(r,s,u){r.lanes|=s;var g=r.alternate;g!==null&&(g.lanes|=s),bm(r.return,s,u)}function $f(r,s,u,g,_){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:g,tail:u,tailMode:_}:(S.isBackwards=s,S.rendering=null,S.renderingStartTime=0,S.last=g,S.tail=u,S.tailMode=_)}function C0(r,s,u){var g=s.pendingProps,_=g.revealOrder,S=g.tail;if(Bi(r,s,g.children,u),g=gr.current,g&2)g=g&1|2,s.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&mv(r,u,s);else if(r.tag===19)mv(r,u,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}g&=1}if(tr(gr,g),!(s.mode&1))s.memoizedState=null;else switch(_){case"forwards":for(u=s.child,_=null;u!==null;)r=u.alternate,r!==null&&Nd(r)===null&&(_=u),u=u.sibling;u=_,u===null?(_=s.child,s.child=null):(_=u.sibling,u.sibling=null),$f(s,!1,_,u,S);break;case"backwards":for(u=null,_=s.child,s.child=null;_!==null;){if(r=_.alternate,r!==null&&Nd(r)===null){s.child=_;break}r=_.sibling,_.sibling=u,u=_,_=r}$f(s,!0,u,null,S);break;case"together":$f(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function vd(r,s){!(s.mode&1)&&r!==null&&(r.alternate=null,s.alternate=null,s.flags|=2)}function Gs(r,s,u){if(r!==null&&(s.dependencies=r.dependencies),wo|=s.lanes,!(u&s.childLanes))return null;if(r!==null&&s.child!==r.child)throw Error(Le(153));if(s.child!==null){for(r=s.child,u=Da(r,r.pendingProps),s.child=u,u.return=s;r.sibling!==null;)r=r.sibling,u=u.sibling=Da(r,r.pendingProps),u.return=s;u.sibling=null}return s.child}function cS(r,s,u){switch(s.tag){case 3:E0(s),Dl();break;case 5:e0(s);break;case 1:Qi(s.type)&&Dd(s);break;case 4:gg(s,s.stateNode.containerInfo);break;case 10:var g=s.type._context,_=s.memoizedProps.value;tr(Bd,g._currentValue),g._currentValue=_;break;case 13:if(g=s.memoizedState,g!==null)return g.dehydrated!==null?(tr(gr,gr.current&1),s.flags|=128,null):u&s.child.childLanes?I0(r,s,u):(tr(gr,gr.current&1),r=Gs(r,s,u),r!==null?r.sibling:null);tr(gr,gr.current&1);break;case 19:if(g=(u&s.childLanes)!==0,r.flags&128){if(g)return C0(r,s,u);s.flags|=128}if(_=s.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),tr(gr,gr.current),g)break;return null;case 22:case 23:return s.lanes=0,T0(r,s,u)}return Gs(r,s,u)}var P0,zm,z0,M0;P0=function(r,s){for(var u=s.child;u!==null;){if(u.tag===5||u.tag===6)r.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===s)break;for(;u.sibling===null;){if(u.return===null||u.return===s)return;u=u.return}u.sibling.return=u.return,u=u.sibling}};zm=function(){};z0=function(r,s,u,g){var _=r.memoizedProps;if(_!==g){r=s.stateNode,mo(ys.current);var S=null;switch(u){case"input":_=Jf(r,_),g=Jf(r,g),S=[];break;case"select":_=_r({},_,{value:void 0}),g=_r({},g,{value:void 0}),S=[];break;case"textarea":_=tm(r,_),g=tm(r,g),S=[];break;default:typeof _.onClick!="function"&&typeof g.onClick=="function"&&(r.onclick=Md)}im(u,g);var z;u=null;for(F in _)if(!g.hasOwnProperty(F)&&_.hasOwnProperty(F)&&_[F]!=null)if(F==="style"){var l=_[F];for(z in l)l.hasOwnProperty(z)&&(u||(u={}),u[z]="")}else F!=="dangerouslySetInnerHTML"&&F!=="children"&&F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&F!=="autoFocus"&&(mc.hasOwnProperty(F)?S||(S=[]):(S=S||[]).push(F,null));for(F in g){var N=g[F];if(l=_!=null?_[F]:void 0,g.hasOwnProperty(F)&&N!==l&&(N!=null||l!=null))if(F==="style")if(l){for(z in l)!l.hasOwnProperty(z)||N&&N.hasOwnProperty(z)||(u||(u={}),u[z]="");for(z in N)N.hasOwnProperty(z)&&l[z]!==N[z]&&(u||(u={}),u[z]=N[z])}else u||(S||(S=[]),S.push(F,u)),u=N;else F==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,l=l?l.__html:void 0,N!=null&&l!==N&&(S=S||[]).push(F,N)):F==="children"?typeof N!="string"&&typeof N!="number"||(S=S||[]).push(F,""+N):F!=="suppressContentEditableWarning"&&F!=="suppressHydrationWarning"&&(mc.hasOwnProperty(F)?(N!=null&&F==="onScroll"&&ar("scroll",r),S||l===N||(S=[])):(S=S||[]).push(F,N))}u&&(S=S||[]).push("style",u);var F=S;(s.updateQueue=F)&&(s.flags|=4)}};M0=function(r,s,u,g){u!==g&&(s.flags|=4)};function ec(r,s){if(!dr)switch(r.tailMode){case"hidden":s=r.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:g.sibling=null}}function bi(r){var s=r.alternate!==null&&r.alternate.child===r.child,u=0,g=0;if(s)for(var _=r.child;_!==null;)u|=_.lanes|_.childLanes,g|=_.subtreeFlags&14680064,g|=_.flags&14680064,_.return=r,_=_.sibling;else for(_=r.child;_!==null;)u|=_.lanes|_.childLanes,g|=_.subtreeFlags,g|=_.flags,_.return=r,_=_.sibling;return r.subtreeFlags|=g,r.childLanes=u,s}function hS(r,s,u){var g=s.pendingProps;switch(ug(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bi(s),null;case 1:return Qi(s.type)&&Ad(),bi(s),null;case 3:return g=s.stateNode,Rl(),or(Ji),or(Ti),_g(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(r===null||r.child===null)&&(sd(s)?s.flags|=4:r===null||r.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Hn!==null&&(Om(Hn),Hn=null))),zm(r,s),bi(s),null;case 5:yg(s);var _=mo(Ic.current);if(u=s.type,r!==null&&s.stateNode!=null)z0(r,s,u,g,_),r.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!g){if(s.stateNode===null)throw Error(Le(166));return bi(s),null}if(r=mo(ys.current),sd(s)){g=s.stateNode,u=s.type;var S=s.memoizedProps;switch(g[ms]=s,g[kc]=S,r=(s.mode&1)!==0,u){case"dialog":ar("cancel",g),ar("close",g);break;case"iframe":case"object":case"embed":ar("load",g);break;case"video":case"audio":for(_=0;_<sc.length;_++)ar(sc[_],g);break;case"source":ar("error",g);break;case"img":case"image":case"link":ar("error",g),ar("load",g);break;case"details":ar("toggle",g);break;case"input":T_(g,S),ar("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!S.multiple},ar("invalid",g);break;case"textarea":E_(g,S),ar("invalid",g)}im(u,S),_=null;for(var z in S)if(S.hasOwnProperty(z)){var l=S[z];z==="children"?typeof l=="string"?g.textContent!==l&&(S.suppressHydrationWarning!==!0&&nd(g.textContent,l,r),_=["children",l]):typeof l=="number"&&g.textContent!==""+l&&(S.suppressHydrationWarning!==!0&&nd(g.textContent,l,r),_=["children",""+l]):mc.hasOwnProperty(z)&&l!=null&&z==="onScroll"&&ar("scroll",g)}switch(u){case"input":Kh(g),k_(g,S,!0);break;case"textarea":Kh(g),I_(g);break;case"select":case"option":break;default:typeof S.onClick=="function"&&(g.onclick=Md)}g=_,s.updateQueue=g,g!==null&&(s.flags|=4)}else{z=_.nodeType===9?_:_.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=sx(u)),r==="http://www.w3.org/1999/xhtml"?u==="script"?(r=z.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof g.is=="string"?r=z.createElement(u,{is:g.is}):(r=z.createElement(u),u==="select"&&(z=r,g.multiple?z.multiple=!0:g.size&&(z.size=g.size))):r=z.createElementNS(r,u),r[ms]=s,r[kc]=g,P0(r,s,!1,!1),s.stateNode=r;e:{switch(z=nm(u,g),u){case"dialog":ar("cancel",r),ar("close",r),_=g;break;case"iframe":case"object":case"embed":ar("load",r),_=g;break;case"video":case"audio":for(_=0;_<sc.length;_++)ar(sc[_],r);_=g;break;case"source":ar("error",r),_=g;break;case"img":case"image":case"link":ar("error",r),ar("load",r),_=g;break;case"details":ar("toggle",r),_=g;break;case"input":T_(r,g),_=Jf(r,g),ar("invalid",r);break;case"option":_=g;break;case"select":r._wrapperState={wasMultiple:!!g.multiple},_=_r({},g,{value:void 0}),ar("invalid",r);break;case"textarea":E_(r,g),_=tm(r,g),ar("invalid",r);break;default:_=g}im(u,_),l=_;for(S in l)if(l.hasOwnProperty(S)){var N=l[S];S==="style"?lx(r,N):S==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&ax(r,N)):S==="children"?typeof N=="string"?(u!=="textarea"||N!=="")&&gc(r,N):typeof N=="number"&&gc(r,""+N):S!=="suppressContentEditableWarning"&&S!=="suppressHydrationWarning"&&S!=="autoFocus"&&(mc.hasOwnProperty(S)?N!=null&&S==="onScroll"&&ar("scroll",r):N!=null&&Hm(r,S,N,z))}switch(u){case"input":Kh(r),k_(r,g,!1);break;case"textarea":Kh(r),I_(r);break;case"option":g.value!=null&&r.setAttribute("value",""+Ra(g.value));break;case"select":r.multiple=!!g.multiple,S=g.value,S!=null?kl(r,!!g.multiple,S,!1):g.defaultValue!=null&&kl(r,!!g.multiple,g.defaultValue,!0);break;default:typeof _.onClick=="function"&&(r.onclick=Md)}switch(u){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return bi(s),null;case 6:if(r&&s.stateNode!=null)M0(r,s,r.memoizedProps,g);else{if(typeof g!="string"&&s.stateNode===null)throw Error(Le(166));if(u=mo(Ic.current),mo(ys.current),sd(s)){if(g=s.stateNode,u=s.memoizedProps,g[ms]=s,(S=g.nodeValue!==u)&&(r=hn,r!==null))switch(r.tag){case 3:nd(g.nodeValue,u,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&nd(g.nodeValue,u,(r.mode&1)!==0)}S&&(s.flags|=4)}else g=(u.nodeType===9?u:u.ownerDocument).createTextNode(g),g[ms]=s,s.stateNode=g}return bi(s),null;case 13:if(or(gr),g=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(dr&&cn!==null&&s.mode&1&&!(s.flags&128))Xx(),Dl(),s.flags|=98560,S=!1;else if(S=sd(s),g!==null&&g.dehydrated!==null){if(r===null){if(!S)throw Error(Le(318));if(S=s.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(Le(317));S[ms]=s}else Dl(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;bi(s),S=!1}else Hn!==null&&(Om(Hn),Hn=null),S=!0;if(!S)return s.flags&65536?s:null}return s.flags&128?(s.lanes=u,s):(g=g!==null,g!==(r!==null&&r.memoizedState!==null)&&g&&(s.child.flags|=8192,s.mode&1&&(r===null||gr.current&1?$r===0&&($r=3):zg())),s.updateQueue!==null&&(s.flags|=4),bi(s),null);case 4:return Rl(),zm(r,s),r===null&&Sc(s.stateNode.containerInfo),bi(s),null;case 10:return pg(s.type._context),bi(s),null;case 17:return Qi(s.type)&&Ad(),bi(s),null;case 19:if(or(gr),S=s.memoizedState,S===null)return bi(s),null;if(g=(s.flags&128)!==0,z=S.rendering,z===null)if(g)ec(S,!1);else{if($r!==0||r!==null&&r.flags&128)for(r=s.child;r!==null;){if(z=Nd(r),z!==null){for(s.flags|=128,ec(S,!1),g=z.updateQueue,g!==null&&(s.updateQueue=g,s.flags|=4),s.subtreeFlags=0,g=u,u=s.child;u!==null;)S=u,r=g,S.flags&=14680066,z=S.alternate,z===null?(S.childLanes=0,S.lanes=r,S.child=null,S.subtreeFlags=0,S.memoizedProps=null,S.memoizedState=null,S.updateQueue=null,S.dependencies=null,S.stateNode=null):(S.childLanes=z.childLanes,S.lanes=z.lanes,S.child=z.child,S.subtreeFlags=0,S.deletions=null,S.memoizedProps=z.memoizedProps,S.memoizedState=z.memoizedState,S.updateQueue=z.updateQueue,S.type=z.type,r=z.dependencies,S.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),u=u.sibling;return tr(gr,gr.current&1|2),s.child}r=r.sibling}S.tail!==null&&Mr()>Fl&&(s.flags|=128,g=!0,ec(S,!1),s.lanes=4194304)}else{if(!g)if(r=Nd(z),r!==null){if(s.flags|=128,g=!0,u=r.updateQueue,u!==null&&(s.updateQueue=u,s.flags|=4),ec(S,!0),S.tail===null&&S.tailMode==="hidden"&&!z.alternate&&!dr)return bi(s),null}else 2*Mr()-S.renderingStartTime>Fl&&u!==1073741824&&(s.flags|=128,g=!0,ec(S,!1),s.lanes=4194304);S.isBackwards?(z.sibling=s.child,s.child=z):(u=S.last,u!==null?u.sibling=z:s.child=z,S.last=z)}return S.tail!==null?(s=S.tail,S.rendering=s,S.tail=s.sibling,S.renderingStartTime=Mr(),s.sibling=null,u=gr.current,tr(gr,g?u&1|2:u&1),s):(bi(s),null);case 22:case 23:return Pg(),g=s.memoizedState!==null,r!==null&&r.memoizedState!==null!==g&&(s.flags|=8192),g&&s.mode&1?un&1073741824&&(bi(s),s.subtreeFlags&6&&(s.flags|=8192)):bi(s),null;case 24:return null;case 25:return null}throw Error(Le(156,s.tag))}function dS(r,s){switch(ug(s),s.tag){case 1:return Qi(s.type)&&Ad(),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Rl(),or(Ji),or(Ti),_g(),r=s.flags,r&65536&&!(r&128)?(s.flags=r&-65537|128,s):null;case 5:return yg(s),null;case 13:if(or(gr),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(Le(340));Dl()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return or(gr),null;case 4:return Rl(),null;case 10:return pg(s.type._context),null;case 22:case 23:return Pg(),null;case 24:return null;default:return null}}var ld=!1,Si=!1,pS=typeof WeakSet=="function"?WeakSet:Set,rt=null;function Sl(r,s){var u=r.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(g){br(r,s,g)}else u.current=null}function Mm(r,s,u){try{u()}catch(g){br(r,s,g)}}var gv=!1;function fS(r,s){if(fm=Cd,r=Bx(),og(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var g=u.getSelection&&u.getSelection();if(g&&g.rangeCount!==0){u=g.anchorNode;var _=g.anchorOffset,S=g.focusNode;g=g.focusOffset;try{u.nodeType,S.nodeType}catch{u=null;break e}var z=0,l=-1,N=-1,F=0,pe=0,he=r,ie=null;t:for(;;){for(var Ie;he!==u||_!==0&&he.nodeType!==3||(l=z+_),he!==S||g!==0&&he.nodeType!==3||(N=z+g),he.nodeType===3&&(z+=he.nodeValue.length),(Ie=he.firstChild)!==null;)ie=he,he=Ie;for(;;){if(he===r)break t;if(ie===u&&++F===_&&(l=z),ie===S&&++pe===g&&(N=z),(Ie=he.nextSibling)!==null)break;he=ie,ie=he.parentNode}he=Ie}u=l===-1||N===-1?null:{start:l,end:N}}else u=null}u=u||{start:0,end:0}}else u=null;for(mm={focusedElem:r,selectionRange:u},Cd=!1,rt=s;rt!==null;)if(s=rt,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,rt=r;else for(;rt!==null;){s=rt;try{var Pe=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(Pe!==null){var Ce=Pe.memoizedProps,Ne=Pe.memoizedState,re=s.stateNode,ee=re.getSnapshotBeforeUpdate(s.elementType===s.type?Ce:Gn(s.type,Ce),Ne);re.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var ce=s.stateNode.containerInfo;ce.nodeType===1?ce.textContent="":ce.nodeType===9&&ce.documentElement&&ce.removeChild(ce.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Le(163))}}catch(Te){br(s,s.return,Te)}if(r=s.sibling,r!==null){r.return=s.return,rt=r;break}rt=s.return}return Pe=gv,gv=!1,Pe}function dc(r,s,u){var g=s.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var _=g=g.next;do{if((_.tag&r)===r){var S=_.destroy;_.destroy=void 0,S!==void 0&&Mm(s,u,S)}_=_.next}while(_!==g)}}function ip(r,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var u=s=s.next;do{if((u.tag&r)===r){var g=u.create;u.destroy=g()}u=u.next}while(u!==s)}}function Am(r){var s=r.ref;if(s!==null){var u=r.stateNode;switch(r.tag){case 5:r=u;break;default:r=u}typeof s=="function"?s(r):s.current=r}}function A0(r){var s=r.alternate;s!==null&&(r.alternate=null,A0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&(delete s[ms],delete s[kc],delete s[_m],delete s[K2],delete s[Y2])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function D0(r){return r.tag===5||r.tag===3||r.tag===4}function yv(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||D0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Dm(r,s,u){var g=r.tag;if(g===5||g===6)r=r.stateNode,s?u.nodeType===8?u.parentNode.insertBefore(r,s):u.insertBefore(r,s):(u.nodeType===8?(s=u.parentNode,s.insertBefore(r,u)):(s=u,s.appendChild(r)),u=u._reactRootContainer,u!=null||s.onclick!==null||(s.onclick=Md));else if(g!==4&&(r=r.child,r!==null))for(Dm(r,s,u),r=r.sibling;r!==null;)Dm(r,s,u),r=r.sibling}function Lm(r,s,u){var g=r.tag;if(g===5||g===6)r=r.stateNode,s?u.insertBefore(r,s):u.appendChild(r);else if(g!==4&&(r=r.child,r!==null))for(Lm(r,s,u),r=r.sibling;r!==null;)Lm(r,s,u),r=r.sibling}var oi=null,Wn=!1;function ya(r,s,u){for(u=u.child;u!==null;)L0(r,s,u),u=u.sibling}function L0(r,s,u){if(gs&&typeof gs.onCommitFiberUnmount=="function")try{gs.onCommitFiberUnmount(Xd,u)}catch{}switch(u.tag){case 5:Si||Sl(u,s);case 6:var g=oi,_=Wn;oi=null,ya(r,s,u),oi=g,Wn=_,oi!==null&&(Wn?(r=oi,u=u.stateNode,r.nodeType===8?r.parentNode.removeChild(u):r.removeChild(u)):oi.removeChild(u.stateNode));break;case 18:oi!==null&&(Wn?(r=oi,u=u.stateNode,r.nodeType===8?Bf(r.parentNode,u):r.nodeType===1&&Bf(r,u),xc(r)):Bf(oi,u.stateNode));break;case 4:g=oi,_=Wn,oi=u.stateNode.containerInfo,Wn=!0,ya(r,s,u),oi=g,Wn=_;break;case 0:case 11:case 14:case 15:if(!Si&&(g=u.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){_=g=g.next;do{var S=_,z=S.destroy;S=S.tag,z!==void 0&&(S&2||S&4)&&Mm(u,s,z),_=_.next}while(_!==g)}ya(r,s,u);break;case 1:if(!Si&&(Sl(u,s),g=u.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=u.memoizedProps,g.state=u.memoizedState,g.componentWillUnmount()}catch(l){br(u,s,l)}ya(r,s,u);break;case 21:ya(r,s,u);break;case 22:u.mode&1?(Si=(g=Si)||u.memoizedState!==null,ya(r,s,u),Si=g):ya(r,s,u);break;default:ya(r,s,u)}}function _v(r){var s=r.updateQueue;if(s!==null){r.updateQueue=null;var u=r.stateNode;u===null&&(u=r.stateNode=new pS),s.forEach(function(g){var _=SS.bind(null,r,g);u.has(g)||(u.add(g),g.then(_,_))})}}function qn(r,s){var u=s.deletions;if(u!==null)for(var g=0;g<u.length;g++){var _=u[g];try{var S=r,z=s,l=z;e:for(;l!==null;){switch(l.tag){case 5:oi=l.stateNode,Wn=!1;break e;case 3:oi=l.stateNode.containerInfo,Wn=!0;break e;case 4:oi=l.stateNode.containerInfo,Wn=!0;break e}l=l.return}if(oi===null)throw Error(Le(160));L0(S,z,_),oi=null,Wn=!1;var N=_.alternate;N!==null&&(N.return=null),_.return=null}catch(F){br(_,s,F)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)R0(s,r),s=s.sibling}function R0(r,s){var u=r.alternate,g=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(qn(s,r),ps(r),g&4){try{dc(3,r,r.return),ip(3,r)}catch(Ce){br(r,r.return,Ce)}try{dc(5,r,r.return)}catch(Ce){br(r,r.return,Ce)}}break;case 1:qn(s,r),ps(r),g&512&&u!==null&&Sl(u,u.return);break;case 5:if(qn(s,r),ps(r),g&512&&u!==null&&Sl(u,u.return),r.flags&32){var _=r.stateNode;try{gc(_,"")}catch(Ce){br(r,r.return,Ce)}}if(g&4&&(_=r.stateNode,_!=null)){var S=r.memoizedProps,z=u!==null?u.memoizedProps:S,l=r.type,N=r.updateQueue;if(r.updateQueue=null,N!==null)try{l==="input"&&S.type==="radio"&&S.name!=null&&ix(_,S),nm(l,z);var F=nm(l,S);for(z=0;z<N.length;z+=2){var pe=N[z],he=N[z+1];pe==="style"?lx(_,he):pe==="dangerouslySetInnerHTML"?ax(_,he):pe==="children"?gc(_,he):Hm(_,pe,he,F)}switch(l){case"input":Qf(_,S);break;case"textarea":nx(_,S);break;case"select":var ie=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!S.multiple;var Ie=S.value;Ie!=null?kl(_,!!S.multiple,Ie,!1):ie!==!!S.multiple&&(S.defaultValue!=null?kl(_,!!S.multiple,S.defaultValue,!0):kl(_,!!S.multiple,S.multiple?[]:"",!1))}_[kc]=S}catch(Ce){br(r,r.return,Ce)}}break;case 6:if(qn(s,r),ps(r),g&4){if(r.stateNode===null)throw Error(Le(162));_=r.stateNode,S=r.memoizedProps;try{_.nodeValue=S}catch(Ce){br(r,r.return,Ce)}}break;case 3:if(qn(s,r),ps(r),g&4&&u!==null&&u.memoizedState.isDehydrated)try{xc(s.containerInfo)}catch(Ce){br(r,r.return,Ce)}break;case 4:qn(s,r),ps(r);break;case 13:qn(s,r),ps(r),_=r.child,_.flags&8192&&(S=_.memoizedState!==null,_.stateNode.isHidden=S,!S||_.alternate!==null&&_.alternate.memoizedState!==null||(Ig=Mr())),g&4&&_v(r);break;case 22:if(pe=u!==null&&u.memoizedState!==null,r.mode&1?(Si=(F=Si)||pe,qn(s,r),Si=F):qn(s,r),ps(r),g&8192){if(F=r.memoizedState!==null,(r.stateNode.isHidden=F)&&!pe&&r.mode&1)for(rt=r,pe=r.child;pe!==null;){for(he=rt=pe;rt!==null;){switch(ie=rt,Ie=ie.child,ie.tag){case 0:case 11:case 14:case 15:dc(4,ie,ie.return);break;case 1:Sl(ie,ie.return);var Pe=ie.stateNode;if(typeof Pe.componentWillUnmount=="function"){g=ie,u=ie.return;try{s=g,Pe.props=s.memoizedProps,Pe.state=s.memoizedState,Pe.componentWillUnmount()}catch(Ce){br(g,u,Ce)}}break;case 5:Sl(ie,ie.return);break;case 22:if(ie.memoizedState!==null){xv(he);continue}}Ie!==null?(Ie.return=ie,rt=Ie):xv(he)}pe=pe.sibling}e:for(pe=null,he=r;;){if(he.tag===5){if(pe===null){pe=he;try{_=he.stateNode,F?(S=_.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none"):(l=he.stateNode,N=he.memoizedProps.style,z=N!=null&&N.hasOwnProperty("display")?N.display:null,l.style.display=ox("display",z))}catch(Ce){br(r,r.return,Ce)}}}else if(he.tag===6){if(pe===null)try{he.stateNode.nodeValue=F?"":he.memoizedProps}catch(Ce){br(r,r.return,Ce)}}else if((he.tag!==22&&he.tag!==23||he.memoizedState===null||he===r)&&he.child!==null){he.child.return=he,he=he.child;continue}if(he===r)break e;for(;he.sibling===null;){if(he.return===null||he.return===r)break e;pe===he&&(pe=null),he=he.return}pe===he&&(pe=null),he.sibling.return=he.return,he=he.sibling}}break;case 19:qn(s,r),ps(r),g&4&&_v(r);break;case 21:break;default:qn(s,r),ps(r)}}function ps(r){var s=r.flags;if(s&2){try{e:{for(var u=r.return;u!==null;){if(D0(u)){var g=u;break e}u=u.return}throw Error(Le(160))}switch(g.tag){case 5:var _=g.stateNode;g.flags&32&&(gc(_,""),g.flags&=-33);var S=yv(r);Lm(r,S,_);break;case 3:case 4:var z=g.stateNode.containerInfo,l=yv(r);Dm(r,l,z);break;default:throw Error(Le(161))}}catch(N){br(r,r.return,N)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function mS(r,s,u){rt=r,B0(r)}function B0(r,s,u){for(var g=(r.mode&1)!==0;rt!==null;){var _=rt,S=_.child;if(_.tag===22&&g){var z=_.memoizedState!==null||ld;if(!z){var l=_.alternate,N=l!==null&&l.memoizedState!==null||Si;l=ld;var F=Si;if(ld=z,(Si=N)&&!F)for(rt=_;rt!==null;)z=rt,N=z.child,z.tag===22&&z.memoizedState!==null?wv(_):N!==null?(N.return=z,rt=N):wv(_);for(;S!==null;)rt=S,B0(S),S=S.sibling;rt=_,ld=l,Si=F}vv(r)}else _.subtreeFlags&8772&&S!==null?(S.return=_,rt=S):vv(r)}}function vv(r){for(;rt!==null;){var s=rt;if(s.flags&8772){var u=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:Si||ip(5,s);break;case 1:var g=s.stateNode;if(s.flags&4&&!Si)if(u===null)g.componentDidMount();else{var _=s.elementType===s.type?u.memoizedProps:Gn(s.type,u.memoizedProps);g.componentDidUpdate(_,u.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var S=s.updateQueue;S!==null&&iv(s,S,g);break;case 3:var z=s.updateQueue;if(z!==null){if(u=null,s.child!==null)switch(s.child.tag){case 5:u=s.child.stateNode;break;case 1:u=s.child.stateNode}iv(s,z,u)}break;case 5:var l=s.stateNode;if(u===null&&s.flags&4){u=l;var N=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&u.focus();break;case"img":N.src&&(u.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var F=s.alternate;if(F!==null){var pe=F.memoizedState;if(pe!==null){var he=pe.dehydrated;he!==null&&xc(he)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Le(163))}Si||s.flags&512&&Am(s)}catch(ie){br(s,s.return,ie)}}if(s===r){rt=null;break}if(u=s.sibling,u!==null){u.return=s.return,rt=u;break}rt=s.return}}function xv(r){for(;rt!==null;){var s=rt;if(s===r){rt=null;break}var u=s.sibling;if(u!==null){u.return=s.return,rt=u;break}rt=s.return}}function wv(r){for(;rt!==null;){var s=rt;try{switch(s.tag){case 0:case 11:case 15:var u=s.return;try{ip(4,s)}catch(N){br(s,u,N)}break;case 1:var g=s.stateNode;if(typeof g.componentDidMount=="function"){var _=s.return;try{g.componentDidMount()}catch(N){br(s,_,N)}}var S=s.return;try{Am(s)}catch(N){br(s,S,N)}break;case 5:var z=s.return;try{Am(s)}catch(N){br(s,z,N)}}}catch(N){br(s,s.return,N)}if(s===r){rt=null;break}var l=s.sibling;if(l!==null){l.return=s.return,rt=l;break}rt=s.return}}var gS=Math.ceil,jd=Ws.ReactCurrentDispatcher,kg=Ws.ReactCurrentOwner,Pn=Ws.ReactCurrentBatchConfig,Lt=0,Jr=null,Lr=null,li=0,un=0,Tl=Oa(0),$r=0,Mc=null,wo=0,np=0,Eg=0,pc=null,Ki=null,Ig=0,Fl=1/0,Os=null,$d=!1,Rm=null,Ma=null,ud=!1,Ta=null,Zd=0,fc=0,Bm=null,xd=-1,wd=0;function Fi(){return Lt&6?Mr():xd!==-1?xd:xd=Mr()}function Aa(r){return r.mode&1?Lt&2&&li!==0?li&-li:Q2.transition!==null?(wd===0&&(wd=xx()),wd):(r=Zt,r!==0||(r=window.event,r=r===void 0?16:Ix(r.type)),r):1}function Kn(r,s,u,g){if(50<fc)throw fc=0,Bm=null,Error(Le(185));Rc(r,u,g),(!(Lt&2)||r!==Jr)&&(r===Jr&&(!(Lt&2)&&(np|=u),$r===4&&ba(r,li)),en(r,g),u===1&&Lt===0&&!(s.mode&1)&&(Fl=Mr()+500,ep&&Na()))}function en(r,s){var u=r.callbackNode;Qb(r,s);var g=Id(r,r===Jr?li:0);if(g===0)u!==null&&z_(u),r.callbackNode=null,r.callbackPriority=0;else if(s=g&-g,r.callbackPriority!==s){if(u!=null&&z_(u),s===1)r.tag===0?J2(bv.bind(null,r)):Gx(bv.bind(null,r)),H2(function(){!(Lt&6)&&Na()}),u=null;else{switch(wx(g)){case 1:u=Qm;break;case 4:u=_x;break;case 16:u=Ed;break;case 536870912:u=vx;break;default:u=Ed}u=Z0(u,F0.bind(null,r))}r.callbackPriority=s,r.callbackNode=u}}function F0(r,s){if(xd=-1,wd=0,Lt&6)throw Error(Le(327));var u=r.callbackNode;if(zl()&&r.callbackNode!==u)return null;var g=Id(r,r===Jr?li:0);if(g===0)return null;if(g&30||g&r.expiredLanes||s)s=qd(r,g);else{s=g;var _=Lt;Lt|=2;var S=N0();(Jr!==r||li!==s)&&(Os=null,Fl=Mr()+500,go(r,s));do try{vS();break}catch(l){O0(r,l)}while(!0);dg(),jd.current=S,Lt=_,Lr!==null?s=0:(Jr=null,li=0,s=$r)}if(s!==0){if(s===2&&(_=um(r),_!==0&&(g=_,s=Fm(r,_))),s===1)throw u=Mc,go(r,0),ba(r,g),en(r,Mr()),u;if(s===6)ba(r,g);else{if(_=r.current.alternate,!(g&30)&&!yS(_)&&(s=qd(r,g),s===2&&(S=um(r),S!==0&&(g=S,s=Fm(r,S))),s===1))throw u=Mc,go(r,0),ba(r,g),en(r,Mr()),u;switch(r.finishedWork=_,r.finishedLanes=g,s){case 0:case 1:throw Error(Le(345));case 2:ho(r,Ki,Os);break;case 3:if(ba(r,g),(g&130023424)===g&&(s=Ig+500-Mr(),10<s)){if(Id(r,0)!==0)break;if(_=r.suspendedLanes,(_&g)!==g){Fi(),r.pingedLanes|=r.suspendedLanes&_;break}r.timeoutHandle=ym(ho.bind(null,r,Ki,Os),s);break}ho(r,Ki,Os);break;case 4:if(ba(r,g),(g&4194240)===g)break;for(s=r.eventTimes,_=-1;0<g;){var z=31-Xn(g);S=1<<z,z=s[z],z>_&&(_=z),g&=~S}if(g=_,g=Mr()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*gS(g/1960))-g,10<g){r.timeoutHandle=ym(ho.bind(null,r,Ki,Os),g);break}ho(r,Ki,Os);break;case 5:ho(r,Ki,Os);break;default:throw Error(Le(329))}}}return en(r,Mr()),r.callbackNode===u?F0.bind(null,r):null}function Fm(r,s){var u=pc;return r.current.memoizedState.isDehydrated&&(go(r,s).flags|=256),r=qd(r,s),r!==2&&(s=Ki,Ki=u,s!==null&&Om(s)),r}function Om(r){Ki===null?Ki=r:Ki.push.apply(Ki,r)}function yS(r){for(var s=r;;){if(s.flags&16384){var u=s.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var g=0;g<u.length;g++){var _=u[g],S=_.getSnapshot;_=_.value;try{if(!Yn(S(),_))return!1}catch{return!1}}}if(u=s.child,s.subtreeFlags&16384&&u!==null)u.return=s,s=u;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ba(r,s){for(s&=~Eg,s&=~np,r.suspendedLanes|=s,r.pingedLanes&=~s,r=r.expirationTimes;0<s;){var u=31-Xn(s),g=1<<u;r[u]=-1,s&=~g}}function bv(r){if(Lt&6)throw Error(Le(327));zl();var s=Id(r,0);if(!(s&1))return en(r,Mr()),null;var u=qd(r,s);if(r.tag!==0&&u===2){var g=um(r);g!==0&&(s=g,u=Fm(r,g))}if(u===1)throw u=Mc,go(r,0),ba(r,s),en(r,Mr()),u;if(u===6)throw Error(Le(345));return r.finishedWork=r.current.alternate,r.finishedLanes=s,ho(r,Ki,Os),en(r,Mr()),null}function Cg(r,s){var u=Lt;Lt|=1;try{return r(s)}finally{Lt=u,Lt===0&&(Fl=Mr()+500,ep&&Na())}}function bo(r){Ta!==null&&Ta.tag===0&&!(Lt&6)&&zl();var s=Lt;Lt|=1;var u=Pn.transition,g=Zt;try{if(Pn.transition=null,Zt=1,r)return r()}finally{Zt=g,Pn.transition=u,Lt=s,!(Lt&6)&&Na()}}function Pg(){un=Tl.current,or(Tl)}function go(r,s){r.finishedWork=null,r.finishedLanes=0;var u=r.timeoutHandle;if(u!==-1&&(r.timeoutHandle=-1,W2(u)),Lr!==null)for(u=Lr.return;u!==null;){var g=u;switch(ug(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Ad();break;case 3:Rl(),or(Ji),or(Ti),_g();break;case 5:yg(g);break;case 4:Rl();break;case 13:or(gr);break;case 19:or(gr);break;case 10:pg(g.type._context);break;case 22:case 23:Pg()}u=u.return}if(Jr=r,Lr=r=Da(r.current,null),li=un=s,$r=0,Mc=null,Eg=np=wo=0,Ki=pc=null,fo!==null){for(s=0;s<fo.length;s++)if(u=fo[s],g=u.interleaved,g!==null){u.interleaved=null;var _=g.next,S=u.pending;if(S!==null){var z=S.next;S.next=_,g.next=z}u.pending=g}fo=null}return r}function O0(r,s){do{var u=Lr;try{if(dg(),yd.current=Ud,Vd){for(var g=yr.memoizedState;g!==null;){var _=g.queue;_!==null&&(_.pending=null),g=g.next}Vd=!1}if(xo=0,Yr=jr=yr=null,hc=!1,Cc=0,kg.current=null,u===null||u.return===null){$r=1,Mc=s,Lr=null;break}e:{var S=r,z=u.return,l=u,N=s;if(s=li,l.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var F=N,pe=l,he=pe.tag;if(!(pe.mode&1)&&(he===0||he===11||he===15)){var ie=pe.alternate;ie?(pe.updateQueue=ie.updateQueue,pe.memoizedState=ie.memoizedState,pe.lanes=ie.lanes):(pe.updateQueue=null,pe.memoizedState=null)}var Ie=uv(z);if(Ie!==null){Ie.flags&=-257,cv(Ie,z,l,S,s),Ie.mode&1&&lv(S,F,s),s=Ie,N=F;var Pe=s.updateQueue;if(Pe===null){var Ce=new Set;Ce.add(N),s.updateQueue=Ce}else Pe.add(N);break e}else{if(!(s&1)){lv(S,F,s),zg();break e}N=Error(Le(426))}}else if(dr&&l.mode&1){var Ne=uv(z);if(Ne!==null){!(Ne.flags&65536)&&(Ne.flags|=256),cv(Ne,z,l,S,s),cg(Bl(N,l));break e}}S=N=Bl(N,l),$r!==4&&($r=2),pc===null?pc=[S]:pc.push(S),S=z;do{switch(S.tag){case 3:S.flags|=65536,s&=-s,S.lanes|=s;var re=w0(S,N,s);rv(S,re);break e;case 1:l=N;var ee=S.type,ce=S.stateNode;if(!(S.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||ce!==null&&typeof ce.componentDidCatch=="function"&&(Ma===null||!Ma.has(ce)))){S.flags|=65536,s&=-s,S.lanes|=s;var Te=b0(S,l,s);rv(S,Te);break e}}S=S.return}while(S!==null)}U0(u)}catch($e){s=$e,Lr===u&&u!==null&&(Lr=u=u.return);continue}break}while(!0)}function N0(){var r=jd.current;return jd.current=Ud,r===null?Ud:r}function zg(){($r===0||$r===3||$r===2)&&($r=4),Jr===null||!(wo&268435455)&&!(np&268435455)||ba(Jr,li)}function qd(r,s){var u=Lt;Lt|=2;var g=N0();(Jr!==r||li!==s)&&(Os=null,go(r,s));do try{_S();break}catch(_){O0(r,_)}while(!0);if(dg(),Lt=u,jd.current=g,Lr!==null)throw Error(Le(261));return Jr=null,li=0,$r}function _S(){for(;Lr!==null;)V0(Lr)}function vS(){for(;Lr!==null&&!Zb();)V0(Lr)}function V0(r){var s=$0(r.alternate,r,un);r.memoizedProps=r.pendingProps,s===null?U0(r):Lr=s,kg.current=null}function U0(r){var s=r;do{var u=s.alternate;if(r=s.return,s.flags&32768){if(u=dS(u,s),u!==null){u.flags&=32767,Lr=u;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{$r=6,Lr=null;return}}else if(u=hS(u,s,un),u!==null){Lr=u;return}if(s=s.sibling,s!==null){Lr=s;return}Lr=s=r}while(s!==null);$r===0&&($r=5)}function ho(r,s,u){var g=Zt,_=Pn.transition;try{Pn.transition=null,Zt=1,xS(r,s,u,g)}finally{Pn.transition=_,Zt=g}return null}function xS(r,s,u,g){do zl();while(Ta!==null);if(Lt&6)throw Error(Le(327));u=r.finishedWork;var _=r.finishedLanes;if(u===null)return null;if(r.finishedWork=null,r.finishedLanes=0,u===r.current)throw Error(Le(177));r.callbackNode=null,r.callbackPriority=0;var S=u.lanes|u.childLanes;if(e2(r,S),r===Jr&&(Lr=Jr=null,li=0),!(u.subtreeFlags&2064)&&!(u.flags&2064)||ud||(ud=!0,Z0(Ed,function(){return zl(),null})),S=(u.flags&15990)!==0,u.subtreeFlags&15990||S){S=Pn.transition,Pn.transition=null;var z=Zt;Zt=1;var l=Lt;Lt|=4,kg.current=null,fS(r,u),R0(u,r),V2(mm),Cd=!!fm,mm=fm=null,r.current=u,mS(u),qb(),Lt=l,Zt=z,Pn.transition=S}else r.current=u;if(ud&&(ud=!1,Ta=r,Zd=_),S=r.pendingLanes,S===0&&(Ma=null),Hb(u.stateNode),en(r,Mr()),s!==null)for(g=r.onRecoverableError,u=0;u<s.length;u++)_=s[u],g(_.value,{componentStack:_.stack,digest:_.digest});if($d)throw $d=!1,r=Rm,Rm=null,r;return Zd&1&&r.tag!==0&&zl(),S=r.pendingLanes,S&1?r===Bm?fc++:(fc=0,Bm=r):fc=0,Na(),null}function zl(){if(Ta!==null){var r=wx(Zd),s=Pn.transition,u=Zt;try{if(Pn.transition=null,Zt=16>r?16:r,Ta===null)var g=!1;else{if(r=Ta,Ta=null,Zd=0,Lt&6)throw Error(Le(331));var _=Lt;for(Lt|=4,rt=r.current;rt!==null;){var S=rt,z=S.child;if(rt.flags&16){var l=S.deletions;if(l!==null){for(var N=0;N<l.length;N++){var F=l[N];for(rt=F;rt!==null;){var pe=rt;switch(pe.tag){case 0:case 11:case 15:dc(8,pe,S)}var he=pe.child;if(he!==null)he.return=pe,rt=he;else for(;rt!==null;){pe=rt;var ie=pe.sibling,Ie=pe.return;if(A0(pe),pe===F){rt=null;break}if(ie!==null){ie.return=Ie,rt=ie;break}rt=Ie}}}var Pe=S.alternate;if(Pe!==null){var Ce=Pe.child;if(Ce!==null){Pe.child=null;do{var Ne=Ce.sibling;Ce.sibling=null,Ce=Ne}while(Ce!==null)}}rt=S}}if(S.subtreeFlags&2064&&z!==null)z.return=S,rt=z;else e:for(;rt!==null;){if(S=rt,S.flags&2048)switch(S.tag){case 0:case 11:case 15:dc(9,S,S.return)}var re=S.sibling;if(re!==null){re.return=S.return,rt=re;break e}rt=S.return}}var ee=r.current;for(rt=ee;rt!==null;){z=rt;var ce=z.child;if(z.subtreeFlags&2064&&ce!==null)ce.return=z,rt=ce;else e:for(z=ee;rt!==null;){if(l=rt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ip(9,l)}}catch($e){br(l,l.return,$e)}if(l===z){rt=null;break e}var Te=l.sibling;if(Te!==null){Te.return=l.return,rt=Te;break e}rt=l.return}}if(Lt=_,Na(),gs&&typeof gs.onPostCommitFiberRoot=="function")try{gs.onPostCommitFiberRoot(Xd,r)}catch{}g=!0}return g}finally{Zt=u,Pn.transition=s}}return!1}function Sv(r,s,u){s=Bl(u,s),s=w0(r,s,1),r=za(r,s,1),s=Fi(),r!==null&&(Rc(r,1,s),en(r,s))}function br(r,s,u){if(r.tag===3)Sv(r,r,u);else for(;s!==null;){if(s.tag===3){Sv(s,r,u);break}else if(s.tag===1){var g=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Ma===null||!Ma.has(g))){r=Bl(u,r),r=b0(s,r,1),s=za(s,r,1),r=Fi(),s!==null&&(Rc(s,1,r),en(s,r));break}}s=s.return}}function wS(r,s,u){var g=r.pingCache;g!==null&&g.delete(s),s=Fi(),r.pingedLanes|=r.suspendedLanes&u,Jr===r&&(li&u)===u&&($r===4||$r===3&&(li&130023424)===li&&500>Mr()-Ig?go(r,0):Eg|=u),en(r,s)}function j0(r,s){s===0&&(r.mode&1?(s=Qh,Qh<<=1,!(Qh&130023424)&&(Qh=4194304)):s=1);var u=Fi();r=qs(r,s),r!==null&&(Rc(r,s,u),en(r,u))}function bS(r){var s=r.memoizedState,u=0;s!==null&&(u=s.retryLane),j0(r,u)}function SS(r,s){var u=0;switch(r.tag){case 13:var g=r.stateNode,_=r.memoizedState;_!==null&&(u=_.retryLane);break;case 19:g=r.stateNode;break;default:throw Error(Le(314))}g!==null&&g.delete(s),j0(r,u)}var $0;$0=function(r,s,u){if(r!==null)if(r.memoizedProps!==s.pendingProps||Ji.current)Yi=!0;else{if(!(r.lanes&u)&&!(s.flags&128))return Yi=!1,cS(r,s,u);Yi=!!(r.flags&131072)}else Yi=!1,dr&&s.flags&1048576&&Wx(s,Rd,s.index);switch(s.lanes=0,s.tag){case 2:var g=s.type;vd(r,s),r=s.pendingProps;var _=Al(s,Ti.current);Pl(s,u),_=xg(null,s,g,r,_,u);var S=wg();return s.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Qi(g)?(S=!0,Dd(s)):S=!1,s.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,mg(s),_.updater=rp,s.stateNode=_,_._reactInternals=s,Tm(s,g,r,u),s=Im(null,s,g,!0,S,u)):(s.tag=0,dr&&S&&lg(s),Bi(null,s,_,u),s=s.child),s;case 16:g=s.elementType;e:{switch(vd(r,s),r=s.pendingProps,_=g._init,g=_(g._payload),s.type=g,_=s.tag=kS(g),r=Gn(g,r),_){case 0:s=Em(null,s,g,r,u);break e;case 1:s=pv(null,s,g,r,u);break e;case 11:s=hv(null,s,g,r,u);break e;case 14:s=dv(null,s,g,Gn(g.type,r),u);break e}throw Error(Le(306,g,""))}return s;case 0:return g=s.type,_=s.pendingProps,_=s.elementType===g?_:Gn(g,_),Em(r,s,g,_,u);case 1:return g=s.type,_=s.pendingProps,_=s.elementType===g?_:Gn(g,_),pv(r,s,g,_,u);case 3:e:{if(E0(s),r===null)throw Error(Le(387));g=s.pendingProps,S=s.memoizedState,_=S.element,Qx(r,s),Od(s,g,null,u);var z=s.memoizedState;if(g=z.element,S.isDehydrated)if(S={element:g,isDehydrated:!1,cache:z.cache,pendingSuspenseBoundaries:z.pendingSuspenseBoundaries,transitions:z.transitions},s.updateQueue.baseState=S,s.memoizedState=S,s.flags&256){_=Bl(Error(Le(423)),s),s=fv(r,s,g,u,_);break e}else if(g!==_){_=Bl(Error(Le(424)),s),s=fv(r,s,g,u,_);break e}else for(cn=Pa(s.stateNode.containerInfo.firstChild),hn=s,dr=!0,Hn=null,u=Yx(s,null,g,u),s.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Dl(),g===_){s=Gs(r,s,u);break e}Bi(r,s,g,u)}s=s.child}return s;case 5:return e0(s),r===null&&wm(s),g=s.type,_=s.pendingProps,S=r!==null?r.memoizedProps:null,z=_.children,gm(g,_)?z=null:S!==null&&gm(g,S)&&(s.flags|=32),k0(r,s),Bi(r,s,z,u),s.child;case 6:return r===null&&wm(s),null;case 13:return I0(r,s,u);case 4:return gg(s,s.stateNode.containerInfo),g=s.pendingProps,r===null?s.child=Ll(s,null,g,u):Bi(r,s,g,u),s.child;case 11:return g=s.type,_=s.pendingProps,_=s.elementType===g?_:Gn(g,_),hv(r,s,g,_,u);case 7:return Bi(r,s,s.pendingProps,u),s.child;case 8:return Bi(r,s,s.pendingProps.children,u),s.child;case 12:return Bi(r,s,s.pendingProps.children,u),s.child;case 10:e:{if(g=s.type._context,_=s.pendingProps,S=s.memoizedProps,z=_.value,tr(Bd,g._currentValue),g._currentValue=z,S!==null)if(Yn(S.value,z)){if(S.children===_.children&&!Ji.current){s=Gs(r,s,u);break e}}else for(S=s.child,S!==null&&(S.return=s);S!==null;){var l=S.dependencies;if(l!==null){z=S.child;for(var N=l.firstContext;N!==null;){if(N.context===g){if(S.tag===1){N=js(-1,u&-u),N.tag=2;var F=S.updateQueue;if(F!==null){F=F.shared;var pe=F.pending;pe===null?N.next=N:(N.next=pe.next,pe.next=N),F.pending=N}}S.lanes|=u,N=S.alternate,N!==null&&(N.lanes|=u),bm(S.return,u,s),l.lanes|=u;break}N=N.next}}else if(S.tag===10)z=S.type===s.type?null:S.child;else if(S.tag===18){if(z=S.return,z===null)throw Error(Le(341));z.lanes|=u,l=z.alternate,l!==null&&(l.lanes|=u),bm(z,u,s),z=S.sibling}else z=S.child;if(z!==null)z.return=S;else for(z=S;z!==null;){if(z===s){z=null;break}if(S=z.sibling,S!==null){S.return=z.return,z=S;break}z=z.return}S=z}Bi(r,s,_.children,u),s=s.child}return s;case 9:return _=s.type,g=s.pendingProps.children,Pl(s,u),_=zn(_),g=g(_),s.flags|=1,Bi(r,s,g,u),s.child;case 14:return g=s.type,_=Gn(g,s.pendingProps),_=Gn(g.type,_),dv(r,s,g,_,u);case 15:return S0(r,s,s.type,s.pendingProps,u);case 17:return g=s.type,_=s.pendingProps,_=s.elementType===g?_:Gn(g,_),vd(r,s),s.tag=1,Qi(g)?(r=!0,Dd(s)):r=!1,Pl(s,u),x0(s,g,_),Tm(s,g,_,u),Im(null,s,g,!0,r,u);case 19:return C0(r,s,u);case 22:return T0(r,s,u)}throw Error(Le(156,s.tag))};function Z0(r,s){return yx(r,s)}function TS(r,s,u,g){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cn(r,s,u,g){return new TS(r,s,u,g)}function Mg(r){return r=r.prototype,!(!r||!r.isReactComponent)}function kS(r){if(typeof r=="function")return Mg(r)?1:0;if(r!=null){if(r=r.$$typeof,r===Km)return 11;if(r===Ym)return 14}return 2}function Da(r,s){var u=r.alternate;return u===null?(u=Cn(r.tag,s,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=s,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&14680064,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,s=r.dependencies,u.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u}function bd(r,s,u,g,_,S){var z=2;if(g=r,typeof r=="function")Mg(r)&&(z=1);else if(typeof r=="string")z=5;else e:switch(r){case fl:return yo(u.children,_,S,s);case Xm:z=8,_|=8;break;case Hf:return r=Cn(12,u,s,_|2),r.elementType=Hf,r.lanes=S,r;case Xf:return r=Cn(13,u,s,_),r.elementType=Xf,r.lanes=S,r;case Kf:return r=Cn(19,u,s,_),r.elementType=Kf,r.lanes=S,r;case ex:return sp(u,_,S,s);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Jv:z=10;break e;case Qv:z=9;break e;case Km:z=11;break e;case Ym:z=14;break e;case va:z=16,g=null;break e}throw Error(Le(130,r==null?r:typeof r,""))}return s=Cn(z,u,s,_),s.elementType=r,s.type=g,s.lanes=S,s}function yo(r,s,u,g){return r=Cn(7,r,g,s),r.lanes=u,r}function sp(r,s,u,g){return r=Cn(22,r,g,s),r.elementType=ex,r.lanes=u,r.stateNode={isHidden:!1},r}function Zf(r,s,u){return r=Cn(6,r,null,s),r.lanes=u,r}function qf(r,s,u){return s=Cn(4,r.children!==null?r.children:[],r.key,s),s.lanes=u,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}function ES(r,s,u,g,_){this.tag=s,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kf(0),this.expirationTimes=kf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kf(0),this.identifierPrefix=g,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Ag(r,s,u,g,_,S,z,l,N){return r=new ES(r,s,u,l,N),s===1?(s=1,S===!0&&(s|=8)):s=0,S=Cn(3,null,null,s),r.current=S,S.stateNode=r,S.memoizedState={element:g,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},mg(S),r}function IS(r,s,u){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pl,key:g==null?null:""+g,children:r,containerInfo:s,implementation:u}}function q0(r){if(!r)return Ba;r=r._reactInternals;e:{if(To(r)!==r||r.tag!==1)throw Error(Le(170));var s=r;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Qi(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(Le(171))}if(r.tag===1){var u=r.type;if(Qi(u))return qx(r,u,s)}return s}function G0(r,s,u,g,_,S,z,l,N){return r=Ag(u,g,!0,r,_,S,z,l,N),r.context=q0(null),u=r.current,g=Fi(),_=Aa(u),S=js(g,_),S.callback=s??null,za(u,S,_),r.current.lanes=_,Rc(r,_,g),en(r,g),r}function ap(r,s,u,g){var _=s.current,S=Fi(),z=Aa(_);return u=q0(u),s.context===null?s.context=u:s.pendingContext=u,s=js(S,z),s.payload={element:r},g=g===void 0?null:g,g!==null&&(s.callback=g),r=za(_,s,z),r!==null&&(Kn(r,_,z,S),gd(r,_,z)),z}function Gd(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Tv(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<s?u:s}}function Dg(r,s){Tv(r,s),(r=r.alternate)&&Tv(r,s)}function CS(){return null}var W0=typeof reportError=="function"?reportError:function(r){console.error(r)};function Lg(r){this._internalRoot=r}op.prototype.render=Lg.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(Le(409));ap(r,s,null,null)};op.prototype.unmount=Lg.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;bo(function(){ap(null,r,null,null)}),s[Zs]=null}};function op(r){this._internalRoot=r}op.prototype.unstable_scheduleHydration=function(r){if(r){var s=Tx();r={blockedOn:null,target:r,priority:s};for(var u=0;u<wa.length&&s!==0&&s<wa[u].priority;u++);wa.splice(u,0,r),u===0&&Ex(r)}};function Rg(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function lp(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function kv(){}function PS(r,s,u,g,_){if(_){if(typeof g=="function"){var S=g;g=function(){var F=Gd(z);S.call(F)}}var z=G0(s,g,r,0,null,!1,!1,"",kv);return r._reactRootContainer=z,r[Zs]=z.current,Sc(r.nodeType===8?r.parentNode:r),bo(),z}for(;_=r.lastChild;)r.removeChild(_);if(typeof g=="function"){var l=g;g=function(){var F=Gd(N);l.call(F)}}var N=Ag(r,0,!1,null,null,!1,!1,"",kv);return r._reactRootContainer=N,r[Zs]=N.current,Sc(r.nodeType===8?r.parentNode:r),bo(function(){ap(s,N,u,g)}),N}function up(r,s,u,g,_){var S=u._reactRootContainer;if(S){var z=S;if(typeof _=="function"){var l=_;_=function(){var N=Gd(z);l.call(N)}}ap(s,z,r,_)}else z=PS(u,s,r,_,g);return Gd(z)}bx=function(r){switch(r.tag){case 3:var s=r.stateNode;if(s.current.memoizedState.isDehydrated){var u=nc(s.pendingLanes);u!==0&&(eg(s,u|1),en(s,Mr()),!(Lt&6)&&(Fl=Mr()+500,Na()))}break;case 13:bo(function(){var g=qs(r,1);if(g!==null){var _=Fi();Kn(g,r,1,_)}}),Dg(r,1)}};tg=function(r){if(r.tag===13){var s=qs(r,134217728);if(s!==null){var u=Fi();Kn(s,r,134217728,u)}Dg(r,134217728)}};Sx=function(r){if(r.tag===13){var s=Aa(r),u=qs(r,s);if(u!==null){var g=Fi();Kn(u,r,s,g)}Dg(r,s)}};Tx=function(){return Zt};kx=function(r,s){var u=Zt;try{return Zt=r,s()}finally{Zt=u}};am=function(r,s,u){switch(s){case"input":if(Qf(r,u),s=u.name,u.type==="radio"&&s!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<u.length;s++){var g=u[s];if(g!==r&&g.form===r.form){var _=Qd(g);if(!_)throw Error(Le(90));rx(g),Qf(g,_)}}}break;case"textarea":nx(r,u);break;case"select":s=u.value,s!=null&&kl(r,!!u.multiple,s,!1)}};hx=Cg;dx=bo;var zS={usingClientEntryPoint:!1,Events:[Fc,_l,Qd,ux,cx,Cg]},tc={findFiberByHostInstance:po,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MS={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ws.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=mx(r),r===null?null:r.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||CS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cd.isDisabled&&cd.supportsFiber)try{Xd=cd.inject(MS),gs=cd}catch{}}pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zS;pn.createPortal=function(r,s){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rg(s))throw Error(Le(200));return IS(r,s,null,u)};pn.createRoot=function(r,s){if(!Rg(r))throw Error(Le(299));var u=!1,g="",_=W0;return s!=null&&(s.unstable_strictMode===!0&&(u=!0),s.identifierPrefix!==void 0&&(g=s.identifierPrefix),s.onRecoverableError!==void 0&&(_=s.onRecoverableError)),s=Ag(r,1,!1,null,null,u,!1,g,_),r[Zs]=s.current,Sc(r.nodeType===8?r.parentNode:r),new Lg(s)};pn.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(Le(188)):(r=Object.keys(r).join(","),Error(Le(268,r)));return r=mx(s),r=r===null?null:r.stateNode,r};pn.flushSync=function(r){return bo(r)};pn.hydrate=function(r,s,u){if(!lp(s))throw Error(Le(200));return up(null,r,s,!0,u)};pn.hydrateRoot=function(r,s,u){if(!Rg(r))throw Error(Le(405));var g=u!=null&&u.hydratedSources||null,_=!1,S="",z=W0;if(u!=null&&(u.unstable_strictMode===!0&&(_=!0),u.identifierPrefix!==void 0&&(S=u.identifierPrefix),u.onRecoverableError!==void 0&&(z=u.onRecoverableError)),s=G0(s,null,r,1,u??null,_,!1,S,z),r[Zs]=s.current,Sc(r),g)for(r=0;r<g.length;r++)u=g[r],_=u._getVersion,_=_(u._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[u,_]:s.mutableSourceEagerHydrationData.push(u,_);return new op(s)};pn.render=function(r,s,u){if(!lp(s))throw Error(Le(200));return up(null,r,s,!1,u)};pn.unmountComponentAtNode=function(r){if(!lp(r))throw Error(Le(40));return r._reactRootContainer?(bo(function(){up(null,null,r,!1,function(){r._reactRootContainer=null,r[Zs]=null})}),!0):!1};pn.unstable_batchedUpdates=Cg;pn.unstable_renderSubtreeIntoContainer=function(r,s,u,g){if(!lp(u))throw Error(Le(200));if(r==null||r._reactInternals===void 0)throw Error(Le(38));return up(r,s,u,!1,g)};pn.version="18.3.1-next-f1338f8080-20240426";function H0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H0)}catch(r){console.error(r)}}H0(),Hv.exports=pn;var AS=Hv.exports,X0,Ev=AS;X0=Ev.createRoot,Ev.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ac(){return Ac=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var u=arguments[s];for(var g in u)Object.prototype.hasOwnProperty.call(u,g)&&(r[g]=u[g])}return r},Ac.apply(this,arguments)}var ka;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(ka||(ka={}));const Iv="popstate";function DS(r){r===void 0&&(r={});function s(g,_){let{pathname:S,search:z,hash:l}=g.location;return Nm("",{pathname:S,search:z,hash:l},_.state&&_.state.usr||null,_.state&&_.state.key||"default")}function u(g,_){return typeof _=="string"?_:Wd(_)}return RS(s,u,null,r)}function Rr(r,s){if(r===!1||r===null||typeof r>"u")throw new Error(s)}function K0(r,s){if(!r){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function LS(){return Math.random().toString(36).substr(2,8)}function Cv(r,s){return{usr:r.state,key:r.key,idx:s}}function Nm(r,s,u,g){return u===void 0&&(u=null),Ac({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof s=="string"?Ul(s):s,{state:u,key:s&&s.key||g||LS()})}function Wd(r){let{pathname:s="/",search:u="",hash:g=""}=r;return u&&u!=="?"&&(s+=u.charAt(0)==="?"?u:"?"+u),g&&g!=="#"&&(s+=g.charAt(0)==="#"?g:"#"+g),s}function Ul(r){let s={};if(r){let u=r.indexOf("#");u>=0&&(s.hash=r.substr(u),r=r.substr(0,u));let g=r.indexOf("?");g>=0&&(s.search=r.substr(g),r=r.substr(0,g)),r&&(s.pathname=r)}return s}function RS(r,s,u,g){g===void 0&&(g={});let{window:_=document.defaultView,v5Compat:S=!1}=g,z=_.history,l=ka.Pop,N=null,F=pe();F==null&&(F=0,z.replaceState(Ac({},z.state,{idx:F}),""));function pe(){return(z.state||{idx:null}).idx}function he(){l=ka.Pop;let Ne=pe(),re=Ne==null?null:Ne-F;F=Ne,N&&N({action:l,location:Ce.location,delta:re})}function ie(Ne,re){l=ka.Push;let ee=Nm(Ce.location,Ne,re);F=pe()+1;let ce=Cv(ee,F),Te=Ce.createHref(ee);try{z.pushState(ce,"",Te)}catch($e){if($e instanceof DOMException&&$e.name==="DataCloneError")throw $e;_.location.assign(Te)}S&&N&&N({action:l,location:Ce.location,delta:1})}function Ie(Ne,re){l=ka.Replace;let ee=Nm(Ce.location,Ne,re);F=pe();let ce=Cv(ee,F),Te=Ce.createHref(ee);z.replaceState(ce,"",Te),S&&N&&N({action:l,location:Ce.location,delta:0})}function Pe(Ne){let re=_.location.origin!=="null"?_.location.origin:_.location.href,ee=typeof Ne=="string"?Ne:Wd(Ne);return ee=ee.replace(/ $/,"%20"),Rr(re,"No window.location.(origin|href) available to create URL for href: "+ee),new URL(ee,re)}let Ce={get action(){return l},get location(){return r(_,z)},listen(Ne){if(N)throw new Error("A history only accepts one active listener");return _.addEventListener(Iv,he),N=Ne,()=>{_.removeEventListener(Iv,he),N=null}},createHref(Ne){return s(_,Ne)},createURL:Pe,encodeLocation(Ne){let re=Pe(Ne);return{pathname:re.pathname,search:re.search,hash:re.hash}},push:ie,replace:Ie,go(Ne){return z.go(Ne)}};return Ce}var Pv;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(Pv||(Pv={}));function BS(r,s,u){return u===void 0&&(u="/"),FS(r,s,u)}function FS(r,s,u,g){let _=typeof s=="string"?Ul(s):s,S=Bg(_.pathname||"/",u);if(S==null)return null;let z=Y0(r);OS(z);let l=null;for(let N=0;l==null&&N<z.length;++N){let F=KS(S);l=WS(z[N],F)}return l}function Y0(r,s,u,g){s===void 0&&(s=[]),u===void 0&&(u=[]),g===void 0&&(g="");let _=(S,z,l)=>{let N={relativePath:l===void 0?S.path||"":l,caseSensitive:S.caseSensitive===!0,childrenIndex:z,route:S};N.relativePath.startsWith("/")&&(Rr(N.relativePath.startsWith(g),'Absolute route path "'+N.relativePath+'" nested under path '+('"'+g+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),N.relativePath=N.relativePath.slice(g.length));let F=La([g,N.relativePath]),pe=u.concat(N);S.children&&S.children.length>0&&(Rr(S.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+F+'".')),Y0(S.children,s,pe,F)),!(S.path==null&&!S.index)&&s.push({path:F,score:qS(F,S.index),routesMeta:pe})};return r.forEach((S,z)=>{var l;if(S.path===""||!((l=S.path)!=null&&l.includes("?")))_(S,z);else for(let N of J0(S.path))_(S,z,N)}),s}function J0(r){let s=r.split("/");if(s.length===0)return[];let[u,...g]=s,_=u.endsWith("?"),S=u.replace(/\?$/,"");if(g.length===0)return _?[S,""]:[S];let z=J0(g.join("/")),l=[];return l.push(...z.map(N=>N===""?S:[S,N].join("/"))),_&&l.push(...z),l.map(N=>r.startsWith("/")&&N===""?"/":N)}function OS(r){r.sort((s,u)=>s.score!==u.score?u.score-s.score:GS(s.routesMeta.map(g=>g.childrenIndex),u.routesMeta.map(g=>g.childrenIndex)))}const NS=/^:[\w-]+$/,VS=3,US=2,jS=1,$S=10,ZS=-2,zv=r=>r==="*";function qS(r,s){let u=r.split("/"),g=u.length;return u.some(zv)&&(g+=ZS),s&&(g+=US),u.filter(_=>!zv(_)).reduce((_,S)=>_+(NS.test(S)?VS:S===""?jS:$S),g)}function GS(r,s){return r.length===s.length&&r.slice(0,-1).every((g,_)=>g===s[_])?r[r.length-1]-s[s.length-1]:0}function WS(r,s,u){let{routesMeta:g}=r,_={},S="/",z=[];for(let l=0;l<g.length;++l){let N=g[l],F=l===g.length-1,pe=S==="/"?s:s.slice(S.length)||"/",he=HS({path:N.relativePath,caseSensitive:N.caseSensitive,end:F},pe),ie=N.route;if(!he)return null;Object.assign(_,he.params),z.push({params:_,pathname:La([S,he.pathname]),pathnameBase:eT(La([S,he.pathnameBase])),route:ie}),he.pathnameBase!=="/"&&(S=La([S,he.pathnameBase]))}return z}function HS(r,s){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[u,g]=XS(r.path,r.caseSensitive,r.end),_=s.match(u);if(!_)return null;let S=_[0],z=S.replace(/(.)\/+$/,"$1"),l=_.slice(1);return{params:g.reduce((F,pe,he)=>{let{paramName:ie,isOptional:Ie}=pe;if(ie==="*"){let Ce=l[he]||"";z=S.slice(0,S.length-Ce.length).replace(/(.)\/+$/,"$1")}const Pe=l[he];return Ie&&!Pe?F[ie]=void 0:F[ie]=(Pe||"").replace(/%2F/g,"/"),F},{}),pathname:S,pathnameBase:z,pattern:r}}function XS(r,s,u){s===void 0&&(s=!1),u===void 0&&(u=!0),K0(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let g=[],_="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(z,l,N)=>(g.push({paramName:l,isOptional:N!=null}),N?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(g.push({paramName:"*"}),_+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):u?_+="\\/*$":r!==""&&r!=="/"&&(_+="(?:(?=\\/|$))"),[new RegExp(_,s?void 0:"i"),g]}function KS(r){try{return r.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return K0(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),r}}function Bg(r,s){if(s==="/")return r;if(!r.toLowerCase().startsWith(s.toLowerCase()))return null;let u=s.endsWith("/")?s.length-1:s.length,g=r.charAt(u);return g&&g!=="/"?null:r.slice(u)||"/"}function YS(r,s){s===void 0&&(s="/");let{pathname:u,search:g="",hash:_=""}=typeof r=="string"?Ul(r):r;return{pathname:u?u.startsWith("/")?u:JS(u,s):s,search:tT(g),hash:rT(_)}}function JS(r,s){let u=s.replace(/\/+$/,"").split("/");return r.split("/").forEach(_=>{_===".."?u.length>1&&u.pop():_!=="."&&u.push(_)}),u.length>1?u.join("/"):"/"}function Gf(r,s,u,g){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(g)+"].  Please separate it out to the ")+("`to."+u+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function QS(r){return r.filter((s,u)=>u===0||s.route.path&&s.route.path.length>0)}function Q0(r,s){let u=QS(r);return s?u.map((g,_)=>_===u.length-1?g.pathname:g.pathnameBase):u.map(g=>g.pathnameBase)}function e1(r,s,u,g){g===void 0&&(g=!1);let _;typeof r=="string"?_=Ul(r):(_=Ac({},r),Rr(!_.pathname||!_.pathname.includes("?"),Gf("?","pathname","search",_)),Rr(!_.pathname||!_.pathname.includes("#"),Gf("#","pathname","hash",_)),Rr(!_.search||!_.search.includes("#"),Gf("#","search","hash",_)));let S=r===""||_.pathname==="",z=S?"/":_.pathname,l;if(z==null)l=u;else{let he=s.length-1;if(!g&&z.startsWith("..")){let ie=z.split("/");for(;ie[0]==="..";)ie.shift(),he-=1;_.pathname=ie.join("/")}l=he>=0?s[he]:"/"}let N=YS(_,l),F=z&&z!=="/"&&z.endsWith("/"),pe=(S||z===".")&&u.endsWith("/");return!N.pathname.endsWith("/")&&(F||pe)&&(N.pathname+="/"),N}const La=r=>r.join("/").replace(/\/\/+/g,"/"),eT=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),tT=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,rT=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function iT(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const t1=["post","put","patch","delete"];new Set(t1);const nT=["get",...t1];new Set(nT);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dc(){return Dc=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var u=arguments[s];for(var g in u)Object.prototype.hasOwnProperty.call(u,g)&&(r[g]=u[g])}return r},Dc.apply(this,arguments)}const Fg=et.createContext(null),sT=et.createContext(null),ko=et.createContext(null),cp=et.createContext(null),Va=et.createContext({outlet:null,matches:[],isDataRoute:!1}),r1=et.createContext(null);function aT(r,s){let{relative:u}=s===void 0?{}:s;Nc()||Rr(!1);let{basename:g,navigator:_}=et.useContext(ko),{hash:S,pathname:z,search:l}=n1(r,{relative:u}),N=z;return g!=="/"&&(N=z==="/"?g:La([g,z])),_.createHref({pathname:N,search:l,hash:S})}function Nc(){return et.useContext(cp)!=null}function Vc(){return Nc()||Rr(!1),et.useContext(cp).location}function i1(r){et.useContext(ko).static||et.useLayoutEffect(r)}function oT(){let{isDataRoute:r}=et.useContext(Va);return r?wT():lT()}function lT(){Nc()||Rr(!1);let r=et.useContext(Fg),{basename:s,future:u,navigator:g}=et.useContext(ko),{matches:_}=et.useContext(Va),{pathname:S}=Vc(),z=JSON.stringify(Q0(_,u.v7_relativeSplatPath)),l=et.useRef(!1);return i1(()=>{l.current=!0}),et.useCallback(function(F,pe){if(pe===void 0&&(pe={}),!l.current)return;if(typeof F=="number"){g.go(F);return}let he=e1(F,JSON.parse(z),S,pe.relative==="path");r==null&&s!=="/"&&(he.pathname=he.pathname==="/"?s:La([s,he.pathname])),(pe.replace?g.replace:g.push)(he,pe.state,pe)},[s,g,z,S,r])}function uT(){let{matches:r}=et.useContext(Va),s=r[r.length-1];return s?s.params:{}}function n1(r,s){let{relative:u}=s===void 0?{}:s,{future:g}=et.useContext(ko),{matches:_}=et.useContext(Va),{pathname:S}=Vc(),z=JSON.stringify(Q0(_,g.v7_relativeSplatPath));return et.useMemo(()=>e1(r,JSON.parse(z),S,u==="path"),[r,z,S,u])}function cT(r,s){return hT(r,s)}function hT(r,s,u,g){Nc()||Rr(!1);let{navigator:_}=et.useContext(ko),{matches:S}=et.useContext(Va),z=S[S.length-1],l=z?z.params:{};z&&z.pathname;let N=z?z.pathnameBase:"/";z&&z.route;let F=Vc(),pe;if(s){var he;let Ne=typeof s=="string"?Ul(s):s;N==="/"||(he=Ne.pathname)!=null&&he.startsWith(N)||Rr(!1),pe=Ne}else pe=F;let ie=pe.pathname||"/",Ie=ie;if(N!=="/"){let Ne=N.replace(/^\//,"").split("/");Ie="/"+ie.replace(/^\//,"").split("/").slice(Ne.length).join("/")}let Pe=BS(r,{pathname:Ie}),Ce=gT(Pe&&Pe.map(Ne=>Object.assign({},Ne,{params:Object.assign({},l,Ne.params),pathname:La([N,_.encodeLocation?_.encodeLocation(Ne.pathname).pathname:Ne.pathname]),pathnameBase:Ne.pathnameBase==="/"?N:La([N,_.encodeLocation?_.encodeLocation(Ne.pathnameBase).pathname:Ne.pathnameBase])})),S,u,g);return s&&Ce?et.createElement(cp.Provider,{value:{location:Dc({pathname:"/",search:"",hash:"",state:null,key:"default"},pe),navigationType:ka.Pop}},Ce):Ce}function dT(){let r=xT(),s=iT(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),u=r instanceof Error?r.stack:null,_={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return et.createElement(et.Fragment,null,et.createElement("h2",null,"Unexpected Application Error!"),et.createElement("h3",{style:{fontStyle:"italic"}},s),u?et.createElement("pre",{style:_},u):null,null)}const pT=et.createElement(dT,null);class fT extends et.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,u){return u.location!==s.location||u.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:u.error,location:u.location,revalidation:s.revalidation||u.revalidation}}componentDidCatch(s,u){console.error("React Router caught the following error during render",s,u)}render(){return this.state.error!==void 0?et.createElement(Va.Provider,{value:this.props.routeContext},et.createElement(r1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mT(r){let{routeContext:s,match:u,children:g}=r,_=et.useContext(Fg);return _&&_.static&&_.staticContext&&(u.route.errorElement||u.route.ErrorBoundary)&&(_.staticContext._deepestRenderedBoundaryId=u.route.id),et.createElement(Va.Provider,{value:s},g)}function gT(r,s,u,g){var _;if(s===void 0&&(s=[]),u===void 0&&(u=null),g===void 0&&(g=null),r==null){var S;if(!u)return null;if(u.errors)r=u.matches;else if((S=g)!=null&&S.v7_partialHydration&&s.length===0&&!u.initialized&&u.matches.length>0)r=u.matches;else return null}let z=r,l=(_=u)==null?void 0:_.errors;if(l!=null){let pe=z.findIndex(he=>he.route.id&&(l==null?void 0:l[he.route.id])!==void 0);pe>=0||Rr(!1),z=z.slice(0,Math.min(z.length,pe+1))}let N=!1,F=-1;if(u&&g&&g.v7_partialHydration)for(let pe=0;pe<z.length;pe++){let he=z[pe];if((he.route.HydrateFallback||he.route.hydrateFallbackElement)&&(F=pe),he.route.id){let{loaderData:ie,errors:Ie}=u,Pe=he.route.loader&&ie[he.route.id]===void 0&&(!Ie||Ie[he.route.id]===void 0);if(he.route.lazy||Pe){N=!0,F>=0?z=z.slice(0,F+1):z=[z[0]];break}}}return z.reduceRight((pe,he,ie)=>{let Ie,Pe=!1,Ce=null,Ne=null;u&&(Ie=l&&he.route.id?l[he.route.id]:void 0,Ce=he.route.errorElement||pT,N&&(F<0&&ie===0?(bT("route-fallback"),Pe=!0,Ne=null):F===ie&&(Pe=!0,Ne=he.route.hydrateFallbackElement||null)));let re=s.concat(z.slice(0,ie+1)),ee=()=>{let ce;return Ie?ce=Ce:Pe?ce=Ne:he.route.Component?ce=et.createElement(he.route.Component,null):he.route.element?ce=he.route.element:ce=pe,et.createElement(mT,{match:he,routeContext:{outlet:pe,matches:re,isDataRoute:u!=null},children:ce})};return u&&(he.route.ErrorBoundary||he.route.errorElement||ie===0)?et.createElement(fT,{location:u.location,revalidation:u.revalidation,component:Ce,error:Ie,children:ee(),routeContext:{outlet:null,matches:re,isDataRoute:!0}}):ee()},null)}var s1=function(r){return r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r}(s1||{}),a1=function(r){return r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId",r}(a1||{});function yT(r){let s=et.useContext(Fg);return s||Rr(!1),s}function _T(r){let s=et.useContext(sT);return s||Rr(!1),s}function vT(r){let s=et.useContext(Va);return s||Rr(!1),s}function o1(r){let s=vT(),u=s.matches[s.matches.length-1];return u.route.id||Rr(!1),u.route.id}function xT(){var r;let s=et.useContext(r1),u=_T(),g=o1();return s!==void 0?s:(r=u.errors)==null?void 0:r[g]}function wT(){let{router:r}=yT(s1.UseNavigateStable),s=o1(a1.UseNavigateStable),u=et.useRef(!1);return i1(()=>{u.current=!0}),et.useCallback(function(_,S){S===void 0&&(S={}),u.current&&(typeof _=="number"?r.navigate(_):r.navigate(_,Dc({fromRouteId:s},S)))},[r,s])}const Mv={};function bT(r,s,u){Mv[r]||(Mv[r]=!0)}function ST(r,s){r==null||r.v7_startTransition,r==null||r.v7_relativeSplatPath}function _a(r){Rr(!1)}function TT(r){let{basename:s="/",children:u=null,location:g,navigationType:_=ka.Pop,navigator:S,static:z=!1,future:l}=r;Nc()&&Rr(!1);let N=s.replace(/^\/*/,"/"),F=et.useMemo(()=>({basename:N,navigator:S,static:z,future:Dc({v7_relativeSplatPath:!1},l)}),[N,l,S,z]);typeof g=="string"&&(g=Ul(g));let{pathname:pe="/",search:he="",hash:ie="",state:Ie=null,key:Pe="default"}=g,Ce=et.useMemo(()=>{let Ne=Bg(pe,N);return Ne==null?null:{location:{pathname:Ne,search:he,hash:ie,state:Ie,key:Pe},navigationType:_}},[N,pe,he,ie,Ie,Pe,_]);return Ce==null?null:et.createElement(ko.Provider,{value:F},et.createElement(cp.Provider,{children:u,value:Ce}))}function kT(r){let{children:s,location:u}=r;return cT(Vm(s),u)}new Promise(()=>{});function Vm(r,s){s===void 0&&(s=[]);let u=[];return et.Children.forEach(r,(g,_)=>{if(!et.isValidElement(g))return;let S=[...s,_];if(g.type===et.Fragment){u.push.apply(u,Vm(g.props.children,S));return}g.type!==_a&&Rr(!1),!g.props.index||!g.props.children||Rr(!1);let z={id:g.props.id||S.join("-"),caseSensitive:g.props.caseSensitive,element:g.props.element,Component:g.props.Component,index:g.props.index,path:g.props.path,loader:g.props.loader,action:g.props.action,errorElement:g.props.errorElement,ErrorBoundary:g.props.ErrorBoundary,hasErrorBoundary:g.props.ErrorBoundary!=null||g.props.errorElement!=null,shouldRevalidate:g.props.shouldRevalidate,handle:g.props.handle,lazy:g.props.lazy};g.props.children&&(z.children=Vm(g.props.children,S)),u.push(z)}),u}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Um(){return Um=Object.assign?Object.assign.bind():function(r){for(var s=1;s<arguments.length;s++){var u=arguments[s];for(var g in u)Object.prototype.hasOwnProperty.call(u,g)&&(r[g]=u[g])}return r},Um.apply(this,arguments)}function ET(r,s){if(r==null)return{};var u={},g=Object.keys(r),_,S;for(S=0;S<g.length;S++)_=g[S],!(s.indexOf(_)>=0)&&(u[_]=r[_]);return u}function IT(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function CT(r,s){return r.button===0&&(!s||s==="_self")&&!IT(r)}const PT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],zT="6";try{window.__reactRouterVersion=zT}catch{}const MT="startTransition",Av=wb[MT];function AT(r){let{basename:s,children:u,future:g,window:_}=r,S=et.useRef();S.current==null&&(S.current=DS({window:_,v5Compat:!0}));let z=S.current,[l,N]=et.useState({action:z.action,location:z.location}),{v7_startTransition:F}=g||{},pe=et.useCallback(he=>{F&&Av?Av(()=>N(he)):N(he)},[N,F]);return et.useLayoutEffect(()=>z.listen(pe),[z,pe]),et.useEffect(()=>ST(g),[g]),et.createElement(TT,{basename:s,children:u,location:l.location,navigationType:l.action,navigator:z,future:g})}const DT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,hp=et.forwardRef(function(s,u){let{onClick:g,relative:_,reloadDocument:S,replace:z,state:l,target:N,to:F,preventScrollReset:pe,viewTransition:he}=s,ie=ET(s,PT),{basename:Ie}=et.useContext(ko),Pe,Ce=!1;if(typeof F=="string"&&LT.test(F)&&(Pe=F,DT))try{let ce=new URL(window.location.href),Te=F.startsWith("//")?new URL(ce.protocol+F):new URL(F),$e=Bg(Te.pathname,Ie);Te.origin===ce.origin&&$e!=null?F=$e+Te.search+Te.hash:Ce=!0}catch{}let Ne=aT(F,{relative:_}),re=RT(F,{replace:z,state:l,target:N,preventScrollReset:pe,relative:_,viewTransition:he});function ee(ce){g&&g(ce),ce.defaultPrevented||re(ce)}return et.createElement("a",Um({},ie,{href:Pe||Ne,onClick:Ce||S?g:ee,ref:u,target:N}))});var Dv;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmit="useSubmit",r.UseSubmitFetcher="useSubmitFetcher",r.UseFetcher="useFetcher",r.useViewTransitionState="useViewTransitionState"})(Dv||(Dv={}));var Lv;(function(r){r.UseFetcher="useFetcher",r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(Lv||(Lv={}));function RT(r,s){let{target:u,replace:g,state:_,preventScrollReset:S,relative:z,viewTransition:l}=s===void 0?{}:s,N=oT(),F=Vc(),pe=n1(r,{relative:z});return et.useCallback(he=>{if(CT(he,u)){he.preventDefault();let ie=g!==void 0?g:Wd(F)===Wd(pe);N(r,{replace:ie,state:_,preventScrollReset:S,relative:z,viewTransition:l})}},[F,N,pe,g,_,u,r,S,z,l])}function BT(){return Me.jsxs("div",{children:[Me.jsx("input",{placeholder:"Search trails",style:{width:"100%",padding:12,borderRadius:8,border:"1px solid #ccc"}}),Me.jsx("h2",{style:{marginTop:16},children:"Featured Trails"}),Me.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[1,2,3,4].map(r=>Me.jsxs(hp,{to:`/trails/${r}`,style:{border:"1px solid #eee",borderRadius:8,padding:12,textDecoration:"none",color:"inherit"},children:[Me.jsx("div",{style:{height:80,background:"#e0f2f1",borderRadius:6}}),Me.jsx("div",{style:{marginTop:8},children:Me.jsxs("strong",{children:["Trail ",r]})}),Me.jsx("div",{style:{fontSize:12,color:"#666"},children:"Easy  5 km"})]},r))})]})}function FT(){return Me.jsxs("div",{children:[Me.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[Me.jsxs("select",{children:[Me.jsx("option",{children:"All difficulties"}),Me.jsx("option",{children:"Easy"}),Me.jsx("option",{children:"Moderate"}),Me.jsx("option",{children:"Hard"})]}),Me.jsxs("select",{children:[Me.jsx("option",{children:"Any length"}),Me.jsx("option",{children:"<5 km"}),Me.jsx("option",{children:"510 km"}),Me.jsx("option",{children:">10 km"})]}),Me.jsx("select",{children:Me.jsx("option",{children:"All regions"})})]}),Me.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:Array.from({length:10}).map((r,s)=>Me.jsx("li",{style:{borderBottom:"1px solid #eee",padding:"12px 0"},children:Me.jsxs(hp,{to:`/trails/${s+1}`,style:{textDecoration:"none",color:"inherit"},children:[Me.jsxs("strong",{children:["Trail ",s+1]}),"  Moderate  8 km"]})},s))})]})}var l1={exports:{}};(function(r,s){(function(u,g){r.exports=g()})(sb,function(){var u,g,_;function S(l,N){if(!u)u=N;else if(!g)g=N;else{var F="var sharedChunk = {}; ("+u+")(sharedChunk); ("+g+")(sharedChunk);",pe={};u(pe),_=N(pe),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([F],{type:"text/javascript"})))}}S(["exports"],function(l){function N(i,e,n,o){return new(n||(n=Promise))(function(h,m){function y(k){try{b(o.next(k))}catch(I){m(I)}}function v(k){try{b(o.throw(k))}catch(I){m(I)}}function b(k){var I;k.done?h(k.value):(I=k.value,I instanceof n?I:new n(function(M){M(I)})).then(y,v)}b((o=o.apply(i,e||[])).next())})}function F(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var pe=he;function he(i,e){this.x=i,this.y=e}he.prototype={clone:function(){return new he(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,n=i.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),n=Math.sin(i),o=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=o,this},_rotateAround:function(i,e){var n=Math.cos(i),o=Math.sin(i),h=e.y+o*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-o*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},he.convert=function(i){return i instanceof he?i:Array.isArray(i)?new he(i[0],i[1]):i};var ie=F(pe),Ie=Pe;function Pe(i,e,n,o){this.cx=3*i,this.bx=3*(n-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(o-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=e,this.p2x=n,this.p2y=o}Pe.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,e){if(e===void 0&&(e=1e-6),i<0)return 0;if(i>1)return 1;for(var n=i,o=0;o<8;o++){var h=this.sampleCurveX(n)-i;if(Math.abs(h)<e)return n;var m=this.sampleCurveDerivativeX(n);if(Math.abs(m)<1e-6)break;n-=h/m}var y=0,v=1;for(n=i,o=0;o<20&&(h=this.sampleCurveX(n),!(Math.abs(h-i)<e));o++)i>h?y=n:v=n,n=.5*(v-y)+y;return n},solve:function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))}};var Ce=F(Ie);let Ne,re;function ee(){return Ne==null&&(Ne=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ne}function ce(){if(re==null&&(re=!1,ee())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let o=0;o<5*5;o++){const h=4*o;e.fillStyle=`rgb(${h},${h+1},${h+2})`,e.fillRect(o%5,Math.floor(o/5),1,1)}const n=e.getImageData(0,0,5,5).data;for(let o=0;o<5*5*4;o++)if(o%4!=3&&n[o]!==o){re=!0;break}}}return re||!1}function Te(i,e,n,o){const h=new Ce(i,e,n,o);return function(m){return h.solve(m)}}const $e=Te(.25,.1,.25,1);function Ye(i,e,n){return Math.min(n,Math.max(e,i))}function it(i,e,n){const o=n-e,h=((i-e)%o+o)%o+e;return h===e?n:h}function We(i,...e){for(const n of e)for(const o in n)i[o]=n[o];return i}let qt=1;function at(i,e,n){const o={};for(const h in i)o[h]=e.call(n||this,i[h],h,i);return o}function Ar(i,e,n){const o={};for(const h in i)e.call(n||this,i[h],h,i)&&(o[h]=i[h]);return o}function Br(i){return Array.isArray(i)?i.map(Br):typeof i=="object"&&i?at(i,Br):i}const ci={};function Dr(i){ci[i]||(typeof console<"u"&&console.warn(i),ci[i]=!0)}function Qr(i,e,n){return(n.y-i.y)*(e.x-i.x)>(e.y-i.y)*(n.x-i.x)}function ki(i){let e=0;for(let n,o,h=0,m=i.length,y=m-1;h<m;y=h++)n=i[h],o=i[y],e+=(o.x-n.x)*(n.y+o.y);return e}function Zr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Ge=null;function pt(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ut(i,e,n,o,h){return N(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(i,{timestamp:0});try{const y=m==null?void 0:m.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const v=y.startsWith("BGR"),b=new Uint8ClampedArray(o*h*4);if(yield m.copyTo(b,function(k,I,M,D,B){const O=4*Math.max(-I,0),j=(Math.max(0,M)-M)*D*4+O,H=4*D,Y=Math.max(0,I),oe=Math.max(0,M);return{rect:{x:Y,y:oe,width:Math.min(k.width,I+D)-Y,height:Math.min(k.height,M+B)-oe},layout:[{offset:j,stride:H}]}}(i,e,n,o,h)),v)for(let k=0;k<b.length;k+=4){const I=b[k];b[k]=b[k+2],b[k+2]=I}return b}finally{m.close()}})}let Ft,Dt,lr,tn;const hi={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const e=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(i,e=0){return this.getImageCanvasContext(i).getImageData(-e,-e,i.width+2*e,i.height+2*e)},getImageCanvasContext(i){const e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=i.width,e.height=i.height,n.drawImage(i,0,0,i.width,i.height),n},resolveURL:i=>(lr||(lr=document.createElement("a")),lr.href=i,lr.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(tn==null&&(tn=matchMedia("(prefers-reduced-motion: reduce)")),tn.matches)}},rn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Jn extends Error{constructor(e,n,o,h){super(`AJAXError: ${n} (${e}): ${o}`),this.status=e,this.statusText=n,this.url=o,this.body=h}}const nn=Zr()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Vi=i=>rn.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))];function Ua(i,e){const n=new AbortController,o=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,cache:i.cache,referrer:nn(),signal:n.signal});let h=!1,m=!1;return i.type==="json"&&o.headers.set("Accept","application/json"),m||fetch(o).then(y=>y.ok?(v=>{(i.type==="arrayBuffer"||i.type==="image"?v.arrayBuffer():i.type==="json"?v.json():v.text()).then(b=>{m||(h=!0,e(null,b,v.headers.get("Cache-Control"),v.headers.get("Expires")))}).catch(b=>{m||e(new Error(b.message))})})(y):y.blob().then(v=>e(new Jn(y.status,y.statusText,i.url,v)))).catch(y=>{y.code!==20&&e(new Error(y.message))}),{cancel:()=>{m=!0,h||n.abort()}}}const Qn=function(i,e){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(Zr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e);if(!Zr())return(Vi(i.url)||Ua)(i,e)}if(!(/^file:/.test(n=i.url)||/^file:/.test(nn())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Ua(i,e);if(Zr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var n;return function(o,h){const m=new XMLHttpRequest;m.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(m.responseType="arraybuffer");for(const y in o.headers)m.setRequestHeader(y,o.headers[y]);return o.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=o.credentials==="include",m.onerror=()=>{h(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let y=m.response;if(o.type==="json")try{y=JSON.parse(m.response)}catch(v){return h(v)}h(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else{const y=new Blob([m.response],{type:m.getResponseHeader("Content-Type")});h(new Jn(m.status,m.statusText,o.url,y))}},m.send(o.body),{cancel:()=>m.abort()}}(i,e)},ja=function(i,e){return Qn(We(i,{type:"arrayBuffer"}),e)};function An(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const e=new URL(i),n=window.location;return e.protocol===n.protocol&&e.host===n.host}function Hs(i,e,n){n[i]&&n[i].indexOf(e)!==-1||(n[i]=n[i]||[],n[i].push(e))}function _s(i,e,n){if(n&&n[i]){const o=n[i].indexOf(e);o!==-1&&n[i].splice(o,1)}}class es{constructor(e,n={}){We(this,n),this.type=e}}class ts extends es{constructor(e,n={}){super("error",We({error:e},n))}}class vs{on(e,n){return this._listeners=this._listeners||{},Hs(e,n,this._listeners),this}off(e,n){return _s(e,n,this._listeners),_s(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},Hs(e,n,this._oneTimeListeners),this):new Promise(o=>this.once(e,o))}fire(e,n){typeof e=="string"&&(e=new es(e,n||{}));const o=e.type;if(this.listens(o)){e.target=this;const h=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const v of h)v.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const v of m)_s(o,v,this._oneTimeListeners),v.call(this,e);const y=this._eventedParent;y&&(We(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof ts&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const di=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ui(i,e){const n={};for(const o in i)o!=="ref"&&(n[o]=i[o]);return di.forEach(o=>{o in e&&(n[o]=e[o])}),n}function Vt(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let n=0;n<i.length;n++)if(!Vt(i[n],e[n]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(const n in i)if(!Vt(i[n],e[n]))return!1;return!0}return i===e}const Ct={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function mn(i,e,n){n.push({command:Ct.addSource,args:[i,e[i]]})}function Xs(i,e,n){e.push({command:Ct.removeSource,args:[i]}),n[i]=!0}function Dn(i,e,n,o){Xs(i,n,o),mn(i,e,n)}function Eo(i,e,n){let o;for(o in i[n])if(Object.prototype.hasOwnProperty.call(i[n],o)&&o!=="data"&&!Vt(i[n][o],e[n][o]))return!1;for(o in e[n])if(Object.prototype.hasOwnProperty.call(e[n],o)&&o!=="data"&&!Vt(i[n][o],e[n][o]))return!1;return!0}function Ks(i,e,n,o,h,m){let y;for(y in e=e||{},i=i||{})Object.prototype.hasOwnProperty.call(i,y)&&(Vt(i[y],e[y])||n.push({command:m,args:[o,y,e[y],h]}));for(y in e)Object.prototype.hasOwnProperty.call(e,y)&&!Object.prototype.hasOwnProperty.call(i,y)&&(Vt(i[y],e[y])||n.push({command:m,args:[o,y,e[y],h]}))}function rs(i){return i.id}function xs(i,e){return i[e.id]=e,i}class De{constructor(e,n,o,h){this.message=(e?`${e}: `:"")+o,h&&(this.identifier=h),n!=null&&n.__line__&&(this.line=n.__line__)}}function gn(i,...e){for(const n of e)for(const o in n)i[o]=n[o];return i}class rr extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}class ws{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[o,h]of n)this.bindings[o]=h}concat(e){return new ws(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Ln={kind:"null"},Be={kind:"number"},gt={kind:"string"},ht={kind:"boolean"},ei={kind:"color"},yn={kind:"object"},ft={kind:"value"},Rn={kind:"collator"},q={kind:"formatted"},A={kind:"padding"},L={kind:"resolvedImage"},V={kind:"variableAnchorOffsetCollection"};function W(i,e){return{kind:"array",itemType:i,N:e}}function X(i){if(i.kind==="array"){const e=X(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const le=[Ln,Be,gt,ht,ei,q,yn,W(ft),A,L,V];function te(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!te(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const n of le)if(!te(n,e))return null}}return`Expected ${X(i)} but found ${X(e)} instead.`}function J(i,e){return e.some(n=>n.kind===i.kind)}function ae(i,e){return e.some(n=>n==="null"?i===null:n==="array"?Array.isArray(i):n==="object"?i&&!Array.isArray(i)&&typeof i=="object":n===typeof i)}function _e(i,e){return i.kind==="array"&&e.kind==="array"?i.itemType.kind===e.itemType.kind&&typeof i.N=="number":i.kind===e.kind}const ve=.96422,be=.82521,nt=4/29,ct=6/29,He=3*ct*ct,ot=ct*ct*ct,dt=Math.PI/180,At=180/Math.PI;function Ot(i){return(i%=360)<0&&(i+=360),i}function Et([i,e,n,o]){let h,m;const y=qr((.2225045*(i=kt(i))+.7168786*(e=kt(e))+.0606169*(n=kt(n)))/1);i===e&&e===n?h=m=y:(h=qr((.4360747*i+.3850649*e+.1430804*n)/ve),m=qr((.0139322*i+.0971045*e+.7141733*n)/be));const v=116*y-16;return[v<0?0:v,500*(h-y),200*(y-m),o]}function kt(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function qr(i){return i>ot?Math.pow(i,1/3):i/He+nt}function jt([i,e,n,o]){let h=(i+16)/116,m=isNaN(e)?h:h+e/500,y=isNaN(n)?h:h-n/200;return h=1*Fr(h),m=ve*Fr(m),y=be*Fr(y),[vr(3.1338561*m-1.6168667*h-.4906146*y),vr(-.9787684*m+1.9161415*h+.033454*y),vr(.0719453*m-.2289914*h+1.4052427*y),o]}function vr(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Fr(i){return i>ct?i*i*i:He*(i-nt)}function ji(i){return parseInt(i.padEnd(2,i),16)/255}function Uc(i,e){return Ys(e?i/100:i,0,1)}function Ys(i,e,n){return Math.min(Math.max(e,i),n)}function Js(i){return!i.some(Number.isNaN)}const dp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Rt{constructor(e,n,o,h=1,m=!0){this.r=e,this.g=n,this.b=o,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[e,n,o,h]))}static parse(e){if(e instanceof Rt)return e;if(typeof e!="string")return;const n=function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=dp[o];if(h){const[y,v,b]=h;return[y/255,v/255,b/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const y=o.length<6?1:2;let v=1;return[ji(o.slice(v,v+=y)),ji(o.slice(v,v+=y)),ji(o.slice(v,v+=y)),ji(o.slice(v,v+y)||"ff")]}if(o.startsWith("rgb")){const y=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,b,k,I,M,D,B,O,j,H,Y,oe]=y,Q=[I||" ",B||" ",H].join("");if(Q==="  "||Q==="  /"||Q===",,"||Q===",,,"){const ue=[k,D,j].join(""),fe=ue==="%%%"?100:ue===""?255:0;if(fe){const we=[Ys(+b/fe,0,1),Ys(+M/fe,0,1),Ys(+O/fe,0,1),Y?Uc(+Y,oe):1];if(Js(we))return we}}return}}const m=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[y,v,b,k,I,M,D,B,O]=m,j=[b||" ",I||" ",D].join("");if(j==="  "||j==="  /"||j===",,"||j===",,,"){const H=[+v,Ys(+k,0,100),Ys(+M,0,100),B?Uc(+B,O):1];if(Js(H))return function([Y,oe,Q,ue]){function fe(we){const je=(we+Y/30)%12,Ke=oe*Math.min(Q,1-Q);return Q-Ke*Math.max(-1,Math.min(je-3,9-je,1))}return Y=Ot(Y),oe/=100,Q/=100,[fe(0),fe(8),fe(4),ue]}(H)}}}(e);return n?new Rt(...n,!1):void 0}get rgb(){const{r:e,g:n,b:o,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[e/m,n/m,o/m,h])}get hcl(){return this.overwriteGetter("hcl",function(e){const[n,o,h,m]=Et(e),y=Math.sqrt(o*o+h*h);return[Math.round(1e4*y)?Ot(Math.atan2(h,o)*At):NaN,y,n,m]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Et(this.rgb))}overwriteGetter(e,n){return Object.defineProperty(this,e,{value:n}),n}toString(){const[e,n,o,h]=this.rgb;return`rgba(${[e,n,o].map(m=>Math.round(255*m)).join(",")},${h})`}}Rt.black=new Rt(0,0,0,1),Rt.white=new Rt(1,1,1,1),Rt.transparent=new Rt(0,0,0,0),Rt.red=new Rt(1,0,0,1);class jl{constructor(e,n,o){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Io{constructor(e,n,o,h,m){this.text=e,this.image=n,this.scale=o,this.fontStack=h,this.textColor=m}}class Gr{constructor(e){this.sections=e}static fromString(e){return new Gr([new Io(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Gr?e:Gr.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class Ei{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ei)return e;if(typeof e=="number")return new Ei([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const n of e)if(typeof n!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Ei(e)}}toString(){return JSON.stringify(this.values)}}const pp=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class $i{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof $i)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let n=0;n<e.length;n+=2){const o=e[n],h=e[n+1];if(typeof o!="string"||!pp.has(o)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new $i(e)}}toString(){return JSON.stringify(this.values)}}class Or{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Or({name:e,available:!1}):null}}function Co(i,e,n,o){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[i,e,n,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[i,e,n,o]:[i,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qs(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Rt||i instanceof jl||i instanceof Gr||i instanceof Ei||i instanceof $i||i instanceof Or)return!0;if(Array.isArray(i)){for(const e of i)if(!Qs(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!Qs(i[e]))return!1;return!0}return!1}function Yt(i){if(i===null)return Ln;if(typeof i=="string")return gt;if(typeof i=="boolean")return ht;if(typeof i=="number")return Be;if(i instanceof Rt)return ei;if(i instanceof jl)return Rn;if(i instanceof Gr)return q;if(i instanceof Ei)return A;if(i instanceof $i)return V;if(i instanceof Or)return L;if(Array.isArray(i)){const e=i.length;let n;for(const o of i){const h=Yt(o);if(n){if(n===h)continue;n=ft;break}n=h}return W(n||ft,e)}return yn}function Pt(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof Rt||i instanceof Gr||i instanceof Ei||i instanceof $i||i instanceof Or?i.toString():JSON.stringify(i)}class bs{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(e.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Qs(e[1]))return n.error("invalid value");const o=e[1];let h=Yt(o);const m=n.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new bs(h,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class ir{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Po={string:gt,number:Be,boolean:ht,object:yn};class Zi{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let o,h=1;const m=e[0];if(m==="array"){let v,b;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in Po)||k==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);v=Po[k],h++}else v=ft;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);b=e[2],h++}o=W(v,b)}else{if(!Po[m])throw new Error(`Types doesn't contain name = ${m}`);o=Po[m]}const y=[];for(;h<e.length;h++){const v=n.parse(e[h],h,ft);if(!v)return null;y.push(v)}return new Zi(o,y)}evaluate(e){for(let n=0;n<this.args.length;n++){const o=this.args[n].evaluate(e);if(!te(this.type,Yt(o)))return o;if(n===this.args.length-1)throw new ir(`Expected value to be of type ${X(this.type)}, but found ${X(Yt(o))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const $l={"to-boolean":ht,"to-color":ei,"to-number":Be,"to-string":gt};class is{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[0];if(!$l[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&e.length!==2)return n.error("Expected one argument.");const h=$l[o],m=[];for(let y=1;y<e.length;y++){const v=n.parse(e[y],y,ft);if(!v)return null;m.push(v)}return new is(h,m)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let n,o;for(const h of this.args){if(n=h.evaluate(e),o=null,n instanceof Rt)return n;if(typeof n=="string"){const m=e.parseColor(n);if(m)return m}else if(Array.isArray(n)&&(o=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Co(n[0],n[1],n[2],n[3]),!o))return new Rt(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new ir(o||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const o of this.args){n=o.evaluate(e);const h=Ei.parse(n);if(h)return h}throw new ir(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const o of this.args){n=o.evaluate(e);const h=$i.parse(n);if(h)return h}throw new ir(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const o of this.args){if(n=o.evaluate(e),n===null)return 0;const h=Number(n);if(!isNaN(h))return h}throw new ir(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return Gr.fromString(Pt(this.args[0].evaluate(e)));case"resolvedImage":return Or.fromString(Pt(this.args[0].evaluate(e)));default:return Pt(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const jc=["Unknown","Point","LineString","Polygon"];class Zl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?jc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=Rt.parse(e)),n}}class zo{constructor(e,n,o=[],h,m=new ws,y=[]){this.registry=e,this.path=o,this.key=o.map(v=>`[${v}]`).join(""),this.scope=m,this.errors=y,this.expectedType=h,this._isConstant=n}parse(e,n,o,h,m={}){return n?this.concat(n,o,h)._parse(e,m):this._parse(e,m)}_parse(e,n){function o(h,m,y){return y==="assert"?new Zi(m,[h]):y==="coerce"?new is(m,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const v=this.expectedType,b=y.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||b.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string")if(v.kind!=="padding"||b.kind!=="value"&&b.kind!=="number"&&b.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||b.kind!=="value"&&b.kind!=="array"){if(this.checkSubtype(v,b))return null}else y=o(y,v,n.typeAnnotation||"coerce");else y=o(y,v,n.typeAnnotation||"coerce");else y=o(y,v,n.typeAnnotation||"coerce");else y=o(y,v,n.typeAnnotation||"assert")}if(!(y instanceof bs)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const v=new Zl;try{y=new bs(y.type,y.evaluate(v))}catch(b){return this.error(b.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,o){const h=typeof e=="number"?this.path.concat(e):this.path,m=o?this.scope.concat(o):this.scope;return new zo(this.registry,this._isConstant,h,n||null,m,this.errors)}error(e,...n){const o=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new rr(o,e))}checkSubtype(e,n){const o=te(e,n);return o&&this.error(o),o}}class Mo{constructor(e,n,o){this.type=Rn,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(e.length!==2)return n.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return n.error("Collator options argument must be an object.");const h=n.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,ht);if(!h)return null;const m=n.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,ht);if(!m)return null;let y=null;return o.locale&&(y=n.parse(o.locale,1,gt),!y)?null:new Mo(h,m,y)}evaluate(e){return new jl(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const ns=8192;function ql(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function $a(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function $c(i,e){const n=(180+i[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(n*h*ns),Math.round(o*h*ns)]}function fp(i,e,n){const o=i[0]-e[0],h=i[1]-e[1],m=i[0]-n[0],y=i[1]-n[1];return o*y-m*h==0&&o*m<=0&&h*y<=0}function Gl(i,e){let n=!1;for(let y=0,v=e.length;y<v;y++){const b=e[y];for(let k=0,I=b.length;k<I-1;k++){if(fp(i,b[k],b[k+1]))return!1;(h=b[k])[1]>(o=i)[1]!=(m=b[k+1])[1]>o[1]&&o[0]<(m[0]-h[0])*(o[1]-h[1])/(m[1]-h[1])+h[0]&&(n=!n)}}var o,h,m;return n}function Wl(i,e){for(let n=0;n<e.length;n++)if(Gl(i,e[n]))return!0;return!1}function Zc(i,e,n,o){const h=o[0]-n[0],m=o[1]-n[1],y=(i[0]-n[0])*m-h*(i[1]-n[1]),v=(e[0]-n[0])*m-h*(e[1]-n[1]);return y>0&&v<0||y<0&&v>0}function mp(i,e,n){for(const k of n)for(let I=0;I<k.length-1;++I)if((v=[(y=k[I+1])[0]-(m=k[I])[0],y[1]-m[1]])[0]*(b=[(h=e)[0]-(o=i)[0],h[1]-o[1]])[1]-v[1]*b[0]!=0&&Zc(o,h,m,y)&&Zc(m,y,o,h))return!0;var o,h,m,y,v,b;return!1}function qc(i,e){for(let n=0;n<i.length;++n)if(!Gl(i[n],e))return!1;for(let n=0;n<i.length-1;++n)if(mp(i[n],i[n+1],e))return!1;return!0}function Gc(i,e){for(let n=0;n<e.length;n++)if(qc(i,e[n]))return!0;return!1}function Ao(i,e,n){const o=[];for(let h=0;h<i.length;h++){const m=[];for(let y=0;y<i[h].length;y++){const v=$c(i[h][y],n);ql(e,v),m.push(v)}o.push(m)}return o}function Wc(i,e,n){const o=[];for(let h=0;h<i.length;h++){const m=Ao(i[h],e,n);o.push(m)}return o}function Hc(i,e,n,o){if(i[0]<n[0]||i[0]>n[2]){const h=.5*o;let m=i[0]-n[0]>h?-o:n[0]-i[0]>h?o:0;m===0&&(m=i[0]-n[2]>h?-o:n[2]-i[0]>h?o:0),i[0]+=m}ql(e,i)}function Hl(i,e,n,o){const h=Math.pow(2,o.z)*ns,m=[o.x*ns,o.y*ns],y=[];for(const v of i)for(const b of v){const k=[b.x+m[0],b.y+m[1]];Hc(k,e,n,h),y.push(k)}return y}function Xl(i,e,n,o){const h=Math.pow(2,o.z)*ns,m=[o.x*ns,o.y*ns],y=[];for(const b of i){const k=[];for(const I of b){const M=[I.x+m[0],I.y+m[1]];ql(e,M),k.push(M)}y.push(k)}if(e[2]-e[0]<=h/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const b of y)for(const k of b)Hc(k,e,n,h)}var v;return y}class Ss{constructor(e,n){this.type=ht,this.geojson=e,this.geometries=n}static parse(e,n){if(e.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Qs(e[1])){const o=e[1];if(o.type==="FeatureCollection")for(let h=0;h<o.features.length;++h){const m=o.features[h].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Ss(o,o.features[h].geometry)}else if(o.type==="Feature"){const h=o.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Ss(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new Ss(o,o)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,o){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(o.type==="Polygon"){const v=Ao(o.coordinates,m,y),b=Hl(n.geometry(),h,m,y);if(!$a(h,m))return!1;for(const k of b)if(!Gl(k,v))return!1}if(o.type==="MultiPolygon"){const v=Wc(o.coordinates,m,y),b=Hl(n.geometry(),h,m,y);if(!$a(h,m))return!1;for(const k of b)if(!Wl(k,v))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,o){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=n.canonicalID();if(o.type==="Polygon"){const v=Ao(o.coordinates,m,y),b=Xl(n.geometry(),h,m,y);if(!$a(h,m))return!1;for(const k of b)if(!qc(k,v))return!1}if(o.type==="MultiPolygon"){const v=Wc(o.coordinates,m,y),b=Xl(n.geometry(),h,m,y);if(!$a(h,m))return!1;for(const k of b)if(!Gc(k,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Do{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const o=e[1];return n.scope.has(o)?new Do(o,n.scope.get(o)):n.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class qi{constructor(e,n,o,h){this.name=e,this.type=n,this._evaluate=o,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,n){const o=e[0],h=qi.definitions[o];if(!h)return n.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=y.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let b=null;for(const[k,I]of v){b=new zo(n.registry,Lo,n.path,null,n.scope);const M=[];let D=!1;for(let B=1;B<e.length;B++){const O=e[B],j=Array.isArray(k)?k[B-1]:k.type,H=b.parse(O,1+M.length,j);if(!H){D=!0;break}M.push(H)}if(!D)if(Array.isArray(k)&&k.length!==M.length)b.error(`Expected ${k.length} arguments, but found ${M.length} instead.`);else{for(let B=0;B<M.length;B++){const O=Array.isArray(k)?k[B]:k.type,j=M[B];b.concat(B+1).checkSubtype(O,j.type)}if(b.errors.length===0)return new qi(o,m,I,M)}}if(v.length===1)n.errors.push(...b.errors);else{const k=(v.length?v:y).map(([M])=>{return D=M,Array.isArray(D)?`(${D.map(X).join(", ")})`:`(${X(D.type)}...)`;var D}).join(" | "),I=[];for(let M=1;M<e.length;M++){const D=n.parse(e[M],1+I.length);if(!D)return null;I.push(X(D.type))}n.error(`Expected arguments of type ${k}, but found (${I.join(", ")}) instead.`)}return null}static register(e,n){qi.definitions=n;for(const o in n)e[o]=qi}}function Lo(i){if(i instanceof Do)return Lo(i.boundExpression);if(i instanceof qi&&i.name==="error"||i instanceof Mo||i instanceof Ss)return!1;const e=i instanceof is||i instanceof Zi;let n=!0;return i.eachChild(o=>{n=e?n&&Lo(o):n&&o instanceof bs}),!!n&&Ro(i)&&Bo(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ro(i){if(i instanceof qi&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Ss)return!1;let e=!0;return i.eachChild(n=>{e&&!Ro(n)&&(e=!1)}),e}function Za(i){if(i instanceof qi&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(n=>{e&&!Za(n)&&(e=!1)}),e}function Bo(i,e){if(i instanceof qi&&e.indexOf(i.name)>=0)return!1;let n=!0;return i.eachChild(o=>{n&&!Bo(o,e)&&(n=!1)}),n}function ea(i,e){const n=i.length-1;let o,h,m=0,y=n,v=0;for(;m<=y;)if(v=Math.floor((m+y)/2),o=i[v],h=i[v+1],o<=e){if(v===n||e<h)return v;m=v+1}else{if(!(o>e))throw new ir("Input is not a number.");y=v-1}return 0}class ss{constructor(e,n,o){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[h,m]of o)this.labels.push(h),this.outputs.push(m)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const o=n.parse(e[1],1,Be);if(!o)return null;const h=[];let m=null;n.expectedType&&n.expectedType.kind!=="value"&&(m=n.expectedType);for(let y=1;y<e.length;y+=2){const v=y===1?-1/0:e[y],b=e[y+1],k=y,I=y+1;if(typeof v!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(h.length&&h[h.length-1][0]>=v)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const M=n.parse(b,I,m);if(!M)return null;m=m||M.type,h.push([v,M])}return new ss(m,o,h)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return o[0].evaluate(e);const m=n.length;return h>=n[m-1]?o[m-1].evaluate(e):o[ea(n,h)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function St(i,e,n){return i+n*(e-i)}function Fo(i,e,n){return i.map((o,h)=>St(o,e[h],n))}const Ii={number:St,color:function(i,e,n,o="rgb"){switch(o){case"rgb":{const[h,m,y,v]=Fo(i.rgb,e.rgb,n);return new Rt(h,m,y,v,!1)}case"hcl":{const[h,m,y,v]=i.hcl,[b,k,I,M]=e.hcl;let D,B;if(isNaN(h)||isNaN(b))isNaN(h)?isNaN(b)?D=NaN:(D=b,y!==1&&y!==0||(B=k)):(D=h,I!==1&&I!==0||(B=m));else{let oe=b-h;b>h&&oe>180?oe-=360:b<h&&h-b>180&&(oe+=360),D=h+n*oe}const[O,j,H,Y]=function([oe,Q,ue,fe]){return oe=isNaN(oe)?0:oe*dt,jt([ue,Math.cos(oe)*Q,Math.sin(oe)*Q,fe])}([D,B??St(m,k,n),St(y,I,n),St(v,M,n)]);return new Rt(O,j,H,Y,!1)}case"lab":{const[h,m,y,v]=jt(Fo(i.lab,e.lab,n));return new Rt(h,m,y,v,!1)}}},array:Fo,padding:function(i,e,n){return new Ei(Fo(i.values,e.values,n))},variableAnchorOffsetCollection:function(i,e,n){const o=i.values,h=e.values;if(o.length!==h.length)throw new ir(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${e.toString()}`);const m=[];for(let y=0;y<o.length;y+=2){if(o[y]!==h[y])throw new ir(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${o[y]}, to[${y}]: ${h[y]}`);m.push(o[y]);const[v,b]=o[y+1],[k,I]=h[y+1];m.push([St(v,k,n),St(b,I,n)])}return new $i(m)}};class Ci{constructor(e,n,o,h,m){this.type=e,this.operator=n,this.interpolation=o,this.input=h,this.labels=[],this.outputs=[];for(const[y,v]of m)this.labels.push(y),this.outputs.push(v)}static interpolationFactor(e,n,o,h){let m=0;if(e.name==="exponential")m=Kl(n,e.base,o,h);else if(e.name==="linear")m=Kl(n,1,o,h);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new Ce(y[0],y[1],y[2],y[3]).solve(Kl(n,1,o,h))}return m}static parse(e,n){let[o,h,m,...y]=e;if(!Array.isArray(h)||h.length===0)return n.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const k=h[1];if(typeof k!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:k}}else{if(h[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const k=h.slice(1);if(k.length!==4||k.some(I=>typeof I!="number"||I<0||I>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:k}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(m=n.parse(m,2,Be),!m)return null;const v=[];let b=null;o==="interpolate-hcl"||o==="interpolate-lab"?b=ei:n.expectedType&&n.expectedType.kind!=="value"&&(b=n.expectedType);for(let k=0;k<y.length;k+=2){const I=y[k],M=y[k+1],D=k+3,B=k+4;if(typeof I!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(v.length&&v[v.length-1][0]>=I)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',D);const O=n.parse(M,B,b);if(!O)return null;b=b||O.type,v.push([I,O])}return _e(b,Be)||_e(b,ei)||_e(b,A)||_e(b,V)||_e(b,W(Be))?new Ci(b,o,h,m,v):n.error(`Type ${X(b)} is not interpolatable.`)}evaluate(e){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return o[0].evaluate(e);const m=n.length;if(h>=n[m-1])return o[m-1].evaluate(e);const y=ea(n,h),v=Ci.interpolationFactor(this.interpolation,h,n[y],n[y+1]),b=o[y].evaluate(e),k=o[y+1].evaluate(e);switch(this.operator){case"interpolate":return Ii[this.type.kind](b,k,v);case"interpolate-hcl":return Ii.color(b,k,v,"hcl");case"interpolate-lab":return Ii.color(b,k,v,"lab")}}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Kl(i,e,n,o){const h=o-n,m=i-n;return h===0?0:e===1?m/h:(Math.pow(e,m)-1)/(Math.pow(e,h)-1)}class Oo{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let o=null;const h=n.expectedType;h&&h.kind!=="value"&&(o=h);const m=[];for(const v of e.slice(1)){const b=n.parse(v,1+m.length,o,void 0,{typeAnnotation:"omit"});if(!b)return null;o=o||b.type,m.push(b)}if(!o)throw new Error("No output type");const y=h&&m.some(v=>te(h,v.type));return new Oo(y?ft:o,m)}evaluate(e){let n,o=null,h=0;for(const m of this.args)if(h++,o=m.evaluate(e),o&&o instanceof Or&&!o.available&&(n||(n=o.name),o=null,h===this.args.length&&(o=n)),o!==null)break;return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class No{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return n.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return n.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=n.parse(e[m+1],m+1);if(!v)return null;o.push([y,v])}const h=n.parse(e[e.length-1],e.length-1,n.expectedType,o);return h?new No(o,h):null}outputDefined(){return this.result.outputDefined()}}class Yl{constructor(e,n,o){this.type=e,this.index=n,this.input=o}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,Be),h=n.parse(e[2],2,W(n.expectedType||ft));return o&&h?new Yl(h.type.itemType,o,h):null}evaluate(e){const n=this.index.evaluate(e),o=this.input.evaluate(e);if(n<0)throw new ir(`Array index out of bounds: ${n} < 0.`);if(n>=o.length)throw new ir(`Array index out of bounds: ${n} > ${o.length-1}.`);if(n!==Math.floor(n))throw new ir(`Array index must be an integer, but found ${n} instead.`);return o[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Jl{constructor(e,n){this.type=ht,this.needle=e,this.haystack=n}static parse(e,n){if(e.length!==3)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,ft),h=n.parse(e[2],2,ft);return o&&h?J(o.type,[ht,gt,Be,Ln,ft])?new Jl(o,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(o.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!o)return!1;if(!ae(n,["boolean","string","number","null"]))throw new ir(`Expected first argument to be of type boolean, string, number or null, but found ${X(Yt(n))} instead.`);if(!ae(o,["string","array"]))throw new ir(`Expected second argument to be of type array or string, but found ${X(Yt(o))} instead.`);return o.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Vo{constructor(e,n,o){this.type=Be,this.needle=e,this.haystack=n,this.fromIndex=o}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,ft),h=n.parse(e[2],2,ft);if(!o||!h)return null;if(!J(o.type,[ht,gt,Be,Ln,ft]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(o.type)} instead`);if(e.length===4){const m=n.parse(e[3],3,Be);return m?new Vo(o,h,m):null}return new Vo(o,h)}evaluate(e){const n=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!ae(n,["boolean","string","number","null"]))throw new ir(`Expected first argument to be of type boolean, string, number or null, but found ${X(Yt(n))} instead.`);if(!ae(o,["string","array"]))throw new ir(`Expected second argument to be of type array or string, but found ${X(Yt(o))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return o.indexOf(n,h)}return o.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Ql{constructor(e,n,o,h,m,y){this.inputType=e,this.type=n,this.input=o,this.cases=h,this.outputs=m,this.otherwise=y}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let o,h;n.expectedType&&n.expectedType.kind!=="value"&&(h=n.expectedType);const m={},y=[];for(let k=2;k<e.length-1;k+=2){let I=e[k];const M=e[k+1];Array.isArray(I)||(I=[I]);const D=n.concat(k);if(I.length===0)return D.error("Expected at least one branch label.");for(const O of I){if(typeof O!="number"&&typeof O!="string")return D.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return D.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return D.error("Numeric branch labels must be integer values.");if(o){if(D.checkSubtype(o,Yt(O)))return null}else o=Yt(O);if(m[String(O)]!==void 0)return D.error("Branch labels must be unique.");m[String(O)]=y.length}const B=n.parse(M,k,h);if(!B)return null;h=h||B.type,y.push(B)}const v=n.parse(e[1],1,ft);if(!v)return null;const b=n.parse(e[e.length-1],e.length-1,h);return b?v.type.kind!=="value"&&n.concat(1).checkSubtype(o,v.type)?null:new Ql(o,h,v,m,y,b):null}evaluate(e){const n=this.input.evaluate(e);return(Yt(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class eu{constructor(e,n,o){this.type=e,this.branches=n,this.otherwise=o}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let o;n.expectedType&&n.expectedType.kind!=="value"&&(o=n.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const v=n.parse(e[y],y,ht);if(!v)return null;const b=n.parse(e[y+1],y+1,o);if(!b)return null;h.push([v,b]),o=o||b.type}const m=n.parse(e[e.length-1],e.length-1,o);if(!m)return null;if(!o)throw new Error("Can't infer output type");return new eu(o,h,m)}evaluate(e){for(const[n,o]of this.branches)if(n.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,o]of this.branches)e(n),e(o);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class Uo{constructor(e,n,o,h){this.type=e,this.input=n,this.beginIndex=o,this.endIndex=h}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const o=n.parse(e[1],1,ft),h=n.parse(e[2],2,Be);if(!o||!h)return null;if(!J(o.type,[W(ft),gt,ft]))return n.error(`Expected first argument to be of type array or string, but found ${X(o.type)} instead`);if(e.length===4){const m=n.parse(e[3],3,Be);return m?new Uo(o.type,o,h,m):null}return new Uo(o.type,o,h)}evaluate(e){const n=this.input.evaluate(e),o=this.beginIndex.evaluate(e);if(!ae(n,["string","array"]))throw new ir(`Expected first argument to be of type array or string, but found ${X(Yt(n))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return n.slice(o,h)}return n.slice(o)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Xc(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Kc(i,e,n,o){return o.compare(e,n)===0}function ta(i,e,n){const o=i!=="=="&&i!=="!=";return class u1{constructor(m,y,v){this.type=ht,this.lhs=m,this.rhs=y,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const v=m[0];let b=y.parse(m[1],1,ft);if(!b)return null;if(!Xc(v,b.type))return y.concat(1).error(`"${v}" comparisons are not supported for type '${X(b.type)}'.`);let k=y.parse(m[2],2,ft);if(!k)return null;if(!Xc(v,k.type))return y.concat(2).error(`"${v}" comparisons are not supported for type '${X(k.type)}'.`);if(b.type.kind!==k.type.kind&&b.type.kind!=="value"&&k.type.kind!=="value")return y.error(`Cannot compare types '${X(b.type)}' and '${X(k.type)}'.`);o&&(b.type.kind==="value"&&k.type.kind!=="value"?b=new Zi(k.type,[b]):b.type.kind!=="value"&&k.type.kind==="value"&&(k=new Zi(b.type,[k])));let I=null;if(m.length===4){if(b.type.kind!=="string"&&k.type.kind!=="string"&&b.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(I=y.parse(m[3],3,Rn),!I)return null}return new u1(b,k,I)}evaluate(m){const y=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(o&&this.hasUntypedArgument){const b=Yt(y),k=Yt(v);if(b.kind!==k.kind||b.kind!=="string"&&b.kind!=="number")throw new ir(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${b.kind}, ${k.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const b=Yt(y),k=Yt(v);if(b.kind!=="string"||k.kind!=="string")return e(m,y,v)}return this.collator?n(m,y,v,this.collator.evaluate(m)):e(m,y,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const gp=ta("==",function(i,e,n){return e===n},Kc),yp=ta("!=",function(i,e,n){return e!==n},function(i,e,n,o){return!Kc(0,e,n,o)}),_p=ta("<",function(i,e,n){return e<n},function(i,e,n,o){return o.compare(e,n)<0}),vp=ta(">",function(i,e,n){return e>n},function(i,e,n,o){return o.compare(e,n)>0}),xp=ta("<=",function(i,e,n){return e<=n},function(i,e,n,o){return o.compare(e,n)<=0}),wp=ta(">=",function(i,e,n){return e>=n},function(i,e,n,o){return o.compare(e,n)>=0});class tu{constructor(e,n,o,h,m){this.type=gt,this.number=e,this.locale=n,this.currency=o,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(e,n){if(e.length!==3)return n.error("Expected two arguments.");const o=n.parse(e[1],1,Be);if(!o)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=n.parse(h.locale,1,gt),!m))return null;let y=null;if(h.currency&&(y=n.parse(h.currency,1,gt),!y))return null;let v=null;if(h["min-fraction-digits"]&&(v=n.parse(h["min-fraction-digits"],1,Be),!v))return null;let b=null;return h["max-fraction-digits"]&&(b=n.parse(h["max-fraction-digits"],1,Be),!b)?null:new tu(o,m,y,v,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class jo{constructor(e){this.type=q,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return n.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=e.length-1;++y){const v=e[y];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let b=null;if(v["font-scale"]&&(b=n.parse(v["font-scale"],1,Be),!b))return null;let k=null;if(v["text-font"]&&(k=n.parse(v["text-font"],1,W(gt)),!k))return null;let I=null;if(v["text-color"]&&(I=n.parse(v["text-color"],1,ei),!I))return null;const M=h[h.length-1];M.scale=b,M.font=k,M.textColor=I}else{const b=n.parse(e[y],1,ft);if(!b)return null;const k=b.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:b,scale:null,font:null,textColor:null})}}return new jo(h)}evaluate(e){return new Gr(this.sections.map(n=>{const o=n.content.evaluate(e);return Yt(o)===L?new Io("",o,null,null,null):new Io(Pt(o),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}}class ru{constructor(e){this.type=L,this.input=e}static parse(e,n){if(e.length!==2)return n.error("Expected two arguments.");const o=n.parse(e[1],1,gt);return o?new ru(o):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),o=Or.fromString(n);return o&&e.availableImages&&(o.available=e.availableImages.indexOf(n)>-1),o}eachChild(e){e(this.input)}outputDefined(){return!1}}class iu{constructor(e){this.type=Be,this.input=e}static parse(e,n){if(e.length!==2)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=n.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${X(o.type)} instead.`):new iu(o):null}evaluate(e){const n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new ir(`Expected value to be of type string or array, but found ${X(Yt(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const ra={"==":gp,"!=":yp,">":vp,"<":_p,">=":wp,"<=":xp,array:Zi,at:Yl,boolean:Zi,case:eu,coalesce:Oo,collator:Mo,format:jo,image:ru,in:Jl,"index-of":Vo,interpolate:Ci,"interpolate-hcl":Ci,"interpolate-lab":Ci,length:iu,let:No,literal:bs,match:Ql,number:Zi,"number-format":tu,object:Zi,slice:Uo,step:ss,string:Zi,"to-boolean":is,"to-color":is,"to-number":is,"to-string":is,var:Do,within:Ss};function Yc(i,[e,n,o,h]){e=e.evaluate(i),n=n.evaluate(i),o=o.evaluate(i);const m=h?h.evaluate(i):1,y=Co(e,n,o,m);if(y)throw new ir(y);return new Rt(e/255,n/255,o/255,m,!1)}function Jc(i,e){return i in e}function nu(i,e){const n=e[i];return n===void 0?null:n}function Ts(i){return{type:i}}function Qc(i){return{result:"success",value:i}}function as(i){return{result:"error",value:i}}function ia(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function eh(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function su(i){return!!i.expression&&i.expression.interpolated}function zt(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Jt(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function bp(i){return i}function Tt(i,e){const n=e.type==="color",o=i.stops&&typeof i.stops[0][0]=="object",h=o||!(o||i.property!==void 0),m=i.type||(su(e)?"exponential":"interval");if(n||e.type==="padding"){const I=n?Rt.parse:Ei.parse;(i=gn({},i)).stops&&(i.stops=i.stops.map(M=>[M[0],I(M[1])])),i.default=I(i.default?i.default:e.default)}if(i.colorSpace&&(y=i.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var y;let v,b,k;if(m==="exponential")v=qa;else if(m==="interval")v=Xt;else if(m==="categorical"){v=Qt,b=Object.create(null);for(const I of i.stops)b[I[0]]=I[1];k=typeof i.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);v=th}if(o){const I={},M=[];for(let O=0;O<i.stops.length;O++){const j=i.stops[O],H=j[0].zoom;I[H]===void 0&&(I[H]={zoom:H,type:i.type,property:i.property,default:i.default,stops:[]},M.push(H)),I[H].stops.push([j[0].value,j[1]])}const D=[];for(const O of M)D.push([I[O].zoom,Tt(I[O],e)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:Ci.interpolationFactor.bind(void 0,B),zoomStops:D.map(O=>O[0]),evaluate:({zoom:O},j)=>qa({stops:D,base:i.base},e,O).evaluate(O,j)}}if(h){const I=m==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:Ci.interpolationFactor.bind(void 0,I),zoomStops:i.stops.map(M=>M[0]),evaluate:({zoom:M})=>v(i,e,M,b,k)}}return{kind:"source",evaluate(I,M){const D=M&&M.properties?M.properties[i.property]:void 0;return D===void 0?ks(i.default,e.default):v(i,e,D,b,k)}}}function ks(i,e,n){return i!==void 0?i:e!==void 0?e:n!==void 0?n:void 0}function Qt(i,e,n,o,h){return ks(typeof n===h?o[n]:void 0,i.default,e.default)}function Xt(i,e,n){if(zt(n)!=="number")return ks(i.default,e.default);const o=i.stops.length;if(o===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[o-1][0])return i.stops[o-1][1];const h=ea(i.stops.map(m=>m[0]),n);return i.stops[h][1]}function qa(i,e,n){const o=i.base!==void 0?i.base:1;if(zt(n)!=="number")return ks(i.default,e.default);const h=i.stops.length;if(h===1||n<=i.stops[0][0])return i.stops[0][1];if(n>=i.stops[h-1][0])return i.stops[h-1][1];const m=ea(i.stops.map(I=>I[0]),n),y=function(I,M,D,B){const O=B-D,j=I-D;return O===0?0:M===1?j/O:(Math.pow(M,j)-1)/(Math.pow(M,O)-1)}(n,o,i.stops[m][0],i.stops[m+1][0]),v=i.stops[m][1],b=i.stops[m+1][1],k=Ii[e.type]||bp;return typeof v.evaluate=="function"?{evaluate(...I){const M=v.evaluate.apply(void 0,I),D=b.evaluate.apply(void 0,I);if(M!==void 0&&D!==void 0)return k(M,D,y,i.colorSpace)}}:k(v,b,y,i.colorSpace)}function th(i,e,n){switch(e.type){case"color":n=Rt.parse(n);break;case"formatted":n=Gr.fromString(n.toString());break;case"resolvedImage":n=Or.fromString(n.toString());break;case"padding":n=Ei.parse(n);break;default:zt(n)===e.type||e.type==="enum"&&e.values[n]||(n=void 0)}return ks(n,i.default,e.default)}qi.register(ra,{error:[{kind:"error"},[gt],(i,[e])=>{throw new ir(e.evaluate(i))}],typeof:[gt,[ft],(i,[e])=>X(Yt(e.evaluate(i)))],"to-rgba":[W(Be,4),[ei],(i,[e])=>{const[n,o,h,m]=e.evaluate(i).rgb;return[255*n,255*o,255*h,m]}],rgb:[ei,[Be,Be,Be],Yc],rgba:[ei,[Be,Be,Be,Be],Yc],has:{type:ht,overloads:[[[gt],(i,[e])=>Jc(e.evaluate(i),i.properties())],[[gt,yn],(i,[e,n])=>Jc(e.evaluate(i),n.evaluate(i))]]},get:{type:ft,overloads:[[[gt],(i,[e])=>nu(e.evaluate(i),i.properties())],[[gt,yn],(i,[e,n])=>nu(e.evaluate(i),n.evaluate(i))]]},"feature-state":[ft,[gt],(i,[e])=>nu(e.evaluate(i),i.featureState||{})],properties:[yn,[],i=>i.properties()],"geometry-type":[gt,[],i=>i.geometryType()],id:[ft,[],i=>i.id()],zoom:[Be,[],i=>i.globals.zoom],"heatmap-density":[Be,[],i=>i.globals.heatmapDensity||0],"line-progress":[Be,[],i=>i.globals.lineProgress||0],accumulated:[ft,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Be,Ts(Be),(i,e)=>{let n=0;for(const o of e)n+=o.evaluate(i);return n}],"*":[Be,Ts(Be),(i,e)=>{let n=1;for(const o of e)n*=o.evaluate(i);return n}],"-":{type:Be,overloads:[[[Be,Be],(i,[e,n])=>e.evaluate(i)-n.evaluate(i)],[[Be],(i,[e])=>-e.evaluate(i)]]},"/":[Be,[Be,Be],(i,[e,n])=>e.evaluate(i)/n.evaluate(i)],"%":[Be,[Be,Be],(i,[e,n])=>e.evaluate(i)%n.evaluate(i)],ln2:[Be,[],()=>Math.LN2],pi:[Be,[],()=>Math.PI],e:[Be,[],()=>Math.E],"^":[Be,[Be,Be],(i,[e,n])=>Math.pow(e.evaluate(i),n.evaluate(i))],sqrt:[Be,[Be],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[Be,[Be],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[Be,[Be],(i,[e])=>Math.log(e.evaluate(i))],log2:[Be,[Be],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[Be,[Be],(i,[e])=>Math.sin(e.evaluate(i))],cos:[Be,[Be],(i,[e])=>Math.cos(e.evaluate(i))],tan:[Be,[Be],(i,[e])=>Math.tan(e.evaluate(i))],asin:[Be,[Be],(i,[e])=>Math.asin(e.evaluate(i))],acos:[Be,[Be],(i,[e])=>Math.acos(e.evaluate(i))],atan:[Be,[Be],(i,[e])=>Math.atan(e.evaluate(i))],min:[Be,Ts(Be),(i,e)=>Math.min(...e.map(n=>n.evaluate(i)))],max:[Be,Ts(Be),(i,e)=>Math.max(...e.map(n=>n.evaluate(i)))],abs:[Be,[Be],(i,[e])=>Math.abs(e.evaluate(i))],round:[Be,[Be],(i,[e])=>{const n=e.evaluate(i);return n<0?-Math.round(-n):Math.round(n)}],floor:[Be,[Be],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[Be,[Be],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[ht,[gt,ft],(i,[e,n])=>i.properties()[e.value]===n.value],"filter-id-==":[ht,[ft],(i,[e])=>i.id()===e.value],"filter-type-==":[ht,[gt],(i,[e])=>i.geometryType()===e.value],"filter-<":[ht,[gt,ft],(i,[e,n])=>{const o=i.properties()[e.value],h=n.value;return typeof o==typeof h&&o<h}],"filter-id-<":[ht,[ft],(i,[e])=>{const n=i.id(),o=e.value;return typeof n==typeof o&&n<o}],"filter->":[ht,[gt,ft],(i,[e,n])=>{const o=i.properties()[e.value],h=n.value;return typeof o==typeof h&&o>h}],"filter-id->":[ht,[ft],(i,[e])=>{const n=i.id(),o=e.value;return typeof n==typeof o&&n>o}],"filter-<=":[ht,[gt,ft],(i,[e,n])=>{const o=i.properties()[e.value],h=n.value;return typeof o==typeof h&&o<=h}],"filter-id-<=":[ht,[ft],(i,[e])=>{const n=i.id(),o=e.value;return typeof n==typeof o&&n<=o}],"filter->=":[ht,[gt,ft],(i,[e,n])=>{const o=i.properties()[e.value],h=n.value;return typeof o==typeof h&&o>=h}],"filter-id->=":[ht,[ft],(i,[e])=>{const n=i.id(),o=e.value;return typeof n==typeof o&&n>=o}],"filter-has":[ht,[ft],(i,[e])=>e.value in i.properties()],"filter-has-id":[ht,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[ht,[W(gt)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[ht,[W(ft)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[ht,[gt,W(ft)],(i,[e,n])=>n.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[ht,[gt,W(ft)],(i,[e,n])=>function(o,h,m,y){for(;m<=y;){const v=m+y>>1;if(h[v]===o)return!0;h[v]>o?y=v-1:m=v+1}return!1}(i.properties()[e.value],n.value,0,n.value.length-1)],all:{type:ht,overloads:[[[ht,ht],(i,[e,n])=>e.evaluate(i)&&n.evaluate(i)],[Ts(ht),(i,e)=>{for(const n of e)if(!n.evaluate(i))return!1;return!0}]]},any:{type:ht,overloads:[[[ht,ht],(i,[e,n])=>e.evaluate(i)||n.evaluate(i)],[Ts(ht),(i,e)=>{for(const n of e)if(n.evaluate(i))return!0;return!1}]]},"!":[ht,[ht],(i,[e])=>!e.evaluate(i)],"is-supported-script":[ht,[gt],(i,[e])=>{const n=i.globals&&i.globals.isSupportedScript;return!n||n(e.evaluate(i))}],upcase:[gt,[gt],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[gt,[gt],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[gt,Ts(ft),(i,e)=>e.map(n=>Pt(n.evaluate(i))).join("")],"resolved-locale":[gt,[Rn],(i,[e])=>e.evaluate(i).resolvedLocale()]});class au{constructor(e,n){var o;this.expression=e,this._warningHistory={},this._evaluator=new Zl,this._defaultValue=n?(o=n).type==="color"&&Jt(o.default)?new Rt(0,0,0,0):o.type==="color"?Rt.parse(o.default)||null:o.type==="padding"?Ei.parse(o.default)||null:o.type==="variableAnchorOffsetCollection"?$i.parse(o.default)||null:o.default===void 0?null:o.default:null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(e,n,o,h,m,y){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=o,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,n,o,h,m,y){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=o||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new ir(`Expected value to be one of ${Object.keys(this._enumValues).map(b=>JSON.stringify(b)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function $o(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in ra}function Zo(i,e){const n=new zo(ra,Lo,[],e?function(h){const m={color:ei,string:gt,number:Be,enum:gt,boolean:ht,formatted:q,padding:A,resolvedImage:L,variableAnchorOffsetCollection:V};return h.type==="array"?W(m[h.value]||ft,h.length):m[h.type]}(e):void 0),o=n.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?Qc(new au(o,e)):as(n.errors)}class ou{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!Za(n.expression)}evaluateWithoutErrorHandling(e,n,o,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,h,m,y)}evaluate(e,n,o,h,m,y){return this._styleExpression.evaluate(e,n,o,h,m,y)}}class qo{constructor(e,n,o,h){this.kind=e,this.zoomStops=o,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Za(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,n,o,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,n,o,h,m,y)}evaluate(e,n,o,h,m,y){return this._styleExpression.evaluate(e,n,o,h,m,y)}interpolationFactor(e,n,o){return this.interpolationType?Ci.interpolationFactor(this.interpolationType,e,n,o):0}}function lu(i,e){const n=Zo(i,e);if(n.result==="error")return n;const o=n.value.expression,h=Ro(o);if(!h&&!ia(e))return as([new rr("","data expressions not supported")]);const m=Bo(o,["zoom"]);if(!m&&!eh(e))return as([new rr("","zoom expressions not supported")]);const y=Wa(o);return y||m?y instanceof rr?as([y]):y instanceof Ci&&!su(e)?as([new rr("",'"interpolate" expressions cannot be used with this property')]):Qc(y?new qo(h?"camera":"composite",n.value,y.labels,y instanceof Ci?y.interpolation:void 0):new ou(h?"constant":"source",n.value)):as([new rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ga{constructor(e,n){this._parameters=e,this._specification=n,gn(this,Tt(this._parameters,this._specification))}static deserialize(e){return new Ga(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Wa(i){let e=null;if(i instanceof No)e=Wa(i.result);else if(i instanceof Oo){for(const n of i.args)if(e=Wa(n),e)break}else(i instanceof ss||i instanceof Ci)&&i.input instanceof qi&&i.input.name==="zoom"&&(e=i);return e instanceof rr||i.eachChild(n=>{const o=Wa(n);o instanceof rr?e=o:!e&&o?e=new rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&o&&e!==o&&(e=new rr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Ha(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!Ha(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Sp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function uu(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Ha(i)||(i=Go(i));const e=Zo(i,Sp);if(e.result==="error")throw new Error(e.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,o,h)=>e.value.evaluate(n,o,{},h),needGeometry:rh(i)}}function Tp(i,e){return i<e?-1:i>e?1:0}function rh(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(rh(i[e]))return!0;return!1}function Go(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?cu(i[1],i[2],"=="):e==="!="?Xa(cu(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?cu(i[1],i[2],e):e==="any"?(n=i.slice(1),["any"].concat(n.map(Go))):e==="all"?["all"].concat(i.slice(1).map(Go)):e==="none"?["all"].concat(i.slice(1).map(Go).map(Xa)):e==="in"?ih(i[1],i.slice(2)):e==="!in"?Xa(ih(i[1],i.slice(2))):e==="has"?nh(i[1]):e==="!has"?Xa(nh(i[1])):e!=="within"||i;var n}function cu(i,e,n){switch(i){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,i,e]}}function ih(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",i,["literal",e.sort(Tp)]]:["filter-in-small",i,["literal",e]]}}function nh(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Xa(i){return["!",i]}function Wo(i){const e=typeof i;if(e==="number"||e==="boolean"||e==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let h="[";for(const m of i)h+=`${Wo(m)},`;return`${h}]`}const n=Object.keys(i).sort();let o="{";for(let h=0;h<n.length;h++)o+=`${JSON.stringify(n[h])}:${Wo(i[n[h]])},`;return`${o}}`}function Ho(i){let e="";for(const n of di)e+=`/${Wo(i[n])}`;return e}function sh(i){const e=i.value;return e?[new De(i.key,e,"constants have been deprecated as of v8")]:[]}function nr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Es(i){if(Array.isArray(i))return i.map(Es);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const n in i)e[n]=Es(i[n]);return e}return nr(i)}function pi(i){const e=i.key,n=i.value,o=i.valueSpec||{},h=i.objectElementValidators||{},m=i.style,y=i.styleSpec,v=i.validateSpec;let b=[];const k=zt(n);if(k!=="object")return[new De(e,n,`object expected, ${k} found`)];for(const I in n){const M=I.split(".")[0],D=o[M]||o["*"];let B;if(h[M])B=h[M];else if(o[M])B=v;else if(h["*"])B=h["*"];else{if(!o["*"]){b.push(new De(e,n[I],`unknown property "${I}"`));continue}B=v}b=b.concat(B({key:(e&&`${e}.`)+I,value:n[I],valueSpec:D,style:m,styleSpec:y,object:n,objectKey:I,validateSpec:v},n))}for(const I in o)h[I]||o[I].required&&o[I].default===void 0&&n[I]===void 0&&b.push(new De(e,n,`missing required property "${I}"`));return b}function na(i){const e=i.value,n=i.valueSpec,o=i.style,h=i.styleSpec,m=i.key,y=i.arrayElementValidator||i.validateSpec;if(zt(e)!=="array")return[new De(m,e,`array expected, ${zt(e)} found`)];if(n.length&&e.length!==n.length)return[new De(m,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new De(m,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let v={type:n.value,values:n.values};h.$version<7&&(v.function=n.function),zt(n.value)==="object"&&(v=n.value);let b=[];for(let k=0;k<e.length;k++)b=b.concat(y({array:e,arrayIndex:k,value:e[k],valueSpec:v,validateSpec:i.validateSpec,style:o,styleSpec:h,key:`${m}[${k}]`}));return b}function Ka(i){const e=i.key,n=i.value,o=i.valueSpec;let h=zt(n);return h==="number"&&n!=n&&(h="NaN"),h!=="number"?[new De(e,n,`number expected, ${h} found`)]:"minimum"in o&&n<o.minimum?[new De(e,n,`${n} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&n>o.maximum?[new De(e,n,`${n} is greater than the maximum value ${o.maximum}`)]:[]}function Xo(i){const e=i.valueSpec,n=nr(i.value.type);let o,h,m,y={};const v=n!=="categorical"&&i.value.property===void 0,b=!v,k=zt(i.value.stops)==="array"&&zt(i.value.stops[0])==="array"&&zt(i.value.stops[0][0])==="object",I=pi({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(B){if(n==="identity")return[new De(B.key,B.value,'identity function may not have a "stops" property')];let O=[];const j=B.value;return O=O.concat(na({key:B.key,value:j,valueSpec:B.valueSpec,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:M})),zt(j)==="array"&&j.length===0&&O.push(new De(B.key,j,"array must have at least one stop")),O},default:function(B){return B.validateSpec({key:B.key,value:B.value,valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec})}}});return n==="identity"&&v&&I.push(new De(i.key,i.value,'missing required property "property"')),n==="identity"||i.value.stops||I.push(new De(i.key,i.value,'missing required property "stops"')),n==="exponential"&&i.valueSpec.expression&&!su(i.valueSpec)&&I.push(new De(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(b&&!ia(i.valueSpec)?I.push(new De(i.key,i.value,"property functions not supported")):v&&!eh(i.valueSpec)&&I.push(new De(i.key,i.value,"zoom functions not supported"))),n!=="categorical"&&!k||i.value.property!==void 0||I.push(new De(i.key,i.value,'"property" property is required')),I;function M(B){let O=[];const j=B.value,H=B.key;if(zt(j)!=="array")return[new De(H,j,`array expected, ${zt(j)} found`)];if(j.length!==2)return[new De(H,j,`array length 2 expected, length ${j.length} found`)];if(k){if(zt(j[0])!=="object")return[new De(H,j,`object expected, ${zt(j[0])} found`)];if(j[0].zoom===void 0)return[new De(H,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new De(H,j,"object stop key must have value")];if(m&&m>nr(j[0].zoom))return[new De(H,j[0].zoom,"stop zoom values must appear in ascending order")];nr(j[0].zoom)!==m&&(m=nr(j[0].zoom),h=void 0,y={}),O=O.concat(pi({key:`${H}[0]`,value:j[0],valueSpec:{zoom:{}},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Ka,value:D}}))}else O=O.concat(D({key:`${H}[0]`,value:j[0],validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec},j));return $o(Es(j[1]))?O.concat([new De(`${H}[1]`,j[1],"expressions are not allowed in function stops.")]):O.concat(B.validateSpec({key:`${H}[1]`,value:j[1],valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec}))}function D(B,O){const j=zt(B.value),H=nr(B.value),Y=B.value!==null?B.value:O;if(o){if(j!==o)return[new De(B.key,Y,`${j} stop domain type must match previous stop domain type ${o}`)]}else o=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new De(B.key,Y,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&n!=="categorical"){let oe=`number expected, ${j} found`;return ia(e)&&n===void 0&&(oe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new De(B.key,Y,oe)]}return n!=="categorical"||j!=="number"||isFinite(H)&&Math.floor(H)===H?n!=="categorical"&&j==="number"&&h!==void 0&&H<h?[new De(B.key,Y,"stop domain values must appear in ascending order")]:(h=H,n==="categorical"&&H in y?[new De(B.key,Y,"stop domain values must be unique")]:(y[H]=!0,[])):[new De(B.key,Y,`integer expected, found ${H}`)]}}function Is(i){const e=(i.expressionContext==="property"?lu:Zo)(Es(i.value),i.valueSpec);if(e.result==="error")return e.value.map(o=>new De(`${i.key}${o.key}`,i.value,o.message));const n=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!n.outputDefined())return[new De(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Za(n))return[new De(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Za(n))return[new De(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Bo(n,["zoom","feature-state"]))return[new De(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Ro(n))return[new De(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ya(i){const e=i.key,n=i.value,o=i.valueSpec,h=[];return Array.isArray(o.values)?o.values.indexOf(nr(n))===-1&&h.push(new De(e,n,`expected one of [${o.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(o.values).indexOf(nr(n))===-1&&h.push(new De(e,n,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function sa(i){return Ha(Es(i.value))?Is(gn({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ah(i)}function ah(i){const e=i.value,n=i.key;if(zt(e)!=="array")return[new De(n,e,`array expected, ${zt(e)} found`)];const o=i.styleSpec;let h,m=[];if(e.length<1)return[new De(n,e,"filter array must have at least 1 element")];switch(m=m.concat(Ya({key:`${n}[0]`,value:e[0],valueSpec:o.filter_operator,style:i.style,styleSpec:i.styleSpec})),nr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&nr(e[1])==="$type"&&m.push(new De(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new De(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=zt(e[1]),h!=="string"&&m.push(new De(`${n}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=zt(e[y]),nr(e[1])==="$type"?m=m.concat(Ya({key:`${n}[${y}]`,value:e[y],valueSpec:o.geometry_type,style:i.style,styleSpec:i.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new De(`${n}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(ah({key:`${n}[${y}]`,value:e[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":h=zt(e[1]),e.length!==2?m.push(new De(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new De(`${n}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=zt(e[1]),e.length!==2?m.push(new De(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&m.push(new De(`${n}[1]`,e[1],`object expected, ${h} found`))}return m}function oh(i,e){const n=i.key,o=i.validateSpec,h=i.style,m=i.styleSpec,y=i.value,v=i.objectKey,b=m[`${e}_${i.layerType}`];if(!b)return[];const k=v.match(/^(.*)-transition$/);if(e==="paint"&&k&&b[k[1]]&&b[k[1]].transition)return o({key:n,value:y,valueSpec:m.transition,style:h,styleSpec:m});const I=i.valueSpec||b[v];if(!I)return[new De(n,y,`unknown property "${v}"`)];let M;if(zt(y)==="string"&&ia(I)&&!I.tokens&&(M=/^{([^}]+)}$/.exec(y)))return[new De(n,y,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(M[1])} }\`.`)];const D=[];return i.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&D.push(new De(n,y,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Jt(Es(y))&&nr(y.type)==="identity"&&D.push(new De(n,y,'"text-font" does not support identity functions'))),D.concat(o({key:i.key,value:y,valueSpec:I,style:h,styleSpec:m,expressionContext:"property",propertyType:e,propertyKey:v}))}function lh(i){return oh(i,"paint")}function uh(i){return oh(i,"layout")}function ch(i){let e=[];const n=i.value,o=i.key,h=i.style,m=i.styleSpec;n.type||n.ref||e.push(new De(o,n,'either "type" or "ref" is required'));let y=nr(n.type);const v=nr(n.ref);if(n.id){const b=nr(n.id);for(let k=0;k<i.arrayIndex;k++){const I=h.layers[k];nr(I.id)===b&&e.push(new De(o,n.id,`duplicate layer id "${n.id}", previously used at line ${I.id.__line__}`))}}if("ref"in n){let b;["type","source","source-layer","filter","layout"].forEach(k=>{k in n&&e.push(new De(o,n[k],`"${k}" is prohibited for ref layers`))}),h.layers.forEach(k=>{nr(k.id)===v&&(b=k)}),b?b.ref?e.push(new De(o,n.ref,"ref cannot reference another ref layer")):y=nr(b.type):e.push(new De(o,n.ref,`ref layer "${v}" not found`))}else if(y!=="background")if(n.source){const b=h.sources&&h.sources[n.source],k=b&&nr(b.type);b?k==="vector"&&y==="raster"?e.push(new De(o,n.source,`layer "${n.id}" requires a raster source`)):k!=="raster-dem"&&y==="hillshade"?e.push(new De(o,n.source,`layer "${n.id}" requires a raster-dem source`)):k==="raster"&&y!=="raster"?e.push(new De(o,n.source,`layer "${n.id}" requires a vector source`)):k!=="vector"||n["source-layer"]?k==="raster-dem"&&y!=="hillshade"?e.push(new De(o,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!n.paint||!n.paint["line-gradient"]||k==="geojson"&&b.lineMetrics||e.push(new De(o,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new De(o,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new De(o,n.source,`source "${n.source}" not found`))}else e.push(new De(o,n,'missing required property "source"'));return e=e.concat(pi({key:o,value:n,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${o}.type`,value:n.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:n,objectKey:"type"}),filter:sa,layout:b=>pi({layer:n,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":k=>uh(gn({layerType:y},k))}}),paint:b=>pi({layer:n,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":k=>lh(gn({layerType:y},k))}})}})),e}function _n(i){const e=i.value,n=i.key,o=zt(e);return o!=="string"?[new De(n,e,`string expected, ${o} found`)]:[]}const Ja={promoteId:function({key:i,value:e}){if(zt(e)==="string")return _n({key:i,value:e});{const n=[];for(const o in e)n.push(..._n({key:`${i}.${o}`,value:e[o]}));return n}}};function Pi(i){const e=i.value,n=i.key,o=i.styleSpec,h=i.style,m=i.validateSpec;if(!e.type)return[new De(n,e,'"type" is required')];const y=nr(e.type);let v;switch(y){case"vector":case"raster":return v=pi({key:n,value:e,valueSpec:o[`source_${y.replace("-","_")}`],style:i.style,styleSpec:o,objectElementValidators:Ja,validateSpec:m}),v;case"raster-dem":return v=function(b){var k;const I=(k=b.sourceName)!==null&&k!==void 0?k:"",M=b.value,D=b.styleSpec,B=D.source_raster_dem,O=b.style;let j=[];const H=zt(M);if(M===void 0)return j;if(H!=="object")return j.push(new De("source_raster_dem",M,`object expected, ${H} found`)),j;const Y=nr(M.encoding)==="custom",oe=["redFactor","greenFactor","blueFactor","baseShift"],Q=b.value.encoding?`"${b.value.encoding}"`:"Default";for(const ue in M)!Y&&oe.includes(ue)?j.push(new De(ue,M[ue],`In "${I}": "${ue}" is only valid when "encoding" is set to "custom". ${Q} encoding found`)):B[ue]?j=j.concat(b.validateSpec({key:ue,value:M[ue],valueSpec:B[ue],validateSpec:b.validateSpec,style:O,styleSpec:D})):j.push(new De(ue,M[ue],`unknown property "${ue}"`));return j}({sourceName:n,value:e,style:i.style,styleSpec:o,validateSpec:m}),v;case"geojson":if(v=pi({key:n,value:e,valueSpec:o.source_geojson,style:h,styleSpec:o,validateSpec:m,objectElementValidators:Ja}),e.cluster)for(const b in e.clusterProperties){const[k,I]=e.clusterProperties[b],M=typeof k=="string"?[k,["accumulated"],["get",b]]:k;v.push(...Is({key:`${n}.${b}.map`,value:I,expressionContext:"cluster-map"})),v.push(...Is({key:`${n}.${b}.reduce`,value:M,expressionContext:"cluster-reduce"}))}return v;case"video":return pi({key:n,value:e,valueSpec:o.source_video,style:h,validateSpec:m,styleSpec:o});case"image":return pi({key:n,value:e,valueSpec:o.source_image,style:h,validateSpec:m,styleSpec:o});case"canvas":return[new De(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ya({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Qa(i){const e=i.value,n=i.styleSpec,o=n.light,h=i.style;let m=[];const y=zt(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new De("light",e,`object expected, ${y} found`)]),m;for(const v in e){const b=v.match(/^(.*)-transition$/);m=m.concat(b&&o[b[1]]&&o[b[1]].transition?i.validateSpec({key:v,value:e[v],valueSpec:n.transition,validateSpec:i.validateSpec,style:h,styleSpec:n}):o[v]?i.validateSpec({key:v,value:e[v],valueSpec:o[v],validateSpec:i.validateSpec,style:h,styleSpec:n}):[new De(v,e[v],`unknown property "${v}"`)])}return m}function hh(i){const e=i.value,n=i.styleSpec,o=n.terrain,h=i.style;let m=[];const y=zt(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new De("terrain",e,`object expected, ${y} found`)]),m;for(const v in e)m=m.concat(o[v]?i.validateSpec({key:v,value:e[v],valueSpec:o[v],validateSpec:i.validateSpec,style:h,styleSpec:n}):[new De(v,e[v],`unknown property "${v}"`)]);return m}function dh(i){let e=[];const n=i.value,o=i.key;if(Array.isArray(n)){const h=[],m=[];for(const y in n)n[y].id&&h.includes(n[y].id)&&e.push(new De(o,n,`all the sprites' ids must be unique, but ${n[y].id} is duplicated`)),h.push(n[y].id),n[y].url&&m.includes(n[y].url)&&e.push(new De(o,n,`all the sprites' URLs must be unique, but ${n[y].url} is duplicated`)),m.push(n[y].url),e=e.concat(pi({key:`${o}[${y}]`,value:n[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return e}return _n({key:o,value:n})}const ph={"*":()=>[],array:na,boolean:function(i){const e=i.value,n=i.key,o=zt(e);return o!=="boolean"?[new De(n,e,`boolean expected, ${o} found`)]:[]},number:Ka,color:function(i){const e=i.key,n=i.value,o=zt(n);return o!=="string"?[new De(e,n,`color expected, ${o} found`)]:Rt.parse(String(n))?[]:[new De(e,n,`color expected, "${n}" found`)]},constants:sh,enum:Ya,filter:sa,function:Xo,layer:ch,object:pi,source:Pi,light:Qa,terrain:hh,string:_n,formatted:function(i){return _n(i).length===0?[]:Is(i)},resolvedImage:function(i){return _n(i).length===0?[]:Is(i)},padding:function(i){const e=i.key,n=i.value;if(zt(n)==="array"){if(n.length<1||n.length>4)return[new De(e,n,`padding requires 1 to 4 values; ${n.length} values found`)];const o={type:"number"};let h=[];for(let m=0;m<n.length;m++)h=h.concat(i.validateSpec({key:`${e}[${m}]`,value:n[m],validateSpec:i.validateSpec,valueSpec:o}));return h}return Ka({key:e,value:n,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const e=i.key,n=i.value,o=zt(n),h=i.styleSpec;if(o!=="array"||n.length<1||n.length%2!=0)return[new De(e,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let y=0;y<n.length;y+=2)m=m.concat(Ya({key:`${e}[${y}]`,value:n[y],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(na({key:`${e}[${y+1}]`,value:n[y+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:h}));return m},sprite:dh};function os(i){const e=i.value,n=i.valueSpec,o=i.styleSpec;return i.validateSpec=os,n.expression&&Jt(nr(e))?Xo(i):n.expression&&$o(Es(e))?Is(i):n.type&&ph[n.type]?ph[n.type](i):pi(gn({},i,{valueSpec:n.type?o[n.type]:n}))}function fh(i){const e=i.value,n=i.key,o=_n(i);return o.length||(e.indexOf("{fontstack}")===-1&&o.push(new De(n,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&o.push(new De(n,e,'"glyphs" url must include a "{range}" token'))),o}function Gi(i,e=ye){let n=[];return n=n.concat(os({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,validateSpec:os,objectElementValidators:{glyphs:fh,"*":()=>[]}})),i.constants&&(n=n.concat(sh({key:"constants",value:i.constants}))),Ko(n)}function Bn(i){return function(e){return i({...e,validateSpec:os})}}function Ko(i){return[].concat(i).sort((e,n)=>e.line-n.line)}function Fn(i){return function(...e){return Ko(i.apply(this,e))}}Gi.source=Fn(Bn(Pi)),Gi.sprite=Fn(Bn(dh)),Gi.glyphs=Fn(Bn(fh)),Gi.light=Fn(Bn(Qa)),Gi.terrain=Fn(Bn(hh)),Gi.layer=Fn(Bn(ch)),Gi.filter=Fn(Bn(sa)),Gi.paintProperty=Fn(Bn(lh)),Gi.layoutProperty=Fn(Bn(uh));const On=Gi,kp=On.light,hu=On.paintProperty,mh=On.layoutProperty;function Yo(i,e){let n=!1;if(e&&e.length)for(const o of e)i.fire(new ts(new Error(o.message))),n=!0;return n}class aa{constructor(e,n,o){const h=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const y=new Int32Array(this.arrayBuffer);e=y[0],this.d=(n=y[1])+2*(o=y[2]);for(let b=0;b<this.d*this.d;b++){const k=y[3+b],I=y[3+b+1];h.push(k===I?null:y.subarray(k,I))}const v=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],v),this.bboxes=y.subarray(v),this.insert=this._insertReadonly}else{this.d=n+2*o;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=o,this.scale=n/e,this.uid=0;const m=o/n*e;this.min=-m,this.max=e+m}insert(e,n,o,h,m){this._forEachCell(n,o,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,n,o,h,m,y){this.cells[m].push(y)}query(e,n,o,h,m){const y=this.min,v=this.max;if(e<=y&&n<=y&&v<=o&&v<=h&&!m)return Array.prototype.slice.call(this.keys);{const b=[];return this._forEachCell(e,n,o,h,this._queryCell,b,{},m),b}}_queryCell(e,n,o,h,m,y,v,b){const k=this.cells[m];if(k!==null){const I=this.keys,M=this.bboxes;for(let D=0;D<k.length;D++){const B=k[D];if(v[B]===void 0){const O=4*B;(b?b(M[O+0],M[O+1],M[O+2],M[O+3]):e<=M[O+2]&&n<=M[O+3]&&o>=M[O+0]&&h>=M[O+1])?(v[B]=!0,y.push(I[B])):v[B]=!1}}}}_forEachCell(e,n,o,h,m,y,v,b){const k=this._convertToCellCoord(e),I=this._convertToCellCoord(n),M=this._convertToCellCoord(o),D=this._convertToCellCoord(h);for(let B=k;B<=M;B++)for(let O=I;O<=D;O++){const j=this.d*O+B;if((!b||b(this._convertFromCellCoord(B),this._convertFromCellCoord(O),this._convertFromCellCoord(B+1),this._convertFromCellCoord(O+1)))&&m.call(this,e,n,o,h,j,y,v,b))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,n=3+this.cells.length+1+1;let o=0;for(let y=0;y<this.cells.length;y++)o+=this.cells[y].length;const h=new Int32Array(n+o+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=n;for(let y=0;y<e.length;y++){const v=e[y];h[3+y]=m,h.set(v,m),m+=v.length}return h[3+e.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+e.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(e,n){const o=e.toArrayBuffer();return n&&n.push(o),{buffer:o}}static deserialize(e){return new aa(e.buffer)}}const Nn={};function Ze(i,e,n={}){if(Nn[i])throw new Error(`${i} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:i,writeable:!1}),Nn[i]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}Ze("Object",Object),Ze("TransferableGridIndex",aa),Ze("Color",Rt),Ze("Error",Error),Ze("AJAXError",Jn),Ze("ResolvedImage",Or),Ze("StylePropertyFunction",Ga),Ze("StyleExpression",au,{omit:["_evaluator"]}),Ze("ZoomDependentExpression",qo),Ze("ZoomConstantExpression",ou),Ze("CompoundExpression",qi,{omit:["_evaluate"]});for(const i in ra)ra[i]._classRegistryKey||Ze(`Expression_${i}`,ra[i]);function Jo(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function ls(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(Jo(i)||pt(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const n=i;return e&&e.push(n.buffer),n}if(i instanceof ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const n=[];for(const o of i)n.push(ls(o,e));return n}if(typeof i=="object"){const n=i.constructor,o=n._classRegistryKey;if(!o)throw new Error("can't serialize object of unregistered class");if(!Nn[o])throw new Error(`${o} is not registered.`);const h=n.serialize?n.serialize(i,e):{};if(n.serialize){if(e&&h===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in i){if(!i.hasOwnProperty(m)||Nn[o].omit.indexOf(m)>=0)continue;const y=i[m];h[m]=Nn[o].shallow.indexOf(m)>=0?y:ls(y,e)}i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(h.$name=o),h}throw new Error("can't serialize object of type "+typeof i)}function oa(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||Jo(i)||pt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(oa);if(typeof i=="object"){const e=i.$name||"Object";if(!Nn[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:n}=Nn[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(i);const o=Object.create(n.prototype);for(const h of Object.keys(i)){if(h==="$name")continue;const m=i[h];o[h]=Nn[e].shallow.indexOf(h)>=0?m:oa(m)}return o}throw new Error("can't deserialize object of type "+typeof i)}class gh{constructor(){this.first=!0}update(e,n){const o=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=o,!0))}}const Ue={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function du(i){for(const e of i)if(fu(e.charCodeAt(0)))return!0;return!1}function pu(i){for(const e of i)if(!Ep(e.charCodeAt(0)))return!1;return!0}function Ep(i){return!(Ue.Arabic(i)||Ue["Arabic Supplement"](i)||Ue["Arabic Extended-A"](i)||Ue["Arabic Presentation Forms-A"](i)||Ue["Arabic Presentation Forms-B"](i))}function fu(i){return!(i!==746&&i!==747&&(i<4352||!(Ue["Bopomofo Extended"](i)||Ue.Bopomofo(i)||Ue["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ue["CJK Compatibility Ideographs"](i)||Ue["CJK Compatibility"](i)||Ue["CJK Radicals Supplement"](i)||Ue["CJK Strokes"](i)||!(!Ue["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ue["CJK Unified Ideographs Extension A"](i)||Ue["CJK Unified Ideographs"](i)||Ue["Enclosed CJK Letters and Months"](i)||Ue["Hangul Compatibility Jamo"](i)||Ue["Hangul Jamo Extended-A"](i)||Ue["Hangul Jamo Extended-B"](i)||Ue["Hangul Jamo"](i)||Ue["Hangul Syllables"](i)||Ue.Hiragana(i)||Ue["Ideographic Description Characters"](i)||Ue.Kanbun(i)||Ue["Kangxi Radicals"](i)||Ue["Katakana Phonetic Extensions"](i)||Ue.Katakana(i)&&i!==12540||!(!Ue["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ue["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ue["Unified Canadian Aboriginal Syllabics"](i)||Ue["Unified Canadian Aboriginal Syllabics Extended"](i)||Ue["Vertical Forms"](i)||Ue["Yijing Hexagram Symbols"](i)||Ue["Yi Syllables"](i)||Ue["Yi Radicals"](i))))}function yh(i){return!(fu(i)||function(e){return!!(Ue["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Ue["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Ue["Letterlike Symbols"](e)||Ue["Number Forms"](e)||Ue["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ue["Control Pictures"](e)&&e!==9251||Ue["Optical Character Recognition"](e)||Ue["Enclosed Alphanumerics"](e)||Ue["Geometric Shapes"](e)||Ue["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ue["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ue["CJK Symbols and Punctuation"](e)||Ue.Katakana(e)||Ue["Private Use Area"](e)||Ue["CJK Compatibility Forms"](e)||Ue["Small Form Variants"](e)||Ue["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function _h(i){return i>=1424&&i<=2303||Ue["Arabic Presentation Forms-A"](i)||Ue["Arabic Presentation Forms-B"](i)}function vh(i,e){return!(!e&&_h(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ue.Khmer(i))}function Ip(i){for(const e of i)if(_h(e.charCodeAt(0)))return!0;return!1}const mu="deferred",gu="loading",yu="loaded";let _u=null,fi="unavailable",us=null;const eo=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(fi="error"),_u&&_u(i)};function vu(){to.fire(new es("pluginStateChange",{pluginStatus:fi,pluginURL:us}))}const to=new vs,xu=function(){return fi},xh=function(){if(fi!==mu||!us)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");fi=gu,vu(),us&&ja({url:us},i=>{i?eo(i):(fi=yu,vu())})},zi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>fi===yu||zi.applyArabicShaping!=null,isLoading:()=>fi===gu,setState(i){if(!Zr())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");fi=i.pluginStatus,us=i.pluginURL},isParsed(){if(!Zr())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return zi.applyArabicShaping!=null&&zi.processBidirectionalText!=null&&zi.processStyledBidirectionalText!=null},getPluginURL(){if(!Zr())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return us}};class Gt{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new gh,this.transition={})}isSupportedScript(e){return function(n,o){for(const h of n)if(!vh(h.charCodeAt(0),o))return!1;return!0}(e,zi.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,n=e-Math.floor(e),o=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*n}}}class Qo{constructor(e,n){this.property=e,this.value=n,this.expression=function(o,h){if(Jt(o))return new Ga(o,h);if($o(o)){const m=lu(o,h);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=o;return h.type==="color"&&typeof o=="string"?m=Rt.parse(o):h.type!=="padding"||typeof o!="number"&&!Array.isArray(o)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(o)&&(m=$i.parse(o)):m=Ei.parse(o),{kind:"constant",evaluate:()=>m}}}(n===void 0?e.specification.default:n,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,n,o){return this.property.possiblyEvaluate(this,e,n,o)}}class wu{constructor(e){this.property=e,this.value=new Qo(e,void 0)}transitioned(e,n){return new bh(this.property,this.value,n,We({},e.transition,this.transition),e.now)}untransitioned(){return new bh(this.property,this.value,null,{},0)}}class wh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Br(this._values[e].value.value)}setValue(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new wu(this._values[e].property)),this._values[e].value=new Qo(this._values[e].property,n===null?void 0:Br(n))}getTransition(e){return Br(this._values[e].transition)}setTransition(e,n){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new wu(this._values[e].property)),this._values[e].transition=Br(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o);const h=this.getTransition(n);h!==void 0&&(e[`${n}-transition`]=h)}return e}transitioned(e,n){const o=new Sh(this._properties);for(const h of Object.keys(this._values))o._values[h]=this._values[h].transitioned(e,n._values[h]);return o}untransitioned(){const e=new Sh(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class bh{constructor(e,n,o,h,m){this.property=e,this.value=n,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,e.specification.transition&&(h.delay||h.duration)&&(this.prior=o)}possiblyEvaluate(e,n,o){const h=e.now||0,m=this.value.possiblyEvaluate(e,n,o),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(e,n,o);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,n,o),m,function(b){if(b<=0)return 0;if(b>=1)return 1;const k=b*b,I=k*b;return 4*(b<.5?I:3*(b-k)+I-.75)}(v))}}return m}}class Sh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,o){const h=new el(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,n,o);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Cp{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Br(this._values[e].value)}setValue(e,n){this._values[e]=new Qo(this._values[e].property,n===null?void 0:Br(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(e[n]=o)}return e}possiblyEvaluate(e,n,o){const h=new el(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,n,o);return h}}class ti{constructor(e,n,o){this.property=e,this.value=n,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,n,o,h){return this.property.evaluate(this.value,this.parameters,e,n,o,h)}}class el{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class tt{constructor(e){this.specification=e}possiblyEvaluate(e,n){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(n)}interpolate(e,n,o){const h=Ii[this.specification.type];return h?h(e,n,o):e}}class lt{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,o,h){return new ti(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},o,h)}:e.expression,n)}interpolate(e,n,o){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new ti(this,{kind:"constant",value:void 0},e.parameters);const h=Ii[this.specification.type];if(h){const m=h(e.value.value,n.value.value,o);return new ti(this,{kind:"constant",value:m},e.parameters)}return e}evaluate(e,n,o,h,m,y){return e.kind==="constant"?e.value:e.evaluate(n,o,h,m,y)}}class ro extends lt{possiblyEvaluate(e,n,o,h){if(e.value===void 0)return new ti(this,{kind:"constant",value:void 0},n);if(e.expression.kind==="constant"){const m=e.expression.evaluate(n,null,{},o,h),y=e.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(y,y,y,n);return new ti(this,{kind:"constant",value:v},n)}if(e.expression.kind==="camera"){const m=this._calculate(e.expression.evaluate({zoom:n.zoom-1}),e.expression.evaluate({zoom:n.zoom}),e.expression.evaluate({zoom:n.zoom+1}),n);return new ti(this,{kind:"constant",value:m},n)}return new ti(this,e.expression,n)}evaluate(e,n,o,h,m,y){if(e.kind==="source"){const v=e.evaluate(n,o,h,m,y);return this._calculate(v,v,v,n)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(n.zoom)-1},o,h),e.evaluate({zoom:Math.floor(n.zoom)},o,h),e.evaluate({zoom:Math.floor(n.zoom)+1},o,h),n):e.value}_calculate(e,n,o,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:o,to:n}}interpolate(e){return e}}class bu{constructor(e){this.specification=e}possiblyEvaluate(e,n,o,h){if(e.value!==void 0){if(e.expression.kind==="constant"){const m=e.expression.evaluate(n,null,{},o,h);return this._calculate(m,m,m,n)}return this._calculate(e.expression.evaluate(new Gt(Math.floor(n.zoom-1),n)),e.expression.evaluate(new Gt(Math.floor(n.zoom),n)),e.expression.evaluate(new Gt(Math.floor(n.zoom+1),n)),n)}}_calculate(e,n,o,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:o,to:n}}interpolate(e){return e}}class Su{constructor(e){this.specification=e}possiblyEvaluate(e,n,o,h){return!!e.expression.evaluate(n,null,{},o,h)}interpolate(){return!1}}class pr{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in e){const o=e[n];o.specification.overridable&&this.overridableProperties.push(n);const h=this.defaultPropertyValues[n]=new Qo(o,void 0),m=this.defaultTransitionablePropertyValues[n]=new wu(o);this.defaultTransitioningPropertyValues[n]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=h.possiblyEvaluate({})}}}Ze("DataDrivenProperty",lt),Ze("DataConstantProperty",tt),Ze("CrossFadedDataDrivenProperty",ro),Ze("CrossFadedProperty",bu),Ze("ColorRampProperty",Su);const Tu="-transition";class Wi extends vs{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new Cp(n.layout)),n.paint)){this._transitionablePaint=new wh(n.paint);for(const o in e.paint)this.setPaintProperty(o,e.paint[o],{validate:!1});for(const o in e.layout)this.setLayoutProperty(o,e.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new el(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,o={}){n!=null&&this._validate(mh,`layers.${this.id}.layout.${e}`,e,n,o)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return e.endsWith(Tu)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,o={}){if(n!=null&&this._validate(hu,`layers.${this.id}.paint.${e}`,e,n,o))return!1;if(e.endsWith(Tu))return this._transitionablePaint.setTransition(e.slice(0,-11),n||void 0),!1;{const h=this._transitionablePaint._values[e],m=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(e,v,b)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,n,o){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ar(e,(n,o)=>!(n===void 0||o==="layout"&&!Object.keys(n).length||o==="paint"&&!Object.keys(n).length))}_validate(e,n,o,h,m={}){return(!m||m.validate!==!1)&&Yo(this,e.call(On,{key:n,layerType:this.type,objectKey:o,value:h,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof ti&&ia(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const Th={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Cs{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class sr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function er(i,e=1){let n=0,o=0;return{members:i.map(h=>{const m=Th[h.type].BYTES_PER_ELEMENT,y=n=la(n,Math.max(e,m)),v=h.components||1;return o=Math.max(o,m),n+=m*v,{name:h.name,type:h.type,components:v,offset:y}}),size:la(n,Math.max(o,e)),alignment:e}}function la(i,e){return Math.ceil(i/e)*e}class io extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const h=2*e;return this.int16[h+0]=n,this.int16[h+1]=o,e}}io.prototype.bytesPerElement=4,Ze("StructArrayLayout2i4",io);class no extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const m=3*e;return this.int16[m+0]=n,this.int16[m+1]=o,this.int16[m+2]=h,e}}no.prototype.bytesPerElement=6,Ze("StructArrayLayout3i6",no);class Ps extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,o,h)}emplace(e,n,o,h,m){const y=4*e;return this.int16[y+0]=n,this.int16[y+1]=o,this.int16[y+2]=h,this.int16[y+3]=m,e}}Ps.prototype.bytesPerElement=8,Ze("StructArrayLayout4i8",Ps);class ku extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,o,h,m,y)}emplace(e,n,o,h,m,y,v){const b=6*e;return this.int16[b+0]=n,this.int16[b+1]=o,this.int16[b+2]=h,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=v,e}}ku.prototype.bytesPerElement=12,Ze("StructArrayLayout2i4i12",ku);class Eu extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,o,h,m,y)}emplace(e,n,o,h,m,y,v){const b=4*e,k=8*e;return this.int16[b+0]=n,this.int16[b+1]=o,this.uint8[k+4]=h,this.uint8[k+5]=m,this.uint8[k+6]=y,this.uint8[k+7]=v,e}}Eu.prototype.bytesPerElement=8,Ze("StructArrayLayout2i4ub8",Eu);class ua extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const h=2*e;return this.float32[h+0]=n,this.float32[h+1]=o,e}}ua.prototype.bytesPerElement=8,Ze("StructArrayLayout2f8",ua);class Iu extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,m,y,v,b,k,I){const M=this.length;return this.resize(M+1),this.emplace(M,e,n,o,h,m,y,v,b,k,I)}emplace(e,n,o,h,m,y,v,b,k,I,M){const D=10*e;return this.uint16[D+0]=n,this.uint16[D+1]=o,this.uint16[D+2]=h,this.uint16[D+3]=m,this.uint16[D+4]=y,this.uint16[D+5]=v,this.uint16[D+6]=b,this.uint16[D+7]=k,this.uint16[D+8]=I,this.uint16[D+9]=M,e}}Iu.prototype.bytesPerElement=20,Ze("StructArrayLayout10ui20",Iu);class Cu extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,m,y,v,b,k,I,M,D){const B=this.length;return this.resize(B+1),this.emplace(B,e,n,o,h,m,y,v,b,k,I,M,D)}emplace(e,n,o,h,m,y,v,b,k,I,M,D,B){const O=12*e;return this.int16[O+0]=n,this.int16[O+1]=o,this.int16[O+2]=h,this.int16[O+3]=m,this.uint16[O+4]=y,this.uint16[O+5]=v,this.uint16[O+6]=b,this.uint16[O+7]=k,this.int16[O+8]=I,this.int16[O+9]=M,this.int16[O+10]=D,this.int16[O+11]=B,e}}Cu.prototype.bytesPerElement=24,Ze("StructArrayLayout4i4ui4i24",Cu);class Mt extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const m=3*e;return this.float32[m+0]=n,this.float32[m+1]=o,this.float32[m+2]=h,e}}Mt.prototype.bytesPerElement=12,Ze("StructArrayLayout3f12",Mt);class p extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}p.prototype.bytesPerElement=4,Ze("StructArrayLayout1ul4",p);class t extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,m,y,v,b,k){const I=this.length;return this.resize(I+1),this.emplace(I,e,n,o,h,m,y,v,b,k)}emplace(e,n,o,h,m,y,v,b,k,I){const M=10*e,D=5*e;return this.int16[M+0]=n,this.int16[M+1]=o,this.int16[M+2]=h,this.int16[M+3]=m,this.int16[M+4]=y,this.int16[M+5]=v,this.uint32[D+3]=b,this.uint16[M+8]=k,this.uint16[M+9]=I,e}}t.prototype.bytesPerElement=20,Ze("StructArrayLayout6i1ul2ui20",t);class a extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,o,h,m,y)}emplace(e,n,o,h,m,y,v){const b=6*e;return this.int16[b+0]=n,this.int16[b+1]=o,this.int16[b+2]=h,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=v,e}}a.prototype.bytesPerElement=12,Ze("StructArrayLayout2i2i2i12",a);class c extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,o,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,n,o,h,m)}emplace(e,n,o,h,m,y){const v=4*e,b=8*e;return this.float32[v+0]=n,this.float32[v+1]=o,this.float32[v+2]=h,this.int16[b+6]=m,this.int16[b+7]=y,e}}c.prototype.bytesPerElement=16,Ze("StructArrayLayout2f1f2i16",c);class d extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,o,h)}emplace(e,n,o,h,m){const y=12*e,v=3*e;return this.uint8[y+0]=n,this.uint8[y+1]=o,this.float32[v+1]=h,this.float32[v+2]=m,e}}d.prototype.bytesPerElement=12,Ze("StructArrayLayout2ub2f12",d);class f extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const m=3*e;return this.uint16[m+0]=n,this.uint16[m+1]=o,this.uint16[m+2]=h,e}}f.prototype.bytesPerElement=6,Ze("StructArrayLayout3ui6",f);class x extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,h,m,y,v,b,k,I,M,D,B,O,j,H,Y){const oe=this.length;return this.resize(oe+1),this.emplace(oe,e,n,o,h,m,y,v,b,k,I,M,D,B,O,j,H,Y)}emplace(e,n,o,h,m,y,v,b,k,I,M,D,B,O,j,H,Y,oe){const Q=24*e,ue=12*e,fe=48*e;return this.int16[Q+0]=n,this.int16[Q+1]=o,this.uint16[Q+2]=h,this.uint16[Q+3]=m,this.uint32[ue+2]=y,this.uint32[ue+3]=v,this.uint32[ue+4]=b,this.uint16[Q+10]=k,this.uint16[Q+11]=I,this.uint16[Q+12]=M,this.float32[ue+7]=D,this.float32[ue+8]=B,this.uint8[fe+36]=O,this.uint8[fe+37]=j,this.uint8[fe+38]=H,this.uint32[ue+10]=Y,this.int16[Q+22]=oe,e}}x.prototype.bytesPerElement=48,Ze("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",x);class w extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,h,m,y,v,b,k,I,M,D,B,O,j,H,Y,oe,Q,ue,fe,we,je,Ke,Ve,Oe,Ae,qe){const Re=this.length;return this.resize(Re+1),this.emplace(Re,e,n,o,h,m,y,v,b,k,I,M,D,B,O,j,H,Y,oe,Q,ue,fe,we,je,Ke,Ve,Oe,Ae,qe)}emplace(e,n,o,h,m,y,v,b,k,I,M,D,B,O,j,H,Y,oe,Q,ue,fe,we,je,Ke,Ve,Oe,Ae,qe,Re){const Ee=32*e,st=16*e;return this.int16[Ee+0]=n,this.int16[Ee+1]=o,this.int16[Ee+2]=h,this.int16[Ee+3]=m,this.int16[Ee+4]=y,this.int16[Ee+5]=v,this.int16[Ee+6]=b,this.int16[Ee+7]=k,this.uint16[Ee+8]=I,this.uint16[Ee+9]=M,this.uint16[Ee+10]=D,this.uint16[Ee+11]=B,this.uint16[Ee+12]=O,this.uint16[Ee+13]=j,this.uint16[Ee+14]=H,this.uint16[Ee+15]=Y,this.uint16[Ee+16]=oe,this.uint16[Ee+17]=Q,this.uint16[Ee+18]=ue,this.uint16[Ee+19]=fe,this.uint16[Ee+20]=we,this.uint16[Ee+21]=je,this.uint16[Ee+22]=Ke,this.uint32[st+12]=Ve,this.float32[st+13]=Oe,this.float32[st+14]=Ae,this.uint16[Ee+30]=qe,this.uint16[Ee+31]=Re,e}}w.prototype.bytesPerElement=64,Ze("StructArrayLayout8i15ui1ul2f2ui64",w);class T extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}T.prototype.bytesPerElement=4,Ze("StructArrayLayout1f4",T);class E extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const m=3*e;return this.uint16[6*e+0]=n,this.float32[m+1]=o,this.float32[m+2]=h,e}}E.prototype.bytesPerElement=12,Ze("StructArrayLayout1ui2f12",E);class C extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,o){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,o)}emplace(e,n,o,h){const m=4*e;return this.uint32[2*e+0]=n,this.uint16[m+2]=o,this.uint16[m+3]=h,e}}C.prototype.bytesPerElement=8,Ze("StructArrayLayout1ul2ui8",C);class P extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const o=this.length;return this.resize(o+1),this.emplace(o,e,n)}emplace(e,n,o){const h=2*e;return this.uint16[h+0]=n,this.uint16[h+1]=o,e}}P.prototype.bytesPerElement=4,Ze("StructArrayLayout2ui4",P);class R extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}R.prototype.bytesPerElement=2,Ze("StructArrayLayout1ui2",R);class Z extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,o,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,o,h)}emplace(e,n,o,h,m){const y=4*e;return this.float32[y+0]=n,this.float32[y+1]=o,this.float32[y+2]=h,this.float32[y+3]=m,e}}Z.prototype.bytesPerElement=16,Ze("StructArrayLayout4f16",Z);class $ extends Cs{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ie(this.anchorPointX,this.anchorPointY)}}$.prototype.size=20;class G extends t{get(e){return new $(this,e)}}Ze("CollisionBoxArray",G);class U extends Cs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}U.prototype.size=48;class ne extends x{get(e){return new U(this,e)}}Ze("PlacedSymbolArray",ne);class de extends Cs{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}de.prototype.size=64;class K extends w{get(e){return new de(this,e)}}Ze("SymbolInstanceArray",K);class se extends T{getoffsetX(e){return this.float32[1*e+0]}}Ze("GlyphOffsetArray",se);class me extends no{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Ze("SymbolLineVertexArray",me);class ge extends Cs{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ge.prototype.size=12;class xe extends E{get(e){return new ge(this,e)}}Ze("TextAnchorOffsetArray",xe);class ke extends Cs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ke.prototype.size=8;class Se extends C{get(e){return new ke(this,e)}}Ze("FeatureIndexArray",Se);class ze extends io{}class Xe extends io{}class xt extends io{}class Fe extends ku{}class ut extends Eu{}class Je extends ua{}class Bt extends Iu{}class vt extends Cu{}class mt extends Mt{}class wt extends p{}class ur extends a{}class $t extends d{}class Nr extends f{}class Sr extends P{}const fr=er([{name:"a_pos",components:2,type:"Int16"}],4),{members:Mi}=fr;class Wt{constructor(e=[]){this.segments=e}prepareSegment(e,n,o,h){let m=this.segments[this.segments.length-1];return e>Wt.MAX_VERTEX_ARRAY_LENGTH&&Dr(`Max vertices per segment is ${Wt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>Wt.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:n.length,primitiveOffset:o.length,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,o,h){return new Wt([{vertexOffset:e,primitiveOffset:n,vertexLength:o,primitiveLength:h,vaos:{},sortKey:0}])}}function vn(i,e){return 256*(i=Ye(Math.floor(i),0,255))+Ye(Math.floor(e),0,255)}Wt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ze("SegmentVector",Wt);const xn=er([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var cs={exports:{}},zs={exports:{}};zs.exports=function(i,e){var n,o,h,m,y,v,b,k;for(o=i.length-(n=3&i.length),h=e,y=3432918353,v=461845907,k=0;k<o;)b=255&i.charCodeAt(k)|(255&i.charCodeAt(++k))<<8|(255&i.charCodeAt(++k))<<16|(255&i.charCodeAt(++k))<<24,++k,h=27492+(65535&(m=5*(65535&(h=(h^=b=(65535&(b=(b=(65535&b)*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(b=0,n){case 3:b^=(255&i.charCodeAt(k+2))<<16;case 2:b^=(255&i.charCodeAt(k+1))<<8;case 1:h^=b=(65535&(b=(b=(65535&(b^=255&i.charCodeAt(k)))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return h^=i.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var ca=zs.exports,Wr={exports:{}};Wr.exports=function(i,e){for(var n,o=i.length,h=e^o,m=0;o>=4;)n=1540483477*(65535&(n=255&i.charCodeAt(m)|(255&i.charCodeAt(++m))<<8|(255&i.charCodeAt(++m))<<16|(255&i.charCodeAt(++m))<<24))+((1540483477*(n>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),o-=4,++m;switch(o){case 3:h^=(255&i.charCodeAt(m+2))<<16;case 2:h^=(255&i.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&i.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Vr=ca,ri=Wr.exports;cs.exports=Vr,cs.exports.murmur3=Vr,cs.exports.murmur2=ri;var Ms=F(cs.exports);class cr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,o,h){this.ids.push(Tr(e)),this.positions.push(n,o,h)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Tr(e);let o=0,h=this.ids.length-1;for(;o<h;){const y=o+h>>1;this.ids[y]>=n?h=y:o=y+1}const m=[];for(;this.ids[o]===n;)m.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return m}static serialize(e,n){const o=new Float64Array(e.ids),h=new Uint32Array(e.positions);return mi(o,h,0,o.length-1),n&&n.push(o.buffer,h.buffer),{ids:o,positions:h}}static deserialize(e){const n=new cr;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function Tr(i){const e=+i;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Ms(String(i))}function mi(i,e,n,o){for(;n<o;){const h=i[n+o>>1];let m=n-1,y=o+1;for(;;){do m++;while(i[m]<h);do y--;while(i[y]>h);if(m>=y)break;hr(i,m,y),hr(e,3*m,3*y),hr(e,3*m+1,3*y+1),hr(e,3*m+2,3*y+2)}y-n<o-y?(mi(i,e,n,y),n=y+1):(mi(i,e,y+1,o),o=y)}}function hr(i,e,n){const o=i[e];i[e]=i[n],i[n]=o}Ze("FeaturePositionMap",cr);class As{constructor(e,n){this.gl=e.gl,this.location=n}}class tl extends As{constructor(e,n){super(e,n),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class kh extends As{constructor(e,n){super(e,n),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Eh extends As{constructor(e,n){super(e,n),this.current=Rt.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Pp=new Float32Array(16);function Pu(i){return[vn(255*i.r,255*i.g),vn(255*i.b,255*i.a)]}class wn{constructor(e,n,o){this.value=e,this.uniformNames=n.map(h=>`u_${h}`),this.type=o}setUniform(e,n,o){e.set(o.constantOr(this.value))}getBinding(e,n,o){return this.type==="color"?new Eh(e,n):new tl(e,n)}}class Ds{constructor(e,n){this.uniformNames=n.map(o=>`u_${o}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr}setUniform(e,n,o,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&e.set(m)}getBinding(e,n,o){return o.substr(0,9)==="u_pattern"?new kh(e,n):new tl(e,n)}}class bn{constructor(e,n,o,h){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=n.map(m=>({name:`a_${m}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,n,o,h,m){const y=this.paintVertexArray.length,v=this.expression.evaluate(new Gt(0),n,{},h,[],m);this.paintVertexArray.resize(e),this._setPaintValue(y,e,v)}updatePaintArray(e,n,o,h){const m=this.expression.evaluate({zoom:0},o,h);this._setPaintValue(e,n,m)}_setPaintValue(e,n,o){if(this.type==="color"){const h=Pu(o);for(let m=e;m<n;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=e;h<n;h++)this.paintVertexArray.emplace(h,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Hi{constructor(e,n,o,h,m,y){this.expression=e,this.uniformNames=n.map(v=>`u_${v}_t`),this.type=o,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=n.map(v=>({name:`a_${v}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,n,o,h,m){const y=this.expression.evaluate(new Gt(this.zoom),n,{},h,[],m),v=this.expression.evaluate(new Gt(this.zoom+1),n,{},h,[],m),b=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(b,e,y,v)}updatePaintArray(e,n,o,h){const m=this.expression.evaluate({zoom:this.zoom},o,h),y=this.expression.evaluate({zoom:this.zoom+1},o,h);this._setPaintValue(e,n,m,y)}_setPaintValue(e,n,o,h){if(this.type==="color"){const m=Pu(o),y=Pu(h);for(let v=e;v<n;v++)this.paintVertexArray.emplace(v,m[0],m[1],y[0],y[1])}else{for(let m=e;m<n;m++)this.paintVertexArray.emplace(m,o,h);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n){const o=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,h=Ye(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,n,o){return new tl(e,n)}}class Sn{constructor(e,n,o,h,m,y){this.expression=e,this.type=n,this.useIntegerZoom=o,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,n,o){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,n.patterns&&n.patterns[this.layerId],o)}updatePaintArray(e,n,o,h,m){this._setPaintValues(e,n,o.patterns&&o.patterns[this.layerId],m)}_setPaintValues(e,n,o,h){if(!h||!o)return;const{min:m,mid:y,max:v}=o,b=h[m],k=h[y],I=h[v];if(b&&k&&I)for(let M=e;M<n;M++)this.zoomInPaintVertexArray.emplace(M,k.tl[0],k.tl[1],k.br[0],k.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],k.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(M,k.tl[0],k.tl[1],k.br[0],k.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],k.pixelRatio,I.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,xn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,xn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class zu{constructor(e,n,o){this.binders={},this._buffers=[];const h=[];for(const m in e.paint._values){if(!o(m))continue;const y=e.paint.get(m);if(!(y instanceof ti&&ia(y.property.specification)))continue;const v=c1(m,e.type),b=y.value,k=y.property.specification.type,I=y.property.useIntegerZoom,M=y.property.specification["property-type"],D=M==="cross-faded"||M==="cross-faded-data-driven";if(b.kind==="constant")this.binders[m]=D?new Ds(b.value,v):new wn(b.value,v,k),h.push(`/u_${m}`);else if(b.kind==="source"||D){const B=Og(m,k,"source");this.binders[m]=D?new Sn(b,k,I,n,B,e.id):new bn(b,v,k,B),h.push(`/a_${m}`)}else{const B=Og(m,k,"composite");this.binders[m]=new Hi(b,v,k,I,n,B),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof bn||n instanceof Hi?n.maxValue:0}populatePaintArrays(e,n,o,h,m){for(const y in this.binders){const v=this.binders[y];(v instanceof bn||v instanceof Hi||v instanceof Sn)&&v.populatePaintArray(e,n,o,h,m)}}setConstantPatternPositions(e,n){for(const o in this.binders){const h=this.binders[o];h instanceof Ds&&h.setConstantPatternPositions(e,n)}}updatePaintArrays(e,n,o,h,m){let y=!1;for(const v in e){const b=n.getPositions(v);for(const k of b){const I=o.feature(k.index);for(const M in this.binders){const D=this.binders[M];if((D instanceof bn||D instanceof Hi||D instanceof Sn)&&D.expression.isStateDependent===!0){const B=h.paint.get(M);D.expression=B.value,D.updatePaintArray(k.start,k.end,I,e[v],m),y=!0}}}}return y}defines(){const e=[];for(const n in this.binders){const o=this.binders[n];(o instanceof wn||o instanceof Ds)&&e.push(...o.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof bn||o instanceof Hi)for(let h=0;h<o.paintVertexAttributes.length;h++)e.push(o.paintVertexAttributes[h].name);else if(o instanceof Sn)for(let h=0;h<xn.members.length;h++)e.push(xn.members[h].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof wn||o instanceof Ds||o instanceof Hi)for(const h of o.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,n){const o=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof wn||m instanceof Ds||m instanceof Hi){for(const y of m.uniformNames)if(n[y]){const v=m.getBinding(e,n[y],y);o.push({name:y,property:h,binding:v})}}}return o}setUniforms(e,n,o,h){for(const{name:m,property:y,binding:v}of n)this.binders[y].setUniform(v,h,o.get(y),m)}updatePaintBuffers(e){this._buffers=[];for(const n in this.binders){const o=this.binders[n];if(e&&o instanceof Sn){const h=e.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(o instanceof bn||o instanceof Hi)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(e){for(const n in this.binders){const o=this.binders[n];(o instanceof bn||o instanceof Hi||o instanceof Sn)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof bn||n instanceof Hi||n instanceof Sn)&&n.destroy()}}}class Vn{constructor(e,n,o=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new zu(h,n,o);this.needsUpload=!1,this._featureMap=new cr,this._bufferOffset=0}populatePaintArrays(e,n,o,h,m,y){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(e,n,h,m,y);n.id!==void 0&&this._featureMap.add(n.id,o,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,o,h){for(const m of o)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,n,m,h)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function c1(i,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}function Og(i,e,n){const o={color:{source:ua,composite:Z},number:{source:T,composite:ua}},h=function(m){return{"line-pattern":{source:Bt,composite:Bt},"fill-pattern":{source:Bt,composite:Bt},"fill-extrusion-pattern":{source:Bt,composite:Bt}}[m]}(i);return h&&h[n]||o[e][n]}Ze("ConstantBinder",wn),Ze("CrossFadedConstantBinder",Ds),Ze("SourceExpressionBinder",bn),Ze("CrossFadedCompositeBinder",Sn),Ze("CompositeExpressionBinder",Hi),Ze("ProgramConfiguration",zu,{omit:["_buffers"]}),Ze("ProgramConfigurationSet",Vn);const xr=8192,zp=Math.pow(2,14)-1,Ng=-zp-1;function so(i){const e=xr/i.extent,n=i.loadGeometry();for(let o=0;o<n.length;o++){const h=n[o];for(let m=0;m<h.length;m++){const y=h[m],v=Math.round(y.x*e),b=Math.round(y.y*e);y.x=Ye(v,Ng,zp),y.y=Ye(b,Ng,zp),(v<y.x||v>y.x+1||b<y.y||b>y.y+1)&&Dr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function ao(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?so(i):[]}}function Ih(i,e,n,o,h){i.emplaceBack(2*e+(o+1)/2,2*n+(h+1)/2)}class Mp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Xe,this.indexArray=new Nr,this.segments=new Wt,this.programConfigurations=new Vn(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o){const h=this.layers[0],m=[];let y=null,v=!1;h.type==="circle"&&(y=h.layout.get("circle-sort-key"),v=!y.isConstant());for(const{feature:b,id:k,index:I,sourceLayerIndex:M}of e){const D=this.layers[0]._featureFilter.needGeometry,B=ao(b,D);if(!this.layers[0]._featureFilter.filter(new Gt(this.zoom),B,o))continue;const O=v?y.evaluate(B,{},o):void 0,j={id:k,properties:b.properties,type:b.type,sourceLayerIndex:M,index:I,geometry:D?B.geometry:so(b),patterns:{},sortKey:O};m.push(j)}v&&m.sort((b,k)=>b.sortKey-k.sortKey);for(const b of m){const{geometry:k,index:I,sourceLayerIndex:M}=b,D=e[I].feature;this.addFeature(b,k,I,o),n.featureIndex.insert(D,k,I,M,this.index)}}update(e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Mi),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,o,h){for(const m of n)for(const y of m){const v=y.x,b=y.y;if(v<0||v>=xr||b<0||b>=xr)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),I=k.vertexLength;Ih(this.layoutVertexArray,v,b,-1,-1),Ih(this.layoutVertexArray,v,b,1,-1),Ih(this.layoutVertexArray,v,b,1,1),Ih(this.layoutVertexArray,v,b,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+3,I+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{},h)}}function Vg(i,e){for(let n=0;n<i.length;n++)if(rl(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(rl(i,e[n]))return!0;return!!Ap(i,e)}function h1(i,e,n){return!!rl(i,e)||!!Dp(e,i,n)}function Ug(i,e){if(i.length===1)return $g(e,i[0]);for(let n=0;n<e.length;n++){const o=e[n];for(let h=0;h<o.length;h++)if(rl(i,o[h]))return!0}for(let n=0;n<i.length;n++)if($g(e,i[n]))return!0;for(let n=0;n<e.length;n++)if(Ap(i,e[n]))return!0;return!1}function d1(i,e,n){if(i.length>1){if(Ap(i,e))return!0;for(let o=0;o<e.length;o++)if(Dp(e[o],i,n))return!0}for(let o=0;o<i.length;o++)if(Dp(i[o],e,n))return!0;return!1}function Ap(i,e){if(i.length===0||e.length===0)return!1;for(let n=0;n<i.length-1;n++){const o=i[n],h=i[n+1];for(let m=0;m<e.length-1;m++)if(p1(o,h,e[m],e[m+1]))return!0}return!1}function p1(i,e,n,o){return Qr(i,n,o)!==Qr(e,n,o)&&Qr(i,e,n)!==Qr(i,e,o)}function Dp(i,e,n){const o=n*n;if(e.length===1)return i.distSqr(e[0])<o;for(let h=1;h<e.length;h++)if(jg(i,e[h-1],e[h])<o)return!0;return!1}function jg(i,e,n){const o=e.distSqr(n);if(o===0)return i.distSqr(e);const h=((i.x-e.x)*(n.x-e.x)+(i.y-e.y)*(n.y-e.y))/o;return i.distSqr(h<0?e:h>1?n:n.sub(e)._mult(h)._add(e))}function $g(i,e){let n,o,h,m=!1;for(let y=0;y<i.length;y++){n=i[y];for(let v=0,b=n.length-1;v<n.length;b=v++)o=n[v],h=n[b],o.y>e.y!=h.y>e.y&&e.x<(h.x-o.x)*(e.y-o.y)/(h.y-o.y)+o.x&&(m=!m)}return m}function rl(i,e){let n=!1;for(let o=0,h=i.length-1;o<i.length;h=o++){const m=i[o],y=i[h];m.y>e.y!=y.y>e.y&&e.x<(y.x-m.x)*(e.y-m.y)/(y.y-m.y)+m.x&&(n=!n)}return n}function f1(i,e,n){const o=n[0],h=n[2];if(i.x<o.x&&e.x<o.x||i.x>h.x&&e.x>h.x||i.y<o.y&&e.y<o.y||i.y>h.y&&e.y>h.y)return!1;const m=Qr(i,e,n[0]);return m!==Qr(i,e,n[1])||m!==Qr(i,e,n[2])||m!==Qr(i,e,n[3])}function Mu(i,e,n){const o=e.paint.get(i).value;return o.kind==="constant"?o.value:n.programConfigurations.get(e.id).getMaxValue(i)}function Ch(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Ph(i,e,n,o,h){if(!e[0]&&!e[1])return i;const m=ie.convert(e)._mult(h);n==="viewport"&&m._rotate(-o);const y=[];for(let v=0;v<i.length;v++)y.push(i[v].sub(m));return y}let Zg,qg;Ze("CircleBucket",Mp,{omit:["layers"]});var m1={get paint(){return qg=qg||new pr({"circle-radius":new lt(ye.paint_circle["circle-radius"]),"circle-color":new lt(ye.paint_circle["circle-color"]),"circle-blur":new lt(ye.paint_circle["circle-blur"]),"circle-opacity":new lt(ye.paint_circle["circle-opacity"]),"circle-translate":new tt(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new tt(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new tt(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new tt(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new lt(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new lt(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new lt(ye.paint_circle["circle-stroke-opacity"])})},get layout(){return Zg=Zg||new pr({"circle-sort-key":new lt(ye.layout_circle["circle-sort-key"])})}},gi=1e-6,il=typeof Float32Array<"u"?Float32Array:Array;function Lp(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Gg(i,e,n){var o=e[0],h=e[1],m=e[2],y=e[3],v=e[4],b=e[5],k=e[6],I=e[7],M=e[8],D=e[9],B=e[10],O=e[11],j=e[12],H=e[13],Y=e[14],oe=e[15],Q=n[0],ue=n[1],fe=n[2],we=n[3];return i[0]=Q*o+ue*v+fe*M+we*j,i[1]=Q*h+ue*b+fe*D+we*H,i[2]=Q*m+ue*k+fe*B+we*Y,i[3]=Q*y+ue*I+fe*O+we*oe,i[4]=(Q=n[4])*o+(ue=n[5])*v+(fe=n[6])*M+(we=n[7])*j,i[5]=Q*h+ue*b+fe*D+we*H,i[6]=Q*m+ue*k+fe*B+we*Y,i[7]=Q*y+ue*I+fe*O+we*oe,i[8]=(Q=n[8])*o+(ue=n[9])*v+(fe=n[10])*M+(we=n[11])*j,i[9]=Q*h+ue*b+fe*D+we*H,i[10]=Q*m+ue*k+fe*B+we*Y,i[11]=Q*y+ue*I+fe*O+we*oe,i[12]=(Q=n[12])*o+(ue=n[13])*v+(fe=n[14])*M+(we=n[15])*j,i[13]=Q*h+ue*b+fe*D+we*H,i[14]=Q*m+ue*k+fe*B+we*Y,i[15]=Q*y+ue*I+fe*O+we*oe,i}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var Au,g1=Gg;function zh(i,e,n){var o=e[0],h=e[1],m=e[2],y=e[3];return i[0]=n[0]*o+n[4]*h+n[8]*m+n[12]*y,i[1]=n[1]*o+n[5]*h+n[9]*m+n[13]*y,i[2]=n[2]*o+n[6]*h+n[10]*m+n[14]*y,i[3]=n[3]*o+n[7]*h+n[11]*m+n[15]*y,i}Au=new il(4),il!=Float32Array&&(Au[0]=0,Au[1]=0,Au[2]=0,Au[3]=0);class y1 extends Wi{constructor(e){super(e,m1)}createBucket(e){return new Mp(e)}queryRadius(e){const n=e;return Mu("circle-radius",this,n)+Mu("circle-stroke-width",this,n)+Ch(this.paint.get("circle-translate"))}queryIntersectsFeature(e,n,o,h,m,y,v,b){const k=Ph(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,v),I=this.paint.get("circle-radius").evaluate(n,o)+this.paint.get("circle-stroke-width").evaluate(n,o),M=this.paint.get("circle-pitch-alignment")==="map",D=M?k:function(O,j){return O.map(H=>Wg(H,j))}(k,b),B=M?I*v:I;for(const O of h)for(const j of O){const H=M?j:Wg(j,b);let Y=B;const oe=zh([],[j.x,j.y,0,1],b);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Y*=oe[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Y*=y.cameraToCenterDistance/oe[3]),h1(D,H,Y))return!0}return!1}}function Wg(i,e){const n=zh([],[i.x,i.y,0,1],e);return new ie(n[0]/n[3],n[1]/n[3])}class Hg extends Mp{}let Xg;Ze("HeatmapBucket",Hg,{omit:["layers"]});var _1={get paint(){return Xg=Xg||new pr({"heatmap-radius":new lt(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new lt(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new tt(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Su(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new tt(ye.paint_heatmap["heatmap-opacity"])})}};function Rp(i,{width:e,height:n},o,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*n*o)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${e*n*o}`)}else h=new Uint8Array(e*n*o);return i.width=e,i.height=n,i.data=h,i}function Kg(i,{width:e,height:n},o){if(e===i.width&&n===i.height)return;const h=Rp({},{width:e,height:n},o);Bp(i,h,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,e),height:Math.min(i.height,n)},o),i.width=e,i.height=n,i.data=h.data}function Bp(i,e,n,o,h,m){if(h.width===0||h.height===0)return e;if(h.width>i.width||h.height>i.height||n.x>i.width-h.width||n.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||o.x>e.width-h.width||o.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,v=e.data;if(y===v)throw new Error("srcData equals dstData, so image is already copied");for(let b=0;b<h.height;b++){const k=((n.y+b)*i.width+n.x)*m,I=((o.y+b)*e.width+o.x)*m;for(let M=0;M<h.width*m;M++)v[I+M]=y[k+M]}return e}class Du{constructor(e,n){Rp(this,e,1,n)}resize(e){Kg(this,e,1)}clone(){return new Du({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,h,m){Bp(e,n,o,h,m,1)}}class sn{constructor(e,n){Rp(this,e,4,n)}resize(e){Kg(this,e,4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new sn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,o,h,m){Bp(e,n,o,h,m,4)}}function Yg(i){const e={},n=i.resolution||256,o=i.clips?i.clips.length:1,h=i.image||new sn({width:n,height:o});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const m=(y,v,b)=>{e[i.evaluationKey]=b;const k=i.expression.evaluate(e);h.data[y+v+0]=Math.floor(255*k.r/k.a),h.data[y+v+1]=Math.floor(255*k.g/k.a),h.data[y+v+2]=Math.floor(255*k.b/k.a),h.data[y+v+3]=Math.floor(255*k.a)};if(i.clips)for(let y=0,v=0;y<o;++y,v+=4*n)for(let b=0,k=0;b<n;b++,k+=4){const I=b/(n-1),{start:M,end:D}=i.clips[y];m(v,k,M*(1-I)+D*I)}else for(let y=0,v=0;y<n;y++,v+=4)m(0,v,y/(n-1));return h}Ze("AlphaImage",Du),Ze("RGBAImage",sn);class v1 extends Wi{createBucket(e){return new Hg(e)}constructor(e){super(e,_1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Yg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Jg;var x1={get paint(){return Jg=Jg||new pr({"hillshade-illumination-direction":new tt(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new tt(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new tt(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new tt(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new tt(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new tt(ye.paint_hillshade["hillshade-accent-color"])})}};class w1 extends Wi{constructor(e){super(e,x1)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const b1=er([{name:"a_pos",components:2,type:"Int16"}],4),{members:S1}=b1;var Fp={exports:{}};function Mh(i,e,n){n=n||2;var o,h,m,y,v,b,k,I=e&&e.length,M=I?e[0]*n:i.length,D=Qg(i,0,M,n,!0),B=[];if(!D||D.next===D.prev)return B;if(I&&(D=function(j,H,Y,oe){var Q,ue,fe,we=[];for(Q=0,ue=H.length;Q<ue;Q++)(fe=Qg(j,H[Q]*oe,Q<ue-1?H[Q+1]*oe:j.length,oe,!1))===fe.next&&(fe.steiner=!0),we.push(M1(fe));for(we.sort(C1),Q=0;Q<we.length;Q++)Y=P1(we[Q],Y);return Y}(i,e,D,n)),i.length>80*n){o=m=i[0],h=y=i[1];for(var O=n;O<M;O+=n)(v=i[O])<o&&(o=v),(b=i[O+1])<h&&(h=b),v>m&&(m=v),b>y&&(y=b);k=(k=Math.max(m-o,y-h))!==0?32767/k:0}return Lu(D,B,n,o,h,k,0),B}function Qg(i,e,n,o,h){var m,y;if(h===Vp(i,e,n,o)>0)for(m=e;m<n;m+=o)y=ry(m,i[m],i[m+1],y);else for(m=n-o;m>=e;m-=o)y=ry(m,i[m],i[m+1],y);return y&&Ah(y,y.next)&&(Bu(y),y=y.next),y}function oo(i,e){if(!i)return i;e||(e=i);var n,o=i;do if(n=!1,o.steiner||!Ah(o,o.next)&&mr(o.prev,o,o.next)!==0)o=o.next;else{if(Bu(o),(o=e=o.prev)===o.next)break;n=!0}while(n||o!==e);return e}function Lu(i,e,n,o,h,m,y){if(i){!y&&m&&function(I,M,D,B){var O=I;do O.z===0&&(O.z=Op(O.x,O.y,M,D,B)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==I);O.prevZ.nextZ=null,O.prevZ=null,function(j){var H,Y,oe,Q,ue,fe,we,je,Ke=1;do{for(Y=j,j=null,ue=null,fe=0;Y;){for(fe++,oe=Y,we=0,H=0;H<Ke&&(we++,oe=oe.nextZ);H++);for(je=Ke;we>0||je>0&&oe;)we!==0&&(je===0||!oe||Y.z<=oe.z)?(Q=Y,Y=Y.nextZ,we--):(Q=oe,oe=oe.nextZ,je--),ue?ue.nextZ=Q:j=Q,Q.prevZ=ue,ue=Q;Y=oe}ue.nextZ=null,Ke*=2}while(fe>1)}(O)}(i,o,h,m);for(var v,b,k=i;i.prev!==i.next;)if(v=i.prev,b=i.next,m?k1(i,o,h,m):T1(i))e.push(v.i/n|0),e.push(i.i/n|0),e.push(b.i/n|0),Bu(i),i=b.next,k=b.next;else if((i=b)===k){y?y===1?Lu(i=E1(oo(i),e,n),e,n,o,h,m,2):y===2&&I1(i,e,n,o,h,m):Lu(oo(i),e,n,o,h,m,1);break}}}function T1(i){var e=i.prev,n=i,o=i.next;if(mr(e,n,o)>=0)return!1;for(var h=e.x,m=n.x,y=o.x,v=e.y,b=n.y,k=o.y,I=h<m?h<y?h:y:m<y?m:y,M=v<b?v<k?v:k:b<k?b:k,D=h>m?h>y?h:y:m>y?m:y,B=v>b?v>k?v:k:b>k?b:k,O=o.next;O!==e;){if(O.x>=I&&O.x<=D&&O.y>=M&&O.y<=B&&nl(h,v,m,b,y,k,O.x,O.y)&&mr(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function k1(i,e,n,o){var h=i.prev,m=i,y=i.next;if(mr(h,m,y)>=0)return!1;for(var v=h.x,b=m.x,k=y.x,I=h.y,M=m.y,D=y.y,B=v<b?v<k?v:k:b<k?b:k,O=I<M?I<D?I:D:M<D?M:D,j=v>b?v>k?v:k:b>k?b:k,H=I>M?I>D?I:D:M>D?M:D,Y=Op(B,O,e,n,o),oe=Op(j,H,e,n,o),Q=i.prevZ,ue=i.nextZ;Q&&Q.z>=Y&&ue&&ue.z<=oe;){if(Q.x>=B&&Q.x<=j&&Q.y>=O&&Q.y<=H&&Q!==h&&Q!==y&&nl(v,I,b,M,k,D,Q.x,Q.y)&&mr(Q.prev,Q,Q.next)>=0||(Q=Q.prevZ,ue.x>=B&&ue.x<=j&&ue.y>=O&&ue.y<=H&&ue!==h&&ue!==y&&nl(v,I,b,M,k,D,ue.x,ue.y)&&mr(ue.prev,ue,ue.next)>=0))return!1;ue=ue.nextZ}for(;Q&&Q.z>=Y;){if(Q.x>=B&&Q.x<=j&&Q.y>=O&&Q.y<=H&&Q!==h&&Q!==y&&nl(v,I,b,M,k,D,Q.x,Q.y)&&mr(Q.prev,Q,Q.next)>=0)return!1;Q=Q.prevZ}for(;ue&&ue.z<=oe;){if(ue.x>=B&&ue.x<=j&&ue.y>=O&&ue.y<=H&&ue!==h&&ue!==y&&nl(v,I,b,M,k,D,ue.x,ue.y)&&mr(ue.prev,ue,ue.next)>=0)return!1;ue=ue.nextZ}return!0}function E1(i,e,n){var o=i;do{var h=o.prev,m=o.next.next;!Ah(h,m)&&ey(h,o,o.next,m)&&Ru(h,m)&&Ru(m,h)&&(e.push(h.i/n|0),e.push(o.i/n|0),e.push(m.i/n|0),Bu(o),Bu(o.next),o=i=m),o=o.next}while(o!==i);return oo(o)}function I1(i,e,n,o,h,m){var y=i;do{for(var v=y.next.next;v!==y.prev;){if(y.i!==v.i&&A1(y,v)){var b=ty(y,v);return y=oo(y,y.next),b=oo(b,b.next),Lu(y,e,n,o,h,m,0),void Lu(b,e,n,o,h,m,0)}v=v.next}y=y.next}while(y!==i)}function C1(i,e){return i.x-e.x}function P1(i,e){var n=function(h,m){var y,v=m,b=h.x,k=h.y,I=-1/0;do{if(k<=v.y&&k>=v.next.y&&v.next.y!==v.y){var M=v.x+(k-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(M<=b&&M>I&&(I=M,y=v.x<v.next.x?v:v.next,M===b))return y}v=v.next}while(v!==m);if(!y)return null;var D,B=y,O=y.x,j=y.y,H=1/0;v=y;do b>=v.x&&v.x>=O&&b!==v.x&&nl(k<j?b:I,k,O,j,k<j?I:b,k,v.x,v.y)&&(D=Math.abs(k-v.y)/(b-v.x),Ru(v,h)&&(D<H||D===H&&(v.x>y.x||v.x===y.x&&z1(y,v)))&&(y=v,H=D)),v=v.next;while(v!==B);return y}(i,e);if(!n)return e;var o=ty(n,i);return oo(o,o.next),oo(n,n.next)}function z1(i,e){return mr(i.prev,i,e.prev)<0&&mr(e.next,i,i.next)<0}function Op(i,e,n,o,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-n)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function M1(i){var e=i,n=i;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==i);return n}function nl(i,e,n,o,h,m,y,v){return(h-y)*(e-v)>=(i-y)*(m-v)&&(i-y)*(o-v)>=(n-y)*(e-v)&&(n-y)*(m-v)>=(h-y)*(o-v)}function A1(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(n,o){var h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==o.i&&h.next.i!==o.i&&ey(h,h.next,n,o))return!0;h=h.next}while(h!==n);return!1}(i,e)&&(Ru(i,e)&&Ru(e,i)&&function(n,o){var h=n,m=!1,y=(n.x+o.x)/2,v=(n.y+o.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&y<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==n);return m}(i,e)&&(mr(i.prev,i,e.prev)||mr(i,e.prev,e))||Ah(i,e)&&mr(i.prev,i,i.next)>0&&mr(e.prev,e,e.next)>0)}function mr(i,e,n){return(e.y-i.y)*(n.x-e.x)-(e.x-i.x)*(n.y-e.y)}function Ah(i,e){return i.x===e.x&&i.y===e.y}function ey(i,e,n,o){var h=Lh(mr(i,e,n)),m=Lh(mr(i,e,o)),y=Lh(mr(n,o,i)),v=Lh(mr(n,o,e));return h!==m&&y!==v||!(h!==0||!Dh(i,n,e))||!(m!==0||!Dh(i,o,e))||!(y!==0||!Dh(n,i,o))||!(v!==0||!Dh(n,e,o))}function Dh(i,e,n){return e.x<=Math.max(i.x,n.x)&&e.x>=Math.min(i.x,n.x)&&e.y<=Math.max(i.y,n.y)&&e.y>=Math.min(i.y,n.y)}function Lh(i){return i>0?1:i<0?-1:0}function Ru(i,e){return mr(i.prev,i,i.next)<0?mr(i,e,i.next)>=0&&mr(i,i.prev,e)>=0:mr(i,e,i.prev)<0||mr(i,i.next,e)<0}function ty(i,e){var n=new Np(i.i,i.x,i.y),o=new Np(e.i,e.x,e.y),h=i.next,m=e.prev;return i.next=e,e.prev=i,n.next=h,h.prev=n,o.next=n,n.prev=o,m.next=o,o.prev=m,o}function ry(i,e,n,o){var h=new Np(i,e,n);return o?(h.next=o.next,h.prev=o,o.next.prev=h,o.next=h):(h.prev=h,h.next=h),h}function Bu(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Np(i,e,n){this.i=i,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Vp(i,e,n,o){for(var h=0,m=e,y=n-o;m<n;m+=o)h+=(i[y]-i[m])*(i[m+1]+i[y+1]),y=m;return h}Fp.exports=Mh,Fp.exports.default=Mh,Mh.deviation=function(i,e,n,o){var h=e&&e.length,m=Math.abs(Vp(i,0,h?e[0]*n:i.length,n));if(h)for(var y=0,v=e.length;y<v;y++)m-=Math.abs(Vp(i,e[y]*n,y<v-1?e[y+1]*n:i.length,n));var b=0;for(y=0;y<o.length;y+=3){var k=o[y]*n,I=o[y+1]*n,M=o[y+2]*n;b+=Math.abs((i[k]-i[M])*(i[I+1]-i[k+1])-(i[k]-i[I])*(i[M+1]-i[k+1]))}return m===0&&b===0?0:Math.abs((b-m)/m)},Mh.flatten=function(i){for(var e=i[0][0].length,n={vertices:[],holes:[],dimensions:e},o=0,h=0;h<i.length;h++){for(var m=0;m<i[h].length;m++)for(var y=0;y<e;y++)n.vertices.push(i[h][m][y]);h>0&&n.holes.push(o+=i[h-1].length)}return n};var iy=F(Fp.exports);function D1(i,e,n,o,h){ny(i,e,n,o||i.length-1,h||L1)}function ny(i,e,n,o,h){for(;o>n;){if(o-n>600){var m=o-n+1,y=e-n+1,v=Math.log(m),b=.5*Math.exp(2*v/3),k=.5*Math.sqrt(v*b*(m-b)/m)*(y-m/2<0?-1:1);ny(i,e,Math.max(n,Math.floor(e-y*b/m+k)),Math.min(o,Math.floor(e+(m-y)*b/m+k)),h)}var I=i[e],M=n,D=o;for(Fu(i,n,e),h(i[o],I)>0&&Fu(i,n,o);M<D;){for(Fu(i,M,D),M++,D--;h(i[M],I)<0;)M++;for(;h(i[D],I)>0;)D--}h(i[n],I)===0?Fu(i,n,D):Fu(i,++D,o),D<=e&&(n=D+1),e<=D&&(o=D-1)}}function Fu(i,e,n){var o=i[e];i[e]=i[n],i[n]=o}function L1(i,e){return i<e?-1:i>e?1:0}function Up(i,e){const n=i.length;if(n<=1)return[i];const o=[];let h,m;for(let y=0;y<n;y++){const v=ki(i[y]);v!==0&&(i[y].area=Math.abs(v),m===void 0&&(m=v<0),m===v<0?(h&&o.push(h),h=[i[y]]):h.push(i[y]))}if(h&&o.push(h),e>1)for(let y=0;y<o.length;y++)o[y].length<=e||(D1(o[y],e,1,o[y].length-1,R1),o[y]=o[y].slice(0,e));return o}function R1(i,e){return e.area-i.area}function jp(i,e,n){const o=n.patternDependencies;let h=!1;for(const m of e){const y=m.paint.get(`${i}-pattern`);y.isConstant()||(h=!0);const v=y.constantOr(null);v&&(h=!0,o[v.to]=!0,o[v.from]=!0)}return h}function $p(i,e,n,o,h){const m=h.patternDependencies;for(const y of e){const v=y.paint.get(`${i}-pattern`).value;if(v.kind!=="constant"){let b=v.evaluate({zoom:o-1},n,{},h.availableImages),k=v.evaluate({zoom:o},n,{},h.availableImages),I=v.evaluate({zoom:o+1},n,{},h.availableImages);b=b&&b.name?b.name:b,k=k&&k.name?k.name:k,I=I&&I.name?I.name:I,m[b]=!0,m[k]=!0,m[I]=!0,n.patterns[y.id]={min:b,mid:k,max:I}}}return n}class Zp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new xt,this.indexArray=new Nr,this.indexArray2=new Sr,this.programConfigurations=new Vn(e.layers,e.zoom),this.segments=new Wt,this.segments2=new Wt,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o){this.hasPattern=jp("fill",this.layers,n);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),y=[];for(const{feature:v,id:b,index:k,sourceLayerIndex:I}of e){const M=this.layers[0]._featureFilter.needGeometry,D=ao(v,M);if(!this.layers[0]._featureFilter.filter(new Gt(this.zoom),D,o))continue;const B=m?h.evaluate(D,{},o,n.availableImages):void 0,O={id:b,properties:v.properties,type:v.type,sourceLayerIndex:I,index:k,geometry:M?D.geometry:so(v),patterns:{},sortKey:B};y.push(O)}m&&y.sort((v,b)=>v.sortKey-b.sortKey);for(const v of y){const{geometry:b,index:k,sourceLayerIndex:I}=v;if(this.hasPattern){const M=$p("fill",this.layers,v,this.zoom,n);this.patternFeatures.push(M)}else this.addFeature(v,b,k,o,{});n.featureIndex.insert(e[k].feature,b,k,I,this.index)}}update(e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o)}addFeatures(e,n,o){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,S1),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,o,h,m){for(const y of Up(n,500)){let v=0;for(const B of y)v+=B.length;const b=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),k=b.vertexLength,I=[],M=[];for(const B of y){if(B.length===0)continue;B!==y[0]&&M.push(I.length/2);const O=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),j=O.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(j+B.length-1,j),I.push(B[0].x),I.push(B[0].y);for(let H=1;H<B.length;H++)this.layoutVertexArray.emplaceBack(B[H].x,B[H].y),this.indexArray2.emplaceBack(j+H-1,j+H),I.push(B[H].x),I.push(B[H].y);O.vertexLength+=B.length,O.primitiveLength+=B.length}const D=iy(I,M);for(let B=0;B<D.length;B+=3)this.indexArray.emplaceBack(k+D[B],k+D[B+1],k+D[B+2]);b.vertexLength+=v,b.primitiveLength+=D.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,m,h)}}let sy,ay;Ze("FillBucket",Zp,{omit:["layers","patternFeatures"]});var B1={get paint(){return ay=ay||new pr({"fill-antialias":new tt(ye.paint_fill["fill-antialias"]),"fill-opacity":new lt(ye.paint_fill["fill-opacity"]),"fill-color":new lt(ye.paint_fill["fill-color"]),"fill-outline-color":new lt(ye.paint_fill["fill-outline-color"]),"fill-translate":new tt(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new tt(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new ro(ye.paint_fill["fill-pattern"])})},get layout(){return sy=sy||new pr({"fill-sort-key":new lt(ye.layout_fill["fill-sort-key"])})}};class F1 extends Wi{constructor(e){super(e,B1)}recalculate(e,n){super.recalculate(e,n);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Zp(e)}queryRadius(){return Ch(this.paint.get("fill-translate"))}queryIntersectsFeature(e,n,o,h,m,y,v){return Ug(Ph(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,v),h)}isTileClipped(){return!0}}const O1=er([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),N1=er([{name:"a_centroid",components:2,type:"Int16"}],4),{members:V1}=O1;var ha={},U1=pe,oy=sl;function sl(i,e,n,o,h){this.properties={},this.extent=n,this.type=0,this._pbf=i,this._geometry=-1,this._keys=o,this._values=h,i.readFields(j1,this,e)}function j1(i,e,n){i==1?e.id=n.readVarint():i==2?function(o,h){for(var m=o.readVarint()+o.pos;o.pos<m;){var y=h._keys[o.readVarint()],v=h._values[o.readVarint()];h.properties[y]=v}}(n,e):i==3?e.type=n.readVarint():i==4&&(e._geometry=n.pos)}function $1(i){for(var e,n,o=0,h=0,m=i.length,y=m-1;h<m;y=h++)o+=((n=i[y]).x-(e=i[h]).x)*(e.y+n.y);return o}sl.types=["Unknown","Point","LineString","Polygon"],sl.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,n=i.readVarint()+i.pos,o=1,h=0,m=0,y=0,v=[];i.pos<n;){if(h<=0){var b=i.readVarint();o=7&b,h=b>>3}if(h--,o===1||o===2)m+=i.readSVarint(),y+=i.readSVarint(),o===1&&(e&&v.push(e),e=[]),e.push(new U1(m,y));else{if(o!==7)throw new Error("unknown command "+o);e&&e.push(e[0].clone())}}return e&&v.push(e),v},sl.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,n=1,o=0,h=0,m=0,y=1/0,v=-1/0,b=1/0,k=-1/0;i.pos<e;){if(o<=0){var I=i.readVarint();n=7&I,o=I>>3}if(o--,n===1||n===2)(h+=i.readSVarint())<y&&(y=h),h>v&&(v=h),(m+=i.readSVarint())<b&&(b=m),m>k&&(k=m);else if(n!==7)throw new Error("unknown command "+n)}return[y,b,v,k]},sl.prototype.toGeoJSON=function(i,e,n){var o,h,m=this.extent*Math.pow(2,n),y=this.extent*i,v=this.extent*e,b=this.loadGeometry(),k=sl.types[this.type];function I(B){for(var O=0;O<B.length;O++){var j=B[O];B[O]=[360*(j.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+v)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(o=0;o<b.length;o++)M[o]=b[o][0];I(b=M);break;case 2:for(o=0;o<b.length;o++)I(b[o]);break;case 3:for(b=function(B){var O=B.length;if(O<=1)return[B];for(var j,H,Y=[],oe=0;oe<O;oe++){var Q=$1(B[oe]);Q!==0&&(H===void 0&&(H=Q<0),H===Q<0?(j&&Y.push(j),j=[B[oe]]):j.push(B[oe]))}return j&&Y.push(j),Y}(b),o=0;o<b.length;o++)for(h=0;h<b[o].length;h++)I(b[o][h])}b.length===1?b=b[0]:k="Multi"+k;var D={type:"Feature",geometry:{type:k,coordinates:b},properties:this.properties};return"id"in this&&(D.id=this.id),D};var Z1=oy,ly=uy;function uy(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(q1,this,e),this.length=this._features.length}function q1(i,e,n){i===15?e.version=n.readVarint():i===1?e.name=n.readString():i===5?e.extent=n.readVarint():i===2?e._features.push(n.pos):i===3?e._keys.push(n.readString()):i===4&&e._values.push(function(o){for(var h=null,m=o.readVarint()+o.pos;o.pos<m;){var y=o.readVarint()>>3;h=y===1?o.readString():y===2?o.readFloat():y===3?o.readDouble():y===4?o.readVarint64():y===5?o.readVarint():y===6?o.readSVarint():y===7?o.readBoolean():null}return h}(n))}uy.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new Z1(this._pbf,e,this.extent,this._keys,this._values)};var G1=ly;function W1(i,e,n){if(i===3){var o=new G1(n,n.readVarint()+n.pos);o.length&&(e[o.name]=o)}}ha.VectorTile=function(i,e){this.layers=i.readFields(W1,{},e)},ha.VectorTileFeature=oy,ha.VectorTileLayer=ly;const H1=ha.VectorTileFeature.types,qp=Math.pow(2,13);function Ou(i,e,n,o,h,m,y,v){i.emplaceBack(e,n,2*Math.floor(o*qp)+y,h*qp*2,m*qp*2,Math.round(v))}class Gp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Fe,this.centroidVertexArray=new ze,this.indexArray=new Nr,this.programConfigurations=new Vn(e.layers,e.zoom),this.segments=new Wt,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o){this.features=[],this.hasPattern=jp("fill-extrusion",this.layers,n);for(const{feature:h,id:m,index:y,sourceLayerIndex:v}of e){const b=this.layers[0]._featureFilter.needGeometry,k=ao(h,b);if(!this.layers[0]._featureFilter.filter(new Gt(this.zoom),k,o))continue;const I={id:m,sourceLayerIndex:v,index:y,geometry:b?k.geometry:so(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push($p("fill-extrusion",this.layers,I,this.zoom,n)):this.addFeature(I,I.geometry,y,o,{}),n.featureIndex.insert(h,I.geometry,y,v,this.index,!0)}}addFeatures(e,n,o){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,n,o)}}update(e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,V1),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,N1.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,n,o,h,m){const y={x:0,y:0,vertexCount:0};for(const v of Up(n,500)){let b=0;for(const O of v)b+=O.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const O of v){if(O.length===0||K1(O))continue;let j=0;for(let H=0;H<O.length;H++){const Y=O[H];if(H>=1){const oe=O[H-1];if(!X1(Y,oe)){k.vertexLength+4>Wt.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Q=Y.sub(oe)._perp()._unit(),ue=oe.dist(Y);j+ue>32768&&(j=0),Ou(this.layoutVertexArray,Y.x,Y.y,Q.x,Q.y,0,0,j),Ou(this.layoutVertexArray,Y.x,Y.y,Q.x,Q.y,0,1,j),y.x+=2*Y.x,y.y+=2*Y.y,y.vertexCount+=2,j+=ue,Ou(this.layoutVertexArray,oe.x,oe.y,Q.x,Q.y,0,0,j),Ou(this.layoutVertexArray,oe.x,oe.y,Q.x,Q.y,0,1,j),y.x+=2*oe.x,y.y+=2*oe.y,y.vertexCount+=2;const fe=k.vertexLength;this.indexArray.emplaceBack(fe,fe+2,fe+1),this.indexArray.emplaceBack(fe+1,fe+2,fe+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+b>Wt.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray)),H1[e.type]!=="Polygon")continue;const I=[],M=[],D=k.vertexLength;for(const O of v)if(O.length!==0){O!==v[0]&&M.push(I.length/2);for(let j=0;j<O.length;j++){const H=O[j];Ou(this.layoutVertexArray,H.x,H.y,0,0,1,1,0),y.x+=H.x,y.y+=H.y,y.vertexCount+=1,I.push(H.x),I.push(H.y)}}const B=iy(I,M);for(let O=0;O<B.length;O+=3)this.indexArray.emplaceBack(D+B[O],D+B[O+2],D+B[O+1]);k.primitiveLength+=B.length/3,k.vertexLength+=b}for(let v=0;v<y.vertexCount;v++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,m,h)}}function X1(i,e){return i.x===e.x&&(i.x<0||i.x>xr)||i.y===e.y&&(i.y<0||i.y>xr)}function K1(i){return i.every(e=>e.x<0)||i.every(e=>e.x>xr)||i.every(e=>e.y<0)||i.every(e=>e.y>xr)}let cy;Ze("FillExtrusionBucket",Gp,{omit:["layers","features"]});var Y1={get paint(){return cy=cy||new pr({"fill-extrusion-opacity":new tt(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new lt(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new tt(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new tt(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ro(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new lt(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new lt(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new tt(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class J1 extends Wi{constructor(e){super(e,Y1)}createBucket(e){return new Gp(e)}queryRadius(){return Ch(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,n,o,h,m,y,v,b){const k=Ph(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,v),I=this.paint.get("fill-extrusion-height").evaluate(n,o),M=this.paint.get("fill-extrusion-base").evaluate(n,o),D=function(O,j,H,Y){const oe=[];for(const Q of O){const ue=[Q.x,Q.y,0,1];zh(ue,ue,j),oe.push(new ie(ue[0]/ue[3],ue[1]/ue[3]))}return oe}(k,b),B=function(O,j,H,Y){const oe=[],Q=[],ue=Y[8]*j,fe=Y[9]*j,we=Y[10]*j,je=Y[11]*j,Ke=Y[8]*H,Ve=Y[9]*H,Oe=Y[10]*H,Ae=Y[11]*H;for(const qe of O){const Re=[],Ee=[];for(const st of qe){const Qe=st.x,_t=st.y,Ht=Y[0]*Qe+Y[4]*_t+Y[12],Kt=Y[1]*Qe+Y[5]*_t+Y[13],Er=Y[2]*Qe+Y[6]*_t+Y[14],Xi=Y[3]*Qe+Y[7]*_t+Y[15],yi=Er+we,wr=Xi+je,Ur=Ht+Ke,Xr=Kt+Ve,_i=Er+Oe,vi=Xi+Ae,Ir=new ie((Ht+ue)/wr,(Kt+fe)/wr);Ir.z=yi/wr,Re.push(Ir);const Cr=new ie(Ur/vi,Xr/vi);Cr.z=_i/vi,Ee.push(Cr)}oe.push(Re),Q.push(Ee)}return[oe,Q]}(h,M,I,b);return function(O,j,H){let Y=1/0;Ug(H,j)&&(Y=hy(H,j[0]));for(let oe=0;oe<j.length;oe++){const Q=j[oe],ue=O[oe];for(let fe=0;fe<Q.length-1;fe++){const we=Q[fe],je=[we,Q[fe+1],ue[fe+1],ue[fe],we];Vg(H,je)&&(Y=Math.min(Y,hy(H,je)))}}return Y!==1/0&&Y}(B[0],B[1],D)}}function Nu(i,e){return i.x*e.x+i.y*e.y}function hy(i,e){if(i.length===1){let n=0;const o=e[n++];let h;for(;!h||o.equals(h);)if(h=e[n++],!h)return 1/0;for(;n<e.length;n++){const m=e[n],y=i[0],v=h.sub(o),b=m.sub(o),k=y.sub(o),I=Nu(v,v),M=Nu(v,b),D=Nu(b,b),B=Nu(k,v),O=Nu(k,b),j=I*D-M*M,H=(D*B-M*O)/j,Y=(I*O-M*B)/j,oe=o.z*(1-H-Y)+h.z*H+m.z*Y;if(isFinite(oe))return oe}return 1/0}{let n=1/0;for(const o of e)n=Math.min(n,o.z);return n}}const Q1=er([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ew}=Q1,tw=er([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:rw}=tw,iw=ha.VectorTileFeature.types,nw=Math.cos(Math.PI/180*37.5),dy=Math.pow(2,14)/.5;class Wp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new ut,this.layoutVertexArray2=new Je,this.indexArray=new Nr,this.programConfigurations=new Vn(e.layers,e.zoom),this.segments=new Wt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,o){this.hasPattern=jp("line",this.layers,n);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),y=[];for(const{feature:v,id:b,index:k,sourceLayerIndex:I}of e){const M=this.layers[0]._featureFilter.needGeometry,D=ao(v,M);if(!this.layers[0]._featureFilter.filter(new Gt(this.zoom),D,o))continue;const B=m?h.evaluate(D,{},o):void 0,O={id:b,properties:v.properties,type:v.type,sourceLayerIndex:I,index:k,geometry:M?D.geometry:so(v),patterns:{},sortKey:B};y.push(O)}m&&y.sort((v,b)=>v.sortKey-b.sortKey);for(const v of y){const{geometry:b,index:k,sourceLayerIndex:I}=v;if(this.hasPattern){const M=$p("line",this.layers,v,this.zoom,n);this.patternFeatures.push(M)}else this.addFeature(v,b,k,o,{});n.featureIndex.insert(e[k].feature,b,k,I,this.index)}}update(e,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,o)}addFeatures(e,n,o){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,n,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,rw)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ew),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,o,h,m){const y=this.layers[0].layout,v=y.get("line-join").evaluate(e,{}),b=y.get("line-cap"),k=y.get("line-miter-limit"),I=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const M of n)this.addLine(M,e,v,b,k,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,m,h)}addLine(e,n,o,h,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Y=0;Y<e.length-1;Y++)this.totalDistance+=e[Y].dist(e[Y+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=iw[n.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let k=0;for(;k<b-1&&e[k].equals(e[k+1]);)k++;if(b<(v?3:2))return;o==="bevel"&&(m=1.05);const I=this.overscaling<=16?15*xr/(512*this.overscaling):0,M=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let D,B,O,j,H;this.e1=this.e2=-1,v&&(D=e[b-2],H=e[k].sub(D)._unit()._perp());for(let Y=k;Y<b;Y++){if(O=Y===b-1?v?e[k+1]:void 0:e[Y+1],O&&e[Y].equals(O))continue;H&&(j=H),D&&(B=D),D=e[Y],H=O?O.sub(D)._unit()._perp():j,j=j||H;let oe=j.add(H);oe.x===0&&oe.y===0||oe._unit();const Q=j.x*H.x+j.y*H.y,ue=oe.x*H.x+oe.y*H.y,fe=ue!==0?1/ue:1/0,we=2*Math.sqrt(2-2*ue),je=ue<nw&&B&&O,Ke=j.x*H.y-j.y*H.x>0;if(je&&Y>k){const Ae=D.dist(B);if(Ae>2*I){const qe=D.sub(D.sub(B)._mult(I/Ae)._round());this.updateDistance(B,qe),this.addCurrentVertex(qe,j,0,0,M),B=qe}}const Ve=B&&O;let Oe=Ve?o:v?"butt":h;if(Ve&&Oe==="round"&&(fe<y?Oe="miter":fe<=2&&(Oe="fakeround")),Oe==="miter"&&fe>m&&(Oe="bevel"),Oe==="bevel"&&(fe>2&&(Oe="flipbevel"),fe<m&&(Oe="miter")),B&&this.updateDistance(B,D),Oe==="miter")oe._mult(fe),this.addCurrentVertex(D,oe,0,0,M);else if(Oe==="flipbevel"){if(fe>100)oe=H.mult(-1);else{const Ae=fe*j.add(H).mag()/j.sub(H).mag();oe._perp()._mult(Ae*(Ke?-1:1))}this.addCurrentVertex(D,oe,0,0,M),this.addCurrentVertex(D,oe.mult(-1),0,0,M)}else if(Oe==="bevel"||Oe==="fakeround"){const Ae=-Math.sqrt(fe*fe-1),qe=Ke?Ae:0,Re=Ke?0:Ae;if(B&&this.addCurrentVertex(D,j,qe,Re,M),Oe==="fakeround"){const Ee=Math.round(180*we/Math.PI/20);for(let st=1;st<Ee;st++){let Qe=st/Ee;if(Qe!==.5){const Ht=Qe-.5;Qe+=Qe*Ht*(Qe-1)*((1.0904+Q*(Q*(3.55645-1.43519*Q)-3.2452))*Ht*Ht+(.848013+Q*(.215638*Q-1.06021)))}const _t=H.sub(j)._mult(Qe)._add(j)._unit()._mult(Ke?-1:1);this.addHalfVertex(D,_t.x,_t.y,!1,Ke,0,M)}}O&&this.addCurrentVertex(D,H,-qe,-Re,M)}else if(Oe==="butt")this.addCurrentVertex(D,oe,0,0,M);else if(Oe==="square"){const Ae=B?1:-1;this.addCurrentVertex(D,oe,Ae,Ae,M)}else Oe==="round"&&(B&&(this.addCurrentVertex(D,j,0,0,M),this.addCurrentVertex(D,j,1,1,M,!0)),O&&(this.addCurrentVertex(D,H,-1,-1,M,!0),this.addCurrentVertex(D,H,0,0,M)));if(je&&Y<b-1){const Ae=D.dist(O);if(Ae>2*I){const qe=D.add(O.sub(D)._mult(I/Ae)._round());this.updateDistance(D,qe),this.addCurrentVertex(qe,H,0,0,M),D=qe}}}}addCurrentVertex(e,n,o,h,m,y=!1){const v=n.y*h-n.x,b=-n.y-n.x*h;this.addHalfVertex(e,n.x+n.y*o,n.y-n.x*o,y,!1,o,m),this.addHalfVertex(e,v,b,y,!0,-h,m),this.distance>dy/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,n,o,h,m,y))}addHalfVertex({x:e,y:n},o,h,m,y,v,b){const k=.5*(this.lineClips?this.scaledDistance*(dy-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(n<<1)+(y?1:0),Math.round(63*o)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const I=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),b.primitiveLength++),y?this.e2=I:this.e1=I}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}let py,fy;Ze("LineBucket",Wp,{omit:["layers","patternFeatures"]});var my={get paint(){return fy=fy||new pr({"line-opacity":new lt(ye.paint_line["line-opacity"]),"line-color":new lt(ye.paint_line["line-color"]),"line-translate":new tt(ye.paint_line["line-translate"]),"line-translate-anchor":new tt(ye.paint_line["line-translate-anchor"]),"line-width":new lt(ye.paint_line["line-width"]),"line-gap-width":new lt(ye.paint_line["line-gap-width"]),"line-offset":new lt(ye.paint_line["line-offset"]),"line-blur":new lt(ye.paint_line["line-blur"]),"line-dasharray":new bu(ye.paint_line["line-dasharray"]),"line-pattern":new ro(ye.paint_line["line-pattern"]),"line-gradient":new Su(ye.paint_line["line-gradient"])})},get layout(){return py=py||new pr({"line-cap":new tt(ye.layout_line["line-cap"]),"line-join":new lt(ye.layout_line["line-join"]),"line-miter-limit":new tt(ye.layout_line["line-miter-limit"]),"line-round-limit":new tt(ye.layout_line["line-round-limit"]),"line-sort-key":new lt(ye.layout_line["line-sort-key"])})}};class sw extends lt{possiblyEvaluate(e,n){return n=new Gt(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(e,n)}evaluate(e,n,o,h){return n=We({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(e,n,o,h)}}let Rh;class aw extends Wi{constructor(e){super(e,my),this.gradientVersion=0,Rh||(Rh=new sw(my.paint.properties["line-width"].specification),Rh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(o){return o._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof ss,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,n){super.recalculate(e,n),this.paint._values["line-floorwidth"]=Rh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Wp(e)}queryRadius(e){const n=e,o=gy(Mu("line-width",this,n),Mu("line-gap-width",this,n)),h=Mu("line-offset",this,n);return o/2+Math.abs(h)+Ch(this.paint.get("line-translate"))}queryIntersectsFeature(e,n,o,h,m,y,v){const b=Ph(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,v),k=v/2*gy(this.paint.get("line-width").evaluate(n,o),this.paint.get("line-gap-width").evaluate(n,o)),I=this.paint.get("line-offset").evaluate(n,o);return I&&(h=function(M,D){const B=[];for(let O=0;O<M.length;O++){const j=M[O],H=[];for(let Y=0;Y<j.length;Y++){const oe=j[Y-1],Q=j[Y],ue=j[Y+1],fe=Y===0?new ie(0,0):Q.sub(oe)._unit()._perp(),we=Y===j.length-1?new ie(0,0):ue.sub(Q)._unit()._perp(),je=fe._add(we)._unit(),Ke=je.x*we.x+je.y*we.y;Ke!==0&&je._mult(1/Ke),H.push(je._mult(D)._add(Q))}B.push(H)}return B}(h,I*v)),function(M,D,B){for(let O=0;O<D.length;O++){const j=D[O];if(M.length>=3){for(let H=0;H<j.length;H++)if(rl(M,j[H]))return!0}if(d1(M,j,B))return!0}return!1}(b,h,k)}isTileClipped(){return!0}}function gy(i,e){return e>0?e+2*i:i}const ow=er([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),lw=er([{name:"a_projected_pos",components:3,type:"Float32"}],4);er([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const uw=er([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);er([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const yy=er([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),cw=er([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function hw(i,e,n){return i.sections.forEach(o=>{o.text=function(h,m,y){const v=m.layout.get("text-transform").evaluate(y,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),zi.applyArabicShaping&&(h=zi.applyArabicShaping(h)),h}(o.text,e,n)}),i}er([{name:"triangle",components:3,type:"Uint16"}]),er([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),er([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),er([{type:"Float32",name:"offsetX"}]),er([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),er([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Vu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var kr=24,_y=Nt,vy=function(i,e,n,o,h){var m,y,v=8*h-o-1,b=(1<<v)-1,k=b>>1,I=-7,M=h-1,D=-1,B=i[e+M];for(M+=D,m=B&(1<<-I)-1,B>>=-I,I+=v;I>0;m=256*m+i[e+M],M+=D,I-=8);for(y=m&(1<<-I)-1,m>>=-I,I+=o;I>0;y=256*y+i[e+M],M+=D,I-=8);if(m===0)m=1-k;else{if(m===b)return y?NaN:1/0*(B?-1:1);y+=Math.pow(2,o),m-=k}return(B?-1:1)*y*Math.pow(2,m-o)},xy=function(i,e,n,o,h,m){var y,v,b,k=8*m-h-1,I=(1<<k)-1,M=I>>1,D=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=0,O=1,j=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,y=I):(y=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-y))<1&&(y--,b*=2),(e+=y+M>=1?D/b:D*Math.pow(2,1-M))*b>=2&&(y++,b/=2),y+M>=I?(v=0,y=I):y+M>=1?(v=(e*b-1)*Math.pow(2,h),y+=M):(v=e*Math.pow(2,M-1)*Math.pow(2,h),y=0));h>=8;i[n+B]=255&v,B+=O,v/=256,h-=8);for(y=y<<h|v,k+=h;k>0;i[n+B]=255&y,B+=O,y/=256,k-=8);i[n+B-O]|=128*j};function Nt(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Nt.Varint=0,Nt.Fixed64=1,Nt.Bytes=2,Nt.Fixed32=5;var Hp=4294967296,wy=1/Hp,by=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ls(i){return i.type===Nt.Bytes?i.readVarint()+i.pos:i.pos+1}function al(i,e,n){return n?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function Sy(i,e,n){var o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(o);for(var h=n.pos-1;h>=i;h--)n.buf[h+o]=n.buf[h]}function dw(i,e){for(var n=0;n<i.length;n++)e.writeVarint(i[n])}function pw(i,e){for(var n=0;n<i.length;n++)e.writeSVarint(i[n])}function fw(i,e){for(var n=0;n<i.length;n++)e.writeFloat(i[n])}function mw(i,e){for(var n=0;n<i.length;n++)e.writeDouble(i[n])}function gw(i,e){for(var n=0;n<i.length;n++)e.writeBoolean(i[n])}function yw(i,e){for(var n=0;n<i.length;n++)e.writeFixed32(i[n])}function _w(i,e){for(var n=0;n<i.length;n++)e.writeSFixed32(i[n])}function vw(i,e){for(var n=0;n<i.length;n++)e.writeFixed64(i[n])}function xw(i,e){for(var n=0;n<i.length;n++)e.writeSFixed64(i[n])}function Bh(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function ol(i,e,n){i[n]=e,i[n+1]=e>>>8,i[n+2]=e>>>16,i[n+3]=e>>>24}function Ty(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}Nt.prototype={destroy:function(){this.buf=null},readFields:function(i,e,n){for(n=n||this.length;this.pos<n;){var o=this.readVarint(),h=o>>3,m=this.pos;this.type=7&o,i(h,e,this),this.pos===m&&this.skip(o)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=Bh(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Ty(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Bh(this.buf,this.pos)+Bh(this.buf,this.pos+4)*Hp;return this.pos+=8,i},readSFixed64:function(){var i=Bh(this.buf,this.pos)+Ty(this.buf,this.pos+4)*Hp;return this.pos+=8,i},readFloat:function(){var i=vy(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=vy(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,n,o=this.buf;return e=127&(n=o[this.pos++]),n<128?e:(e|=(127&(n=o[this.pos++]))<<7,n<128?e:(e|=(127&(n=o[this.pos++]))<<14,n<128?e:(e|=(127&(n=o[this.pos++]))<<21,n<128?e:function(h,m,y){var v,b,k=y.buf;if(v=(112&(b=k[y.pos++]))>>4,b<128||(v|=(127&(b=k[y.pos++]))<<3,b<128)||(v|=(127&(b=k[y.pos++]))<<10,b<128)||(v|=(127&(b=k[y.pos++]))<<17,b<128)||(v|=(127&(b=k[y.pos++]))<<24,b<128)||(v|=(1&(b=k[y.pos++]))<<31,b<128))return al(h,v,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=o[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&by?function(n,o,h){return by.decode(n.subarray(o,h))}(this.buf,e,i):function(n,o,h){for(var m="",y=o;y<h;){var v,b,k,I=n[y],M=null,D=I>239?4:I>223?3:I>191?2:1;if(y+D>h)break;D===1?I<128&&(M=I):D===2?(192&(v=n[y+1]))==128&&(M=(31&I)<<6|63&v)<=127&&(M=null):D===3?(b=n[y+2],(192&(v=n[y+1]))==128&&(192&b)==128&&((M=(15&I)<<12|(63&v)<<6|63&b)<=2047||M>=55296&&M<=57343)&&(M=null)):D===4&&(b=n[y+2],k=n[y+3],(192&(v=n[y+1]))==128&&(192&b)==128&&(192&k)==128&&((M=(15&I)<<18|(63&v)<<12|(63&b)<<6|63&k)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,D=1):M>65535&&(M-=65536,m+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),m+=String.fromCharCode(M),y+=D}return m}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==Nt.Bytes)return i.push(this.readVarint(e));var n=Ls(this);for(i=i||[];this.pos<n;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==Nt.Bytes)return i.push(this.readSVarint());var e=Ls(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Nt.Bytes)return i.push(this.readBoolean());var e=Ls(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Nt.Bytes)return i.push(this.readFloat());var e=Ls(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Nt.Bytes)return i.push(this.readDouble());var e=Ls(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Nt.Bytes)return i.push(this.readFixed32());var e=Ls(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Nt.Bytes)return i.push(this.readSFixed32());var e=Ls(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Nt.Bytes)return i.push(this.readFixed64());var e=Ls(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Nt.Bytes)return i.push(this.readSFixed64());var e=Ls(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===Nt.Varint)for(;this.buf[this.pos++]>127;);else if(e===Nt.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Nt.Fixed32)this.pos+=4;else{if(e!==Nt.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),ol(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),ol(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),ol(this.buf,-1&i,this.pos),ol(this.buf,Math.floor(i*wy),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),ol(this.buf,-1&i,this.pos),ol(this.buf,Math.floor(i*wy),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,n){var o,h;if(e>=0?(o=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(o=~(-e%4294967296))?o=o+1|0:(o=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(m,y,v){v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,v.buf[v.pos]=127&(m>>>=7)}(o,0,n),function(m,y){var v=(7&m)<<4;y.buf[y.pos++]|=v|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(h,n)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(o,h,m){for(var y,v,b=0;b<h.length;b++){if((y=h.charCodeAt(b))>55295&&y<57344){if(!v){y>56319||b+1===h.length?(o[m++]=239,o[m++]=191,o[m++]=189):v=y;continue}if(y<56320){o[m++]=239,o[m++]=191,o[m++]=189,v=y;continue}y=v-55296<<10|y-56320|65536,v=null}else v&&(o[m++]=239,o[m++]=191,o[m++]=189,v=null);y<128?o[m++]=y:(y<2048?o[m++]=y>>6|192:(y<65536?o[m++]=y>>12|224:(o[m++]=y>>18|240,o[m++]=y>>12&63|128),o[m++]=y>>6&63|128),o[m++]=63&y|128)}return m}(this.buf,i,this.pos);var n=this.pos-e;n>=128&&Sy(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(i){this.realloc(4),xy(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),xy(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=i[n]},writeRawMessage:function(i,e){this.pos++;var n=this.pos;i(e,this);var o=this.pos-n;o>=128&&Sy(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeMessage:function(i,e,n){this.writeTag(i,Nt.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,dw,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,pw,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,gw,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,fw,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,mw,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,yw,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,_w,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,vw,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,xw,e)},writeBytesField:function(i,e){this.writeTag(i,Nt.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,Nt.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,Nt.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,Nt.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,Nt.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,Nt.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,Nt.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,Nt.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,Nt.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,Nt.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,!!e)}};var Xp=F(_y);const Kp=3;function ww(i,e,n){i===1&&n.readMessage(bw,e)}function bw(i,e,n){if(i===3){const{id:o,bitmap:h,width:m,height:y,left:v,top:b,advance:k}=n.readMessage(Sw,{});e.push({id:o,bitmap:new Du({width:m+2*Kp,height:y+2*Kp},h),metrics:{width:m,height:y,left:v,top:b,advance:k}})}}function Sw(i,e,n){i===1?e.id=n.readVarint():i===2?e.bitmap=n.readBytes():i===3?e.width=n.readVarint():i===4?e.height=n.readVarint():i===5?e.left=n.readSVarint():i===6?e.top=n.readSVarint():i===7&&(e.advance=n.readVarint())}const ky=Kp;function Ey(i){let e=0,n=0;for(const y of i)e+=y.w*y.h,n=Math.max(n,y.w);i.sort((y,v)=>v.h-y.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let h=0,m=0;for(const y of i)for(let v=o.length-1;v>=0;v--){const b=o[v];if(!(y.w>b.w||y.h>b.h)){if(y.x=b.x,y.y=b.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===b.w&&y.h===b.h){const k=o.pop();v<o.length&&(o[v]=k)}else y.h===b.h?(b.x+=y.w,b.w-=y.w):y.w===b.w?(b.y+=y.h,b.h-=y.h):(o.push({x:b.x+y.w,y:b.y,w:b.w-y.w,h:y.h}),b.y+=y.h,b.h-=y.h);break}}return{w:h,h:m,fill:e/(h*m)||0}}const Ai=1;class Yp{constructor(e,{pixelRatio:n,version:o,stretchX:h,stretchY:m,content:y}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=h,this.stretchY=m,this.content=y,this.version=o}get tl(){return[this.paddedRect.x+Ai,this.paddedRect.y+Ai]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ai,this.paddedRect.y+this.paddedRect.h-Ai]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ai)/this.pixelRatio,(this.paddedRect.h-2*Ai)/this.pixelRatio]}}class Iy{constructor(e,n){const o={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,o,m),this.addImages(n,h,m);const{w:y,h:v}=Ey(m),b=new sn({width:y||1,height:v||1});for(const k in e){const I=e[k],M=o[k].paddedRect;sn.copy(I.data,b,{x:0,y:0},{x:M.x+Ai,y:M.y+Ai},I.data)}for(const k in n){const I=n[k],M=h[k].paddedRect,D=M.x+Ai,B=M.y+Ai,O=I.data.width,j=I.data.height;sn.copy(I.data,b,{x:0,y:0},{x:D,y:B},I.data),sn.copy(I.data,b,{x:0,y:j-1},{x:D,y:B-1},{width:O,height:1}),sn.copy(I.data,b,{x:0,y:0},{x:D,y:B+j},{width:O,height:1}),sn.copy(I.data,b,{x:O-1,y:0},{x:D-1,y:B},{width:1,height:j}),sn.copy(I.data,b,{x:0,y:0},{x:D+O,y:B},{width:1,height:j})}this.image=b,this.iconPositions=o,this.patternPositions=h}addImages(e,n,o){for(const h in e){const m=e[h],y={x:0,y:0,w:m.data.width+2*Ai,h:m.data.height+2*Ai};o.push(y),n[h]=new Yp(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,n){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in e.updatedImages)this.patchUpdatedImage(this.iconPositions[o],e.getImage(o),n),this.patchUpdatedImage(this.patternPositions[o],e.getImage(o),n)}patchUpdatedImage(e,n,o){if(!e||!n||e.version===n.version)return;e.version=n.version;const[h,m]=e.tl;o.update(n.data,void 0,{x:h,y:m})}}var da;Ze("ImagePosition",Yp),Ze("ImageAtlas",Iy),l.ai=void 0,(da=l.ai||(l.ai={}))[da.none=0]="none",da[da.horizontal=1]="horizontal",da[da.vertical=2]="vertical",da[da.horizontalOnly=3]="horizontalOnly";const Uu=-17;class ju{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const o=new ju;return o.scale=e||1,o.fontStack=n,o}static forImage(e){const n=new ju;return n.imageName=e,n}}class ll{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const o=new ll;for(let h=0;h<e.sections.length;h++){const m=e.sections[h];m.image?o.addImageSection(m):o.addTextSection(m,n)}return o}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let n="";for(let o=0;o<e.length;o++){const h=e.charCodeAt(o+1)||null,m=e.charCodeAt(o-1)||null;n+=h&&yh(h)&&!Vu[e[o+1]]||m&&yh(m)&&!Vu[e[o-1]]||!Vu[e[o]]?e[o]:Vu[e[o]]}return n}(this.text)}trim(){let e=0;for(let o=0;o<this.text.length&&Oh[this.text.charCodeAt(o)];o++)e++;let n=this.text.length;for(let o=this.text.length-1;o>=0&&o>=e&&Oh[this.text.charCodeAt(o)];o--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const o=new ll;return o.text=this.text.substring(e,n),o.sectionIndex=this.sectionIndex.slice(e,n),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(ju.forText(e.scale,e.fontStack||n));const o=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(o)}addImageSection(e){const n=e.image?e.image.name:"";if(n.length===0)return void Dr("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(ju.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Dr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Fh(i,e,n,o,h,m,y,v,b,k,I,M,D,B,O,j){const H=ll.fromFeature(i,h);let Y;M===l.ai.vertical&&H.verticalizePunctuation();const{processBidirectionalText:oe,processStyledBidirectionalText:Q}=zi;if(oe&&H.sections.length===1){Y=[];const we=oe(H.toString(),Jp(H,k,m,e,o,B,O));for(const je of we){const Ke=new ll;Ke.text=je,Ke.sections=H.sections;for(let Ve=0;Ve<je.length;Ve++)Ke.sectionIndex.push(0);Y.push(Ke)}}else if(Q){Y=[];const we=Q(H.text,H.sectionIndex,Jp(H,k,m,e,o,B,O));for(const je of we){const Ke=new ll;Ke.text=je[0],Ke.sectionIndex=je[1],Ke.sections=H.sections,Y.push(Ke)}}else Y=function(we,je){const Ke=[],Ve=we.text;let Oe=0;for(const Ae of je)Ke.push(we.substring(Oe,Ae)),Oe=Ae;return Oe<Ve.length&&Ke.push(we.substring(Oe,Ve.length)),Ke}(H,Jp(H,k,m,e,o,B,O));const ue=[],fe={positionedLines:ue,text:H.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:M,iconsInText:!1,verticalizable:!1};return function(we,je,Ke,Ve,Oe,Ae,qe,Re,Ee,st,Qe,_t){let Ht=0,Kt=Uu,Er=0,Xi=0;const yi=Re==="right"?1:Re==="left"?0:.5;let wr=0;for(const Ir of Oe){Ir.trim();const Cr=Ir.getMaxScale(),ii=(Cr-1)*kr,xi={positionedGlyphs:[],lineOffset:0};we.positionedLines[wr]=xi;const ni=xi.positionedGlyphs;let Di=0;if(!Ir.length()){Kt+=Ae,++wr;continue}for(let Pr=0;Pr<Ir.length();Pr++){const bt=Ir.getSection(Pr),si=Ir.getSectionIndex(Pr),Kr=Ir.getCharCode(Pr);let zr=0,Tn=null,Un=null,jn=null,Rs=kr;const kn=!(Ee===l.ai.horizontal||!Qe&&!fu(Kr)||Qe&&(Oh[Kr]||(Ur=Kr,Ue.Arabic(Ur)||Ue["Arabic Supplement"](Ur)||Ue["Arabic Extended-A"](Ur)||Ue["Arabic Presentation Forms-A"](Ur)||Ue["Arabic Presentation Forms-B"](Ur))));if(bt.imageName){const on=Ve[bt.imageName];if(!on)continue;jn=bt.imageName,we.iconsInText=we.iconsInText||!0,Un=on.paddedRect;const Ri=on.displaySize;bt.scale=bt.scale*kr/_t,Tn={width:Ri[0],height:Ri[1],left:Ai,top:-ky,advance:kn?Ri[1]:Ri[0]},zr=ii+(kr-Ri[1]*bt.scale),Rs=Tn.advance;const Bs=kn?Ri[0]*bt.scale-kr*Cr:Ri[1]*bt.scale-kr*Cr;Bs>0&&Bs>Di&&(Di=Bs)}else{const on=Ke[bt.fontStack],Ri=on&&on[Kr];if(Ri&&Ri.rect)Un=Ri.rect,Tn=Ri.metrics;else{const Bs=je[bt.fontStack],Wu=Bs&&Bs[Kr];if(!Wu)continue;Tn=Wu.metrics}zr=(Cr-bt.scale)*kr}kn?(we.verticalizable=!0,ni.push({glyph:Kr,imageName:jn,x:Ht,y:Kt+zr,vertical:kn,scale:bt.scale,fontStack:bt.fontStack,sectionIndex:si,metrics:Tn,rect:Un}),Ht+=Rs*bt.scale+st):(ni.push({glyph:Kr,imageName:jn,x:Ht,y:Kt+zr,vertical:kn,scale:bt.scale,fontStack:bt.fontStack,sectionIndex:si,metrics:Tn,rect:Un}),Ht+=Tn.advance*bt.scale+st)}ni.length!==0&&(Er=Math.max(Ht-st,Er),Ew(ni,0,ni.length-1,yi,Di)),Ht=0;const Li=Ae*Cr+Di;xi.lineOffset=Math.max(Di,ii),Kt+=Li,Xi=Math.max(Li,Xi),++wr}var Ur;const Xr=Kt-Uu,{horizontalAlign:_i,verticalAlign:vi}=Qp(qe);(function(Ir,Cr,ii,xi,ni,Di,Li,Pr,bt){const si=(Cr-ii)*ni;let Kr=0;Kr=Di!==Li?-Pr*xi-Uu:(-xi*bt+.5)*Li;for(const zr of Ir)for(const Tn of zr.positionedGlyphs)Tn.x+=si,Tn.y+=Kr})(we.positionedLines,yi,_i,vi,Er,Xi,Ae,Xr,Oe.length),we.top+=-vi*Xr,we.bottom=we.top+Xr,we.left+=-_i*Er,we.right=we.left+Er}(fe,e,n,o,Y,y,v,b,M,k,D,j),!function(we){for(const je of we)if(je.positionedGlyphs.length!==0)return!1;return!0}(ue)&&fe}const Oh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Tw={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Cy(i,e,n,o,h,m){if(e.imageName){const y=o[e.imageName];return y?y.displaySize[0]*e.scale*kr/m+h:0}{const y=n[e.fontStack],v=y&&y[i];return v?v.metrics.advance*e.scale+h:0}}function Py(i,e,n,o){const h=Math.pow(i-e,2);return o?i<e?h/2:2*h:h+Math.abs(n)*n}function kw(i,e,n){let o=0;return i===10&&(o-=1e4),n&&(o+=150),i!==40&&i!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function zy(i,e,n,o,h,m){let y=null,v=Py(e,n,h,m);for(const b of o){const k=Py(e-b.x,n,h,m)+b.badness;k<=v&&(y=b,v=k)}return{index:i,x:e,priorBreak:y,badness:v}}function My(i){return i?My(i.priorBreak).concat(i.index):[]}function Jp(i,e,n,o,h,m,y){if(m!=="point")return[];if(!i)return[];const v=[],b=function(D,B,O,j,H,Y){let oe=0;for(let Q=0;Q<D.length();Q++){const ue=D.getSection(Q);oe+=Cy(D.getCharCode(Q),ue,j,H,B,Y)}return oe/Math.max(1,Math.ceil(oe/O))}(i,e,n,o,h,y),k=i.text.indexOf("")>=0;let I=0;for(let D=0;D<i.length();D++){const B=i.getSection(D),O=i.getCharCode(D);if(Oh[O]||(I+=Cy(O,B,o,h,e,y)),D<i.length()-1){const j=!((M=O)<11904||!(Ue["Bopomofo Extended"](M)||Ue.Bopomofo(M)||Ue["CJK Compatibility Forms"](M)||Ue["CJK Compatibility Ideographs"](M)||Ue["CJK Compatibility"](M)||Ue["CJK Radicals Supplement"](M)||Ue["CJK Strokes"](M)||Ue["CJK Symbols and Punctuation"](M)||Ue["CJK Unified Ideographs Extension A"](M)||Ue["CJK Unified Ideographs"](M)||Ue["Enclosed CJK Letters and Months"](M)||Ue["Halfwidth and Fullwidth Forms"](M)||Ue.Hiragana(M)||Ue["Ideographic Description Characters"](M)||Ue["Kangxi Radicals"](M)||Ue["Katakana Phonetic Extensions"](M)||Ue.Katakana(M)||Ue["Vertical Forms"](M)||Ue["Yi Radicals"](M)||Ue["Yi Syllables"](M)));(Tw[O]||j||B.imageName)&&v.push(zy(D+1,I,b,v,kw(O,i.getCharCode(D+1),j&&k),!1))}}var M;return My(zy(i.length(),I,b,v,0,!0))}function Qp(i){let e=.5,n=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Ew(i,e,n,o,h){if(!o&&!h)return;const m=i[n],y=(i[n].x+m.metrics.advance*m.scale)*o;for(let v=e;v<=n;v++)i[v].x-=y,i[v].y+=h}function Iw(i,e,n){const{horizontalAlign:o,verticalAlign:h}=Qp(n),m=e[0]-i.displaySize[0]*o,y=e[1]-i.displaySize[1]*h;return{image:i,top:y,bottom:y+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function Ay(i,e,n,o,h,m){const y=i.image;let v;if(y.content){const H=y.content,Y=y.pixelRatio||1;v=[H[0]/Y,H[1]/Y,y.displaySize[0]-H[2]/Y,y.displaySize[1]-H[3]/Y]}const b=e.left*m,k=e.right*m;let I,M,D,B;n==="width"||n==="both"?(B=h[0]+b-o[3],M=h[0]+k+o[1]):(B=h[0]+(b+k-y.displaySize[0])/2,M=B+y.displaySize[0]);const O=e.top*m,j=e.bottom*m;return n==="height"||n==="both"?(I=h[1]+O-o[0],D=h[1]+j+o[2]):(I=h[1]+(O+j-y.displaySize[1])/2,D=I+y.displaySize[1]),{image:y,top:I,right:M,bottom:D,left:B,collisionPadding:v}}const $u=255,hs=128,pa=$u*hs;function Dy(i,e){const{expression:n}=e;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Gt(i+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:h}=n;let m=0;for(;m<o.length&&o[m]<=i;)m++;m=Math.max(0,m-1);let y=m;for(;y<o.length&&o[y]<i+1;)y++;y=Math.min(o.length-1,y);const v=o[m],b=o[y];return n.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:b,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:b,minSize:n.evaluate(new Gt(v)),maxSize:n.evaluate(new Gt(b)),interpolationType:h}}}function ef(i,e,n){let o="never";const h=i.get(e);return h?o=h:i.get(n)&&(o="always"),o}const Cw=ha.VectorTileFeature.types,Pw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Nh(i,e,n,o,h,m,y,v,b,k,I,M,D){const B=v?Math.min(pa,Math.round(v[0])):0,O=v?Math.min(pa,Math.round(v[1])):0;i.emplaceBack(e,n,Math.round(32*o),Math.round(32*h),m,y,(B<<1)+(b?1:0),O,16*k,16*I,256*M,256*D)}function tf(i,e,n){i.emplaceBack(e.x,e.y,n),i.emplaceBack(e.x,e.y,n),i.emplaceBack(e.x,e.y,n),i.emplaceBack(e.x,e.y,n)}function zw(i){for(const e of i.sections)if(Ip(e.text))return!0;return!1}class rf{constructor(e){this.layoutVertexArray=new vt,this.indexArray=new Nr,this.programConfigurations=e,this.segments=new Wt,this.dynamicLayoutVertexArray=new mt,this.opacityVertexArray=new wt,this.hasVisibleVertices=!1,this.placedSymbolArray=new ne}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,n,o,h){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ow.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,lw.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Pw,!0),this.opacityVertexBuffer.itemSize=1),(o||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ze("SymbolBuffers",rf);class nf{constructor(e,n,o){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new o,this.segments=new Wt,this.collisionVertexArray=new $t}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,uw.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ze("CollisionBuffers",nf);class ul{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Lp([]),this.placementViewportMatrix=Lp([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Dy(this.zoom,n["text-size"]),this.iconSizeData=Dy(this.zoom,n["icon-size"]);const o=this.layers[0].layout,h=o.get("symbol-sort-key"),m=o.get("symbol-z-order");this.canOverlap=ef(o,"text-overlap","text-allow-overlap")!=="never"||ef(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map(y=>l.ai[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID}createArrays(){this.text=new rf(new Vn(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new rf(new Vn(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new se,this.lineVertexArray=new me,this.symbolInstances=new K,this.textAnchorOffsets=new xe}calculateGlyphDependencies(e,n,o,h,m){for(let y=0;y<e.length;y++)if(n[e.charCodeAt(y)]=!0,(o||h)&&m){const v=Vu[e.charAt(y)];v&&(n[v.charCodeAt(0)]=!0)}}populate(e,n,o){const h=this.layers[0],m=h.layout,y=m.get("text-font"),v=m.get("text-field"),b=m.get("icon-image"),k=(v.value.kind!=="constant"||v.value.value instanceof Gr&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),I=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,M=m.get("symbol-sort-key");if(this.features=[],!k&&!I)return;const D=n.iconDependencies,B=n.glyphDependencies,O=n.availableImages,j=new Gt(this.zoom);for(const{feature:H,id:Y,index:oe,sourceLayerIndex:Q}of e){const ue=h._featureFilter.needGeometry,fe=ao(H,ue);if(!h._featureFilter.filter(j,fe,o))continue;let we,je;if(ue||(fe.geometry=so(H)),k){const Ve=h.getValueAndResolveTokens("text-field",fe,o,O),Oe=Gr.factory(Ve);zw(Oe)&&(this.hasRTLText=!0),(!this.hasRTLText||xu()==="unavailable"||this.hasRTLText&&zi.isParsed())&&(we=hw(Oe,h,fe))}if(I){const Ve=h.getValueAndResolveTokens("icon-image",fe,o,O);je=Ve instanceof Or?Ve:Or.fromString(Ve)}if(!we&&!je)continue;const Ke=this.sortFeaturesByKey?M.evaluate(fe,{},o):void 0;if(this.features.push({id:Y,text:we,icon:je,index:oe,sourceLayerIndex:Q,geometry:fe.geometry,properties:H.properties,type:Cw[H.type],sortKey:Ke}),je&&(D[je.name]=!0),we){const Ve=y.evaluate(fe,{},o).join(","),Oe=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.ai.vertical)>=0;for(const Ae of we.sections)if(Ae.image)D[Ae.image.name]=!0;else{const qe=du(we.toString()),Re=Ae.fontStack||Ve,Ee=B[Re]=B[Re]||{};this.calculateGlyphDependencies(Ae.text,Ee,Oe,this.allowVerticalPlacement,qe)}}}m.get("symbol-placement")==="line"&&(this.features=function(H){const Y={},oe={},Q=[];let ue=0;function fe(Ve){Q.push(H[Ve]),ue++}function we(Ve,Oe,Ae){const qe=oe[Ve];return delete oe[Ve],oe[Oe]=qe,Q[qe].geometry[0].pop(),Q[qe].geometry[0]=Q[qe].geometry[0].concat(Ae[0]),qe}function je(Ve,Oe,Ae){const qe=Y[Oe];return delete Y[Oe],Y[Ve]=qe,Q[qe].geometry[0].shift(),Q[qe].geometry[0]=Ae[0].concat(Q[qe].geometry[0]),qe}function Ke(Ve,Oe,Ae){const qe=Ae?Oe[0][Oe[0].length-1]:Oe[0][0];return`${Ve}:${qe.x}:${qe.y}`}for(let Ve=0;Ve<H.length;Ve++){const Oe=H[Ve],Ae=Oe.geometry,qe=Oe.text?Oe.text.toString():null;if(!qe){fe(Ve);continue}const Re=Ke(qe,Ae),Ee=Ke(qe,Ae,!0);if(Re in oe&&Ee in Y&&oe[Re]!==Y[Ee]){const st=je(Re,Ee,Ae),Qe=we(Re,Ee,Q[st].geometry);delete Y[Re],delete oe[Ee],oe[Ke(qe,Q[Qe].geometry,!0)]=Qe,Q[st].geometry=null}else Re in oe?we(Re,Ee,Ae):Ee in Y?je(Re,Ee,Ae):(fe(Ve),Y[Re]=ue-1,oe[Ee]=ue-1)}return Q.filter(Ve=>Ve.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((H,Y)=>H.sortKey-Y.sortKey)}update(e,n,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,o),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,o))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const o=this.lineVertexArray.length;if(e.segment!==void 0){let h=e.dist(n[e.segment+1]),m=e.dist(n[e.segment]);const y={};for(let v=e.segment+1;v<n.length;v++)y[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:h},v<n.length-1&&(h+=n[v+1].dist(n[v]));for(let v=e.segment||0;v>=0;v--)y[v]={x:n[v].x,y:n[v].y,tileUnitDistanceFromAnchor:m},v>0&&(m+=n[v-1].dist(n[v]));for(let v=0;v<n.length;v++){const b=y[v];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,n,o,h,m,y,v,b,k,I,M,D){const B=e.indexArray,O=e.layoutVertexArray,j=e.segments.prepareSegment(4*n.length,O,B,this.canOverlap?y.sortKey:void 0),H=this.glyphOffsetArray.length,Y=j.vertexLength,oe=this.allowVerticalPlacement&&v===l.ai.vertical?Math.PI/2:0,Q=y.text&&y.text.sections;for(let ue=0;ue<n.length;ue++){const{tl:fe,tr:we,bl:je,br:Ke,tex:Ve,pixelOffsetTL:Oe,pixelOffsetBR:Ae,minFontScaleX:qe,minFontScaleY:Re,glyphOffset:Ee,isSDF:st,sectionIndex:Qe}=n[ue],_t=j.vertexLength,Ht=Ee[1];Nh(O,b.x,b.y,fe.x,Ht+fe.y,Ve.x,Ve.y,o,st,Oe.x,Oe.y,qe,Re),Nh(O,b.x,b.y,we.x,Ht+we.y,Ve.x+Ve.w,Ve.y,o,st,Ae.x,Oe.y,qe,Re),Nh(O,b.x,b.y,je.x,Ht+je.y,Ve.x,Ve.y+Ve.h,o,st,Oe.x,Ae.y,qe,Re),Nh(O,b.x,b.y,Ke.x,Ht+Ke.y,Ve.x+Ve.w,Ve.y+Ve.h,o,st,Ae.x,Ae.y,qe,Re),tf(e.dynamicLayoutVertexArray,b,oe),B.emplaceBack(_t,_t+1,_t+2),B.emplaceBack(_t+1,_t+2,_t+3),j.vertexLength+=4,j.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ee[0]),ue!==n.length-1&&Qe===n[ue+1].sectionIndex||e.programConfigurations.populatePaintArrays(O.length,y,y.index,{},D,Q&&Q[Qe])}e.placedSymbolArray.emplaceBack(b.x,b.y,H,this.glyphOffsetArray.length-H,Y,k,I,b.segment,o?o[0]:0,o?o[1]:0,h[0],h[1],v,0,!1,0,M)}_addCollisionDebugVertex(e,n,o,h,m,y){return n.emplaceBack(0,0),e.emplaceBack(o.x,o.y,h,m,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(e,n,o,h,m,y,v){const b=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),k=b.vertexLength,I=m.layoutVertexArray,M=m.collisionVertexArray,D=v.anchorX,B=v.anchorY;this._addCollisionDebugVertex(I,M,y,D,B,new ie(e,n)),this._addCollisionDebugVertex(I,M,y,D,B,new ie(o,n)),this._addCollisionDebugVertex(I,M,y,D,B,new ie(o,h)),this._addCollisionDebugVertex(I,M,y,D,B,new ie(e,h)),b.vertexLength+=4;const O=m.indexArray;O.emplaceBack(k,k+1),O.emplaceBack(k+1,k+2),O.emplaceBack(k+2,k+3),O.emplaceBack(k+3,k),b.primitiveLength+=4}addDebugCollisionBoxes(e,n,o,h){for(let m=e;m<n;m++){const y=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new nf(ur,yy.members,Sr),this.iconCollisionBox=new nf(ur,yy.members,Sr);for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(e,n,o,h,m,y,v,b,k){const I={};for(let M=n;M<o;M++){const D=e.get(M);I.textBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},I.textFeatureIndex=D.featureIndex;break}for(let M=h;M<m;M++){const D=e.get(M);I.verticalTextBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},I.verticalTextFeatureIndex=D.featureIndex;break}for(let M=y;M<v;M++){const D=e.get(M);I.iconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},I.iconFeatureIndex=D.featureIndex;break}for(let M=b;M<k;M++){const D=e.get(M);I.verticalIconBox={x1:D.x1,y1:D.y1,x2:D.x2,y2:D.y2,anchorPointX:D.anchorPointX,anchorPointY:D.anchorPointY},I.verticalIconFeatureIndex=D.featureIndex;break}return I}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const o=e.placedSymbolArray.get(n),h=o.vertexStartIndex+4*o.numGlyphs;for(let m=o.vertexStartIndex;m<h;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(e),o=Math.cos(e),h=[],m=[],y=[];for(let v=0;v<this.symbolInstances.length;++v){y.push(v);const b=this.symbolInstances.get(v);h.push(0|Math.round(n*b.anchorX+o*b.anchorY)),m.push(b.featureIndex)}return y.sort((v,b)=>h[v]-h[b]||m[b]-m[v]),y}addToSortKeyRanges(e,n){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===n?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const o=this.symbolInstances.get(n);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((h,m,y)=>{h>=0&&y.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Ly,Ry;Ze("SymbolBucket",ul,{omit:["layers","collisionBoxArray","features","compareText"]}),ul.MAX_GLYPHS=65535,ul.addDynamicAttributes=tf;var sf={get paint(){return Ry=Ry||new pr({"icon-opacity":new lt(ye.paint_symbol["icon-opacity"]),"icon-color":new lt(ye.paint_symbol["icon-color"]),"icon-halo-color":new lt(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new lt(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new lt(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new tt(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new tt(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new lt(ye.paint_symbol["text-opacity"]),"text-color":new lt(ye.paint_symbol["text-color"],{runtimeType:ei,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new lt(ye.paint_symbol["text-halo-color"]),"text-halo-width":new lt(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new lt(ye.paint_symbol["text-halo-blur"]),"text-translate":new tt(ye.paint_symbol["text-translate"]),"text-translate-anchor":new tt(ye.paint_symbol["text-translate-anchor"])})},get layout(){return Ly=Ly||new pr({"symbol-placement":new tt(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new tt(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new tt(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new lt(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new tt(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new tt(ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new tt(ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new tt(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new tt(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new tt(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new lt(ye.layout_symbol["icon-size"]),"icon-text-fit":new tt(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tt(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new lt(ye.layout_symbol["icon-image"]),"icon-rotate":new lt(ye.layout_symbol["icon-rotate"]),"icon-padding":new lt(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new tt(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new lt(ye.layout_symbol["icon-offset"]),"icon-anchor":new lt(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new tt(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new tt(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new tt(ye.layout_symbol["text-rotation-alignment"]),"text-field":new lt(ye.layout_symbol["text-field"]),"text-font":new lt(ye.layout_symbol["text-font"]),"text-size":new lt(ye.layout_symbol["text-size"]),"text-max-width":new lt(ye.layout_symbol["text-max-width"]),"text-line-height":new tt(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new lt(ye.layout_symbol["text-letter-spacing"]),"text-justify":new lt(ye.layout_symbol["text-justify"]),"text-radial-offset":new lt(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new tt(ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new lt(ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new lt(ye.layout_symbol["text-anchor"]),"text-max-angle":new tt(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new tt(ye.layout_symbol["text-writing-mode"]),"text-rotate":new lt(ye.layout_symbol["text-rotate"]),"text-padding":new tt(ye.layout_symbol["text-padding"]),"text-keep-upright":new tt(ye.layout_symbol["text-keep-upright"]),"text-transform":new lt(ye.layout_symbol["text-transform"]),"text-offset":new lt(ye.layout_symbol["text-offset"]),"text-allow-overlap":new tt(ye.layout_symbol["text-allow-overlap"]),"text-overlap":new tt(ye.layout_symbol["text-overlap"]),"text-ignore-placement":new tt(ye.layout_symbol["text-ignore-placement"]),"text-optional":new tt(ye.layout_symbol["text-optional"])})}};class By{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Ln,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ze("FormatSectionOverride",By,{omit:["defaultValue"]});class Vh extends Wi{constructor(e){super(e,sf)}recalculate(e,n){if(super.recalculate(e,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const h=[];for(const m of o)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,n,o,h){const m=this.layout.get(e).evaluate(n,{},o,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||$o(y.value)||!m?m:function(v,b){return b.replace(/{([^{}]+)}/g,(k,I)=>v&&I in v?String(v[I]):"")}(n.properties,m)}createBucket(e){return new ul(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of sf.paint.overridableProperties){if(!Vh.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),o=new By(n),h=new au(o,n.property.specification);let m=null;m=n.value.kind==="constant"||n.value.kind==="source"?new ou("source",h):new qo("composite",h,n.value.zoomStops),this.paint._values[e]=new ti(n.property,m,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,o){return!(!this.layout||n.isDataDriven()||o.isDataDriven())&&Vh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const o=e.get("text-field"),h=sf.paint.properties[n];let m=!1;const y=v=>{for(const b of v)if(h.overrides&&h.overrides.hasOverride(b))return void(m=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Gr)y(o.value.value.sections);else if(o.value.kind==="source"){const v=k=>{m||(k instanceof bs&&Yt(k.value)===q?y(k.value.sections):k instanceof jo?y(k.sections):k.eachChild(v))},b=o.value;b._styleExpression&&v(b._styleExpression.expression)}return m}}let Fy;var Mw={get paint(){return Fy=Fy||new pr({"background-color":new tt(ye.paint_background["background-color"]),"background-pattern":new bu(ye.paint_background["background-pattern"]),"background-opacity":new tt(ye.paint_background["background-opacity"])})}};class Aw extends Wi{constructor(e){super(e,Mw)}}let Oy;var Dw={get paint(){return Oy=Oy||new pr({"raster-opacity":new tt(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new tt(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new tt(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new tt(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new tt(ye.paint_raster["raster-saturation"]),"raster-contrast":new tt(ye.paint_raster["raster-contrast"]),"raster-resampling":new tt(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new tt(ye.paint_raster["raster-fade-duration"])})}};class Lw extends Wi{constructor(e){super(e,Dw)}}class Rw extends Wi{constructor(e){super(e,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Bw{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const af=63710088e-1;class fa{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new fa(it(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,o=this.lat*n,h=e.lat*n,m=Math.sin(o)*Math.sin(h)+Math.cos(o)*Math.cos(h)*Math.cos((e.lng-this.lng)*n);return af*Math.acos(Math.min(m,1))}static convert(e){if(e instanceof fa)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new fa(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new fa(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ny=2*Math.PI*af;function Vy(i){return Ny*Math.cos(i*Math.PI/180)}function Uy(i){return(180+i)/360}function jy(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function $y(i,e){return i/Vy(e)}function Zy(i){return 360*i-180}function of(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Uh{constructor(e,n,o=0){this.x=+e,this.y=+n,this.z=+o}static fromLngLat(e,n=0){const o=fa.convert(e);return new Uh(Uy(o.lng),jy(o.lat),$y(n,o.lat))}toLngLat(){return new fa(Zy(this.x),of(this.y))}toAltitude(){return this.z*Vy(of(this.y))}meterInMercatorCoordinateUnits(){return 1/Ny*(e=of(this.y),1/Math.cos(e*Math.PI/180));var e}}function qy(i,e,n){var o=2*Math.PI*6378137/256/Math.pow(2,n);return[i*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}class lf{constructor(e,n,o){if(e<0||e>25||o<0||o>=Math.pow(2,e)||n<0||n>=Math.pow(2,e))throw new Error(`x=${n}, y=${o}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=n,this.y=o,this.key=Zu(0,e,e,n,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n,o){const h=(y=this.y,v=this.z,b=qy(256*(m=this.x),256*(y=Math.pow(2,v)-y-1),v),k=qy(256*(m+1),256*(y+1),v),b[0]+","+b[1]+","+k[0]+","+k[1]);var m,y,v,b,k;const I=function(M,D,B){let O,j="";for(let H=M;H>0;H--)O=1<<H-1,j+=(D&O?1:0)+(B&O?2:0);return j}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,I).replace(/{bbox-epsg-3857}/g,h)}isChildOf(e){const n=this.z-e.z;return n>0&&e.x===this.x>>n&&e.y===this.y>>n}getTilePoint(e){const n=Math.pow(2,this.z);return new ie((e.x*n-this.x)*xr,(e.y*n-this.y)*xr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Gy{constructor(e,n){this.wrap=e,this.canonical=n,this.key=Zu(e,n.z,n.z,n.x,n.y)}}class an{constructor(e,n,o,h,m){if(e<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${o}`);this.overscaledZ=e,this.wrap=n,this.canonical=new lf(o,+h,+m),this.key=Zu(n,e,o,h,m)}clone(){return new an(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-e;return e>this.canonical.z?new an(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new an(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-e;return e>this.canonical.z?Zu(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):Zu(this.wrap*+n,e,e,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new an(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,o=2*this.canonical.x,h=2*this.canonical.y;return[new an(n,this.wrap,n,o,h),new an(n,this.wrap,n,o+1,h),new an(n,this.wrap,n,o,h+1),new an(n,this.wrap,n,o+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new an(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new an(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Gy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Uh(e.x-this.wrap,e.y))}}function Zu(i,e,n,o,h){(i*=2)<0&&(i=-1*i-1);const m=1<<n;return(m*m*i+m*h+o).toString(36)+n.toString(36)+e.toString(36)}Ze("CanonicalTileID",lf),Ze("OverscaledTileID",an,{omit:["posMatrix"]});class Wy{constructor(e,n,o,h=1,m=1,y=1,v=0){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void Dr(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const b=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=y,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<b;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(b,k)]=this.data[this._idx(b-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,b)]=this.data[this._idx(k,b-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(b,-1)]=this.data[this._idx(b-1,0)],this.data[this._idx(-1,b)]=this.data[this._idx(0,b-1)],this.data[this._idx(b,b)]=this.data[this._idx(b-1,b-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<b;k++)for(let I=0;I<b;I++){const M=this.get(k,I);M>this.max&&(this.max=M),M<this.min&&(this.min=M)}}get(e,n){const o=new Uint8Array(this.data.buffer),h=4*this._idx(e,n);return this.unpack(o[h],o[h+1],o[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}unpack(e,n,o){return e*this.redFactor+n*this.greenFactor+o*this.blueFactor-this.baseShift}getPixels(){return new sn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,n,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,m=n*this.dim+this.dim,y=o*this.dim,v=o*this.dim+this.dim;switch(n){case-1:h=m-1;break;case 1:m=h+1}switch(o){case-1:y=v-1;break;case 1:v=y+1}const b=-n*this.dim,k=-o*this.dim;for(let I=y;I<v;I++)for(let M=h;M<m;M++)this.data[this._idx(M,I)]=e.data[this._idx(M+b,I+k)]}}Ze("DEMData",Wy);class Hy{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const o=e[n];this._stringToNumber[o]=n,this._numberToString[n]=o}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Xy{constructor(e,n,o,h,m){this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=o,e._y=h,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(e[n]=this[n]);return e}}class Ky{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new aa(xr,16,0),this.grid3D=new aa(xr,16,0),this.featureIndexArray=new Se,this.promoteId=n}insert(e,n,o,h,m,y){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,h,m);const b=y?this.grid3D:this.grid;for(let k=0;k<n.length;k++){const I=n[k],M=[1/0,1/0,-1/0,-1/0];for(let D=0;D<I.length;D++){const B=I[D];M[0]=Math.min(M[0],B.x),M[1]=Math.min(M[1],B.y),M[2]=Math.max(M[2],B.x),M[3]=Math.max(M[3],B.y)}M[0]<xr&&M[1]<xr&&M[2]>=0&&M[3]>=0&&b.insert(v,M[0],M[1],M[2],M[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ha.VectorTile(new Xp(this.rawTileData)).layers,this.sourceLayerCoder=new Hy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,n,o,h){this.loadVTLayers();const m=e.params||{},y=xr/e.tileSize/e.scale,v=uu(m.filter),b=e.queryGeometry,k=e.queryPadding*y,I=Jy(b),M=this.grid.query(I.minX-k,I.minY-k,I.maxX+k,I.maxY+k),D=Jy(e.cameraQueryGeometry),B=this.grid3D.query(D.minX-k,D.minY-k,D.maxX+k,D.maxY+k,(H,Y,oe,Q)=>function(ue,fe,we,je,Ke){for(const Oe of ue)if(fe<=Oe.x&&we<=Oe.y&&je>=Oe.x&&Ke>=Oe.y)return!0;const Ve=[new ie(fe,we),new ie(fe,Ke),new ie(je,Ke),new ie(je,we)];if(ue.length>2){for(const Oe of Ve)if(rl(ue,Oe))return!0}for(let Oe=0;Oe<ue.length-1;Oe++)if(f1(ue[Oe],ue[Oe+1],Ve))return!0;return!1}(e.cameraQueryGeometry,H-k,Y-k,oe+k,Q+k));for(const H of B)M.push(H);M.sort(Fw);const O={};let j;for(let H=0;H<M.length;H++){const Y=M[H];if(Y===j)continue;j=Y;const oe=this.featureIndexArray.get(Y);let Q=null;this.loadMatchingFeature(O,oe.bucketIndex,oe.sourceLayerIndex,oe.featureIndex,v,m.layers,m.availableImages,n,o,h,(ue,fe,we)=>(Q||(Q=so(ue)),fe.queryIntersectsFeature(b,ue,we,Q,this.z,e.transform,y,e.pixelPosMatrix)))}return O}loadMatchingFeature(e,n,o,h,m,y,v,b,k,I,M){const D=this.bucketLayerIDs[n];if(y&&!function(H,Y){for(let oe=0;oe<H.length;oe++)if(Y.indexOf(H[oe])>=0)return!0;return!1}(y,D))return;const B=this.sourceLayerCoder.decode(o),O=this.vtLayers[B].feature(h);if(m.needGeometry){const H=ao(O,!0);if(!m.filter(new Gt(this.tileID.overscaledZ),H,this.tileID.canonical))return}else if(!m.filter(new Gt(this.tileID.overscaledZ),O))return;const j=this.getId(O,B);for(let H=0;H<D.length;H++){const Y=D[H];if(y&&y.indexOf(Y)<0)continue;const oe=b[Y];if(!oe)continue;let Q={};j&&I&&(Q=I.getState(oe.sourceLayer||"_geojsonTileLayer",j));const ue=We({},k[Y]);ue.paint=Yy(ue.paint,oe.paint,O,Q,v),ue.layout=Yy(ue.layout,oe.layout,O,Q,v);const fe=!M||M(O,oe,Q);if(!fe)continue;const we=new Xy(O,this.z,this.x,this.y,j);we.layer=ue;let je=e[Y];je===void 0&&(je=e[Y]=[]),je.push({featureIndex:h,feature:we,intersectionZ:fe})}}lookupSymbolFeatures(e,n,o,h,m,y,v,b){const k={};this.loadVTLayers();const I=uu(m);for(const M of e)this.loadMatchingFeature(k,o,h,M,I,y,v,b,n);return k}hasLayer(e){for(const n of this.bucketLayerIDs)for(const o of n)if(e===o)return!0;return!1}getId(e,n){let o=e.id;return this.promoteId&&(o=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof o=="boolean"&&(o=Number(o))),o}}function Yy(i,e,n,o,h){return at(i,(m,y)=>{const v=e instanceof el?e.get(y):null;return v&&v.evaluate?v.evaluate(n,o,h):v})}function Jy(i){let e=1/0,n=1/0,o=-1/0,h=-1/0;for(const m of i)e=Math.min(e,m.x),n=Math.min(n,m.y),o=Math.max(o,m.x),h=Math.max(h,m.y);return{minX:e,minY:n,maxX:o,maxY:h}}function Fw(i,e){return e-i}function Qy(i,e,n,o,h){const m=[];for(let y=0;y<i.length;y++){const v=i[y];let b;for(let k=0;k<v.length-1;k++){let I=v[k],M=v[k+1];I.x<e&&M.x<e||(I.x<e?I=new ie(e,I.y+(e-I.x)/(M.x-I.x)*(M.y-I.y))._round():M.x<e&&(M=new ie(e,I.y+(e-I.x)/(M.x-I.x)*(M.y-I.y))._round()),I.y<n&&M.y<n||(I.y<n?I=new ie(I.x+(n-I.y)/(M.y-I.y)*(M.x-I.x),n)._round():M.y<n&&(M=new ie(I.x+(n-I.y)/(M.y-I.y)*(M.x-I.x),n)._round()),I.x>=o&&M.x>=o||(I.x>=o?I=new ie(o,I.y+(o-I.x)/(M.x-I.x)*(M.y-I.y))._round():M.x>=o&&(M=new ie(o,I.y+(o-I.x)/(M.x-I.x)*(M.y-I.y))._round()),I.y>=h&&M.y>=h||(I.y>=h?I=new ie(I.x+(h-I.y)/(M.y-I.y)*(M.x-I.x),h)._round():M.y>=h&&(M=new ie(I.x+(h-I.y)/(M.y-I.y)*(M.x-I.x),h)._round()),b&&I.equals(b[b.length-1])||(b=[I],m.push(b)),b.push(M)))))}}return m}Ze("FeatureIndex",Ky,{omit:["rawTileData","sourceLayerCoder"]});class ma extends ie{constructor(e,n,o,h){super(e,n),this.angle=o,h!==void 0&&(this.segment=h)}clone(){return new ma(this.x,this.y,this.angle,this.segment)}}function e_(i,e,n,o,h){if(e.segment===void 0||n===0)return!0;let m=e,y=e.segment+1,v=0;for(;v>-n/2;){if(y--,y<0)return!1;v-=i[y].dist(m),m=i[y]}v+=i[y].dist(i[y+1]),y++;const b=[];let k=0;for(;v<n/2;){const I=i[y],M=i[y+1];if(!M)return!1;let D=i[y-1].angleTo(I)-I.angleTo(M);for(D=Math.abs((D+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:v,angleDelta:D}),k+=D;v-b[0].distance>o;)k-=b.shift().angleDelta;if(k>h)return!1;y++,v+=I.dist(M)}return!0}function t_(i){let e=0;for(let n=0;n<i.length-1;n++)e+=i[n].dist(i[n+1]);return e}function r_(i,e,n){return i?.6*e*n:0}function i_(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function Ow(i,e,n,o,h,m){const y=r_(n,h,m),v=i_(n,o)*m;let b=0;const k=t_(i)/2;for(let I=0;I<i.length-1;I++){const M=i[I],D=i[I+1],B=M.dist(D);if(b+B>k){const O=(k-b)/B,j=Ii.number(M.x,D.x,O),H=Ii.number(M.y,D.y,O),Y=new ma(j,H,D.angleTo(M),I);return Y._round(),!y||e_(i,Y,v,y,e)?Y:void 0}b+=B}}function Nw(i,e,n,o,h,m,y,v,b){const k=r_(o,m,y),I=i_(o,h),M=I*y,D=i[0].x===0||i[0].x===b||i[0].y===0||i[0].y===b;return e-M<e/4&&(e=M+e/4),n_(i,D?e/2*v%e:(I/2+2*m)*y*v%e,e,k,n,M,D,!1,b)}function n_(i,e,n,o,h,m,y,v,b){const k=m/2,I=t_(i);let M=0,D=e-n,B=[];for(let O=0;O<i.length-1;O++){const j=i[O],H=i[O+1],Y=j.dist(H),oe=H.angleTo(j);for(;D+n<M+Y;){D+=n;const Q=(D-M)/Y,ue=Ii.number(j.x,H.x,Q),fe=Ii.number(j.y,H.y,Q);if(ue>=0&&ue<b&&fe>=0&&fe<b&&D-k>=0&&D+k<=I){const we=new ma(ue,fe,oe,O);we._round(),o&&!e_(i,we,m,o,h)||B.push(we)}}M+=Y}return v||B.length||y||(B=n_(i,M/2,n,o,h,m,y,!0,b)),B}Ze("Anchor",ma);const cl=Ai;function s_(i,e,n,o){const h=[],m=i.image,y=m.pixelRatio,v=m.paddedRect.w-2*cl,b=m.paddedRect.h-2*cl,k=i.right-i.left,I=i.bottom-i.top,M=m.stretchX||[[0,v]],D=m.stretchY||[[0,b]],B=(Ae,qe)=>Ae+qe[1]-qe[0],O=M.reduce(B,0),j=D.reduce(B,0),H=v-O,Y=b-j;let oe=0,Q=O,ue=0,fe=j,we=0,je=H,Ke=0,Ve=Y;if(m.content&&o){const Ae=m.content;oe=jh(M,0,Ae[0]),ue=jh(D,0,Ae[1]),Q=jh(M,Ae[0],Ae[2]),fe=jh(D,Ae[1],Ae[3]),we=Ae[0]-oe,Ke=Ae[1]-ue,je=Ae[2]-Ae[0]-Q,Ve=Ae[3]-Ae[1]-fe}const Oe=(Ae,qe,Re,Ee)=>{const st=$h(Ae.stretch-oe,Q,k,i.left),Qe=Zh(Ae.fixed-we,je,Ae.stretch,O),_t=$h(qe.stretch-ue,fe,I,i.top),Ht=Zh(qe.fixed-Ke,Ve,qe.stretch,j),Kt=$h(Re.stretch-oe,Q,k,i.left),Er=Zh(Re.fixed-we,je,Re.stretch,O),Xi=$h(Ee.stretch-ue,fe,I,i.top),yi=Zh(Ee.fixed-Ke,Ve,Ee.stretch,j),wr=new ie(st,_t),Ur=new ie(Kt,_t),Xr=new ie(Kt,Xi),_i=new ie(st,Xi),vi=new ie(Qe/y,Ht/y),Ir=new ie(Er/y,yi/y),Cr=e*Math.PI/180;if(Cr){const ni=Math.sin(Cr),Di=Math.cos(Cr),Li=[Di,-ni,ni,Di];wr._matMult(Li),Ur._matMult(Li),_i._matMult(Li),Xr._matMult(Li)}const ii=Ae.stretch+Ae.fixed,xi=qe.stretch+qe.fixed;return{tl:wr,tr:Ur,bl:_i,br:Xr,tex:{x:m.paddedRect.x+cl+ii,y:m.paddedRect.y+cl+xi,w:Re.stretch+Re.fixed-ii,h:Ee.stretch+Ee.fixed-xi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:vi,pixelOffsetBR:Ir,minFontScaleX:je/y/k,minFontScaleY:Ve/y/I,isSDF:n}};if(o&&(m.stretchX||m.stretchY)){const Ae=a_(M,H,O),qe=a_(D,Y,j);for(let Re=0;Re<Ae.length-1;Re++){const Ee=Ae[Re],st=Ae[Re+1];for(let Qe=0;Qe<qe.length-1;Qe++)h.push(Oe(Ee,qe[Qe],st,qe[Qe+1]))}}else h.push(Oe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:b+1}));return h}function jh(i,e,n){let o=0;for(const h of i)o+=Math.max(e,Math.min(n,h[1]))-Math.max(e,Math.min(n,h[0]));return o}function a_(i,e,n){const o=[{fixed:-cl,stretch:0}];for(const[h,m]of i){const y=o[o.length-1];o.push({fixed:h-y.stretch,stretch:y.stretch}),o.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return o.push({fixed:e+cl,stretch:n}),o}function $h(i,e,n,o){return i/e*n+o}function Zh(i,e,n,o){return i-e*n/o}class qh{constructor(e,n,o,h,m,y,v,b,k,I){if(this.boxStartIndex=e.length,k){let M=y.top,D=y.bottom;const B=y.collisionPadding;B&&(M-=B[1],D+=B[3]);let O=D-M;O>0&&(O=Math.max(10,O),this.circleDiameter=O)}else{let M=y.top*v-b[0],D=y.bottom*v+b[2],B=y.left*v-b[3],O=y.right*v+b[1];const j=y.collisionPadding;if(j&&(B-=j[0]*v,M-=j[1]*v,O+=j[2]*v,D+=j[3]*v),I){const H=new ie(B,M),Y=new ie(O,M),oe=new ie(B,D),Q=new ie(O,D),ue=I*Math.PI/180;H._rotate(ue),Y._rotate(ue),oe._rotate(ue),Q._rotate(ue),B=Math.min(H.x,Y.x,oe.x,Q.x),O=Math.max(H.x,Y.x,oe.x,Q.x),M=Math.min(H.y,Y.y,oe.y,Q.y),D=Math.max(H.y,Y.y,oe.y,Q.y)}e.emplaceBack(n.x,n.y,B,M,O,D,o,h,m)}this.boxEndIndex=e.length}}class Vw{constructor(e=[],n=Uw){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:o}=this,h=n[e];for(;e>0;){const m=e-1>>1,y=n[m];if(o(h,y)>=0)break;n[e]=y,e=m}n[e]=h}_down(e){const{data:n,compare:o}=this,h=this.length>>1,m=n[e];for(;e<h;){let y=1+(e<<1),v=n[y];const b=y+1;if(b<this.length&&o(n[b],v)<0&&(y=b,v=n[b]),o(v,m)>=0)break;n[e]=v,e=y}n[e]=m}}function Uw(i,e){return i<e?-1:i>e?1:0}function jw(i,e=1,n=!1){let o=1/0,h=1/0,m=-1/0,y=-1/0;const v=i[0];for(let B=0;B<v.length;B++){const O=v[B];(!B||O.x<o)&&(o=O.x),(!B||O.y<h)&&(h=O.y),(!B||O.x>m)&&(m=O.x),(!B||O.y>y)&&(y=O.y)}const b=Math.min(m-o,y-h);let k=b/2;const I=new Vw([],$w);if(b===0)return new ie(o,h);for(let B=o;B<m;B+=b)for(let O=h;O<y;O+=b)I.push(new hl(B+k,O+k,k,i));let M=function(B){let O=0,j=0,H=0;const Y=B[0];for(let oe=0,Q=Y.length,ue=Q-1;oe<Q;ue=oe++){const fe=Y[oe],we=Y[ue],je=fe.x*we.y-we.x*fe.y;j+=(fe.x+we.x)*je,H+=(fe.y+we.y)*je,O+=3*je}return new hl(j/O,H/O,0,B)}(i),D=I.length;for(;I.length;){const B=I.pop();(B.d>M.d||!M.d)&&(M=B,n&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,D)),B.max-M.d<=e||(k=B.h/2,I.push(new hl(B.p.x-k,B.p.y-k,k,i)),I.push(new hl(B.p.x+k,B.p.y-k,k,i)),I.push(new hl(B.p.x-k,B.p.y+k,k,i)),I.push(new hl(B.p.x+k,B.p.y+k,k,i)),D+=4)}return n&&(console.log(`num probes: ${D}`),console.log(`best distance: ${M.d}`)),M.p}function $w(i,e){return e.max-i.max}function hl(i,e,n,o){this.p=new ie(i,e),this.h=n,this.d=function(h,m){let y=!1,v=1/0;for(let b=0;b<m.length;b++){const k=m[b];for(let I=0,M=k.length,D=M-1;I<M;D=I++){const B=k[I],O=k[D];B.y>h.y!=O.y>h.y&&h.x<(O.x-B.x)*(h.y-B.y)/(O.y-B.y)+B.x&&(y=!y),v=Math.min(v,jg(h,B,O))}}return(y?1:-1)*Math.sqrt(v)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}var Hr;l.aq=void 0,(Hr=l.aq||(l.aq={}))[Hr.center=1]="center",Hr[Hr.left=2]="left",Hr[Hr.right=3]="right",Hr[Hr.top=4]="top",Hr[Hr.bottom=5]="bottom",Hr[Hr["top-left"]=6]="top-left",Hr[Hr["top-right"]=7]="top-right",Hr[Hr["bottom-left"]=8]="bottom-left",Hr[Hr["bottom-right"]=9]="bottom-right";const ga=7,uf=Number.POSITIVE_INFINITY;function o_(i,e){return e[1]!==uf?function(n,o,h){let m=0,y=0;switch(o=Math.abs(o),h=Math.abs(h),n){case"top-right":case"top-left":case"top":y=h-ga;break;case"bottom-right":case"bottom-left":case"bottom":y=-h+ga}switch(n){case"top-right":case"bottom-right":case"right":m=-o;break;case"top-left":case"bottom-left":case"left":m=o}return[m,y]}(i,e[0],e[1]):function(n,o){let h=0,m=0;o<0&&(o=0);const y=o/Math.SQRT2;switch(n){case"top-right":case"top-left":m=y-ga;break;case"bottom-right":case"bottom-left":m=-y+ga;break;case"bottom":m=-o+ga;break;case"top":m=o-ga}switch(n){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=o;break;case"right":h=-o}return[h,m]}(i,e[0])}function l_(i,e,n){var o;const h=i.layout,m=(o=h.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(e,{},n);if(m){const v=m.values,b=[];for(let k=0;k<v.length;k+=2){const I=b[k]=v[k],M=v[k+1].map(D=>D*kr);I.startsWith("top")?M[1]-=ga:I.startsWith("bottom")&&(M[1]+=ga),b[k+1]=M}return new $i(b)}const y=h.get("text-variable-anchor");if(y){let v;v=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(e,{},n)*kr,uf]:h.get("text-offset").evaluate(e,{},n).map(k=>k*kr);const b=[];for(const k of y)b.push(k,o_(k,v));return new $i(b)}return null}function cf(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Zw(i,e,n,o,h,m,y,v,b,k,I){let M=m.textMaxSize.evaluate(e,{});M===void 0&&(M=y);const D=i.layers[0].layout,B=D.get("icon-offset").evaluate(e,{},I),O=c_(n.horizontal),j=y/24,H=i.tilePixelRatio*j,Y=i.tilePixelRatio*M/24,oe=i.tilePixelRatio*v,Q=i.tilePixelRatio*D.get("symbol-spacing"),ue=D.get("text-padding")*i.tilePixelRatio,fe=function(Ee,st,Qe,_t=1){const Ht=Ee.get("icon-padding").evaluate(st,{},Qe),Kt=Ht&&Ht.values;return[Kt[0]*_t,Kt[1]*_t,Kt[2]*_t,Kt[3]*_t]}(D,e,I,i.tilePixelRatio),we=D.get("text-max-angle")/180*Math.PI,je=D.get("text-rotation-alignment")!=="viewport"&&D.get("symbol-placement")!=="point",Ke=D.get("icon-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",Ve=D.get("symbol-placement"),Oe=Q/2,Ae=D.get("icon-text-fit");let qe;o&&Ae!=="none"&&(i.allowVerticalPlacement&&n.vertical&&(qe=Ay(o,n.vertical,Ae,D.get("icon-text-fit-padding"),B,j)),O&&(o=Ay(o,O,Ae,D.get("icon-text-fit-padding"),B,j)));const Re=(Ee,st)=>{st.x<0||st.x>=xr||st.y<0||st.y>=xr||function(Qe,_t,Ht,Kt,Er,Xi,yi,wr,Ur,Xr,_i,vi,Ir,Cr,ii,xi,ni,Di,Li,Pr,bt,si,Kr,zr,Tn){const Un=Qe.addToLineVertexArray(_t,Ht);let jn,Rs,kn,on,Ri=0,Bs=0,Wu=0,f_=0,_f=-1,vf=-1;const Fs={};let m_=Ms("");if(Qe.allowVerticalPlacement&&Kt.vertical){const ai=wr.layout.get("text-rotate").evaluate(bt,{},zr)+90;kn=new qh(Ur,_t,Xr,_i,vi,Kt.vertical,Ir,Cr,ii,ai),yi&&(on=new qh(Ur,_t,Xr,_i,vi,yi,ni,Di,ii,ai))}if(Er){const ai=wr.layout.get("icon-rotate").evaluate(bt,{}),ln=wr.layout.get("icon-text-fit")!=="none",lo=s_(Er,ai,Kr,ln),Zn=yi?s_(yi,ai,Kr,ln):void 0;Rs=new qh(Ur,_t,Xr,_i,vi,Er,ni,Di,!1,ai),Ri=4*lo.length;const uo=Qe.iconSizeData;let ds=null;uo.kind==="source"?(ds=[hs*wr.layout.get("icon-size").evaluate(bt,{})],ds[0]>pa&&Dr(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${$u}. Reduce your "icon-size".`)):uo.kind==="composite"&&(ds=[hs*si.compositeIconSizes[0].evaluate(bt,{},zr),hs*si.compositeIconSizes[1].evaluate(bt,{},zr)],(ds[0]>pa||ds[1]>pa)&&Dr(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${$u}. Reduce your "icon-size".`)),Qe.addSymbols(Qe.icon,lo,ds,Pr,Li,bt,l.ai.none,_t,Un.lineStartIndex,Un.lineLength,-1,zr),_f=Qe.icon.placedSymbolArray.length-1,Zn&&(Bs=4*Zn.length,Qe.addSymbols(Qe.icon,Zn,ds,Pr,Li,bt,l.ai.vertical,_t,Un.lineStartIndex,Un.lineLength,-1,zr),vf=Qe.icon.placedSymbolArray.length-1)}const g_=Object.keys(Kt.horizontal);for(const ai of g_){const ln=Kt.horizontal[ai];if(!jn){m_=Ms(ln.text);const Zn=wr.layout.get("text-rotate").evaluate(bt,{},zr);jn=new qh(Ur,_t,Xr,_i,vi,ln,Ir,Cr,ii,Zn)}const lo=ln.positionedLines.length===1;if(Wu+=u_(Qe,_t,ln,Xi,wr,ii,bt,xi,Un,Kt.vertical?l.ai.horizontal:l.ai.horizontalOnly,lo?g_:[ai],Fs,_f,si,zr),lo)break}Kt.vertical&&(f_+=u_(Qe,_t,Kt.vertical,Xi,wr,ii,bt,xi,Un,l.ai.vertical,["vertical"],Fs,vf,si,zr));const Ww=jn?jn.boxStartIndex:Qe.collisionBoxArray.length,Hw=jn?jn.boxEndIndex:Qe.collisionBoxArray.length,Xw=kn?kn.boxStartIndex:Qe.collisionBoxArray.length,Kw=kn?kn.boxEndIndex:Qe.collisionBoxArray.length,Yw=Rs?Rs.boxStartIndex:Qe.collisionBoxArray.length,Jw=Rs?Rs.boxEndIndex:Qe.collisionBoxArray.length,Qw=on?on.boxStartIndex:Qe.collisionBoxArray.length,eb=on?on.boxEndIndex:Qe.collisionBoxArray.length;let $n=-1;const Wh=(ai,ln)=>ai&&ai.circleDiameter?Math.max(ai.circleDiameter,ln):ln;$n=Wh(jn,$n),$n=Wh(kn,$n),$n=Wh(Rs,$n),$n=Wh(on,$n);const y_=$n>-1?1:0;y_&&($n*=Tn/kr),Qe.glyphOffsetArray.length>=ul.MAX_GLYPHS&&Dr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),bt.sortKey!==void 0&&Qe.addToSortKeyRanges(Qe.symbolInstances.length,bt.sortKey);const tb=l_(wr,bt,zr),[rb,ib]=function(ai,ln){const lo=ai.length,Zn=ln==null?void 0:ln.values;if((Zn==null?void 0:Zn.length)>0)for(let uo=0;uo<Zn.length;uo+=2){const ds=Zn[uo+1];ai.emplaceBack(l.aq[Zn[uo]],ds[0],ds[1])}return[lo,ai.length]}(Qe.textAnchorOffsets,tb);Qe.symbolInstances.emplaceBack(_t.x,_t.y,Fs.right>=0?Fs.right:-1,Fs.center>=0?Fs.center:-1,Fs.left>=0?Fs.left:-1,Fs.vertical||-1,_f,vf,m_,Ww,Hw,Xw,Kw,Yw,Jw,Qw,eb,Xr,Wu,f_,Ri,Bs,y_,0,Ir,$n,rb,ib)}(i,st,Ee,n,o,h,qe,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,H,[ue,ue,ue,ue],je,b,oe,fe,Ke,B,e,m,k,I,y)};if(Ve==="line")for(const Ee of Qy(e.geometry,0,0,xr,xr)){const st=Nw(Ee,Q,we,n.vertical||O,o,24,Y,i.overscaling,xr);for(const Qe of st)O&&qw(i,O.text,Oe,Qe)||Re(Ee,Qe)}else if(Ve==="line-center"){for(const Ee of e.geometry)if(Ee.length>1){const st=Ow(Ee,we,n.vertical||O,o,24,Y);st&&Re(Ee,st)}}else if(e.type==="Polygon")for(const Ee of Up(e.geometry,0)){const st=jw(Ee,16);Re(Ee[0],new ma(st.x,st.y,0))}else if(e.type==="LineString")for(const Ee of e.geometry)Re(Ee,new ma(Ee[0].x,Ee[0].y,0));else if(e.type==="Point")for(const Ee of e.geometry)for(const st of Ee)Re([st],new ma(st.x,st.y,0))}function u_(i,e,n,o,h,m,y,v,b,k,I,M,D,B,O){const j=function(oe,Q,ue,fe,we,je,Ke,Ve){const Oe=fe.layout.get("text-rotate").evaluate(je,{})*Math.PI/180,Ae=[];for(const qe of Q.positionedLines)for(const Re of qe.positionedGlyphs){if(!Re.rect)continue;const Ee=Re.rect||{};let st=ky+1,Qe=!0,_t=1,Ht=0;const Kt=(we||Ve)&&Re.vertical,Er=Re.metrics.advance*Re.scale/2;if(Ve&&Q.verticalizable&&(Ht=qe.lineOffset/2-(Re.imageName?-(kr-Re.metrics.width*Re.scale)/2:(Re.scale-1)*kr)),Re.imageName){const Pr=Ke[Re.imageName];Qe=Pr.sdf,_t=Pr.pixelRatio,st=Ai/_t}const Xi=we?[Re.x+Er,Re.y]:[0,0];let yi=we?[0,0]:[Re.x+Er+ue[0],Re.y+ue[1]-Ht],wr=[0,0];Kt&&(wr=yi,yi=[0,0]);const Ur=Re.metrics.isDoubleResolution?2:1,Xr=(Re.metrics.left-st)*Re.scale-Er+yi[0],_i=(-Re.metrics.top-st)*Re.scale+yi[1],vi=Xr+Ee.w/Ur*Re.scale/_t,Ir=_i+Ee.h/Ur*Re.scale/_t,Cr=new ie(Xr,_i),ii=new ie(vi,_i),xi=new ie(Xr,Ir),ni=new ie(vi,Ir);if(Kt){const Pr=new ie(-Er,Er-Uu),bt=-Math.PI/2,si=kr/2-Er,Kr=new ie(5-Uu-si,-(Re.imageName?si:0)),zr=new ie(...wr);Cr._rotateAround(bt,Pr)._add(Kr)._add(zr),ii._rotateAround(bt,Pr)._add(Kr)._add(zr),xi._rotateAround(bt,Pr)._add(Kr)._add(zr),ni._rotateAround(bt,Pr)._add(Kr)._add(zr)}if(Oe){const Pr=Math.sin(Oe),bt=Math.cos(Oe),si=[bt,-Pr,Pr,bt];Cr._matMult(si),ii._matMult(si),xi._matMult(si),ni._matMult(si)}const Di=new ie(0,0),Li=new ie(0,0);Ae.push({tl:Cr,tr:ii,bl:xi,br:ni,tex:Ee,writingMode:Q.writingMode,glyphOffset:Xi,sectionIndex:Re.sectionIndex,isSDF:Qe,pixelOffsetTL:Di,pixelOffsetBR:Li,minFontScaleX:0,minFontScaleY:0})}return Ae}(0,n,v,h,m,y,o,i.allowVerticalPlacement),H=i.textSizeData;let Y=null;H.kind==="source"?(Y=[hs*h.layout.get("text-size").evaluate(y,{})],Y[0]>pa&&Dr(`${i.layerIds[0]}: Value for "text-size" is >= ${$u}. Reduce your "text-size".`)):H.kind==="composite"&&(Y=[hs*B.compositeTextSizes[0].evaluate(y,{},O),hs*B.compositeTextSizes[1].evaluate(y,{},O)],(Y[0]>pa||Y[1]>pa)&&Dr(`${i.layerIds[0]}: Value for "text-size" is >= ${$u}. Reduce your "text-size".`)),i.addSymbols(i.text,j,Y,v,m,y,k,e,b.lineStartIndex,b.lineLength,D,O);for(const oe of I)M[oe]=i.text.placedSymbolArray.length-1;return 4*j.length}function c_(i){for(const e in i)return i[e];return null}function qw(i,e,n,o){const h=i.compareText;if(e in h){const m=h[e];for(let y=m.length-1;y>=0;y--)if(o.dist(m[y])<n)return!0}else h[e]=[];return h[e].push(o),!1}const h_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class hf{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,o]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=o>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=h_[15&o];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new hf(v,y,m,e)}constructor(e,n=64,o=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const m=h_.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,b=(8-v%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${o}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+b,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+v+b),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+b,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=n,o}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return df(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,o,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:v}=this,b=[0,m.length-1,0],k=[];for(;b.length;){const I=b.pop()||0,M=b.pop()||0,D=b.pop()||0;if(M-D<=v){for(let H=D;H<=M;H++){const Y=y[2*H],oe=y[2*H+1];Y>=e&&Y<=o&&oe>=n&&oe<=h&&k.push(m[H])}continue}const B=D+M>>1,O=y[2*B],j=y[2*B+1];O>=e&&O<=o&&j>=n&&j<=h&&k.push(m[B]),(I===0?e<=O:n<=j)&&(b.push(D),b.push(B-1),b.push(1-I)),(I===0?o>=O:h>=j)&&(b.push(B+1),b.push(M),b.push(1-I))}return k}within(e,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:y}=this,v=[0,h.length-1,0],b=[],k=o*o;for(;v.length;){const I=v.pop()||0,M=v.pop()||0,D=v.pop()||0;if(M-D<=y){for(let H=D;H<=M;H++)p_(m[2*H],m[2*H+1],e,n)<=k&&b.push(h[H]);continue}const B=D+M>>1,O=m[2*B],j=m[2*B+1];p_(O,j,e,n)<=k&&b.push(h[B]),(I===0?e-o<=O:n-o<=j)&&(v.push(D),v.push(B-1),v.push(1-I)),(I===0?e+o>=O:n+o>=j)&&(v.push(B+1),v.push(M),v.push(1-I))}return b}}function df(i,e,n,o,h,m){if(h-o<=n)return;const y=o+h>>1;d_(i,e,y,o,h,m),df(i,e,n,o,y-1,1-m),df(i,e,n,y+1,h,1-m)}function d_(i,e,n,o,h,m){for(;h>o;){if(h-o>600){const k=h-o+1,I=n-o+1,M=Math.log(k),D=.5*Math.exp(2*M/3),B=.5*Math.sqrt(M*D*(k-D)/k)*(I-k/2<0?-1:1);d_(i,e,n,Math.max(o,Math.floor(n-I*D/k+B)),Math.min(h,Math.floor(n+(k-I)*D/k+B)),m)}const y=e[2*n+m];let v=o,b=h;for(qu(i,e,o,n),e[2*h+m]>y&&qu(i,e,o,h);v<b;){for(qu(i,e,v,b),v++,b--;e[2*v+m]<y;)v++;for(;e[2*b+m]>y;)b--}e[2*o+m]===y?qu(i,e,o,b):(b++,qu(i,e,b,h)),b<=n&&(o=b+1),n<=b&&(h=b-1)}}function qu(i,e,n,o){pf(i,n,o),pf(e,2*n,2*o),pf(e,2*n+1,2*o+1)}function pf(i,e,n){const o=i[e];i[e]=i[n],i[n]=o}function p_(i,e,n,o){const h=i-n,m=e-o;return h*h+m*m}var ff;l.bh=void 0,(ff=l.bh||(l.bh={})).create="create",ff.load="load",ff.fullLoad="fullLoad";let Gh=null,Gu=[];const mf=1e3/60,gf="loadTime",yf="fullLoadTime",Gw={mark(i){performance.mark(i)},frame(i){const e=i;Gh!=null&&Gu.push(e-Gh),Gh=e},clearMetrics(){Gh=null,Gu=[],performance.clearMeasures(gf),performance.clearMeasures(yf);for(const i in l.bh)performance.clearMarks(l.bh[i])},getPerformanceMetrics(){performance.measure(gf,l.bh.create,l.bh.load),performance.measure(yf,l.bh.create,l.bh.fullLoad);const i=performance.getEntriesByName(gf)[0].duration,e=performance.getEntriesByName(yf)[0].duration,n=Gu.length,o=1/(Gu.reduce((m,y)=>m+y,0)/n/1e3),h=Gu.filter(m=>m>mf).reduce((m,y)=>m+(y-mf)/mf,0);return{loadTime:i,fullLoadTime:e,fps:o,percentDroppedFrames:h/(n+h)*100,totalFrames:n}}};l.$=function(i,e,n){var o,h,m,y,v,b,k,I,M,D,B,O,j=n[0],H=n[1],Y=n[2];return e===i?(i[12]=e[0]*j+e[4]*H+e[8]*Y+e[12],i[13]=e[1]*j+e[5]*H+e[9]*Y+e[13],i[14]=e[2]*j+e[6]*H+e[10]*Y+e[14],i[15]=e[3]*j+e[7]*H+e[11]*Y+e[15]):(h=e[1],m=e[2],y=e[3],v=e[4],b=e[5],k=e[6],I=e[7],M=e[8],D=e[9],B=e[10],O=e[11],i[0]=o=e[0],i[1]=h,i[2]=m,i[3]=y,i[4]=v,i[5]=b,i[6]=k,i[7]=I,i[8]=M,i[9]=D,i[10]=B,i[11]=O,i[12]=o*j+v*H+M*Y+e[12],i[13]=h*j+b*H+D*Y+e[13],i[14]=m*j+k*H+B*Y+e[14],i[15]=y*j+I*H+O*Y+e[15]),i},l.A=il,l.B=Ii,l.C=class{constructor(i,e,n){this.receive=o=>{const h=o.data,m=h.id;if(m&&(!h.targetMapId||this.mapId===h.targetMapId))if(h.type==="<cancel>"){delete this.tasks[m];const y=this.cancelCallbacks[m];delete this.cancelCallbacks[m],y&&y()}else Zr()||h.mustQueue?(this.tasks[m]=h,this.taskQueue.push(m),this.invoker.trigger()):this.processTask(m,h)},this.process=()=>{if(!this.taskQueue.length)return;const o=this.taskQueue.shift(),h=this.tasks[o];delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),h&&this.processTask(o,h)},this.target=i,this.parent=e,this.mapId=n,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new Bw(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Zr()?i:window}send(i,e,n,o,h=!1){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(this.callbacks[m]=n);const y=[],v={id:m,type:i,hasCallback:!!n,targetMapId:o,mustQueue:h,sourceMapId:this.mapId,data:ls(e,y)};return this.target.postMessage(v,{transfer:y}),{cancel:()=>{n&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:o,sourceMapId:this.mapId})}}}processTask(i,e){if(e.type==="<response>"){const n=this.callbacks[i];delete this.callbacks[i],n&&(e.error?n(oa(e.error)):n(null,oa(e.data)))}else{let n=!1;const o=[],h=e.hasCallback?(v,b)=>{n=!0,delete this.cancelCallbacks[i];const k={id:i,type:"<response>",sourceMapId:this.mapId,error:v?ls(v):null,data:ls(b,o)};this.target.postMessage(k,{transfer:o})}:v=>{n=!0};let m=null;const y=oa(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,y,h);else if("getWorkerSource"in this.parent){const v=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,v[0],y.source)[v[1]](y,h)}else h(new Error(`Could not find function ${e.type}`));!n&&m&&m.cancel&&(this.cancelCallbacks[i]=m.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.D=tt,l.E=vs,l.F=function(i,e){const n={};for(let o=0;o<e.length;o++){const h=e[o];h in i&&(n[h]=i[h])}return n},l.G=Uy,l.H=jy,l.I=Yp,l.J=ee,l.K=ce,l.L=fa,l.M=Ut,l.N=xr,l.O=an,l.P=ie,l.Q=er,l.R=sn,l.S=Wt,l.T=wh,l.U=Uh,l.V=class extends Ps{},l.W=lf,l.X=function(i,e){const n=window.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let o=0;o<i.length;o++){const h=window.document.createElement("source");An(i[o])||(n.crossOrigin="Anonymous"),h.src=i[o],n.appendChild(h)}return{cancel:()=>{}}},l.Y=De,l.Z=function(){var i=new il(16);return il!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},l._=N,l.a=pt,l.a$=class extends R{},l.a0=function(i,e,n){var o=n[0],h=n[1],m=n[2];return i[0]=e[0]*o,i[1]=e[1]*o,i[2]=e[2]*o,i[3]=e[3]*o,i[4]=e[4]*h,i[5]=e[5]*h,i[6]=e[6]*h,i[7]=e[7]*h,i[8]=e[8]*m,i[9]=e[9]*m,i[10]=e[10]*m,i[11]=e[11]*m,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},l.a1=Gg,l.a2=function(){return qt++},l.a3=G,l.a4=ul,l.a5=function(){zi.isLoading()||zi.isLoaded()||xu()!=="deferred"||xh()},l.a6=uu,l.a7=ao,l.a8=Gt,l.a9=Xy,l.aA=eo,l.aB=function(i){i=i.slice();const e=Object.create(null);for(let n=0;n<i.length;n++)e[i[n].id]=i[n];for(let n=0;n<i.length;n++)"ref"in i[n]&&(i[n]=Ui(i[n],e[i[n].ref]));return i},l.aC=function(i){if(i.type==="custom")return new Rw(i);switch(i.type){case"background":return new Aw(i);case"circle":return new y1(i);case"fill":return new F1(i);case"fill-extrusion":return new J1(i);case"heatmap":return new v1(i);case"hillshade":return new w1(i);case"line":return new aw(i);case"raster":return new Lw(i);case"symbol":return new Vh(i)}},l.aD=Br,l.aE=function(i,e){if(!i)return[{command:Ct.setStyle,args:[e]}];let n=[];try{if(!Vt(i.version,e.version))return[{command:Ct.setStyle,args:[e]}];Vt(i.center,e.center)||n.push({command:Ct.setCenter,args:[e.center]}),Vt(i.zoom,e.zoom)||n.push({command:Ct.setZoom,args:[e.zoom]}),Vt(i.bearing,e.bearing)||n.push({command:Ct.setBearing,args:[e.bearing]}),Vt(i.pitch,e.pitch)||n.push({command:Ct.setPitch,args:[e.pitch]}),Vt(i.sprite,e.sprite)||n.push({command:Ct.setSprite,args:[e.sprite]}),Vt(i.glyphs,e.glyphs)||n.push({command:Ct.setGlyphs,args:[e.glyphs]}),Vt(i.transition,e.transition)||n.push({command:Ct.setTransition,args:[e.transition]}),Vt(i.light,e.light)||n.push({command:Ct.setLight,args:[e.light]});const o={},h=[];(function(y,v,b,k){let I;for(I in v=v||{},y=y||{})Object.prototype.hasOwnProperty.call(y,I)&&(Object.prototype.hasOwnProperty.call(v,I)||Xs(I,b,k));for(I in v)Object.prototype.hasOwnProperty.call(v,I)&&(Object.prototype.hasOwnProperty.call(y,I)?Vt(y[I],v[I])||(y[I].type==="geojson"&&v[I].type==="geojson"&&Eo(y,v,I)?b.push({command:Ct.setGeoJSONSourceData,args:[I,v[I].data]}):Dn(I,v,b,k)):mn(I,v,b))})(i.sources,e.sources,h,o);const m=[];i.layers&&i.layers.forEach(y=>{o[y.source]?n.push({command:Ct.removeLayer,args:[y.id]}):m.push(y)}),n=n.concat(h),function(y,v,b){v=v||[];const k=(y=y||[]).map(rs),I=v.map(rs),M=y.reduce(xs,{}),D=v.reduce(xs,{}),B=k.slice(),O=Object.create(null);let j,H,Y,oe,Q,ue,fe;for(j=0,H=0;j<k.length;j++)Y=k[j],Object.prototype.hasOwnProperty.call(D,Y)?H++:(b.push({command:Ct.removeLayer,args:[Y]}),B.splice(B.indexOf(Y,H),1));for(j=0,H=0;j<I.length;j++)Y=I[I.length-1-j],B[B.length-1-j]!==Y&&(Object.prototype.hasOwnProperty.call(M,Y)?(b.push({command:Ct.removeLayer,args:[Y]}),B.splice(B.lastIndexOf(Y,B.length-H),1)):H++,ue=B[B.length-j],b.push({command:Ct.addLayer,args:[D[Y],ue]}),B.splice(B.length-j,0,Y),O[Y]=!0);for(j=0;j<I.length;j++)if(Y=I[j],oe=M[Y],Q=D[Y],!O[Y]&&!Vt(oe,Q))if(Vt(oe.source,Q.source)&&Vt(oe["source-layer"],Q["source-layer"])&&Vt(oe.type,Q.type)){for(fe in Ks(oe.layout,Q.layout,b,Y,null,Ct.setLayoutProperty),Ks(oe.paint,Q.paint,b,Y,null,Ct.setPaintProperty),Vt(oe.filter,Q.filter)||b.push({command:Ct.setFilter,args:[Y,Q.filter]}),Vt(oe.minzoom,Q.minzoom)&&Vt(oe.maxzoom,Q.maxzoom)||b.push({command:Ct.setLayerZoomRange,args:[Y,Q.minzoom,Q.maxzoom]}),oe)Object.prototype.hasOwnProperty.call(oe,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?Ks(oe[fe],Q[fe],b,Y,fe.slice(6),Ct.setPaintProperty):Vt(oe[fe],Q[fe])||b.push({command:Ct.setLayerProperty,args:[Y,fe,Q[fe]]}));for(fe in Q)Object.prototype.hasOwnProperty.call(Q,fe)&&!Object.prototype.hasOwnProperty.call(oe,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?Ks(oe[fe],Q[fe],b,Y,fe.slice(6),Ct.setPaintProperty):Vt(oe[fe],Q[fe])||b.push({command:Ct.setLayerProperty,args:[Y,fe,Q[fe]]}))}else b.push({command:Ct.removeLayer,args:[Y]}),ue=B[B.lastIndexOf(Y)+1],b.push({command:Ct.addLayer,args:[Q,ue]})}(m,e.layers,n)}catch(o){console.warn("Unable to compute style diff:",o),n=[{command:Ct.setStyle,args:[e]}]}return n},l.aF=function(i){const e=[],n=i.id;return n===void 0&&e.push({message:`layers.${n}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${n}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},l.aG=function i(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let o=0;o<e.length;o++)if(!i(e[o],n[o]))return!1;return!0}if(typeof e=="object"&&e!==null&&n!==null){if(typeof n!="object"||Object.keys(e).length!==Object.keys(n).length)return!1;for(const o in e)if(!i(e[o],n[o]))return!1;return!0}return e===n},l.aH=at,l.aI=Ar,l.aJ=to,l.aK=function(i){return i({pluginStatus:fi,pluginURL:us}),to.on("pluginStateChange",i),i},l.aL=class extends As{constructor(i,e){super(i,e),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},l.aM=tl,l.aN=class extends As{constructor(i,e){super(i,e),this.current=Pp}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},l.aO=kh,l.aP=class extends As{constructor(i,e){super(i,e),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},l.aQ=class extends As{constructor(i,e){super(i,e),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},l.aR=Eh,l.aS=function(i,e,n,o,h,m,y){var v=1/(e-n),b=1/(o-h),k=1/(m-y);return i[0]=-2*v,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*b,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*k,i[11]=0,i[12]=(e+n)*v,i[13]=(h+o)*b,i[14]=(y+m)*k,i[15]=1,i},l.aT=Rt,l.aU=g1,l.aV=class extends c{},l.aW=cw,l.aX=class extends f{},l.aY=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},l.aZ=Yg,l.a_=ze,l.aa=function(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,o,h,m)=>{const y=h||m;return e[o]=!y||y.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e},l.ab=function(i,e){const n=[];for(const o in i)o in e||n.push(o);return n},l.ac=function(i){if(Ge==null){const e=i.navigator?i.navigator.userAgent:null;Ge=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Ge},l.ad=Ye,l.ae=function(i,e,n){var o=Math.sin(n),h=Math.cos(n),m=e[0],y=e[1],v=e[2],b=e[3],k=e[4],I=e[5],M=e[6],D=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=m*h+k*o,i[1]=y*h+I*o,i[2]=v*h+M*o,i[3]=b*h+D*o,i[4]=k*h-m*o,i[5]=I*h-y*o,i[6]=M*h-v*o,i[7]=D*h-b*o,i},l.af=function(i){var e=new il(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},l.ag=zh,l.ah=function(i,e){let n=0,o=0;if(i.kind==="constant")o=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:y}=i,v=h?Ye(Ci.interpolationFactor(h,e,m,y),0,1):0;i.kind==="camera"?o=Ii.number(i.minSize,i.maxSize,v):n=v}return{uSizeT:n,uSize:o}},l.aj=function(i,{uSize:e,uSizeT:n},{lowerSize:o,upperSize:h}){return i.kind==="source"?o/hs:i.kind==="composite"?Ii.number(o/hs,h/hs,n):e},l.ak=tf,l.al=function(i,e,n,o){const h=e.y-i.y,m=e.x-i.x,y=o.y-n.y,v=o.x-n.x,b=y*m-v*h;if(b===0)return null;const k=(v*(i.y-n.y)-y*(i.x-n.x))/b;return new ie(i.x+k*m,i.y+k*h)},l.am=Qy,l.an=Vg,l.ao=Lp,l.ap=kr,l.ar=ef,l.as=function(i,e){var n=e[0],o=e[1],h=e[2],m=e[3],y=e[4],v=e[5],b=e[6],k=e[7],I=e[8],M=e[9],D=e[10],B=e[11],O=e[12],j=e[13],H=e[14],Y=e[15],oe=n*v-o*y,Q=n*b-h*y,ue=n*k-m*y,fe=o*b-h*v,we=o*k-m*v,je=h*k-m*b,Ke=I*j-M*O,Ve=I*H-D*O,Oe=I*Y-B*O,Ae=M*H-D*j,qe=M*Y-B*j,Re=D*Y-B*H,Ee=oe*Re-Q*qe+ue*Ae+fe*Oe-we*Ve+je*Ke;return Ee?(i[0]=(v*Re-b*qe+k*Ae)*(Ee=1/Ee),i[1]=(h*qe-o*Re-m*Ae)*Ee,i[2]=(j*je-H*we+Y*fe)*Ee,i[3]=(D*we-M*je-B*fe)*Ee,i[4]=(b*Oe-y*Re-k*Ve)*Ee,i[5]=(n*Re-h*Oe+m*Ve)*Ee,i[6]=(H*ue-O*je-Y*Q)*Ee,i[7]=(I*je-D*ue+B*Q)*Ee,i[8]=(y*qe-v*Oe+k*Ke)*Ee,i[9]=(o*Oe-n*qe-m*Ke)*Ee,i[10]=(O*we-j*ue+Y*oe)*Ee,i[11]=(M*ue-I*we-B*oe)*Ee,i[12]=(v*Ve-y*Ae-b*Ke)*Ee,i[13]=(n*Ae-o*Ve+h*Ke)*Ee,i[14]=(j*Q-O*fe-H*oe)*Ee,i[15]=(I*fe-M*Q+D*oe)*Ee,i):null},l.at=cf,l.au=Qp,l.av=hf,l.aw=function(){const i={},e=ye.$version;for(const n in ye.$root){const o=ye.$root[n];if(o.required){let h=null;h=n==="version"?e:o.type==="array"?[]:{},h!=null&&(i[n]=h)}}return i},l.ax=Ct,l.ay=gh,l.az=nn,l.b=function(i,e){const n=new Blob([new Uint8Array(i)],{type:"image/png"});createImageBitmap(n).then(o=>{e(null,o)}).catch(o=>{e(new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},l.b0=Nr,l.b1=function(i,e){var n=i[0],o=i[1],h=i[2],m=i[3],y=i[4],v=i[5],b=i[6],k=i[7],I=i[8],M=i[9],D=i[10],B=i[11],O=i[12],j=i[13],H=i[14],Y=i[15],oe=e[0],Q=e[1],ue=e[2],fe=e[3],we=e[4],je=e[5],Ke=e[6],Ve=e[7],Oe=e[8],Ae=e[9],qe=e[10],Re=e[11],Ee=e[12],st=e[13],Qe=e[14],_t=e[15];return Math.abs(n-oe)<=gi*Math.max(1,Math.abs(n),Math.abs(oe))&&Math.abs(o-Q)<=gi*Math.max(1,Math.abs(o),Math.abs(Q))&&Math.abs(h-ue)<=gi*Math.max(1,Math.abs(h),Math.abs(ue))&&Math.abs(m-fe)<=gi*Math.max(1,Math.abs(m),Math.abs(fe))&&Math.abs(y-we)<=gi*Math.max(1,Math.abs(y),Math.abs(we))&&Math.abs(v-je)<=gi*Math.max(1,Math.abs(v),Math.abs(je))&&Math.abs(b-Ke)<=gi*Math.max(1,Math.abs(b),Math.abs(Ke))&&Math.abs(k-Ve)<=gi*Math.max(1,Math.abs(k),Math.abs(Ve))&&Math.abs(I-Oe)<=gi*Math.max(1,Math.abs(I),Math.abs(Oe))&&Math.abs(M-Ae)<=gi*Math.max(1,Math.abs(M),Math.abs(Ae))&&Math.abs(D-qe)<=gi*Math.max(1,Math.abs(D),Math.abs(qe))&&Math.abs(B-Re)<=gi*Math.max(1,Math.abs(B),Math.abs(Re))&&Math.abs(O-Ee)<=gi*Math.max(1,Math.abs(O),Math.abs(Ee))&&Math.abs(j-st)<=gi*Math.max(1,Math.abs(j),Math.abs(st))&&Math.abs(H-Qe)<=gi*Math.max(1,Math.abs(H),Math.abs(Qe))&&Math.abs(Y-_t)<=gi*Math.max(1,Math.abs(Y),Math.abs(_t))},l.b2=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},l.b3=function(i,e,n){return i[0]=e[0]*n[0],i[1]=e[1]*n[1],i[2]=e[2]*n[2],i[3]=e[3]*n[3],i},l.b4=function(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]*e[3]},l.b5=it,l.b6=Gy,l.b7=$y,l.b8=function(i,e,n,o,h){var m,y=1/Math.tan(e/2);return i[0]=y/n,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=y,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0?(i[10]=(h+o)*(m=1/(o-h)),i[14]=2*h*o*m):(i[10]=-1,i[14]=-2*o),i},l.b9=function(i,e,n){var o=Math.sin(n),h=Math.cos(n),m=e[4],y=e[5],v=e[6],b=e[7],k=e[8],I=e[9],M=e[10],D=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=m*h+k*o,i[5]=y*h+I*o,i[6]=v*h+M*o,i[7]=b*h+D*o,i[8]=k*h-m*o,i[9]=I*h-y*o,i[10]=M*h-v*o,i[11]=D*h-b*o,i},l.bA=pe,l.bB=_y,l.bC=Zo,l.bD=zi,l.ba=Te,l.bb=$e,l.bc=function(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},l.bd=class extends no{},l.be=af,l.bf=Zy,l.bg=Gw,l.bi=Jn,l.bj=function(i,e,n=!1){if(fi===mu||fi===gu||fi===yu)throw new Error("setRTLTextPlugin cannot be called multiple times.");us=hi.resolveURL(i),fi=mu,_u=e,vu(),n||xh()},l.bk=xu,l.bl=function(i,e){const n={};for(let h=0;h<i.length;h++){const m=e&&e[i[h].id]||Ho(i[h]);e&&(e[i[h].id]=m);let y=n[m];y||(y=n[m]=[]),y.push(i[h])}const o=[];for(const h in n)o.push(n[h]);return o},l.bm=Ze,l.bn=Hy,l.bo=Ky,l.bp=Iy,l.bq=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=xr/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const e=i.bucket.layers[0],n=e.layout,o=e._unevaluatedLayout._values,h={layoutIconSize:o["icon-size"].possiblyEvaluate(new Gt(i.bucket.zoom+1),i.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Gt(i.bucket.zoom+1),i.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Gt(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:I}=i.bucket.textSizeData;h.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Gt(k),i.canonical),o["text-size"].possiblyEvaluate(new Gt(I),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:I}=i.bucket.iconSizeData;h.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Gt(k),i.canonical),o["icon-size"].possiblyEvaluate(new Gt(I),i.canonical)]}const m=n.get("text-line-height")*kr,y=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",v=n.get("text-keep-upright"),b=n.get("text-size");for(const k of i.bucket.features){const I=n.get("text-font").evaluate(k,{},i.canonical).join(","),M=b.evaluate(k,{},i.canonical),D=h.layoutTextSize.evaluate(k,{},i.canonical),B=h.layoutIconSize.evaluate(k,{},i.canonical),O={horizontal:{},vertical:void 0},j=k.text;let H,Y=[0,0];if(j){const ue=j.toString(),fe=n.get("text-letter-spacing").evaluate(k,{},i.canonical)*kr,we=pu(ue)?fe:0,je=n.get("text-anchor").evaluate(k,{},i.canonical),Ke=l_(e,k,i.canonical);if(!Ke){const Re=n.get("text-radial-offset").evaluate(k,{},i.canonical);Y=Re?o_(je,[Re*kr,uf]):n.get("text-offset").evaluate(k,{},i.canonical).map(Ee=>Ee*kr)}let Ve=y?"center":n.get("text-justify").evaluate(k,{},i.canonical);const Oe=n.get("symbol-placement"),Ae=Oe==="point"?n.get("text-max-width").evaluate(k,{},i.canonical)*kr:0,qe=()=>{i.bucket.allowVerticalPlacement&&du(ue)&&(O.vertical=Fh(j,i.glyphMap,i.glyphPositions,i.imagePositions,I,Ae,m,je,"left",we,Y,l.ai.vertical,!0,Oe,D,M))};if(!y&&Ke){const Re=new Set;if(Ve==="auto")for(let st=0;st<Ke.values.length;st+=2)Re.add(cf(Ke.values[st]));else Re.add(Ve);let Ee=!1;for(const st of Re)if(!O.horizontal[st])if(Ee)O.horizontal[st]=O.horizontal[0];else{const Qe=Fh(j,i.glyphMap,i.glyphPositions,i.imagePositions,I,Ae,m,"center",st,we,Y,l.ai.horizontal,!1,Oe,D,M);Qe&&(O.horizontal[st]=Qe,Ee=Qe.positionedLines.length===1)}qe()}else{Ve==="auto"&&(Ve=cf(je));const Re=Fh(j,i.glyphMap,i.glyphPositions,i.imagePositions,I,Ae,m,je,Ve,we,Y,l.ai.horizontal,!1,Oe,D,M);Re&&(O.horizontal[Ve]=Re),qe(),du(ue)&&y&&v&&(O.vertical=Fh(j,i.glyphMap,i.glyphPositions,i.imagePositions,I,Ae,m,je,Ve,we,Y,l.ai.vertical,!1,Oe,D,M))}}let oe=!1;if(k.icon&&k.icon.name){const ue=i.imageMap[k.icon.name];ue&&(H=Iw(i.imagePositions[k.icon.name],n.get("icon-offset").evaluate(k,{},i.canonical),n.get("icon-anchor").evaluate(k,{},i.canonical)),oe=!!ue.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=oe:i.bucket.sdfIcons!==oe&&Dr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ue.pixelRatio!==i.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const Q=c_(O.horizontal)||O.vertical;i.bucket.iconsInText=!!Q&&Q.iconsInText,(Q||H)&&Zw(i.bucket,k,O,H,i.imageMap,h,D,B,Y,oe,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},l.br=Wp,l.bs=Zp,l.bt=Gp,l.bu=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},l.bv=Xp,l.bw=ha,l.bx=function(i,e,n,o,h){return N(this,void 0,void 0,function*(){if(ce())try{return yield Ut(i,e,n,o,h)}catch{}return function(m,y,v,b,k){const I=m.width,M=m.height;Ft&&Dt||(Ft=new OffscreenCanvas(I,M),Dt=Ft.getContext("2d",{willReadFrequently:!0})),Ft.width=I,Ft.height=M,Dt.drawImage(m,0,0,I,M);const D=Dt.getImageData(y,v,b,k);return Dt.clearRect(0,0,I,M),D.data}(i,e,n,o,h)})},l.by=Wy,l.bz=F,l.c=rn,l.d=function(i,e){const n=new Image;n.onload=()=>{e(null,n),URL.revokeObjectURL(n.src),n.onload=null,window.requestAnimationFrame(()=>{n.src=yt})},n.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const o=new Blob([new Uint8Array(i)],{type:"image/png"});n.src=i.byteLength?URL.createObjectURL(o):yt},l.e=We,l.f=function(i,e){return Qn(We(i,{type:"json"}),e)},l.g=Vi,l.h=hi,l.i=Zr,l.j=ts,l.k=es,l.l=ja,l.m=Qn,l.n=function(i){return new Xp(i).readFields(ww,[])},l.o=function(i,e,n){if(!i.length)return n(null,[]);let o=i.length;const h=new Array(i.length);let m=null;i.forEach((y,v)=>{e(y,(b,k)=>{b&&(m=b),h[v]=k,--o==0&&n(m,h)})})},l.p=Ey,l.q=Du,l.r=pr,l.s=An,l.t=kp,l.u=Ue,l.v=ye,l.w=Dr,l.x=Yo,l.y=On,l.z=function([i,e,n]){return e+=90,e*=Math.PI/180,n*=Math.PI/180,{x:i*Math.cos(e)*Math.sin(n),y:i*Math.sin(e)*Math.sin(n),z:i*Math.cos(n)}}}),S(["./shared"],function(l){class N{constructor(A){this.keyCache={},A&&this.replace(A)}replace(A){this._layerConfigs={},this._layers={},this.update(A,[])}update(A,L){for(const W of A){this._layerConfigs[W.id]=W;const X=this._layers[W.id]=l.aC(W);X._featureFilter=l.a6(X.filter),this.keyCache[W.id]&&delete this.keyCache[W.id]}for(const W of L)delete this.keyCache[W],delete this._layerConfigs[W],delete this._layers[W];this.familiesBySource={};const V=l.bl(Object.values(this._layerConfigs),this.keyCache);for(const W of V){const X=W.map(ve=>this._layers[ve.id]),le=X[0];if(le.visibility==="none")continue;const te=le.source||"";let J=this.familiesBySource[te];J||(J=this.familiesBySource[te]={});const ae=le.sourceLayer||"_geojsonTileLayer";let _e=J[ae];_e||(_e=J[ae]=[]),_e.push(X)}}}class F{constructor(A){const L={},V=[];for(const te in A){const J=A[te],ae=L[te]={};for(const _e in J){const ve=J[+_e];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const be={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};V.push(be),ae[_e]={rect:be,metrics:ve.metrics}}}const{w:W,h:X}=l.p(V),le=new l.q({width:W||1,height:X||1});for(const te in A){const J=A[te];for(const ae in J){const _e=J[+ae];if(!_e||_e.bitmap.width===0||_e.bitmap.height===0)continue;const ve=L[te][ae].rect;l.q.copy(_e.bitmap,le,{x:0,y:0},{x:ve.x+1,y:ve.y+1},_e.bitmap)}}this.image=le,this.positions=L}}l.bm("GlyphAtlas",F);class pe{constructor(A){this.tileID=new l.O(A.tileID.overscaledZ,A.tileID.wrap,A.tileID.canonical.z,A.tileID.canonical.x,A.tileID.canonical.y),this.uid=A.uid,this.zoom=A.zoom,this.pixelRatio=A.pixelRatio,this.tileSize=A.tileSize,this.source=A.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=A.showCollisionBoxes,this.collectResourceTiming=!!A.collectResourceTiming,this.returnDependencies=!!A.returnDependencies,this.promoteId=A.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(A,L,V,W,X){this.status="parsing",this.data=A,this.collisionBoxArray=new l.a3;const le=new l.bn(Object.keys(A.layers).sort()),te=new l.bo(this.tileID,this.promoteId);te.bucketLayerIDs=[];const J={},ae={featureIndex:te,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},_e=L.familiesBySource[this.source];for(const Et in _e){const kt=A.layers[Et];if(!kt)continue;kt.version===1&&l.w(`Vector tile source "${this.source}" layer "${Et}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const qr=le.encode(Et),jt=[];for(let vr=0;vr<kt.length;vr++){const Fr=kt.feature(vr),ji=te.getId(Fr,Et);jt.push({feature:Fr,id:ji,index:vr,sourceLayerIndex:qr})}for(const vr of _e[Et]){const Fr=vr[0];Fr.source!==this.source&&l.w(`layer.source = ${Fr.source} does not equal this.source = ${this.source}`),Fr.minzoom&&this.zoom<Math.floor(Fr.minzoom)||Fr.maxzoom&&this.zoom>=Fr.maxzoom||Fr.visibility!=="none"&&(he(vr,this.zoom,V),(J[Fr.id]=Fr.createBucket({index:te.bucketLayerIDs.length,layers:vr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:qr,sourceID:this.source})).populate(jt,ae,this.tileID.canonical),te.bucketLayerIDs.push(vr.map(ji=>ji.id)))}}let ve,be,nt,ct;const He=l.aH(ae.glyphDependencies,Et=>Object.keys(Et).map(Number));this.inFlightDependencies.forEach(Et=>Et==null?void 0:Et.cancel()),this.inFlightDependencies=[];const ot=++this.dependencySentinel;Object.keys(He).length?this.inFlightDependencies.push(W.send("getGlyphs",{uid:this.uid,stacks:He,source:this.source,tileID:this.tileID,type:"glyphs"},(Et,kt)=>{ot===this.dependencySentinel&&(ve||(ve=Et,be=kt,Ot.call(this)))})):be={};const dt=Object.keys(ae.iconDependencies);dt.length?this.inFlightDependencies.push(W.send("getImages",{icons:dt,source:this.source,tileID:this.tileID,type:"icons"},(Et,kt)=>{ot===this.dependencySentinel&&(ve||(ve=Et,nt=kt,Ot.call(this)))})):nt={};const At=Object.keys(ae.patternDependencies);function Ot(){if(ve)return X(ve);if(be&&nt&&ct){const Et=new F(be),kt=new l.bp(nt,ct);for(const qr in J){const jt=J[qr];jt instanceof l.a4?(he(jt.layers,this.zoom,V),l.bq({bucket:jt,glyphMap:be,glyphPositions:Et.positions,imageMap:nt,imagePositions:kt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):jt.hasPattern&&(jt instanceof l.br||jt instanceof l.bs||jt instanceof l.bt)&&(he(jt.layers,this.zoom,V),jt.addFeatures(ae,this.tileID.canonical,kt.patternPositions))}this.status="done",X(null,{buckets:Object.values(J).filter(qr=>!qr.isEmpty()),featureIndex:te,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Et.image,imageAtlas:kt,glyphMap:this.returnDependencies?be:null,iconMap:this.returnDependencies?nt:null,glyphPositions:this.returnDependencies?Et.positions:null})}}At.length?this.inFlightDependencies.push(W.send("getImages",{icons:At,source:this.source,tileID:this.tileID,type:"patterns"},(Et,kt)=>{ot===this.dependencySentinel&&(ve||(ve=Et,ct=kt,Ot.call(this)))})):ct={},Ot.call(this)}}function he(q,A,L){const V=new l.a8(A);for(const W of q)W.recalculate(V,L)}function ie(q,A){const L=l.l(q.request,(V,W,X,le)=>{if(V)A(V);else if(W)try{const te=new l.bw.VectorTile(new l.bv(W));A(null,{vectorTile:te,rawData:W,cacheControl:X,expires:le})}catch(te){const J=new Uint8Array(W);let ae=`Unable to parse the tile at ${q.request.url}, `;ae+=J[0]===31&&J[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${te.messge}`,A(new Error(ae))}});return()=>{L.cancel(),A()}}class Ie{constructor(A,L,V,W){this.actor=A,this.layerIndex=L,this.availableImages=V,this.loadVectorData=W||ie,this.fetching={},this.loading={},this.loaded={}}loadTile(A,L){const V=A.uid;this.loading||(this.loading={});const W=!!(A&&A.request&&A.request.collectResourceTiming)&&new l.bu(A.request),X=this.loading[V]=new pe(A);X.abort=this.loadVectorData(A,(le,te)=>{if(delete this.loading[V],le||!te)return X.status="done",this.loaded[V]=X,L(le);const J=te.rawData,ae={};te.expires&&(ae.expires=te.expires),te.cacheControl&&(ae.cacheControl=te.cacheControl);const _e={};if(W){const ve=W.finish();ve&&(_e.resourceTiming=JSON.parse(JSON.stringify(ve)))}X.vectorTile=te.vectorTile,X.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,(ve,be)=>{if(delete this.fetching[V],ve||!be)return L(ve);L(null,l.e({rawTileData:J.slice(0)},be,ae,_e))}),this.loaded=this.loaded||{},this.loaded[V]=X,this.fetching[V]={rawTileData:J,cacheControl:ae,resourceTiming:_e}})}reloadTile(A,L){const V=this.loaded,W=A.uid;if(V&&V[W]){const X=V[W];X.showCollisionBoxes=A.showCollisionBoxes,X.status==="parsing"?X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,(le,te)=>{if(le||!te)return L(le,te);let J;if(this.fetching[W]){const{rawTileData:ae,cacheControl:_e,resourceTiming:ve}=this.fetching[W];delete this.fetching[W],J=l.e({rawTileData:ae.slice(0)},te,_e,ve)}else J=te;L(null,J)}):X.status==="done"&&(X.vectorTile?X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,L):L())}}abortTile(A,L){const V=this.loading,W=A.uid;V&&V[W]&&V[W].abort&&(V[W].abort(),delete V[W]),L()}removeTile(A,L){const V=this.loaded,W=A.uid;V&&V[W]&&delete V[W],L()}}class Pe{constructor(){this.loaded={}}loadTile(A,L){return l._(this,void 0,void 0,function*(){const{uid:V,encoding:W,rawImageData:X,redFactor:le,greenFactor:te,blueFactor:J,baseShift:ae}=A,_e=X.width+2,ve=X.height+2,be=l.a(X)?new l.R({width:_e,height:ve},yield l.bx(X,-1,-1,_e,ve)):X,nt=new l.by(V,be,W,le,te,J,ae);this.loaded=this.loaded||{},this.loaded[V]=nt,L(null,nt)})}removeTile(A){const L=this.loaded,V=A.uid;L&&L[V]&&delete L[V]}}function Ce(q,A){if(q.length!==0){Ne(q[0],A);for(var L=1;L<q.length;L++)Ne(q[L],!A)}}function Ne(q,A){for(var L=0,V=0,W=0,X=q.length,le=X-1;W<X;le=W++){var te=(q[W][0]-q[le][0])*(q[le][1]+q[W][1]),J=L+te;V+=Math.abs(L)>=Math.abs(te)?L-J+te:te-J+L,L=J}L+V>=0!=!!A&&q.reverse()}var re=l.bz(function q(A,L){var V,W=A&&A.type;if(W==="FeatureCollection")for(V=0;V<A.features.length;V++)q(A.features[V],L);else if(W==="GeometryCollection")for(V=0;V<A.geometries.length;V++)q(A.geometries[V],L);else if(W==="Feature")q(A.geometry,L);else if(W==="Polygon")Ce(A.coordinates,L);else if(W==="MultiPolygon")for(V=0;V<A.coordinates.length;V++)Ce(A.coordinates[V],L);return A});const ee=l.bw.VectorTileFeature.prototype.toGeoJSON;var ce={exports:{}},Te=l.bA,$e=l.bw.VectorTileFeature,Ye=it;function it(q,A){this.options=A||{},this.features=q,this.length=q.length}function We(q,A){this.id=typeof q.id=="number"?q.id:void 0,this.type=q.type,this.rawGeometry=q.type===1?[q.geometry]:q.geometry,this.properties=q.tags,this.extent=A||4096}it.prototype.feature=function(q){return new We(this.features[q],this.options.extent)},We.prototype.loadGeometry=function(){var q=this.rawGeometry;this.geometry=[];for(var A=0;A<q.length;A++){for(var L=q[A],V=[],W=0;W<L.length;W++)V.push(new Te(L[W][0],L[W][1]));this.geometry.push(V)}return this.geometry},We.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var q=this.geometry,A=1/0,L=-1/0,V=1/0,W=-1/0,X=0;X<q.length;X++)for(var le=q[X],te=0;te<le.length;te++){var J=le[te];A=Math.min(A,J.x),L=Math.max(L,J.x),V=Math.min(V,J.y),W=Math.max(W,J.y)}return[A,V,L,W]},We.prototype.toGeoJSON=$e.prototype.toGeoJSON;var qt=l.bB,at=Ye;function Ar(q){var A=new qt;return function(L,V){for(var W in L.layers)V.writeMessage(3,Br,L.layers[W])}(q,A),A.finish()}function Br(q,A){var L;A.writeVarintField(15,q.version||1),A.writeStringField(1,q.name||""),A.writeVarintField(5,q.extent||4096);var V={keys:[],values:[],keycache:{},valuecache:{}};for(L=0;L<q.length;L++)V.feature=q.feature(L),A.writeMessage(2,ci,V);var W=V.keys;for(L=0;L<W.length;L++)A.writeStringField(3,W[L]);var X=V.values;for(L=0;L<X.length;L++)A.writeMessage(4,Ge,X[L])}function ci(q,A){var L=q.feature;L.id!==void 0&&A.writeVarintField(1,L.id),A.writeMessage(2,Dr,q),A.writeVarintField(3,L.type),A.writeMessage(4,Zr,L)}function Dr(q,A){var L=q.feature,V=q.keys,W=q.values,X=q.keycache,le=q.valuecache;for(var te in L.properties){var J=L.properties[te],ae=X[te];if(J!==null){ae===void 0&&(V.push(te),X[te]=ae=V.length-1),A.writeVarint(ae);var _e=typeof J;_e!=="string"&&_e!=="boolean"&&_e!=="number"&&(J=JSON.stringify(J));var ve=_e+":"+J,be=le[ve];be===void 0&&(W.push(J),le[ve]=be=W.length-1),A.writeVarint(be)}}}function Qr(q,A){return(A<<3)+(7&q)}function ki(q){return q<<1^q>>31}function Zr(q,A){for(var L=q.loadGeometry(),V=q.type,W=0,X=0,le=L.length,te=0;te<le;te++){var J=L[te],ae=1;V===1&&(ae=J.length),A.writeVarint(Qr(1,ae));for(var _e=V===3?J.length-1:J.length,ve=0;ve<_e;ve++){ve===1&&V!==1&&A.writeVarint(Qr(2,_e-1));var be=J[ve].x-W,nt=J[ve].y-X;A.writeVarint(ki(be)),A.writeVarint(ki(nt)),W+=be,X+=nt}V===3&&A.writeVarint(Qr(7,1))}}function Ge(q,A){var L=typeof q;L==="string"?A.writeStringField(1,q):L==="boolean"?A.writeBooleanField(7,q):L==="number"&&(q%1!=0?A.writeDoubleField(3,q):q<0?A.writeSVarintField(6,q):A.writeVarintField(5,q))}ce.exports=Ar,ce.exports.fromVectorTileJs=Ar,ce.exports.fromGeojsonVt=function(q,A){A=A||{};var L={};for(var V in q)L[V]=new at(q[V].features,A),L[V].name=V,L[V].version=A.version,L[V].extent=A.extent;return Ar({layers:L})},ce.exports.GeoJSONWrapper=at;var pt=l.bz(ce.exports);const yt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:q=>q},Ut=Math.fround||(Ft=new Float32Array(1),q=>(Ft[0]=+q,Ft[0]));var Ft;const Dt=3,lr=5,tn=6;class hi{constructor(A){this.options=Object.assign(Object.create(yt),A),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(A){const{log:L,minZoom:V,maxZoom:W}=this.options;L&&console.time("total time");const X=`prepare ${A.length} points`;L&&console.time(X),this.points=A;const le=[];for(let J=0;J<A.length;J++){const ae=A[J];if(!ae.geometry)continue;const[_e,ve]=ae.geometry.coordinates,be=Ut(nn(_e)),nt=Ut(Vi(ve));le.push(be,nt,1/0,J,-1,1),this.options.reduce&&le.push(0)}let te=this.trees[W+1]=this._createTree(le);L&&console.timeEnd(X);for(let J=W;J>=V;J--){const ae=+Date.now();te=this.trees[J]=this._createTree(this._cluster(te,J)),L&&console.log("z%d: %d clusters in %dms",J,te.numItems,+Date.now()-ae)}return L&&console.timeEnd("total time"),this}getClusters(A,L){let V=((A[0]+180)%360+360)%360-180;const W=Math.max(-90,Math.min(90,A[1]));let X=A[2]===180?180:((A[2]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,A[3]));if(A[2]-A[0]>=360)V=-180,X=180;else if(V>X){const ve=this.getClusters([V,W,180,le],L),be=this.getClusters([-180,W,X,le],L);return ve.concat(be)}const te=this.trees[this._limitZoom(L)],J=te.range(nn(V),Vi(le),nn(X),Vi(W)),ae=te.data,_e=[];for(const ve of J){const be=this.stride*ve;_e.push(ae[be+lr]>1?rn(ae,be,this.clusterProps):this.points[ae[be+Dt]])}return _e}getChildren(A){const L=this._getOriginId(A),V=this._getOriginZoom(A),W="No cluster with the specified id.",X=this.trees[V];if(!X)throw new Error(W);const le=X.data;if(L*this.stride>=le.length)throw new Error(W);const te=this.options.radius/(this.options.extent*Math.pow(2,V-1)),J=X.within(le[L*this.stride],le[L*this.stride+1],te),ae=[];for(const _e of J){const ve=_e*this.stride;le[ve+4]===A&&ae.push(le[ve+lr]>1?rn(le,ve,this.clusterProps):this.points[le[ve+Dt]])}if(ae.length===0)throw new Error(W);return ae}getLeaves(A,L,V){const W=[];return this._appendLeaves(W,A,L=L||10,V=V||0,0),W}getTile(A,L,V){const W=this.trees[this._limitZoom(A)],X=Math.pow(2,A),{extent:le,radius:te}=this.options,J=te/le,ae=(V-J)/X,_e=(V+1+J)/X,ve={features:[]};return this._addTileFeatures(W.range((L-J)/X,ae,(L+1+J)/X,_e),W.data,L,V,X,ve),L===0&&this._addTileFeatures(W.range(1-J/X,ae,1,_e),W.data,X,V,X,ve),L===X-1&&this._addTileFeatures(W.range(0,ae,J/X,_e),W.data,-1,V,X,ve),ve.features.length?ve:null}getClusterExpansionZoom(A){let L=this._getOriginZoom(A)-1;for(;L<=this.options.maxZoom;){const V=this.getChildren(A);if(L++,V.length!==1)break;A=V[0].properties.cluster_id}return L}_appendLeaves(A,L,V,W,X){const le=this.getChildren(L);for(const te of le){const J=te.properties;if(J&&J.cluster?X+J.point_count<=W?X+=J.point_count:X=this._appendLeaves(A,J.cluster_id,V,W,X):X<W?X++:A.push(te),A.length===V)break}return X}_createTree(A){const L=new l.av(A.length/this.stride|0,this.options.nodeSize,Float32Array);for(let V=0;V<A.length;V+=this.stride)L.add(A[V],A[V+1]);return L.finish(),L.data=A,L}_addTileFeatures(A,L,V,W,X,le){for(const te of A){const J=te*this.stride,ae=L[J+lr]>1;let _e,ve,be;if(ae)_e=Jn(L,J,this.clusterProps),ve=L[J],be=L[J+1];else{const He=this.points[L[J+Dt]];_e=He.properties;const[ot,dt]=He.geometry.coordinates;ve=nn(ot),be=Vi(dt)}const nt={type:1,geometry:[[Math.round(this.options.extent*(ve*X-V)),Math.round(this.options.extent*(be*X-W))]],tags:_e};let ct;ct=ae||this.options.generateId?L[J+Dt]:this.points[L[J+Dt]].id,ct!==void 0&&(nt.id=ct),le.features.push(nt)}}_limitZoom(A){return Math.max(this.options.minZoom,Math.min(Math.floor(+A),this.options.maxZoom+1))}_cluster(A,L){const{radius:V,extent:W,reduce:X,minPoints:le}=this.options,te=V/(W*Math.pow(2,L)),J=A.data,ae=[],_e=this.stride;for(let ve=0;ve<J.length;ve+=_e){if(J[ve+2]<=L)continue;J[ve+2]=L;const be=J[ve],nt=J[ve+1],ct=A.within(J[ve],J[ve+1],te),He=J[ve+lr];let ot=He;for(const dt of ct){const At=dt*_e;J[At+2]>L&&(ot+=J[At+lr])}if(ot>He&&ot>=le){let dt,At=be*He,Ot=nt*He,Et=-1;const kt=((ve/_e|0)<<5)+(L+1)+this.points.length;for(const qr of ct){const jt=qr*_e;if(J[jt+2]<=L)continue;J[jt+2]=L;const vr=J[jt+lr];At+=J[jt]*vr,Ot+=J[jt+1]*vr,J[jt+4]=kt,X&&(dt||(dt=this._map(J,ve,!0),Et=this.clusterProps.length,this.clusterProps.push(dt)),X(dt,this._map(J,jt)))}J[ve+4]=kt,ae.push(At/ot,Ot/ot,1/0,kt,-1,ot),X&&ae.push(Et)}else{for(let dt=0;dt<_e;dt++)ae.push(J[ve+dt]);if(ot>1)for(const dt of ct){const At=dt*_e;if(!(J[At+2]<=L)){J[At+2]=L;for(let Ot=0;Ot<_e;Ot++)ae.push(J[At+Ot])}}}}return ae}_getOriginId(A){return A-this.points.length>>5}_getOriginZoom(A){return(A-this.points.length)%32}_map(A,L,V){if(A[L+lr]>1){const le=this.clusterProps[A[L+tn]];return V?Object.assign({},le):le}const W=this.points[A[L+Dt]].properties,X=this.options.map(W);return V&&X===W?Object.assign({},X):X}}function rn(q,A,L){return{type:"Feature",id:q[A+Dt],properties:Jn(q,A,L),geometry:{type:"Point",coordinates:[(V=q[A],360*(V-.5)),Ua(q[A+1])]}};var V}function Jn(q,A,L){const V=q[A+lr],W=V>=1e4?`${Math.round(V/1e3)}k`:V>=1e3?Math.round(V/100)/10+"k":V,X=q[A+tn],le=X===-1?{}:Object.assign({},L[X]);return Object.assign(le,{cluster:!0,cluster_id:q[A+Dt],point_count:V,point_count_abbreviated:W})}function nn(q){return q/360+.5}function Vi(q){const A=Math.sin(q*Math.PI/180),L=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return L<0?0:L>1?1:L}function Ua(q){const A=(180-360*q)*Math.PI/180;return 360*Math.atan(Math.exp(A))/Math.PI-90}function Qn(q,A,L,V){for(var W,X=V,le=L-A>>1,te=L-A,J=q[A],ae=q[A+1],_e=q[L],ve=q[L+1],be=A+3;be<L;be+=3){var nt=ja(q[be],q[be+1],J,ae,_e,ve);if(nt>X)W=be,X=nt;else if(nt===X){var ct=Math.abs(be-le);ct<te&&(W=be,te=ct)}}X>V&&(W-A>3&&Qn(q,A,W,V),q[W+2]=X,L-W>3&&Qn(q,W,L,V))}function ja(q,A,L,V,W,X){var le=W-L,te=X-V;if(le!==0||te!==0){var J=((q-L)*le+(A-V)*te)/(le*le+te*te);J>1?(L=W,V=X):J>0&&(L+=le*J,V+=te*J)}return(le=q-L)*le+(te=A-V)*te}function An(q,A,L,V){var W={id:q===void 0?null:q,type:A,geometry:L,tags:V,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(X){var le=X.geometry,te=X.type;if(te==="Point"||te==="MultiPoint"||te==="LineString")Hs(X,le);else if(te==="Polygon"||te==="MultiLineString")for(var J=0;J<le.length;J++)Hs(X,le[J]);else if(te==="MultiPolygon")for(J=0;J<le.length;J++)for(var ae=0;ae<le[J].length;ae++)Hs(X,le[J][ae])}(W),W}function Hs(q,A){for(var L=0;L<A.length;L+=3)q.minX=Math.min(q.minX,A[L]),q.minY=Math.min(q.minY,A[L+1]),q.maxX=Math.max(q.maxX,A[L]),q.maxY=Math.max(q.maxY,A[L+1])}function _s(q,A,L,V){if(A.geometry){var W=A.geometry.coordinates,X=A.geometry.type,le=Math.pow(L.tolerance/((1<<L.maxZoom)*L.extent),2),te=[],J=A.id;if(L.promoteId?J=A.properties[L.promoteId]:L.generateId&&(J=V||0),X==="Point")es(W,te);else if(X==="MultiPoint")for(var ae=0;ae<W.length;ae++)es(W[ae],te);else if(X==="LineString")ts(W,te,le,!1);else if(X==="MultiLineString"){if(L.lineMetrics){for(ae=0;ae<W.length;ae++)ts(W[ae],te=[],le,!1),q.push(An(J,"LineString",te,A.properties));return}vs(W,te,le,!1)}else if(X==="Polygon")vs(W,te,le,!0);else{if(X!=="MultiPolygon"){if(X==="GeometryCollection"){for(ae=0;ae<A.geometry.geometries.length;ae++)_s(q,{id:J,geometry:A.geometry.geometries[ae],properties:A.properties},L,V);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ae=0;ae<W.length;ae++){var _e=[];vs(W[ae],_e,le,!0),te.push(_e)}}q.push(An(J,X,te,A.properties))}}function es(q,A){A.push(ye(q[0])),A.push(di(q[1])),A.push(0)}function ts(q,A,L,V){for(var W,X,le=0,te=0;te<q.length;te++){var J=ye(q[te][0]),ae=di(q[te][1]);A.push(J),A.push(ae),A.push(0),te>0&&(le+=V?(W*ae-J*X)/2:Math.sqrt(Math.pow(J-W,2)+Math.pow(ae-X,2))),W=J,X=ae}var _e=A.length-3;A[2]=1,Qn(A,0,_e,L),A[_e+2]=1,A.size=Math.abs(le),A.start=0,A.end=A.size}function vs(q,A,L,V){for(var W=0;W<q.length;W++){var X=[];ts(q[W],X,L,V),A.push(X)}}function ye(q){return q/360+.5}function di(q){var A=Math.sin(q*Math.PI/180),L=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return L<0?0:L>1?1:L}function Ui(q,A,L,V,W,X,le,te){if(V/=A,X>=(L/=A)&&le<V)return q;if(le<L||X>=V)return null;for(var J=[],ae=0;ae<q.length;ae++){var _e=q[ae],ve=_e.geometry,be=_e.type,nt=W===0?_e.minX:_e.minY,ct=W===0?_e.maxX:_e.maxY;if(nt>=L&&ct<V)J.push(_e);else if(!(ct<L||nt>=V)){var He=[];if(be==="Point"||be==="MultiPoint")Vt(ve,He,L,V,W);else if(be==="LineString")Ct(ve,He,L,V,W,!1,te.lineMetrics);else if(be==="MultiLineString")Xs(ve,He,L,V,W,!1);else if(be==="Polygon")Xs(ve,He,L,V,W,!0);else if(be==="MultiPolygon")for(var ot=0;ot<ve.length;ot++){var dt=[];Xs(ve[ot],dt,L,V,W,!0),dt.length&&He.push(dt)}if(He.length){if(te.lineMetrics&&be==="LineString"){for(ot=0;ot<He.length;ot++)J.push(An(_e.id,be,He[ot],_e.tags));continue}be!=="LineString"&&be!=="MultiLineString"||(He.length===1?(be="LineString",He=He[0]):be="MultiLineString"),be!=="Point"&&be!=="MultiPoint"||(be=He.length===3?"Point":"MultiPoint"),J.push(An(_e.id,be,He,_e.tags))}}}return J.length?J:null}function Vt(q,A,L,V,W){for(var X=0;X<q.length;X+=3){var le=q[X+W];le>=L&&le<=V&&(A.push(q[X]),A.push(q[X+1]),A.push(q[X+2]))}}function Ct(q,A,L,V,W,X,le){for(var te,J,ae=mn(q),_e=W===0?Eo:Ks,ve=q.start,be=0;be<q.length-3;be+=3){var nt=q[be],ct=q[be+1],He=q[be+2],ot=q[be+3],dt=q[be+4],At=W===0?nt:ct,Ot=W===0?ot:dt,Et=!1;le&&(te=Math.sqrt(Math.pow(nt-ot,2)+Math.pow(ct-dt,2))),At<L?Ot>L&&(J=_e(ae,nt,ct,ot,dt,L),le&&(ae.start=ve+te*J)):At>V?Ot<V&&(J=_e(ae,nt,ct,ot,dt,V),le&&(ae.start=ve+te*J)):Dn(ae,nt,ct,He),Ot<L&&At>=L&&(J=_e(ae,nt,ct,ot,dt,L),Et=!0),Ot>V&&At<=V&&(J=_e(ae,nt,ct,ot,dt,V),Et=!0),!X&&Et&&(le&&(ae.end=ve+te*J),A.push(ae),ae=mn(q)),le&&(ve+=te)}var kt=q.length-3;nt=q[kt],ct=q[kt+1],He=q[kt+2],(At=W===0?nt:ct)>=L&&At<=V&&Dn(ae,nt,ct,He),kt=ae.length-3,X&&kt>=3&&(ae[kt]!==ae[0]||ae[kt+1]!==ae[1])&&Dn(ae,ae[0],ae[1],ae[2]),ae.length&&A.push(ae)}function mn(q){var A=[];return A.size=q.size,A.start=q.start,A.end=q.end,A}function Xs(q,A,L,V,W,X){for(var le=0;le<q.length;le++)Ct(q[le],A,L,V,W,X,!1)}function Dn(q,A,L,V){q.push(A),q.push(L),q.push(V)}function Eo(q,A,L,V,W,X){var le=(X-A)/(V-A);return q.push(X),q.push(L+(W-L)*le),q.push(1),le}function Ks(q,A,L,V,W,X){var le=(X-L)/(W-L);return q.push(A+(V-A)*le),q.push(X),q.push(1),le}function rs(q,A){for(var L=[],V=0;V<q.length;V++){var W,X=q[V],le=X.type;if(le==="Point"||le==="MultiPoint"||le==="LineString")W=xs(X.geometry,A);else if(le==="MultiLineString"||le==="Polygon"){W=[];for(var te=0;te<X.geometry.length;te++)W.push(xs(X.geometry[te],A))}else if(le==="MultiPolygon")for(W=[],te=0;te<X.geometry.length;te++){for(var J=[],ae=0;ae<X.geometry[te].length;ae++)J.push(xs(X.geometry[te][ae],A));W.push(J)}L.push(An(X.id,le,W,X.tags))}return L}function xs(q,A){var L=[];L.size=q.size,q.start!==void 0&&(L.start=q.start,L.end=q.end);for(var V=0;V<q.length;V+=3)L.push(q[V]+A,q[V+1],q[V+2]);return L}function De(q,A){if(q.transformed)return q;var L,V,W,X=1<<q.z,le=q.x,te=q.y;for(L=0;L<q.features.length;L++){var J=q.features[L],ae=J.geometry,_e=J.type;if(J.geometry=[],_e===1)for(V=0;V<ae.length;V+=2)J.geometry.push(gn(ae[V],ae[V+1],A,X,le,te));else for(V=0;V<ae.length;V++){var ve=[];for(W=0;W<ae[V].length;W+=2)ve.push(gn(ae[V][W],ae[V][W+1],A,X,le,te));J.geometry.push(ve)}}return q.transformed=!0,q}function gn(q,A,L,V,W,X){return[Math.round(L*(q*V-W)),Math.round(L*(A*V-X))]}function rr(q,A,L,V,W){for(var X=A===W.maxZoom?0:W.tolerance/((1<<A)*W.extent),le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:L,y:V,z:A,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},te=0;te<q.length;te++){le.numFeatures++,ws(le,q[te],X,W);var J=q[te].minX,ae=q[te].minY,_e=q[te].maxX,ve=q[te].maxY;J<le.minX&&(le.minX=J),ae<le.minY&&(le.minY=ae),_e>le.maxX&&(le.maxX=_e),ve>le.maxY&&(le.maxY=ve)}return le}function ws(q,A,L,V){var W=A.geometry,X=A.type,le=[];if(X==="Point"||X==="MultiPoint")for(var te=0;te<W.length;te+=3)le.push(W[te]),le.push(W[te+1]),q.numPoints++,q.numSimplified++;else if(X==="LineString")Ln(le,W,q,L,!1,!1);else if(X==="MultiLineString"||X==="Polygon")for(te=0;te<W.length;te++)Ln(le,W[te],q,L,X==="Polygon",te===0);else if(X==="MultiPolygon")for(var J=0;J<W.length;J++){var ae=W[J];for(te=0;te<ae.length;te++)Ln(le,ae[te],q,L,!0,te===0)}if(le.length){var _e=A.tags||null;if(X==="LineString"&&V.lineMetrics){for(var ve in _e={},A.tags)_e[ve]=A.tags[ve];_e.mapbox_clip_start=W.start/W.size,_e.mapbox_clip_end=W.end/W.size}var be={geometry:le,type:X==="Polygon"||X==="MultiPolygon"?3:X==="LineString"||X==="MultiLineString"?2:1,tags:_e};A.id!==null&&(be.id=A.id),q.features.push(be)}}function Ln(q,A,L,V,W,X){var le=V*V;if(V>0&&A.size<(W?le:V))L.numPoints+=A.length/3;else{for(var te=[],J=0;J<A.length;J+=3)(V===0||A[J+2]>le)&&(L.numSimplified++,te.push(A[J]),te.push(A[J+1])),L.numPoints++;W&&function(ae,_e){for(var ve=0,be=0,nt=ae.length,ct=nt-2;be<nt;ct=be,be+=2)ve+=(ae[be]-ae[ct])*(ae[be+1]+ae[ct+1]);if(ve>0===_e)for(be=0,nt=ae.length;be<nt/2;be+=2){var He=ae[be],ot=ae[be+1];ae[be]=ae[nt-2-be],ae[be+1]=ae[nt-1-be],ae[nt-2-be]=He,ae[nt-1-be]=ot}}(te,X),q.push(te)}}function Be(q,A){var L=(A=this.options=function(W,X){for(var le in X)W[le]=X[le];return W}(Object.create(this.options),A)).debug;if(L&&console.time("preprocess data"),A.maxZoom<0||A.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(A.promoteId&&A.generateId)throw new Error("promoteId and generateId cannot be used together.");var V=function(W,X){var le=[];if(W.type==="FeatureCollection")for(var te=0;te<W.features.length;te++)_s(le,W.features[te],X,te);else _s(le,W.type==="Feature"?W:{geometry:W},X);return le}(q,A);this.tiles={},this.tileCoords=[],L&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",A.indexMaxZoom,A.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),V=function(W,X){var le=X.buffer/X.extent,te=W,J=Ui(W,1,-1-le,le,0,-1,2,X),ae=Ui(W,1,1-le,2+le,0,-1,2,X);return(J||ae)&&(te=Ui(W,1,-le,1+le,0,-1,2,X)||[],J&&(te=rs(J,1).concat(te)),ae&&(te=te.concat(rs(ae,-1)))),te}(V,A),V.length&&this.splitTile(V,0,0,0),L&&(V.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function gt(q,A,L){return 32*((1<<q)*L+A)+q}function ht(q,A){return A?q.properties[A]:q.id}function ei(q,A){if(q==null)return!0;if(q.type==="Feature")return ht(q,A)!=null;if(q.type==="FeatureCollection"){const L=new Set;for(const V of q.features){const W=ht(V,A);if(W==null||L.has(W))return!1;L.add(W)}return!0}return!1}function yn(q,A){const L=new Map;if(q!=null)if(q.type==="Feature")L.set(ht(q,A),q);else for(const V of q.features)L.set(ht(V,A),V);return L}Be.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Be.prototype.splitTile=function(q,A,L,V,W,X,le){for(var te=[q,A,L,V],J=this.options,ae=J.debug;te.length;){V=te.pop(),L=te.pop(),A=te.pop(),q=te.pop();var _e=1<<A,ve=gt(A,L,V),be=this.tiles[ve];if(!be&&(ae>1&&console.time("creation"),be=this.tiles[ve]=rr(q,A,L,V,J),this.tileCoords.push({z:A,x:L,y:V}),ae)){ae>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",A,L,V,be.numFeatures,be.numPoints,be.numSimplified),console.timeEnd("creation"));var nt="z"+A;this.stats[nt]=(this.stats[nt]||0)+1,this.total++}if(be.source=q,W){if(A===J.maxZoom||A===W)continue;var ct=1<<W-A;if(L!==Math.floor(X/ct)||V!==Math.floor(le/ct))continue}else if(A===J.indexMaxZoom||be.numPoints<=J.indexMaxPoints)continue;if(be.source=null,q.length!==0){ae>1&&console.time("clipping");var He,ot,dt,At,Ot,Et,kt=.5*J.buffer/J.extent,qr=.5-kt,jt=.5+kt,vr=1+kt;He=ot=dt=At=null,Ot=Ui(q,_e,L-kt,L+jt,0,be.minX,be.maxX,J),Et=Ui(q,_e,L+qr,L+vr,0,be.minX,be.maxX,J),q=null,Ot&&(He=Ui(Ot,_e,V-kt,V+jt,1,be.minY,be.maxY,J),ot=Ui(Ot,_e,V+qr,V+vr,1,be.minY,be.maxY,J),Ot=null),Et&&(dt=Ui(Et,_e,V-kt,V+jt,1,be.minY,be.maxY,J),At=Ui(Et,_e,V+qr,V+vr,1,be.minY,be.maxY,J),Et=null),ae>1&&console.timeEnd("clipping"),te.push(He||[],A+1,2*L,2*V),te.push(ot||[],A+1,2*L,2*V+1),te.push(dt||[],A+1,2*L+1,2*V),te.push(At||[],A+1,2*L+1,2*V+1)}}},Be.prototype.getTile=function(q,A,L){var V=this.options,W=V.extent,X=V.debug;if(q<0||q>24)return null;var le=1<<q,te=gt(q,A=(A%le+le)%le,L);if(this.tiles[te])return De(this.tiles[te],W);X>1&&console.log("drilling down to z%d-%d-%d",q,A,L);for(var J,ae=q,_e=A,ve=L;!J&&ae>0;)ae--,_e=Math.floor(_e/2),ve=Math.floor(ve/2),J=this.tiles[gt(ae,_e,ve)];return J&&J.source?(X>1&&console.log("found parent tile z%d-%d-%d",ae,_e,ve),X>1&&console.time("drilling down"),this.splitTile(J.source,ae,_e,ve,q,A,L),X>1&&console.timeEnd("drilling down"),this.tiles[te]?De(this.tiles[te],W):null):null};class ft extends Ie{constructor(A,L,V,W){super(A,L,V),this._dataUpdateable=new Map,this.loadGeoJSON=(X,le)=>{const{promoteId:te}=X;if(X.request)return l.f(X.request,(J,ae,_e,ve)=>{this._dataUpdateable=ei(ae,te)?yn(ae,te):void 0,le(J,ae,_e,ve)});if(typeof X.data=="string")try{const J=JSON.parse(X.data);this._dataUpdateable=ei(J,te)?yn(J,te):void 0,le(null,J)}catch{le(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`))}else X.dataDiff?this._dataUpdateable?(function(J,ae,_e){var ve,be,nt,ct;if(ae.removeAll&&J.clear(),ae.remove)for(const He of ae.remove)J.delete(He);if(ae.add)for(const He of ae.add){const ot=ht(He,_e);ot!=null&&J.set(ot,He)}if(ae.update)for(const He of ae.update){let ot=J.get(He.id);if(ot==null)continue;const dt=!He.removeAllProperties&&(((ve=He.removeProperties)===null||ve===void 0?void 0:ve.length)>0||((be=He.addOrUpdateProperties)===null||be===void 0?void 0:be.length)>0);if((He.newGeometry||He.removeAllProperties||dt)&&(ot=Object.assign({},ot),J.set(He.id,ot),dt&&(ot.properties=Object.assign({},ot.properties))),He.newGeometry&&(ot.geometry=He.newGeometry),He.removeAllProperties)ot.properties={};else if(((nt=He.removeProperties)===null||nt===void 0?void 0:nt.length)>0)for(const At of He.removeProperties)Object.prototype.hasOwnProperty.call(ot.properties,At)&&delete ot.properties[At];if(((ct=He.addOrUpdateProperties)===null||ct===void 0?void 0:ct.length)>0)for(const{key:At,value:Ot}of He.addOrUpdateProperties)ot.properties[At]=Ot}}(this._dataUpdateable,X.dataDiff,te),le(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):le(new Error(`Cannot update existing geojson data in ${X.source}`)):le(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,W&&(this.loadGeoJSON=W)}loadGeoJSONTile(A,L){const V=A.tileID.canonical;if(!this._geoJSONIndex)return L(null,null);const W=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!W)return L(null,null);const X=new class{constructor(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.N,this.length=te.length,this._features=te}feature(te){return new class{constructor(J){this._feature=J,this.extent=l.N,this.type=J.type,this.properties=J.tags,"id"in J&&!isNaN(J.id)&&(this.id=parseInt(J.id,10))}loadGeometry(){if(this._feature.type===1){const J=[];for(const ae of this._feature.geometry)J.push([new l.P(ae[0],ae[1])]);return J}{const J=[];for(const ae of this._feature.geometry){const _e=[];for(const ve of ae)_e.push(new l.P(ve[0],ve[1]));J.push(_e)}return J}}toGeoJSON(J,ae,_e){return ee.call(this,J,ae,_e)}}(this._features[te])}}(W.features);let le=pt(X);le.byteOffset===0&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),L(null,{vectorTile:X,rawData:le.buffer})}loadData(A,L){var V;(V=this._pendingRequest)===null||V===void 0||V.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const W=!!(A&&A.request&&A.request.collectResourceTiming)&&new l.bu(A.request);this._pendingCallback=L,this._pendingRequest=this.loadGeoJSON(A,(X,le)=>{if(delete this._pendingCallback,delete this._pendingRequest,X||!le)return L(X);if(typeof le!="object")return L(new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`));{re(le,!0);try{if(A.filter){const J=l.bC(A.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));le={type:"FeatureCollection",features:le.features.filter(_e=>J.value.evaluate({zoom:0},_e))}}this._geoJSONIndex=A.cluster?new hi(function({superclusterOptions:J,clusterProperties:ae}){if(!ae||!J)return J;const _e={},ve={},be={accumulated:null,zoom:0},nt={properties:null},ct=Object.keys(ae);for(const He of ct){const[ot,dt]=ae[He],At=l.bC(dt),Ot=l.bC(typeof ot=="string"?[ot,["accumulated"],["get",He]]:ot);_e[He]=At.value,ve[He]=Ot.value}return J.map=He=>{nt.properties=He;const ot={};for(const dt of ct)ot[dt]=_e[dt].evaluate(be,nt);return ot},J.reduce=(He,ot)=>{nt.properties=ot;for(const dt of ct)be.accumulated=He[dt],He[dt]=ve[dt].evaluate(be,nt)},J}(A)).load(le.features):function(J,ae){return new Be(J,ae)}(le,A.geojsonVtOptions)}catch(J){return L(J)}this.loaded={};const te={};if(W){const J=W.finish();J&&(te.resourceTiming={},te.resourceTiming[A.source]=JSON.parse(JSON.stringify(J)))}L(null,te)}})}reloadTile(A,L){const V=this.loaded;return V&&V[A.uid]?super.reloadTile(A,L):this.loadTile(A,L)}removeSource(A,L){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),L()}getClusterExpansionZoom(A,L){try{L(null,this._geoJSONIndex.getClusterExpansionZoom(A.clusterId))}catch(V){L(V)}}getClusterChildren(A,L){try{L(null,this._geoJSONIndex.getChildren(A.clusterId))}catch(V){L(V)}}getClusterLeaves(A,L){try{L(null,this._geoJSONIndex.getLeaves(A.clusterId,A.limit,A.offset))}catch(V){L(V)}}}class Rn{constructor(A){this.self=A,this.actor=new l.C(A,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ie,geojson:ft},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(L,V)=>{if(this.workerSourceTypes[L])throw new Error(`Worker source with name "${L}" already registered.`);this.workerSourceTypes[L]=V},this.self.registerRTLTextPlugin=L=>{if(l.bD.isParsed())throw new Error("RTL text plugin already registered.");l.bD.applyArabicShaping=L.applyArabicShaping,l.bD.processBidirectionalText=L.processBidirectionalText,l.bD.processStyledBidirectionalText=L.processStyledBidirectionalText}}setReferrer(A,L){this.referrer=L}setImages(A,L,V){this.availableImages[A]=L;for(const W in this.workerSources[A]){const X=this.workerSources[A][W];for(const le in X)X[le].availableImages=L}V()}setLayers(A,L,V){this.getLayerIndex(A).replace(L),V()}updateLayers(A,L,V){this.getLayerIndex(A).update(L.layers,L.removedIds),V()}loadTile(A,L,V){this.getWorkerSource(A,L.type,L.source).loadTile(L,V)}loadDEMTile(A,L,V){this.getDEMWorkerSource(A,L.source).loadTile(L,V)}reloadTile(A,L,V){this.getWorkerSource(A,L.type,L.source).reloadTile(L,V)}abortTile(A,L,V){this.getWorkerSource(A,L.type,L.source).abortTile(L,V)}removeTile(A,L,V){this.getWorkerSource(A,L.type,L.source).removeTile(L,V)}removeDEMTile(A,L){this.getDEMWorkerSource(A,L.source).removeTile(L)}removeSource(A,L,V){if(!this.workerSources[A]||!this.workerSources[A][L.type]||!this.workerSources[A][L.type][L.source])return;const W=this.workerSources[A][L.type][L.source];delete this.workerSources[A][L.type][L.source],W.removeSource!==void 0?W.removeSource(L,V):V()}loadWorkerSource(A,L,V){try{this.self.importScripts(L.url),V()}catch(W){V(W.toString())}}syncRTLPluginState(A,L,V){try{l.bD.setState(L);const W=l.bD.getPluginURL();if(l.bD.isLoaded()&&!l.bD.isParsed()&&W!=null){this.self.importScripts(W);const X=l.bD.isParsed();V(X?void 0:new Error(`RTL Text Plugin failed to import scripts from ${W}`),X)}}catch(W){V(W.toString())}}getAvailableImages(A){let L=this.availableImages[A];return L||(L=[]),L}getLayerIndex(A){let L=this.layerIndexes[A];return L||(L=this.layerIndexes[A]=new N),L}getWorkerSource(A,L,V){return this.workerSources[A]||(this.workerSources[A]={}),this.workerSources[A][L]||(this.workerSources[A][L]={}),this.workerSources[A][L][V]||(this.workerSources[A][L][V]=new this.workerSourceTypes[L]({send:(W,X,le)=>{this.actor.send(W,X,le,A)}},this.getLayerIndex(A),this.getAvailableImages(A))),this.workerSources[A][L][V]}getDEMWorkerSource(A,L){return this.demWorkerSources[A]||(this.demWorkerSources[A]={}),this.demWorkerSources[A][L]||(this.demWorkerSources[A][L]=new Pe),this.demWorkerSources[A][L]}}return l.i()&&(self.worker=new Rn(self)),Rn}),S(["./shared"],function(l){var N="3.6.2";class F{static testProp(t){if(!F.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in F.docStyle)return t[a];return t[0]}static create(t,a,c){const d=window.document.createElement(t);return a!==void 0&&(d.className=a),c&&c.appendChild(d),d}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){F.docStyle&&F.selectProp&&(F.userSelect=F.docStyle[F.selectProp],F.docStyle[F.selectProp]="none")}static enableDrag(){F.docStyle&&F.selectProp&&(F.docStyle[F.selectProp]=F.userSelect)}static setTransform(t,a){t.style[F.transformProp]=a}static addEventListener(t,a,c,d={}){t.addEventListener(a,c,"passive"in d?d:d.capture)}static removeEventListener(t,a,c,d={}){t.removeEventListener(a,c,"passive"in d?d:d.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",F.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",F.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",F.suppressClickInternal,!0)},0)}static mousePos(t,a){const c=t.getBoundingClientRect();return new l.P(a.clientX-c.left-t.clientLeft,a.clientY-c.top-t.clientTop)}static touchPos(t,a){const c=t.getBoundingClientRect(),d=[];for(let f=0;f<a.length;f++)d.push(new l.P(a[f].clientX-c.left-t.clientLeft,a[f].clientY-c.top-t.clientTop));return d}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}F.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,F.selectProp=F.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),F.transformProp=F.testProp(["transform","WebkitTransform"]);const pe={supported:!1,testSupport:function(p){!Ie&&ie&&(Pe?Ce(p):he=p)}};let he,ie,Ie=!1,Pe=!1;function Ce(p){const t=p.createTexture();p.bindTexture(p.TEXTURE_2D,t);try{if(p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,ie),p.isContextLost())return;pe.supported=!0}catch{}p.deleteTexture(t),Ie=!0}var Ne,re;typeof document<"u"&&(ie=document.createElement("img"),ie.onload=function(){he&&Ce(he),he=null,Pe=!0},ie.onerror=function(){Ie=!0,he=null},ie.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(p){let t,a,c,d;p.resetRequestQueue=()=>{t=[],a=0,c=0,d={}},p.addThrottleControl=E=>{const C=c++;return d[C]=E,C},p.removeThrottleControl=E=>{delete d[E],w()},p.getImage=(E,C,P=!0)=>{pe.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*");const R={requestParameters:E,supportImageRefresh:P,callback:C,cancelled:!1,completed:!1,cancel:()=>{R.completed||R.cancelled||(R.cancelled=!0,R.innerRequest&&(R.innerRequest.cancel(),a--),w())}};return t.push(R),w(),R};const f=E=>{const{requestParameters:C,supportImageRefresh:P,callback:R}=E;return l.e(C,{type:"image"}),(P!==!1||l.i()||l.g(C.url)||C.headers&&!Object.keys(C.headers).reduce((Z,$)=>Z&&$==="accept",!0)?l.m:T)(C,(Z,$,G,U)=>{x(E,R,Z,$,G,U)})},x=(E,C,P,R,Z,$)=>{P?C(P):R instanceof HTMLImageElement||l.a(R)?C(null,R):R&&((G,U)=>{typeof createImageBitmap=="function"?l.b(G,U):l.d(G,U)})(R,(G,U)=>{G!=null?C(G):U!=null&&C(null,U,{cacheControl:Z,expires:$})}),E.cancelled||(E.completed=!0,a--,w())},w=()=>{const E=(()=>{const C=Object.keys(d);let P=!1;if(C.length>0){for(const R of C)if(P=d[R](),P)break}return P})()?l.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let C=a;C<E&&t.length>0;C++){const P=t.shift();if(P.cancelled){C--;continue}const R=f(P);a++,P.innerRequest=R}},T=(E,C)=>{const P=new Image,R=E.url;let Z=!1;const $=E.credentials;return $&&$==="include"?P.crossOrigin="use-credentials":($&&$==="same-origin"||!l.s(R))&&(P.crossOrigin="anonymous"),P.fetchPriority="high",P.onload=()=>{C(null,P),P.onerror=P.onload=null},P.onerror=()=>{Z||C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),P.onerror=P.onload=null},P.src=R,{cancel:()=>{Z=!0,P.src=""}}}}(Ne||(Ne={})),Ne.resetRequestQueue(),function(p){p.Glyphs="Glyphs",p.Image="Image",p.Source="Source",p.SpriteImage="SpriteImage",p.SpriteJSON="SpriteJSON",p.Style="Style",p.Tile="Tile",p.Unknown="Unknown"}(re||(re={}));class ee{constructor(t){this._transformRequestFn=t}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}normalizeSpriteURL(t,a,c){const d=function(f){const x=f.match(ce);if(!x)throw new Error(`Unable to parse URL "${f}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(t);return d.path+=`${a}${c}`,function(f){const x=f.params.length?`?${f.params.join("&")}`:"";return`${f.protocol}://${f.authority}${f.path}${x}`}(d)}setTransformRequest(t){this._transformRequestFn=t}}const ce=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Te(p){var t=new l.A(3);return t[0]=p[0],t[1]=p[1],t[2]=p[2],t}var $e,Ye=function(p,t,a){return p[0]=t[0]-a[0],p[1]=t[1]-a[1],p[2]=t[2]-a[2],p};$e=new l.A(3),l.A!=Float32Array&&($e[0]=0,$e[1]=0,$e[2]=0);var it=function(p){var t=p[0],a=p[1];return t*t+a*a};function We(p){const t=[];if(typeof p=="string")t.push({id:"default",url:p});else if(p&&p.length>0){const a=[];for(const{id:c,url:d}of p){const f=`${c}${d}`;a.indexOf(f)===-1&&(a.push(f),t.push({id:c,url:d}))}}return t}function qt(p,t,a,c,d){if(c)return void p(c);if(d!==Object.values(t).length||d!==Object.values(a).length)return;const f={};for(const x in t){f[x]={};const w=l.h.getImageCanvasContext(a[x]),T=t[x];for(const E in T){const{width:C,height:P,x:R,y:Z,sdf:$,pixelRatio:G,stretchX:U,stretchY:ne,content:de}=T[E];f[x][E]={data:null,pixelRatio:G,sdf:$,stretchX:U,stretchY:ne,content:de,spriteData:{width:C,height:P,x:R,y:Z,context:w}}}}p(null,f)}(function(){var p=new l.A(2);l.A!=Float32Array&&(p[0]=0,p[1]=0)})();class at{constructor(t,a,c,d){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(a,d)}update(t,a,c){const{width:d,height:f}=t,x=!(this.size&&this.size[0]===d&&this.size[1]===f||c),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(a&&a.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!a||a.premultiply!==!1)),x)this.size=[d,f],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||l.a(t)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,t):T.texImage2D(T.TEXTURE_2D,0,this.format,d,f,0,this.format,T.UNSIGNED_BYTE,t.data);else{const{x:E,y:C}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||l.a(t)?T.texSubImage2D(T.TEXTURE_2D,0,E,C,T.RGBA,T.UNSIGNED_BYTE,t):T.texSubImage2D(T.TEXTURE_2D,0,E,C,d,f,T.RGBA,T.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(t,a,c){const{context:d}=this,{gl:f}=d;f.bindTexture(f.TEXTURE_2D,this.texture),c!==f.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=f.LINEAR),t!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,c||t),this.filter=t),a!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,a),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Ar(p){const{userImage:t}=p;return!!(t&&t.render&&t.render())&&(p.data.replace(new Uint8Array(t.data.buffer)),!0)}class Br extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,callback:c}of this.requestors)this._notify(a,c);this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const c=a.spriteData;a.data=new l.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let c=!0;const d=a.data||a.spriteData;return this._validateStretch(a.stretchX,d&&d.width)||(this.fire(new l.j(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(a.stretchY,d&&d.height)||(this.fire(new l.j(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(a.content,a)||(this.fire(new l.j(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,a){if(!t)return!0;let c=0;for(const d of t){if(d[0]<c||d[1]<d[0]||a<d[1])return!1;c=d[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const c=a.spriteData,d=c&&c.width||a.data.width,f=c&&c.height||a.data.height;return!(t[0]<0||d<t[0]||t[1]<0||f<t[1]||t[2]<0||d<t[2]||t[3]<0||f<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,c=!0){const d=this.getImage(t);if(c&&(d.data.width!==a.data.width||d.data.height!==a.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=d.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,a){let c=!0;if(!this.isLoaded())for(const d of t)this.images[d]||(c=!1);this.isLoaded()||c?this._notify(t,a):this.requestors.push({ids:t,callback:a})}_notify(t,a){const c={};for(const d of t){let f=this.getImage(d);f||(this.fire(new l.k("styleimagemissing",{id:d})),f=this.getImage(d)),f?c[d]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:l.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}a(null,c)}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],c=this.getImage(t);if(!c)return null;if(a&&a.position.version===c.version)return a.position;if(a)a.position.version=c.version;else{const d={w:c.data.width+2,h:c.data.height+2,x:0,y:0},f=new l.I(d,c);this.patterns[t]={bin:d,position:f}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new at(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const f in this.patterns)t.push(this.patterns[f].bin);const{w:a,h:c}=l.p(t),d=this.atlasImage;d.resize({width:a||1,height:c||1});for(const f in this.patterns){const{bin:x}=this.patterns[f],w=x.x+1,T=x.y+1,E=this.getImage(f).data,C=E.width,P=E.height;l.R.copy(E,d,{x:0,y:0},{x:w,y:T},{width:C,height:P}),l.R.copy(E,d,{x:0,y:P-1},{x:w,y:T-1},{width:C,height:1}),l.R.copy(E,d,{x:0,y:0},{x:w,y:T+P},{width:C,height:1}),l.R.copy(E,d,{x:C-1,y:0},{x:w-1,y:T},{width:1,height:P}),l.R.copy(E,d,{x:0,y:0},{x:w+C,y:T},{width:1,height:P})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const c=this.getImage(a);c||l.w(`Image with ID: "${a}" was not found`),Ar(c)&&this.updateImage(a,c)}}}const ci=1e20;function Dr(p,t,a,c,d,f,x,w,T){for(let E=t;E<t+c;E++)Qr(p,a*f+E,f,d,x,w,T);for(let E=a;E<a+d;E++)Qr(p,E*f+t,1,c,x,w,T)}function Qr(p,t,a,c,d,f,x){f[0]=0,x[0]=-ci,x[1]=ci,d[0]=p[t];for(let w=1,T=0,E=0;w<c;w++){d[w]=p[t+w*a];const C=w*w;do{const P=f[T];E=(d[w]-d[P]+C-P*P)/(w-P)/2}while(E<=x[T]&&--T>-1);T++,f[T]=w,x[T]=E,x[T+1]=ci}for(let w=0,T=0;w<c;w++){for(;x[T+1]<w;)T++;const E=f[T],C=w-E;p[t+w*a]=d[E]+C*C}}class ki{constructor(t,a){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={}}setURL(t){this.url=t}getGlyphs(t,a){const c=[];for(const d in t)for(const f of t[d])c.push({stack:d,id:f});l.o(c,({stack:d,id:f},x)=>{let w=this.entries[d];w||(w=this.entries[d]={glyphs:{},requests:{},ranges:{}});let T=w.glyphs[f];if(T!==void 0)return void x(null,{stack:d,id:f,glyph:T});if(T=this._tinySDF(w,d,f),T)return w.glyphs[f]=T,void x(null,{stack:d,id:f,glyph:T});const E=Math.floor(f/256);if(256*E>65535)return void x(new Error("glyphs > 65535 not supported"));if(w.ranges[E])return void x(null,{stack:d,id:f,glyph:T});if(!this.url)return void x(new Error("glyphsUrl is not set"));let C=w.requests[E];C||(C=w.requests[E]=[],ki.loadGlyphRange(d,E,this.url,this.requestManager,(P,R)=>{if(R){for(const Z in R)this._doesCharSupportLocalGlyph(+Z)||(w.glyphs[+Z]=R[+Z]);w.ranges[E]=!0}for(const Z of C)Z(P,R);delete w.requests[E]})),C.push((P,R)=>{P?x(P):R&&x(null,{stack:d,id:f,glyph:R[f]||null})})},(d,f)=>{if(d)a(d);else if(f){const x={};for(const{stack:w,id:T,glyph:E}of f)(x[w]||(x[w]={}))[T]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics};a(null,x)}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(l.u["CJK Unified Ideographs"](t)||l.u["Hangul Syllables"](t)||l.u.Hiragana(t)||l.u.Katakana(t))}_tinySDF(t,a,c){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let f=t.tinySDF;if(!f){let w="400";/bold/i.test(a)?w="900":/medium/i.test(a)?w="500":/light/i.test(a)&&(w="200"),f=t.tinySDF=new ki.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:w})}const x=f.draw(String.fromCharCode(c));return{id:c,bitmap:new l.q({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}ki.loadGlyphRange=function(p,t,a,c,d){const f=256*t,x=f+255,w=c.transformRequest(a.replace("{fontstack}",p).replace("{range}",`${f}-${x}`),re.Glyphs);l.l(w,(T,E)=>{if(T)d(T);else if(E){const C={};for(const P of l.n(E))C[P.id]=P;d(null,C)}})},ki.TinySDF=class{constructor({fontSize:p=24,buffer:t=3,radius:a=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:f="normal",fontStyle:x="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=a;const w=this.size=p+4*t,T=this._createCanvas(w),E=this.ctx=T.getContext("2d",{willReadFrequently:!0});E.font=`${x} ${f} ${p}px ${d}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(p){const t=document.createElement("canvas");return t.width=t.height=p,t}draw(p){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:f}=this.ctx.measureText(p),x=Math.ceil(a),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-d))),T=Math.min(this.size-this.buffer,x+Math.ceil(c)),E=w+2*this.buffer,C=T+2*this.buffer,P=Math.max(E*C,0),R=new Uint8ClampedArray(P),Z={data:R,width:E,height:C,glyphWidth:w,glyphHeight:T,glyphTop:x,glyphLeft:0,glyphAdvance:t};if(w===0||T===0)return Z;const{ctx:$,buffer:G,gridInner:U,gridOuter:ne}=this;$.clearRect(G,G,w,T),$.fillText(p,G,G+x);const de=$.getImageData(G,G,w,T);ne.fill(ci,0,P),U.fill(0,0,P);for(let K=0;K<T;K++)for(let se=0;se<w;se++){const me=de.data[4*(K*w+se)+3]/255;if(me===0)continue;const ge=(K+G)*E+se+G;if(me===1)ne[ge]=0,U[ge]=ci;else{const xe=.5-me;ne[ge]=xe>0?xe*xe:0,U[ge]=xe<0?xe*xe:0}}Dr(ne,0,0,E,C,E,this.f,this.v,this.z),Dr(U,G,G,w,T,E,this.f,this.v,this.z);for(let K=0;K<P;K++){const se=Math.sqrt(ne[K])-Math.sqrt(U[K]);R[K]=Math.round(255-255*(se/this.radius+this.cutoff))}return Z}};class Zr{constructor(){this.specification=l.v.light.position}possiblyEvaluate(t,a){return l.z(t.expression.evaluate(a))}interpolate(t,a,c){return{x:l.B.number(t.x,a.x,c),y:l.B.number(t.y,a.y,c),z:l.B.number(t.z,a.z,c)}}}let Ge;class pt extends l.E{constructor(t){super(),Ge=Ge||new l.r({anchor:new l.D(l.v.light.anchor),position:new Zr,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.T(Ge),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(l.t,t,a))for(const c in t){const d=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),d):this._transitionable.setValue(c,d)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,c){return(!c||c.validate!==!1)&&l.x(this,t.call(l.y,l.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}}class yt{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const c=t.join(",")+String(a);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,a)),this.dashEntry[c]}getDashRanges(t,a,c){const d=[];let f=t.length%2==1?-t[t.length-1]*c:0,x=t[0]*c,w=!0;d.push({left:f,right:x,isDash:w,zeroLength:t[0]===0});let T=t[0];for(let E=1;E<t.length;E++){w=!w;const C=t[E];f=T*c,T+=C,x=T*c,d.push({left:f,right:x,isDash:w,zeroLength:C===0})}return d}addRoundDash(t,a,c){const d=a/2;for(let f=-c;f<=c;f++){const x=this.width*(this.nextRow+c+f);let w=0,T=t[w];for(let E=0;E<this.width;E++){E/T.right>1&&(T=t[++w]);const C=Math.abs(E-T.left),P=Math.abs(E-T.right),R=Math.min(C,P);let Z;const $=f/c*(d+1);if(T.isDash){const G=d-Math.abs($);Z=Math.sqrt(R*R+G*G)}else Z=d-Math.sqrt(R*R+$*$);this.data[x+E]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(t){for(let w=t.length-1;w>=0;--w){const T=t[w],E=t[w+1];T.zeroLength?t.splice(w,1):E&&E.isDash===T.isDash&&(E.left=T.left,t.splice(w,1))}const a=t[0],c=t[t.length-1];a.isDash===c.isDash&&(a.left=c.left-this.width,c.right=a.right+this.width);const d=this.width*this.nextRow;let f=0,x=t[f];for(let w=0;w<this.width;w++){w/x.right>1&&(x=t[++f]);const T=Math.abs(w-x.left),E=Math.abs(w-x.right),C=Math.min(T,E);this.data[d+w]=Math.max(0,Math.min(255,(x.isDash?C:-C)+128))}}addDash(t,a){const c=a?7:0,d=2*c+1;if(this.nextRow+d>this.height)return l.w("LineAtlas out of space"),null;let f=0;for(let w=0;w<t.length;w++)f+=t[w];if(f!==0){const w=this.width/f,T=this.getDashRanges(t,this.width,w);a?this.addRoundDash(T,w,c):this.addRegularDash(T)}const x={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:f};return this.nextRow+=d,this.dirty=!0,x}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}class Ut{constructor(t,a,c){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=c;const d=this.workerPool.acquire(c);for(let f=0;f<d.length;f++){const x=new l.C(d[f],a,c);x.name=`Worker ${f}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a,c){l.o(this.actors,(d,f)=>{d.send(t,a,f)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}}function Ft(p,t,a){const c=function(d,f){if(d)return a(d);if(f){const x=l.F(l.e(f,p),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);f.vector_layers&&(x.vectorLayers=f.vector_layers,x.vectorLayerIds=x.vectorLayers.map(w=>w.id)),a(null,x)}};return p.url?l.f(t.transformRequest(p.url,re.Source),c):l.h.frame(()=>c(null,p))}class Dt{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof l.L?new l.L(t.lng,t.lat):l.L.convert(t),this}setSouthWest(t){return this._sw=t instanceof l.L?new l.L(t.lng,t.lat):l.L.convert(t),this}extend(t){const a=this._sw,c=this._ne;let d,f;if(t instanceof l.L)d=t,f=t;else{if(!(t instanceof Dt))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Dt.convert(t)):this.extend(l.L.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(l.L.convert(t)):this;if(d=t._sw,f=t._ne,!d||!f)return this}return a||c?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),c.lng=Math.max(f.lng,c.lng),c.lat=Math.max(f.lat,c.lat)):(this._sw=new l.L(d.lng,d.lat),this._ne=new l.L(f.lng,f.lat)),this}getCenter(){return new l.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.L(this.getWest(),this.getNorth())}getSouthEast(){return new l.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:c}=l.L.convert(t);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(t){return t instanceof Dt?t:t&&new Dt(t)}static fromLngLat(t,a=0){const c=360*a/40075017,d=c/Math.cos(Math.PI/180*t.lat);return new Dt(new l.L(t.lng-d,t.lat-c),new l.L(t.lng+d,t.lat+c))}}class lr{constructor(t,a,c){this.bounds=Dt.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),c=Math.floor(l.G(this.bounds.getWest())*a),d=Math.floor(l.H(this.bounds.getNorth())*a),f=Math.ceil(l.G(this.bounds.getEast())*a),x=Math.ceil(l.H(this.bounds.getSouth())*a);return t.x>=c&&t.x<f&&t.y>=d&&t.y<x}}class tn extends l.E{constructor(t,a,c,d){if(super(),this.load=()=>{this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ft(this._options,this.map._requestManager,(f,x)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),f?this.fire(new l.j(f)):x&&(l.e(this,x),x.bounds&&(this.tileBounds=new lr(x.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>l.e({},this._options),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.F(a,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(t,a){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(c,re.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function f(x,w){return delete t.request,t.aborted?a(null):x&&x.status!==404?a(x):(w&&w.resourceTiming&&(t.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&t.setExpiryData(w),t.loadVectorData(w,this.map.painter),a(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}d.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired"?t.state==="loading"?t.reloadCallback=a:t.request=t.actor.send("reloadTile",d,f.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",d,f.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class hi extends l.E{constructor(t,a,c,d){super(),this.id=t,this.dispatcher=c,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},a),l.e(this,l.F(a,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ft(this._options,this.map._requestManager,(t,a)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new l.j(t)):a&&(l.e(this,a),a.bounds&&(this.tileBounds=new lr(a.bounds,this.minzoom,this.maxzoom)),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}serialize(){return l.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,a){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=Ne.getImage(this.map._requestManager.transformRequest(c,re.Tile),(d,f,x)=>{if(delete t.request,t.aborted)t.state="unloaded",a(null);else if(d)t.state="errored",a(d);else if(f){this.map._refreshExpiredTiles&&x&&t.setExpiryData(x);const w=this.map.painter.context,T=w.gl;t.texture=this.map.painter.getTileTexture(f.width),t.texture?t.texture.update(f,{useMipmap:!0}):(t.texture=new at(w,f,T.RGBA,{useMipmap:!0}),t.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),w.extTextureFilterAnisotropic&&T.texParameterf(T.TEXTURE_2D,w.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,w.extTextureFilterAnisotropicMax)),t.state="loaded",a(null)}},this.map._refreshExpiredTiles)}abortTile(t,a){t.request&&(t.request.cancel(),delete t.request),a()}unloadTile(t,a){t.texture&&this.map.painter.saveTileTexture(t.texture),a()}hasTransition(){return!1}}class rn extends hi{constructor(t,a,c,d){super(t,a,c,d),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t,a){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(c,re.Tile);function f(x,w){x&&(t.state="errored",a(x)),w&&(t.dem=w,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",a(null))}t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.request=Ne.getImage(d,(x,w,T)=>l._(this,void 0,void 0,function*(){if(delete t.request,t.aborted)t.state="unloaded",a(null);else if(x)t.state="errored",a(x);else if(w){this.map._refreshExpiredTiles&&t.setExpiryData(T);const E=l.a(w)&&l.J()?w:yield function(P){return l._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&l.K()){const R=P.width+2,Z=P.height+2;try{return new l.R({width:R,height:Z},yield l.M(P,-1,-1,R,Z))}catch{}}return l.h.getImageData(P,1)})}(w),C={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};t.actor&&t.state!=="expired"||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",C,f))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(t){const a=t.canonical,c=Math.pow(2,a.z),d=(a.x-1+c)%c,f=a.x===0?t.wrap-1:t.wrap,x=(a.x+1+c)%c,w=a.x+1===c?t.wrap+1:t.wrap,T={};return T[new l.O(t.overscaledZ,f,a.z,d,a.y).key]={backfilled:!1},T[new l.O(t.overscaledZ,w,a.z,x,a.y).key]={backfilled:!1},a.y>0&&(T[new l.O(t.overscaledZ,f,a.z,d,a.y-1).key]={backfilled:!1},T[new l.O(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},T[new l.O(t.overscaledZ,w,a.z,x,a.y-1).key]={backfilled:!1}),a.y+1<c&&(T[new l.O(t.overscaledZ,f,a.z,d,a.y+1).key]={backfilled:!1},T[new l.O(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},T[new l.O(t.overscaledZ,w,a.z,x,a.y+1).key]={backfilled:!1}),T}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class Jn extends l.E{constructor(t,a,c,d){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>l.e({},this._options,{type:this.type,data:this._data}),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(d),this._data=a.data,this._options=l.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const f=l.N/this.tileSize;this.workerOptions=l.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*f,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*f,extent:l.N,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:l.N,radius:(a.clusterRadius||50)*f,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},a),this}getClusterChildren(t,a){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},a),this}getClusterLeaves(t,a,c,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:a,offset:c},d),this}_updateWorkerData(t){const a=l.e({},this.workerOptions);t?a.dataDiff=t:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(l.h.resolveURL(this._data),re.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new l.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,a,(c,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new l.k("dataabort",{dataType:"source"}));let f=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(f=d.resourceTiming[this.id].slice(0)),c)return void this.fire(new l.j(c));const x={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&l.e(x,{resourceTiming:f}),this.fire(new l.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new l.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(t,a){const c=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const d={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(c,d,(f,x)=>(delete t.request,t.unloadVectorData(),t.aborted?a(null):f?a(f):(t.loadVectorData(x,this.map.painter,c==="reloadTile"),a(null))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var nn=l.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Vi extends l.E{constructor(t,a,c,d){super(),this.load=(f,x)=>{this._loaded=!1,this.fire(new l.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Ne.getImage(this.map._requestManager.transformRequest(this.url,re.Image),(w,T)=>{this._request=null,this._loaded=!0,w?this.fire(new l.j(w)):T&&(this.image=T,f&&(this.coordinates=f),x&&x(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const f=this.map.painter.context,x=f.gl;this.boundsBuffer||(this.boundsBuffer=f.createVertexBuffer(this._boundsArray,nn.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new at(f,this.image,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const E=this.tiles[T];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,w=!0)}w&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=t,this.dispatcher=c,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=a}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(l.U.fromLngLat);this.tileID=function(d){let f=1/0,x=1/0,w=-1/0,T=-1/0;for(const R of d)f=Math.min(f,R.x),x=Math.min(x,R.y),w=Math.max(w,R.x),T=Math.max(T,R.y);const E=Math.max(w-f,T-x),C=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),P=Math.pow(2,C);return new l.W(C,Math.floor((f+w)/2*P),Math.floor((x+T)/2*P))}(a),this.minzoom=this.maxzoom=this.tileID.z;const c=a.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new l.V,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,l.N,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,l.N),this._boundsArray.emplaceBack(c[2].x,c[2].y,l.N,l.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(t,a){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},a(null)):(t.state="errored",a(null))}hasTransition(){return!1}}class Ua extends Vi{constructor(t,a,c,d){super(t,a,c,d),this.load=()=>{this._loaded=!1;const f=this.options;this.urls=[];for(const x of f.urls)this.urls.push(this.map._requestManager.transformRequest(x,re.Source).url);l.X(this.urls,(x,w)=>{this._loaded=!0,x?this.fire(new l.j(x)):w&&(this.video=w,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,x=f.gl;this.boundsBuffer||(this.boundsBuffer=f.createVertexBuffer(this._boundsArray,nn.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE),x.texSubImage2D(x.TEXTURE_2D,0,0,0,x.RGBA,x.UNSIGNED_BYTE,this.video)):(this.texture=new at(f,this.video,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const E=this.tiles[T];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,w=!0)}w&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=a}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new l.j(new l.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Qn extends Vi{constructor(t,a,c,d){super(t,a,c,d),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const x=this.map.painter.context,w=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,nn.members)),this.boundsSegments||(this.boundsSegments=l.S.simpleSegment(0,0,4,2)),this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new at(x,this.canvas,w.RGBA,{premultiply:!0});let T=!1;for(const E in this.tiles){const C=this.tiles[E];C.state!=="loaded"&&(C.state="loaded",C.texture=this.texture,T=!0)}T&&this.fire(new l.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(f=>!Array.isArray(f)||f.length!==2||f.some(x=>typeof x!="number"))||this.fire(new l.j(new l.Y(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.j(new l.Y(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new l.j(new l.Y(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new l.j(new l.Y(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.j(new l.Y(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const ja={},An=p=>{switch(p){case"geojson":return Jn;case"image":return Vi;case"raster":return hi;case"raster-dem":return rn;case"vector":return tn;case"video":return Ua;case"canvas":return Qn}return ja[p]};function Hs(p,t){const a=l.Z();return l.$(a,a,[1,1,0]),l.a0(a,a,[.5*p.width,.5*p.height,1]),l.a1(a,a,p.calculatePosMatrix(t.toUnwrapped()))}function _s(p,t,a,c,d,f){const x=function(P,R,Z){if(P)for(const $ of P){const G=R[$];if(G&&G.source===Z&&G.type==="fill-extrusion")return!0}else for(const $ in R){const G=R[$];if(G.source===Z&&G.type==="fill-extrusion")return!0}return!1}(d&&d.layers,t,p.id),w=f.maxPitchScaleFactor(),T=p.tilesIn(c,w,x);T.sort(es);const E=[];for(const P of T)E.push({wrappedTileID:P.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(t,a,p._state,P.queryGeometry,P.cameraQueryGeometry,P.scale,d,f,w,Hs(p.transform,P.tileID))});const C=function(P){const R={},Z={};for(const $ of P){const G=$.queryResults,U=$.wrappedTileID,ne=Z[U]=Z[U]||{};for(const de in G){const K=G[de],se=ne[de]=ne[de]||{},me=R[de]=R[de]||[];for(const ge of K)se[ge.featureIndex]||(se[ge.featureIndex]=!0,me.push(ge))}}return R}(E);for(const P in C)C[P].forEach(R=>{const Z=R.feature,$=p.getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=$});return C}function es(p,t){const a=p.tileID,c=t.tileID;return a.overscaledZ-c.overscaledZ||a.canonical.y-c.canonical.y||a.wrap-c.wrap||a.canonical.x-c.canonical.x}class ts{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=l.a2(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const a=t+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(d,f){const x={};if(!f)return x;for(const w of d){const T=w.layerIds.map(E=>f.getLayer(E)).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(E=>T.filter(C=>C.id===E)[0]));for(const E of T)x[E.id]=w}}return x}(t.buckets,a.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const f=this.buckets[d];if(f instanceof l.a4){if(this.hasSymbolBuckets=!0,!c)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const f=this.buckets[d];if(f instanceof l.a4&&f.hasRTLText){this.hasRTLText=!0,l.a5();break}}this.queryPadding=0;for(const d in this.buckets){const f=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(f))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new l.a3}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new at(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new at(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,c,d,f,x,w,T,E,C){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:f,scale:x,tileSize:this.tileSize,pixelPosMatrix:C,transform:T,params:w,queryPadding:this.queryPadding*E},t,a,c):{}}querySourceFeatures(t,a){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),f=a&&a.sourceLayer?a.sourceLayer:"",x=d._geojsonTileLayer||d[f];if(!x)return;const w=l.a6(a&&a.filter),{z:T,x:E,y:C}=this.tileID.canonical,P={z:T,x:E,y:C};for(let R=0;R<x.length;R++){const Z=x.feature(R);if(w.needGeometry){const U=l.a7(Z,!0);if(!w.filter(new l.a8(this.tileID.overscaledZ),U,this.tileID.canonical))continue}else if(!w.filter(new l.a8(this.tileID.overscaledZ),Z))continue;const $=c.getId(Z,f),G=new l.a9(Z,T,E,C,$);G.tile=P,t.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const c=l.aa(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const f=this.expirationTime-a;f?this.expirationTime=c+Math.max(f,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!a.style.hasLayer(d))continue;const f=this.buckets[d],x=f.layers[0].sourceLayer||"_geojsonTileLayer",w=c[x],T=t[x];if(!w||!T||Object.keys(T).length===0)continue;f.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const E=a&&a.style&&a.style.getLayer(d);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(f)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<l.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=l.h.now()+t}setDependencies(t,a){const c={};for(const d of a)c[d]=!0;this.dependencies[t]=c}hasDependency(t,a){for(const c of t){const d=this.dependencies[c];if(d){for(const f of a)if(d[f])return!0}}return!1}}class vs{constructor(t,a){this.max=t,this.onRemove=a,this.reset()}reset(){for(const t in this.data)for(const a of this.data[t])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(t,a,c){const d=t.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const f={value:a,timeout:void 0};if(c!==void 0&&(f.timeout=setTimeout(()=>{this.remove(t,f)},c)),this.data[d].push(f),this.order.push(d),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const a=this.data[t].shift();return a.timeout&&clearTimeout(a.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),a.value}getByKey(t){const a=this.data[t];return a?a[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,a){if(!this.has(t))return this;const c=t.wrapped().key,d=a===void 0?0:this.data[c].indexOf(a),f=this.data[c][d];return this.data[c].splice(d,1),f.timeout&&clearTimeout(f.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(f.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(t){const a=[];for(const c in this.data)for(const d of this.data[c])t(d.value)||a.push(d);for(const c of a)this.remove(c.value.tileID,c)}}class ye{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,c){const d=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][d]=this.stateChanges[t][d]||{},l.e(this.stateChanges[t][d],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const f in this.state[t])f!==d&&(this.deletedStates[t][f]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][d]===null){this.deletedStates[t][d]={};for(const f in this.state[t][d])c[f]||(this.deletedStates[t][d][f]=null)}else for(const f in c)this.deletedStates[t]&&this.deletedStates[t][d]&&this.deletedStates[t][d][f]===null&&delete this.deletedStates[t][d][f]}removeFeatureState(t,a,c){if(this.deletedStates[t]===null)return;const d=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&a!==void 0)this.deletedStates[t][d]!==null&&(this.deletedStates[t][d]=this.deletedStates[t][d]||{},this.deletedStates[t][d][c]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][d])for(c in this.deletedStates[t][d]={},this.stateChanges[t][d])this.deletedStates[t][d][c]=null;else this.deletedStates[t][d]=null;else this.deletedStates[t]=null}getState(t,a){const c=String(a),d=l.e({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const f=this.deletedStates[t][a];if(f===null)return{};for(const x in f)delete d[x]}return d}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const f={};for(const x in this.stateChanges[d])this.state[d][x]||(this.state[d][x]={}),l.e(this.state[d][x],this.stateChanges[d][x]),f[x]=this.state[d][x];c[d]=f}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const f={};if(this.deletedStates[d]===null)for(const x in this.state[d])f[x]={},this.state[d][x]={};else for(const x in this.deletedStates[d]){if(this.deletedStates[d][x]===null)this.state[d][x]={};else for(const w of Object.keys(this.deletedStates[d][x]))delete this.state[d][x][w];f[x]=this.state[d][x]}c[d]=c[d]||{},l.e(c[d],f)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const d in t)t[d].setFeatureState(c,a)}}class di extends l.E{constructor(t,a,c){super(),this.id=t,this.dispatcher=c,this.on("data",d=>{d.dataType==="source"&&d.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,f,x,w)=>{const T=new(An(f.type))(d,f,x,w);if(T.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${T.id}`);return T})(t,a,c,this),this._tiles={},this._cache=new vs(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ye,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const a=this._tiles[t];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a){return this._source.loadTile(t,a)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,()=>{}),this._source.fire(new l.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const c=this._tiles[a];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(Ui).map(t=>t.key)}getRenderableIds(t){const a=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&a.push(this._tiles[c]);return t?a.sort((c,d)=>{const f=c.tileID,x=d.tileID,w=new l.P(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),T=new l.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-x.overscaledZ||T.y-w.y||T.x-w.x}).map(c=>c.tileID.key):a.map(c=>c.tileID).sort(Ui).map(c=>c.key)}hasRenderableParent(t){const a=this.findLoadedParent(t,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(t,a){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(a||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,a){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=a),this._loadTile(c,this._tileLoaded.bind(this,c,t,a)))}_tileLoaded(t,a,c,d){if(d)return t.state="errored",void(d.status!==404?this._source.fire(new l.j(d,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=l.h.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new l.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const a=this.getRenderableIds();for(let d=0;d<a.length;d++){const f=a[d];if(t.neighboringTiles&&t.neighboringTiles[f]){const x=this.getTileByID(f);c(t,x),c(x,t)}}function c(d,f){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let x=f.tileID.canonical.x-d.tileID.canonical.x;const w=f.tileID.canonical.y-d.tileID.canonical.y,T=Math.pow(2,d.tileID.canonical.z),E=f.tileID.key;x===0&&w===0||Math.abs(w)>1||(Math.abs(x)>1&&(Math.abs(x+T)===1?x+=T:Math.abs(x-T)===1&&(x-=T)),f.dem&&d.dem&&(d.dem.backfillBorder(f.dem,x,w),d.neighboringTiles&&d.neighboringTiles[E]&&(d.neighboringTiles[E].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,a,c,d){for(const f in this._tiles){let x=this._tiles[f];if(d[f]||!x.hasData()||x.tileID.overscaledZ<=a||x.tileID.overscaledZ>c)continue;let w=x.tileID;for(;x&&x.tileID.overscaledZ>a+1;){const E=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[E.key],x&&x.hasData()&&(w=E)}let T=w;for(;T.overscaledZ>a;)if(T=T.scaledTo(T.overscaledZ-1),t[T.key]){d[w.key]=w;break}}}findLoadedParent(t,a){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=a?c:null}for(let c=t.overscaledZ-1;c>=a;c--){const d=t.scaledTo(c),f=this._getLoadedTile(d);if(f)return f}}_getLoadedTile(t){const a=this._tiles[t.key];return a&&a.hasData()?a:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,d=Math.floor(a*c*(this._maxTileCacheZoomLevels===null?l.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),f=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(f)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,a){const c={};for(const d in this._tiles){const f=this._tiles[d];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+a),c[f.tileID.key]=f}this._tiles=c;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}update(t,a){if(this.transform=t,this.terrain=a,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(C=>new l.O(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y)):(c=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(c=c.filter(C=>this._source.hasTile(C)))):c=[];const d=t.coveringZoomLevel(this._source),f=Math.max(d-di.maxOverzooming,this._source.minzoom),x=Math.max(d+di.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const C={};for(const P of c)if(P.canonical.z>this._source.minzoom){const R=P.scaledTo(P.canonical.z-1);C[R.key]=R;const Z=P.scaledTo(Math.max(this._source.minzoom,Math.min(P.canonical.z,5)));C[Z.key]=Z}c=c.concat(Object.values(C))}const w=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new l.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(c,d);if(Vt(this._source.type)){const C={},P={},R=Object.keys(T),Z=l.h.now();for(const $ of R){const G=T[$],U=this._tiles[$];if(!U||U.fadeEndTime!==0&&U.fadeEndTime<=Z)continue;const ne=this.findLoadedParent(G,f);ne&&(this._addTile(ne.tileID),C[ne.tileID.key]=ne.tileID),P[$]=G}this._retainLoadedChildren(P,d,x,T);for(const $ in C)T[$]||(this._coveredTiles[$]=!0,T[$]=C[$]);if(a){const $={},G={};for(const U of c)this._tiles[U.key].hasData()?$[U.key]=U:G[U.key]=U;for(const U in G){const ne=G[U].children(this._source.maxzoom);this._tiles[ne[0].key]&&this._tiles[ne[1].key]&&this._tiles[ne[2].key]&&this._tiles[ne[3].key]&&($[ne[0].key]=T[ne[0].key]=ne[0],$[ne[1].key]=T[ne[1].key]=ne[1],$[ne[2].key]=T[ne[2].key]=ne[2],$[ne[3].key]=T[ne[3].key]=ne[3],delete G[U])}for(const U in G){const ne=this.findLoadedParent(G[U],this._source.minzoom);if(ne){$[ne.tileID.key]=T[ne.tileID.key]=ne.tileID;for(const de in $)$[de].isChildOf(ne.tileID)&&delete $[de]}}for(const U in this._tiles)$[U]||(this._coveredTiles[U]=!0)}}for(const C in T)this._tiles[C].clearFadeHold();const E=l.ab(this._tiles,T);for(const C of E){const P=this._tiles[C];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(C)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){const c={},d={},f=Math.max(a-di.maxOverzooming,this._source.minzoom),x=Math.max(a+di.maxUnderzooming,this._source.minzoom),w={};for(const T of t){const E=this._addTile(T);c[T.key]=T,E.hasData()||a<this._source.maxzoom&&(w[T.key]=T)}this._retainLoadedChildren(w,a,x,c);for(const T of t){let E=this._tiles[T.key];if(E.hasData())continue;if(a+1>this._source.maxzoom){const P=T.children(this._source.maxzoom)[0],R=this.getTile(P);if(R&&R.hasData()){c[P.key]=P;continue}}else{const P=T.children(this._source.maxzoom);if(c[P[0].key]&&c[P[1].key]&&c[P[2].key]&&c[P[3].key])continue}let C=E.wasRequested();for(let P=T.overscaledZ-1;P>=f;--P){const R=T.scaledTo(P);if(d[R.key])break;if(d[R.key]=!0,E=this.getTile(R),!E&&C&&(E=this._addTile(R)),E){const Z=E.hasData();if((C||Z)&&(c[R.key]=R),C=E.wasRequested(),Z)break}}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const a=[];let c,d=this._tiles[t].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){c=this._loadedParentTiles[d.key];break}a.push(d.key);const f=d.scaledTo(d.overscaledZ-1);if(c=this._getLoadedTile(f),c)break;d=f}for(const f of a)this._loadedParentTiles[f]=c}}_addTile(t){let a=this._tiles[t.key];if(a)return a;a=this._cache.getAndRemove(t),a&&(this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,a)));const c=a;return a||(a=new ts(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,this._tileLoaded.bind(this,a,t.key,a.state))),a.uses++,this._tiles[t.key]=a,c||this._source.fire(new l.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=a.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const a=this._tiles[t];a&&(a.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,a,c){const d=[],f=this.transform;if(!f)return d;const x=c?f.getCameraQueryGeometry(t):t,w=t.map($=>f.pointCoordinate($,this.terrain)),T=x.map($=>f.pointCoordinate($,this.terrain)),E=this.getIds();let C=1/0,P=1/0,R=-1/0,Z=-1/0;for(const $ of T)C=Math.min(C,$.x),P=Math.min(P,$.y),R=Math.max(R,$.x),Z=Math.max(Z,$.y);for(let $=0;$<E.length;$++){const G=this._tiles[E[$]];if(G.holdingForFade())continue;const U=G.tileID,ne=Math.pow(2,f.zoom-G.tileID.overscaledZ),de=a*G.queryPadding*l.N/G.tileSize/ne,K=[U.getTilePoint(new l.U(C,P)),U.getTilePoint(new l.U(R,Z))];if(K[0].x-de<l.N&&K[0].y-de<l.N&&K[1].x+de>=0&&K[1].y+de>=0){const se=w.map(ge=>U.getTilePoint(ge)),me=T.map(ge=>U.getTilePoint(ge));d.push({tile:G,tileID:U,queryGeometry:se,cameraQueryGeometry:me,scale:ne})}}return d}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);for(const c of a)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Vt(this._source.type)){const t=l.h.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=t)return!0}return!1}setFeatureState(t,a,c){this._state.updateState(t=t||"_geojsonTileLayer",a,c)}removeFeatureState(t,a,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",a,c)}getFeatureState(t,a){return this._state.getState(t=t||"_geojsonTileLayer",a)}setDependencies(t,a,c){const d=this._tiles[t];d&&d.setDependencies(a,c)}reloadTilesForDependencies(t,a){for(const c in this._tiles)this._tiles[c].hasDependency(t,a)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(t,a))}}function Ui(p,t){const a=Math.abs(2*p.wrap)-+(p.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return p.overscaledZ-t.overscaledZ||c-a||t.canonical.y-p.canonical.y||t.canonical.x-p.canonical.x}function Vt(p){return p==="raster"||p==="image"||p==="video"}di.maxOverzooming=10,di.maxUnderzooming=3;const Ct="mapboxgl_preloaded_worker_pool";class mn{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<mn.workerCount;)this.workers.push(new Worker(l.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ct]}numActive(){return Object.keys(this.active).length}}const Xs=Math.floor(l.h.hardwareConcurrency/2);let Dn;function Eo(){return Dn||(Dn=new mn),Dn}mn.workerCount=l.ac(globalThis)?Math.max(Math.min(Xs,3),1):1;class Ks{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=l.ad(t,0,1);let a=1,c=this._distances[a];const d=t*this.paddedLength+this.padding;for(;c<d&&a<this._distances.length;)c=this._distances[++a];const f=a-1,x=this._distances[f],w=c-x,T=w>0?(d-x)/w:0;return this.points[f].mult(1-T).add(this.points[a].mult(T))}}function rs(p,t){let a=!0;return p==="always"||p!=="never"&&t!=="never"||(a=!1),a}class xs{constructor(t,a,c){const d=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(a/c);for(let x=0;x<this.xCellCount*this.yCellCount;x++)d.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,c,d,f){this._forEachCell(a,c,d,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(f)}insertCircle(t,a,c,d){this._forEachCell(a-d,c-d,a+d,c+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(c),this.circles.push(d)}_insertBoxCell(t,a,c,d,f,x){this.boxCells[f].push(x)}_insertCircleCell(t,a,c,d,f,x){this.circleCells[f].push(x)}_query(t,a,c,d,f,x,w){if(c<0||t>this.width||d<0||a>this.height)return[];const T=[];if(t<=0&&a<=0&&this.width<=c&&this.height<=d){if(f)return[{key:null,x1:t,y1:a,x2:c,y2:d}];for(let E=0;E<this.boxKeys.length;E++)T.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const C=this.circles[3*E],P=this.circles[3*E+1],R=this.circles[3*E+2];T.push({key:this.circleKeys[E],x1:C-R,y1:P-R,x2:C+R,y2:P+R})}}else this._forEachCell(t,a,c,d,this._queryCell,T,{hitTest:f,overlapMode:x,seenUids:{box:{},circle:{}}},w);return T}query(t,a,c,d){return this._query(t,a,c,d,!1,null)}hitTest(t,a,c,d,f,x){return this._query(t,a,c,d,!0,f,x).length>0}hitTestCircle(t,a,c,d,f){const x=t-c,w=t+c,T=a-c,E=a+c;if(w<0||x>this.width||E<0||T>this.height)return!1;const C=[];return this._forEachCell(x,T,w,E,this._queryCellCircle,C,{hitTest:!0,overlapMode:d,circle:{x:t,y:a,radius:c},seenUids:{box:{},circle:{}}},f),C.length>0}_queryCell(t,a,c,d,f,x,w,T){const{seenUids:E,hitTest:C,overlapMode:P}=w,R=this.boxCells[f];if(R!==null){const $=this.bboxes;for(const G of R)if(!E.box[G]){E.box[G]=!0;const U=4*G,ne=this.boxKeys[G];if(t<=$[U+2]&&a<=$[U+3]&&c>=$[U+0]&&d>=$[U+1]&&(!T||T(ne))&&(!C||!rs(P,ne.overlapMode))&&(x.push({key:ne,x1:$[U],y1:$[U+1],x2:$[U+2],y2:$[U+3]}),C))return!0}}const Z=this.circleCells[f];if(Z!==null){const $=this.circles;for(const G of Z)if(!E.circle[G]){E.circle[G]=!0;const U=3*G,ne=this.circleKeys[G];if(this._circleAndRectCollide($[U],$[U+1],$[U+2],t,a,c,d)&&(!T||T(ne))&&(!C||!rs(P,ne.overlapMode))){const de=$[U],K=$[U+1],se=$[U+2];if(x.push({key:ne,x1:de-se,y1:K-se,x2:de+se,y2:K+se}),C)return!0}}}return!1}_queryCellCircle(t,a,c,d,f,x,w,T){const{circle:E,seenUids:C,overlapMode:P}=w,R=this.boxCells[f];if(R!==null){const $=this.bboxes;for(const G of R)if(!C.box[G]){C.box[G]=!0;const U=4*G,ne=this.boxKeys[G];if(this._circleAndRectCollide(E.x,E.y,E.radius,$[U+0],$[U+1],$[U+2],$[U+3])&&(!T||T(ne))&&!rs(P,ne.overlapMode))return x.push(!0),!0}}const Z=this.circleCells[f];if(Z!==null){const $=this.circles;for(const G of Z)if(!C.circle[G]){C.circle[G]=!0;const U=3*G,ne=this.circleKeys[G];if(this._circlesCollide($[U],$[U+1],$[U+2],E.x,E.y,E.radius)&&(!T||T(ne))&&!rs(P,ne.overlapMode))return x.push(!0),!0}}}_forEachCell(t,a,c,d,f,x,w,T){const E=this._convertToXCellCoord(t),C=this._convertToYCellCoord(a),P=this._convertToXCellCoord(c),R=this._convertToYCellCoord(d);for(let Z=E;Z<=P;Z++)for(let $=C;$<=R;$++)if(f.call(this,t,a,c,d,this.xCellCount*$+Z,x,w,T))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,c,d,f,x){const w=d-t,T=f-a,E=c+x;return E*E>w*w+T*T}_circleAndRectCollide(t,a,c,d,f,x,w){const T=(x-d)/2,E=Math.abs(t-(d+T));if(E>T+c)return!1;const C=(w-f)/2,P=Math.abs(a-(f+C));if(P>C+c)return!1;if(E<=T||P<=C)return!0;const R=E-T,Z=P-C;return R*R+Z*Z<=c*c}}function De(p,t,a,c,d){const f=l.Z();return t?(l.a0(f,f,[1/d,1/d,1]),a||l.ae(f,f,c.angle)):l.a1(f,c.labelPlaneMatrix,p),f}function gn(p,t,a,c,d){if(t){const f=l.af(p);return l.a0(f,f,[d,d,1]),a||l.ae(f,f,-c.angle),f}return c.glCoordMatrix}function rr(p,t,a){let c;a?(c=[p.x,p.y,a(p.x,p.y),1],l.ag(c,c,t)):(c=[p.x,p.y,0,1],W(c,c,t));const d=c[3];return{point:new l.P(c[0]/d,c[1]/d),signedDistanceFromCamera:d}}function ws(p,t){return .5+p/t*.5}function Ln(p,t){const a=p[0]/p[3],c=p[1]/p[3];return a>=-t[0]&&a<=t[0]&&c>=-t[1]&&c<=t[1]}function Be(p,t,a,c,d,f,x,w,T,E){const C=c?p.textSizeData:p.iconSizeData,P=l.ah(C,a.transform.zoom),R=[256/a.width*2+1,256/a.height*2+1],Z=c?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;Z.clear();const $=p.lineVertexArray,G=c?p.text.placedSymbolArray:p.icon.placedSymbolArray,U=a.transform.width/a.transform.height;let ne=!1;for(let de=0;de<G.length;de++){const K=G.get(de);if(K.hidden||K.writingMode===l.ai.vertical&&!ne){V(K.numGlyphs,Z);continue}let se;if(ne=!1,E?(se=[K.anchorX,K.anchorY,E(K.anchorX,K.anchorY),1],l.ag(se,se,t)):(se=[K.anchorX,K.anchorY,0,1],W(se,se,t)),!Ln(se,R)){V(K.numGlyphs,Z);continue}const me=ws(a.transform.cameraToCenterDistance,se[3]),ge=l.aj(C,P,K),xe=x?ge/me:ge*me,ke=new l.P(K.anchorX,K.anchorY),Se=rr(ke,d,E).point,ze={projections:{},offsets:{}},Xe=ei(K,xe,!1,w,t,d,f,p.glyphOffsetArray,$,Z,Se,ke,ze,U,T,E);ne=Xe.useVertical,(Xe.notEnoughRoom||ne||Xe.needsFlipping&&ei(K,xe,!0,w,t,d,f,p.glyphOffsetArray,$,Z,Se,ke,ze,U,T,E).notEnoughRoom)&&V(K.numGlyphs,Z)}c?p.text.dynamicLayoutVertexBuffer.updateData(Z):p.icon.dynamicLayoutVertexBuffer.updateData(Z)}function gt(p,t,a,c,d,f,x,w,T,E,C,P,R){const Z=w.glyphStartIndex+w.numGlyphs,$=w.lineStartIndex,G=w.lineStartIndex+w.lineLength,U=t.getoffsetX(w.glyphStartIndex),ne=t.getoffsetX(Z-1),de=A(p*U,a,c,d,f,x,w.segment,$,G,T,E,C,P,R);if(!de)return null;const K=A(p*ne,a,c,d,f,x,w.segment,$,G,T,E,C,P,R);return K?{first:de,last:K}:null}function ht(p,t,a,c){return p===l.ai.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*c?{useVertical:!0}:(p===l.ai.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function ei(p,t,a,c,d,f,x,w,T,E,C,P,R,Z,$,G){const U=t/24,ne=p.lineOffsetX*U,de=p.lineOffsetY*U;let K;if(p.numGlyphs>1){const se=p.glyphStartIndex+p.numGlyphs,me=p.lineStartIndex,ge=p.lineStartIndex+p.lineLength,xe=gt(U,w,ne,de,a,C,P,p,T,f,R,$,G);if(!xe)return{notEnoughRoom:!0};const ke=rr(xe.first.point,x,G).point,Se=rr(xe.last.point,x,G).point;if(c&&!a){const ze=ht(p.writingMode,ke,Se,Z);if(ze)return ze}K=[xe.first];for(let ze=p.glyphStartIndex+1;ze<se-1;ze++)K.push(A(U*w.getoffsetX(ze),ne,de,a,C,P,p.segment,me,ge,T,f,R,$,G));K.push(xe.last)}else{if(c&&!a){const me=rr(P,d,G).point,ge=p.lineStartIndex+p.segment+1,xe=new l.P(T.getx(ge),T.gety(ge)),ke=rr(xe,d,G),Se=ke.signedDistanceFromCamera>0?ke.point:yn(P,xe,me,1,d,G),ze=ht(p.writingMode,me,Se,Z);if(ze)return ze}const se=A(U*w.getoffsetX(p.glyphStartIndex),ne,de,a,C,P,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,T,f,R,$,G);if(!se)return{notEnoughRoom:!0};K=[se]}for(const se of K)l.ak(E,se.point,se.angle);return{}}function yn(p,t,a,c,d,f){const x=rr(p.add(p.sub(t)._unit()),d,f).point,w=a.sub(x);return a.add(w._mult(c/w.mag()))}function ft(p,t){const{projectionCache:a,lineVertexArray:c,labelPlaneMatrix:d,tileAnchorPoint:f,distanceFromAnchor:x,getElevation:w,previousVertex:T,direction:E,absOffsetX:C}=t;if(a.projections[p])return a.projections[p];const P=new l.P(c.getx(p),c.gety(p)),R=rr(P,d,w);if(R.signedDistanceFromCamera>0)return a.projections[p]=R.point,R.point;const Z=p-E;return yn(x===0?f:new l.P(c.getx(Z),c.gety(Z)),P,T,C-x+1,d,w)}function Rn(p,t,a){return p._unit()._perp()._mult(t*a)}function q(p,t,a,c,d,f,x,w){const{projectionCache:T,direction:E}=w;if(T.offsets[p])return T.offsets[p];const C=a.add(t);if(p+E<c||p+E>=d)return T.offsets[p]=C,C;const P=ft(p+E,w),R=Rn(P.sub(a),x,E),Z=a.add(R),$=P.add(R);return T.offsets[p]=l.al(f,C,Z,$)||C,T.offsets[p]}function A(p,t,a,c,d,f,x,w,T,E,C,P,R,Z){const $=c?p-t:p+t;let G=$>0?1:-1,U=0;c&&(G*=-1,U=Math.PI),G<0&&(U+=Math.PI);let ne,de,K=G>0?w+x:w+x+1,se=d,me=d,ge=0,xe=0;const ke=Math.abs($),Se=[];let ze;for(;ge+xe<=ke;){if(K+=G,K<w||K>=T)return null;ge+=xe,me=se,de=ne;const Fe={projectionCache:P,lineVertexArray:E,labelPlaneMatrix:C,tileAnchorPoint:f,distanceFromAnchor:ge,getElevation:Z,previousVertex:me,direction:G,absOffsetX:ke};if(se=ft(K,Fe),a===0)Se.push(me),ze=se.sub(me);else{let ut;const Je=se.sub(me);ut=Je.mag()===0?Rn(ft(K+G,Fe).sub(se),a,G):Rn(Je,a,G),de||(de=me.add(ut)),ne=q(K,ut,se,w,T,de,a,Fe),Se.push(de),ze=ne.sub(de)}xe=ze.mag()}const Xe=ze._mult((ke-ge)/xe)._add(de||me),xt=U+Math.atan2(se.y-me.y,se.x-me.x);return Se.push(Xe),{point:Xe,angle:R?xt:0,path:Se}}const L=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function V(p,t){for(let a=0;a<p;a++){const c=t.length;t.resize(c+4),t.float32.set(L,3*c)}}function W(p,t,a){const c=t[0],d=t[1];return p[0]=a[0]*c+a[4]*d+a[12],p[1]=a[1]*c+a[5]*d+a[13],p[3]=a[3]*c+a[7]*d+a[15],p}const X=100;class le{constructor(t,a=new xs(t.width+200,t.height+200,25),c=new xs(t.width+200,t.height+200,25)){this.transform=t,this.grid=a,this.ignoredGrid=c,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+X,this.screenBottomBoundary=t.height+X,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,c,d,f,x){const w=this.projectAndGetPerspectiveRatio(d,t.anchorPointX,t.anchorPointY,x),T=c*w.perspectiveRatio,E=t.x1*T+w.point.x,C=t.y1*T+w.point.y,P=t.x2*T+w.point.x,R=t.y2*T+w.point.y;return!this.isInsideGrid(E,C,P,R)||a!=="always"&&this.grid.hitTest(E,C,P,R,a,f)||w.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[E,C,P,R],offscreen:this.isOffscreen(E,C,P,R)}}placeCollisionCircles(t,a,c,d,f,x,w,T,E,C,P,R,Z,$){const G=[],U=new l.P(a.anchorX,a.anchorY),ne=rr(U,x,$),de=ws(this.transform.cameraToCenterDistance,ne.signedDistanceFromCamera),K=(C?f/de:f*de)/l.ap,se=rr(U,w,$).point,me=gt(K,d,a.lineOffsetX*K,a.lineOffsetY*K,!1,se,U,a,c,w,{projections:{},offsets:{}},!1,$);let ge=!1,xe=!1,ke=!0;if(me){const Se=.5*R*de+Z,ze=new l.P(-100,-100),Xe=new l.P(this.screenRightBoundary,this.screenBottomBoundary),xt=new Ks,Fe=me.first,ut=me.last;let Je=[];for(let mt=Fe.path.length-1;mt>=1;mt--)Je.push(Fe.path[mt]);for(let mt=1;mt<ut.path.length;mt++)Je.push(ut.path[mt]);const Bt=2.5*Se;if(T){const mt=Je.map(wt=>rr(wt,T,$));Je=mt.some(wt=>wt.signedDistanceFromCamera<=0)?[]:mt.map(wt=>wt.point)}let vt=[];if(Je.length>0){const mt=Je[0].clone(),wt=Je[0].clone();for(let ur=1;ur<Je.length;ur++)mt.x=Math.min(mt.x,Je[ur].x),mt.y=Math.min(mt.y,Je[ur].y),wt.x=Math.max(wt.x,Je[ur].x),wt.y=Math.max(wt.y,Je[ur].y);vt=mt.x>=ze.x&&wt.x<=Xe.x&&mt.y>=ze.y&&wt.y<=Xe.y?[Je]:wt.x<ze.x||mt.x>Xe.x||wt.y<ze.y||mt.y>Xe.y?[]:l.am([Je],ze.x,ze.y,Xe.x,Xe.y)}for(const mt of vt){xt.reset(mt,.25*Se);let wt=0;wt=xt.length<=.5*Se?1:Math.ceil(xt.paddedLength/Bt)+1;for(let ur=0;ur<wt;ur++){const $t=ur/Math.max(wt-1,1),Nr=xt.lerp($t),Sr=Nr.x+X,fr=Nr.y+X;G.push(Sr,fr,Se,0);const Mi=Sr-Se,Wt=fr-Se,vn=Sr+Se,xn=fr+Se;if(ke=ke&&this.isOffscreen(Mi,Wt,vn,xn),xe=xe||this.isInsideGrid(Mi,Wt,vn,xn),t!=="always"&&this.grid.hitTestCircle(Sr,fr,Se,t,P)&&(ge=!0,!E))return{circles:[],offscreen:!1,collisionDetected:ge}}}}return{circles:!E&&ge||!xe||de<this.perspectiveRatioCutoff?[]:G,offscreen:ke,collisionDetected:ge}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let c=1/0,d=1/0,f=-1/0,x=-1/0;for(const C of t){const P=new l.P(C.x+X,C.y+X);c=Math.min(c,P.x),d=Math.min(d,P.y),f=Math.max(f,P.x),x=Math.max(x,P.y),a.push(P)}const w=this.grid.query(c,d,f,x).concat(this.ignoredGrid.query(c,d,f,x)),T={},E={};for(const C of w){const P=C.key;if(T[P.bucketInstanceId]===void 0&&(T[P.bucketInstanceId]={}),T[P.bucketInstanceId][P.featureIndex])continue;const R=[new l.P(C.x1,C.y1),new l.P(C.x2,C.y1),new l.P(C.x2,C.y2),new l.P(C.x1,C.y2)];l.an(a,R)&&(T[P.bucketInstanceId][P.featureIndex]=!0,E[P.bucketInstanceId]===void 0&&(E[P.bucketInstanceId]=[]),E[P.bucketInstanceId].push(P.featureIndex))}return E}insertCollisionBox(t,a,c,d,f,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:f,collisionGroupID:x,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,c,d,f,x){const w=c?this.ignoredGrid:this.grid,T={bucketInstanceId:d,featureIndex:f,collisionGroupID:x,overlapMode:a};for(let E=0;E<t.length;E+=4)w.insertCircle(T,t[E],t[E+1],t[E+2])}projectAndGetPerspectiveRatio(t,a,c,d){let f;return d?(f=[a,c,d(a,c),1],l.ag(f,f,t)):(f=[a,c,0,1],W(f,f,t)),{point:new l.P((f[0]/f[3]+1)/2*this.transform.width+X,(-f[1]/f[3]+1)/2*this.transform.height+X),perspectiveRatio:.5+this.transform.cameraToCenterDistance/f[3]*.5}}isOffscreen(t,a,c,d){return c<X||t>=this.screenRightBoundary||d<X||a>this.screenBottomBoundary}isInsideGrid(t,a,c,d){return c>=0&&t<this.gridRightBoundary&&d>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=l.ao([]);return l.$(t,t,[-100,-100,0]),t}}function te(p,t,a){return t*(l.N/(p.tileSize*Math.pow(2,a-p.tileID.overscaledZ)))}class J{constructor(t,a,c,d){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):d&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class ae{constructor(t,a,c,d,f){this.text=new J(t?t.text:null,a,c,f),this.icon=new J(t?t.icon:null,a,d,f)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _e{constructor(t,a,c){this.text=t,this.icon=a,this.skipFade=c}}class ve{constructor(){this.invProjMatrix=l.Z(),this.viewportMatrix=l.Z(),this.circles=[]}}class be{constructor(t,a,c,d,f){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=f}}class nt{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:c=>c.collisionGroupID===a}}return this.collisionGroups[t]}}function ct(p,t,a,c,d){const{horizontalAlign:f,verticalAlign:x}=l.au(p);return new l.P(-(f-.5)*t+c[0]*d,-(x-.5)*a+c[1]*d)}function He(p,t,a,c,d,f){const{x1:x,x2:w,y1:T,y2:E,anchorPointX:C,anchorPointY:P}=p,R=new l.P(t,a);return c&&R._rotate(d?f:-f),{x1:x+R.x,y1:T+R.y,x2:w+R.x,y2:E+R.y,anchorPointX:C,anchorPointY:P}}class ot{constructor(t,a,c,d,f){this.transform=t.clone(),this.terrain=a,this.collisionIndex=new le(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new nt(d),this.collisionCircleArrays={},this.prevPlacement=f,f&&(f.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,a,c,d){const f=c.getBucket(a),x=c.latestFeatureIndex;if(!f||!x||a.id!==f.layerIds[0])return;const w=c.collisionBoxArray,T=f.layers[0].layout,E=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),C=c.tileSize/l.N,P=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),R=T.get("text-pitch-alignment")==="map",Z=T.get("text-rotation-alignment")==="map",$=te(c,1,this.transform.zoom),G=De(P,R,Z,this.transform,$);let U=null;if(R){const de=gn(P,R,Z,this.transform,$);U=l.a1([],this.transform.labelPlaneMatrix,de)}this.retainedQueryData[f.bucketInstanceId]=new be(f.bucketInstanceId,x,f.sourceLayerIndex,f.index,c.tileID);const ne={bucket:f,layout:T,posMatrix:P,textLabelPlaneMatrix:G,labelToScreenMatrix:U,scale:E,textPixelRatio:C,holdingForFade:c.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:l.ah(f.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(d)for(const de of f.sortKeyRanges){const{sortKey:K,symbolInstanceStart:se,symbolInstanceEnd:me}=de;t.push({sortKey:K,symbolInstanceStart:se,symbolInstanceEnd:me,parameters:ne})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:ne})}attemptAnchorPlacement(t,a,c,d,f,x,w,T,E,C,P,R,Z,$,G,U){const ne=l.aq[t.textAnchor],de=[t.textOffset0,t.textOffset1],K=ct(ne,c,d,de,f),se=this.collisionIndex.placeCollisionBox(He(a,K.x,K.y,x,w,this.transform.angle),P,T,E,C.predicate,U);if((!G||this.collisionIndex.placeCollisionBox(He(G,K.x,K.y,x,w,this.transform.angle),P,T,E,C.predicate,U).box.length!==0)&&se.box.length>0){let me;if(this.prevPlacement&&this.prevPlacement.variableOffsets[R.crossTileID]&&this.prevPlacement.placements[R.crossTileID]&&this.prevPlacement.placements[R.crossTileID].text&&(me=this.prevPlacement.variableOffsets[R.crossTileID].anchor),R.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[R.crossTileID]={textOffset:de,width:c,height:d,anchor:ne,textBoxScale:f,prevAnchor:me},this.markUsedJustification(Z,ne,R,$),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,$,R),this.placedOrientations[R.crossTileID]=$),{shift:K,placedGlyphBoxes:se}}}placeLayerBucketPart(t,a,c){const{bucket:d,layout:f,posMatrix:x,textLabelPlaneMatrix:w,labelToScreenMatrix:T,textPixelRatio:E,holdingForFade:C,collisionBoxArray:P,partiallyEvaluatedTextSize:R,collisionGroup:Z}=t.parameters,$=f.get("text-optional"),G=f.get("icon-optional"),U=l.ar(f,"text-overlap","text-allow-overlap"),ne=U==="always",de=l.ar(f,"icon-overlap","icon-allow-overlap"),K=de==="always",se=f.get("text-rotation-alignment")==="map",me=f.get("text-pitch-alignment")==="map",ge=f.get("icon-text-fit")!=="none",xe=f.get("symbol-z-order")==="viewport-y",ke=ne&&(K||!d.hasIconData()||G),Se=K&&(ne||!d.hasTextData()||$);!d.collisionArrays&&P&&d.deserializeCollisionBoxes(P);const ze=this.retainedQueryData[d.bucketInstanceId].tileID,Xe=this.terrain?(Fe,ut)=>this.terrain.getElevation(ze,Fe,ut):null,xt=(Fe,ut)=>{var Je,Bt;if(a[Fe.crossTileID])return;if(C)return void(this.placements[Fe.crossTileID]=new _e(!1,!1,!1));let vt=!1,mt=!1,wt=!0,ur=null,$t={box:null,offscreen:null},Nr={box:null},Sr=null,fr=null,Mi=null,Wt=0,vn=0,xn=0;ut.textFeatureIndex?Wt=ut.textFeatureIndex:Fe.useRuntimeCollisionCircles&&(Wt=Fe.featureIndex),ut.verticalTextFeatureIndex&&(vn=ut.verticalTextFeatureIndex);const cs=ut.textBox;if(cs){const Wr=cr=>{let Tr=l.ai.horizontal;if(d.allowVerticalPlacement&&!cr&&this.prevPlacement){const mi=this.prevPlacement.placedOrientations[Fe.crossTileID];mi&&(this.placedOrientations[Fe.crossTileID]=mi,Tr=mi,this.markUsedOrientation(d,Tr,Fe))}return Tr},Vr=(cr,Tr)=>{if(d.allowVerticalPlacement&&Fe.numVerticalGlyphVertices>0&&ut.verticalTextBox){for(const mi of d.writingModes)if(mi===l.ai.vertical?($t=Tr(),Nr=$t):$t=cr(),$t&&$t.box&&$t.box.length)break}else $t=cr()},ri=Fe.textAnchorOffsetStartIndex,Ms=Fe.textAnchorOffsetEndIndex;if(Ms===ri){const cr=(Tr,mi)=>{const hr=this.collisionIndex.placeCollisionBox(Tr,U,E,x,Z.predicate,Xe);return hr&&hr.box&&hr.box.length&&(this.markUsedOrientation(d,mi,Fe),this.placedOrientations[Fe.crossTileID]=mi),hr};Vr(()=>cr(cs,l.ai.horizontal),()=>{const Tr=ut.verticalTextBox;return d.allowVerticalPlacement&&Fe.numVerticalGlyphVertices>0&&Tr?cr(Tr,l.ai.vertical):{box:null,offscreen:null}}),Wr($t&&$t.box&&$t.box.length)}else{let cr=l.aq[(Bt=(Je=this.prevPlacement)===null||Je===void 0?void 0:Je.variableOffsets[Fe.crossTileID])===null||Bt===void 0?void 0:Bt.anchor];const Tr=(hr,As,tl)=>{const kh=hr.x2-hr.x1,Eh=hr.y2-hr.y1,Pp=Fe.textBoxScale,Pu=ge&&de==="never"?As:null;let wn={box:[],offscreen:!1},Ds=U==="never"?1:2,bn="never";cr&&Ds++;for(let Hi=0;Hi<Ds;Hi++){for(let Sn=ri;Sn<Ms;Sn++){const zu=d.textAnchorOffsets.get(Sn);if(cr&&zu.textAnchor!==cr)continue;const Vn=this.attemptAnchorPlacement(zu,hr,kh,Eh,Pp,se,me,E,x,Z,bn,Fe,d,tl,Pu,Xe);if(Vn&&(wn=Vn.placedGlyphBoxes,wn&&wn.box&&wn.box.length))return vt=!0,ur=Vn.shift,wn}cr?cr=null:bn=U}return wn};Vr(()=>Tr(cs,ut.iconBox,l.ai.horizontal),()=>{const hr=ut.verticalTextBox;return d.allowVerticalPlacement&&!($t&&$t.box&&$t.box.length)&&Fe.numVerticalGlyphVertices>0&&hr?Tr(hr,ut.verticalIconBox,l.ai.vertical):{box:null,offscreen:null}}),$t&&(vt=$t.box,wt=$t.offscreen);const mi=Wr($t&&$t.box);if(!vt&&this.prevPlacement){const hr=this.prevPlacement.variableOffsets[Fe.crossTileID];hr&&(this.variableOffsets[Fe.crossTileID]=hr,this.markUsedJustification(d,hr.anchor,Fe,mi))}}}if(Sr=$t,vt=Sr&&Sr.box&&Sr.box.length>0,wt=Sr&&Sr.offscreen,Fe.useRuntimeCollisionCircles){const Wr=d.text.placedSymbolArray.get(Fe.centerJustifiedTextSymbolIndex),Vr=l.aj(d.textSizeData,R,Wr),ri=f.get("text-padding");fr=this.collisionIndex.placeCollisionCircles(U,Wr,d.lineVertexArray,d.glyphOffsetArray,Vr,x,w,T,c,me,Z.predicate,Fe.collisionCircleDiameter,ri,Xe),fr.circles.length&&fr.collisionDetected&&!c&&l.w("Collisions detected, but collision boxes are not shown"),vt=ne||fr.circles.length>0&&!fr.collisionDetected,wt=wt&&fr.offscreen}if(ut.iconFeatureIndex&&(xn=ut.iconFeatureIndex),ut.iconBox){const Wr=Vr=>{const ri=ge&&ur?He(Vr,ur.x,ur.y,se,me,this.transform.angle):Vr;return this.collisionIndex.placeCollisionBox(ri,de,E,x,Z.predicate,Xe)};Nr&&Nr.box&&Nr.box.length&&ut.verticalIconBox?(Mi=Wr(ut.verticalIconBox),mt=Mi.box.length>0):(Mi=Wr(ut.iconBox),mt=Mi.box.length>0),wt=wt&&Mi.offscreen}const zs=$||Fe.numHorizontalGlyphVertices===0&&Fe.numVerticalGlyphVertices===0,ca=G||Fe.numIconVertices===0;if(zs||ca?ca?zs||(mt=mt&&vt):vt=mt&&vt:mt=vt=mt&&vt,vt&&Sr&&Sr.box&&this.collisionIndex.insertCollisionBox(Sr.box,U,f.get("text-ignore-placement"),d.bucketInstanceId,Nr&&Nr.box&&vn?vn:Wt,Z.ID),mt&&Mi&&this.collisionIndex.insertCollisionBox(Mi.box,de,f.get("icon-ignore-placement"),d.bucketInstanceId,xn,Z.ID),fr&&(vt&&this.collisionIndex.insertCollisionCircles(fr.circles,U,f.get("text-ignore-placement"),d.bucketInstanceId,Wt,Z.ID),c)){const Wr=d.bucketInstanceId;let Vr=this.collisionCircleArrays[Wr];Vr===void 0&&(Vr=this.collisionCircleArrays[Wr]=new ve);for(let ri=0;ri<fr.circles.length;ri+=4)Vr.circles.push(fr.circles[ri+0]),Vr.circles.push(fr.circles[ri+1]),Vr.circles.push(fr.circles[ri+2]),Vr.circles.push(fr.collisionDetected?1:0)}if(Fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Fe.crossTileID]=new _e(vt||ke,mt||Se,wt||d.justReloaded),a[Fe.crossTileID]=!0};if(xe){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Fe=d.getSortedSymbolIndexes(this.transform.angle);for(let ut=Fe.length-1;ut>=0;--ut){const Je=Fe[ut];xt(d.symbolInstances.get(Je),d.collisionArrays[Je])}}else for(let Fe=t.symbolInstanceStart;Fe<t.symbolInstanceEnd;Fe++)xt(d.symbolInstances.get(Fe),d.collisionArrays[Fe]);if(c&&d.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[d.bucketInstanceId];l.as(Fe.invProjMatrix,x),Fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}markUsedJustification(t,a,c,d){let f;f=d===l.ai.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[l.at(a)];const x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const w of x)w>=0&&(t.text.placedSymbolArray.get(w).crossTileID=f>=0&&w!==f?0:c.crossTileID)}markUsedOrientation(t,a,c){const d=a===l.ai.horizontal||a===l.ai.horizontalOnly?a:0,f=a===l.ai.vertical?a:0,x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const w of x)t.text.placedSymbolArray.get(w).placedOrientation=d;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=f)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let c=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const d=a?a.symbolFadeChange(t):1,f=a?a.opacities:{},x=a?a.variableOffsets:{},w=a?a.placedOrientations:{};for(const T in this.placements){const E=this.placements[T],C=f[T];C?(this.opacities[T]=new ae(C,d,E.text,E.icon),c=c||E.text!==C.text.placed||E.icon!==C.icon.placed):(this.opacities[T]=new ae(null,d,E.text,E.icon,E.skipFade),c=c||E.text||E.icon)}for(const T in f){const E=f[T];if(!this.opacities[T]){const C=new ae(E,d,!1,!1);C.isHidden()||(this.opacities[T]=C,c=c||E.text.placed||E.icon.placed)}}for(const T in x)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=x[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const c={};for(const d of a){const f=d.getBucket(t);f&&d.latestFeatureIndex&&t.id===f.layerIds[0]&&this.updateBucketOpacities(f,c,d.collisionBoxArray)}}updateBucketOpacities(t,a,c){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const d=t.layers[0],f=d.layout,x=new ae(null,0,!1,!1,!0),w=f.get("text-allow-overlap"),T=f.get("icon-allow-overlap"),E=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),C=f.get("text-rotation-alignment")==="map",P=f.get("text-pitch-alignment")==="map",R=f.get("icon-text-fit")!=="none",Z=new ae(null,0,w&&(T||!t.hasIconData()||f.get("icon-optional")),T&&(w||!t.hasTextData()||f.get("text-optional")),!0);!t.collisionArrays&&c&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(c);const $=(G,U,ne)=>{for(let de=0;de<U/4;de++)G.opacityVertexArray.emplaceBack(ne);G.hasVisibleVertices=G.hasVisibleVertices||ne!==ji};for(let G=0;G<t.symbolInstances.length;G++){const U=t.symbolInstances.get(G),{numHorizontalGlyphVertices:ne,numVerticalGlyphVertices:de,crossTileID:K}=U;let se=this.opacities[K];a[K]?se=x:se||(se=Z,this.opacities[K]=se),a[K]=!0;const me=U.numIconVertices>0,ge=this.placedOrientations[U.crossTileID],xe=ge===l.ai.vertical,ke=ge===l.ai.horizontal||ge===l.ai.horizontalOnly;if(ne>0||de>0){const Se=Fr(se.text);$(t.text,ne,xe?ji:Se),$(t.text,de,ke?ji:Se);const ze=se.text.isHidden();[U.rightJustifiedTextSymbolIndex,U.centerJustifiedTextSymbolIndex,U.leftJustifiedTextSymbolIndex].forEach(Fe=>{Fe>=0&&(t.text.placedSymbolArray.get(Fe).hidden=ze||xe?1:0)}),U.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(U.verticalPlacedTextSymbolIndex).hidden=ze||ke?1:0);const Xe=this.variableOffsets[U.crossTileID];Xe&&this.markUsedJustification(t,Xe.anchor,U,ge);const xt=this.placedOrientations[U.crossTileID];xt&&(this.markUsedJustification(t,"left",U,xt),this.markUsedOrientation(t,xt,U))}if(me){const Se=Fr(se.icon),ze=!(R&&U.verticalPlacedIconSymbolIndex&&xe);U.placedIconSymbolIndex>=0&&($(t.icon,U.numIconVertices,ze?Se:ji),t.icon.placedSymbolArray.get(U.placedIconSymbolIndex).hidden=se.icon.isHidden()),U.verticalPlacedIconSymbolIndex>=0&&($(t.icon,U.numVerticalIconVertices,ze?ji:Se),t.icon.placedSymbolArray.get(U.verticalPlacedIconSymbolIndex).hidden=se.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Se=t.collisionArrays[G];if(Se){let ze=new l.P(0,0);if(Se.textBox||Se.verticalTextBox){let xt=!0;if(E){const Fe=this.variableOffsets[K];Fe?(ze=ct(Fe.anchor,Fe.width,Fe.height,Fe.textOffset,Fe.textBoxScale),C&&ze._rotate(P?this.transform.angle:-this.transform.angle)):xt=!1}Se.textBox&&dt(t.textCollisionBox.collisionVertexArray,se.text.placed,!xt||xe,ze.x,ze.y),Se.verticalTextBox&&dt(t.textCollisionBox.collisionVertexArray,se.text.placed,!xt||ke,ze.x,ze.y)}const Xe=!!(!ke&&Se.verticalIconBox);Se.iconBox&&dt(t.iconCollisionBox.collisionVertexArray,se.icon.placed,Xe,R?ze.x:0,R?ze.y:0),Se.verticalIconBox&&dt(t.iconCollisionBox.collisionVertexArray,se.icon.placed,!Xe,R?ze.x:0,R?ze.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const G=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=G.invProjMatrix,t.placementViewportMatrix=G.viewportMatrix,t.collisionCircleArray=G.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const c=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function dt(p,t,a,c,d){p.emplaceBack(t?1:0,a?1:0,c||0,d||0),p.emplaceBack(t?1:0,a?1:0,c||0,d||0),p.emplaceBack(t?1:0,a?1:0,c||0,d||0),p.emplaceBack(t?1:0,a?1:0,c||0,d||0)}const At=Math.pow(2,25),Ot=Math.pow(2,24),Et=Math.pow(2,17),kt=Math.pow(2,16),qr=Math.pow(2,9),jt=Math.pow(2,8),vr=Math.pow(2,1);function Fr(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const t=p.placed?1:0,a=Math.floor(127*p.opacity);return a*At+t*Ot+a*Et+t*kt+a*qr+t*jt+a*vr+t}const ji=0;class Uc{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,c,d,f){const x=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(x,d,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((w,T)=>w.sortKey-T.sortKey));this._currentPartIndex<x.length;)if(a.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,f())return!0;return!1}}class Ys{constructor(t,a,c,d,f,x,w,T){this.placement=new ot(t,a,x,w,T),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=f,this._done=!1}isDone(){return this._done}continuePlacement(t,a,c){const d=l.h.now(),f=()=>!this._forceFullPlacement&&l.h.now()-d>2;for(;this._currentPlacementIndex>=0;){const x=a[t[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=w)&&(!x.maxzoom||x.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Uc(x)),this._inProgressLayer.continuePlacement(c[x.source],this.placement,this._showCollisionBoxes,x,f))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Js=512/l.N/2;class dp{constructor(t,a,c){this.tileID=t,this.bucketInstanceId=c,this._symbolsByKey={};const d=new Map;for(let f=0;f<a.length;f++){const x=a.get(f),w=x.key,T=d.get(w);T?T.push(x):d.set(w,[x])}for(const[f,x]of d){const w={positions:x.map(T=>({x:Math.floor(T.anchorX*Js),y:Math.floor(T.anchorY*Js)})),crossTileIDs:x.map(T=>T.crossTileID)};if(w.positions.length>128){const T=new l.av(w.positions.length,16,Uint16Array);for(const{x:E,y:C}of w.positions)T.add(E,C);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[f]=w}}getScaledCoordinates(t,a){const{x:c,y:d,z:f}=this.tileID.canonical,{x,y:w,z:T}=a.canonical,E=Js/Math.pow(2,T-f),C=(w*l.N+t.anchorY)*E,P=d*l.N*Js;return{x:Math.floor((x*l.N+t.anchorX)*E-c*l.N*Js),y:Math.floor(C-P)}}findMatches(t,a,c){const d=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let f=0;f<t.length;f++){const x=t.get(f);if(x.crossTileID)continue;const w=this._symbolsByKey[x.key];if(!w)continue;const T=this.getScaledCoordinates(x,a);if(w.index){const E=w.index.range(T.x-d,T.y-d,T.x+d,T.y+d).sort();for(const C of E){const P=w.crossTileIDs[C];if(!c[P]){c[P]=!0,x.crossTileID=P;break}}}else if(w.positions)for(let E=0;E<w.positions.length;E++){const C=w.positions[E],P=w.crossTileIDs[E];if(Math.abs(C.x-T.x)<=d&&Math.abs(C.y-T.y)<=d&&!c[P]){c[P]=!0,x.crossTileID=P;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class Rt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class jl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const c in this.indexes){const d=this.indexes[c],f={};for(const x in d){const w=d[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+a),f[w.tileID.key]=w}this.indexes[c]=f}this.lng=t}addBucket(t,a,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let f=0;f<a.symbolInstances.length;f++)a.symbolInstances.get(f).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const d=this.usedCrossTileIDs[t.overscaledZ];for(const f in this.indexes){const x=this.indexes[f];if(Number(f)>t.overscaledZ)for(const w in x){const T=x[w];T.tileID.isChildOf(t)&&T.findMatches(a.symbolInstances,t,d)}else{const w=x[t.scaledTo(Number(f)).key];w&&w.findMatches(a.symbolInstances,t,d)}}for(let f=0;f<a.symbolInstances.length;f++){const x=a.symbolInstances.get(f);x.crossTileID||(x.crossTileID=c.generate(),d[x.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new dp(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const c of a.getCrossTileIDsLists())for(const d of c)delete this.usedCrossTileIDs[t][d]}removeStaleBuckets(t){let a=!1;for(const c in this.indexes){const d=this.indexes[c];for(const f in d)t[d[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,d[f]),delete d[f],a=!0)}return a}}class Io{constructor(){this.layerIndexes={},this.crossTileIDs=new Rt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,c){let d=this.layerIndexes[t.id];d===void 0&&(d=this.layerIndexes[t.id]=new jl);let f=!1;const x={};d.handleWrapJump(c);for(const w of a){const T=w.getBucket(t);T&&t.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(w.tileID,T,this.crossTileIDs)&&(f=!0),x[T.bucketInstanceId]=!0)}return d.removeStaleBuckets(x)&&(f=!0),f}pruneUnusedLayers(t){const a={};t.forEach(c=>{a[c]=!0});for(const c in this.layerIndexes)a[c]||delete this.layerIndexes[c]}}const Gr=(p,t)=>l.x(p,t&&t.filter(a=>a.identifier!=="source.canvas")),Ei=l.F(l.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),pp=l.F(l.ax,["setCenter","setZoom","setBearing","setPitch"]),$i=l.aw();class Or extends l.E{constructor(t,a={}){super(),this.map=t,this.dispatcher=new Ut(Eo(),this,t._getMapId()),this.imageManager=new Br,this.imageManager.setEventedParent(this),this.glyphManager=new ki(t._requestManager,a.localIdeographFontFamily),this.lineAtlas=new yt(256,512),this.crossTileSymbolIndex=new Io,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.az());const c=this;this._rtlTextPluginCallback=Or.registerForPluginStateChange(d=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:d.pluginStatus,pluginURL:d.pluginURL},(f,x)=>{if(l.aA(f),x&&x.every(w=>w))for(const w in c.sourceCaches){const T=c.sourceCaches[w].getSource().type;T!=="vector"&&T!=="geojson"||c.sourceCaches[w].reload()}})}),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const f=this.sourceCaches[d.sourceId];if(!f)return;const x=f.getSource();if(x&&x.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===x.id&&this._validateLayer(T)}})}loadURL(t,a={},c){this.fire(new l.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const d=this.map._requestManager.transformRequest(t,re.Style);this._request=l.f(d,(f,x)=>{this._request=null,f?this.fire(new l.j(f)):x&&this._load(x,a,c)})}loadJSON(t,a={},c){this.fire(new l.k("dataloading",{dataType:"style"})),this._request=l.h.frame(()=>{this._request=null,a.validate=a.validate!==!1,this._load(t,a,c)})}loadEmpty(){this.fire(new l.k("dataloading",{dataType:"style"})),this._load($i,{validate:!1})}_load(t,a,c){var d;const f=a.transformStyle?a.transformStyle(c,t):t;if(!a.validate||!Gr(this,l.y(f))){this._loaded=!0,this.stylesheet=f;for(const x in f.sources)this.addSource(x,f.sources[x],{validate:!1});f.sprite?this._loadSprite(f.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(f.glyphs),this._createLayers(),this.light=new pt(this.stylesheet.light),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new l.k("data",{dataType:"style"})),this.fire(new l.k("style.load"))}}_createLayers(){const t=l.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",t),this._order=t.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of t){const c=l.aC(a);c.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=c}}_loadSprite(t,a=!1,c=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(d,f,x,w){const T=We(d),E=T.length,C=x>1?"@2x":"",P={},R={},Z={};for(const{id:$,url:G}of T){const U=f.transformRequest(f.normalizeSpriteURL(G,C,".json"),re.SpriteJSON),ne=`${$}_${U.url}`;P[ne]=l.f(U,(se,me)=>{delete P[ne],R[$]=me,qt(w,R,Z,se,E)});const de=f.transformRequest(f.normalizeSpriteURL(G,C,".png"),re.SpriteImage),K=`${$}_${de.url}`;P[K]=Ne.getImage(de,(se,me)=>{delete P[K],Z[$]=me,qt(w,R,Z,se,E)})}return{cancel(){for(const $ of Object.values(P))$.cancel()}}}(t,this.map._requestManager,this.map.getPixelRatio(),(d,f)=>{if(this._spriteRequest=null,d)this.fire(new l.j(d));else if(f)for(const x in f){this._spritesImagesIds[x]=[];const w=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(T=>!(T in f)):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in f[x]){const E=x==="default"?T:`${x}:${T}`;this._spritesImagesIds[x].push(E),E in this.imageManager.images?this.imageManager.updateImage(E,f[x][T],!1):this.imageManager.addImage(E,f[x][T]),a&&(this._changedImages[E]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"})),c&&c(d)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}_validateLayer(t){const a=this.sourceCaches[t.source];if(!a)return;const c=t.sourceLayer;if(!c)return;const d=a.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(c)===-1)&&this.fire(new l.j(new Error(`Source layer "${c}" does not exist on source "${d.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const a=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a);const c=[];for(const d of t)a[d]&&c.push(a[d]);return c}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const c of a){const d=this._layers[c];d.type!=="custom"&&(t[c]=d.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(this._changed){const d=Object.keys(this._updatedLayers),f=Object.keys(this._removedLayers);(d.length||f.length)&&this._updateWorkerLayers(d,f);for(const x in this._updatedSources){const w=this._updatedSources[x];if(w==="reload")this._reloadSource(x);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const c={};for(const d in this.sourceCaches){const f=this.sourceCaches[d];c[d]=f.used,f.used=!1}for(const d of this._order){const f=this._layers[d];f.recalculate(t,this._availableImages),!f.isHidden(t.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}for(const d in c){const f=this.sourceCaches[d];c[d]!==f.used&&f.fire(new l.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(t),this.z=t.zoom,a&&this.fire(new l.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(t),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){this._checkLoaded();const c=this.serialize();if(t=a.transformStyle?a.transformStyle(c,t):t,Gr(this,l.y(t)))return!1;(t=l.aD(t)).layers=l.aB(t.layers);const d=l.aE(c,t).filter(x=>!(x.command in pp));if(d.length===0)return!1;const f=d.filter(x=>!(x.command in Ei));if(f.length>0)throw new Error(`Unimplemented: ${f.map(x=>x.command).join(", ")}.`);for(const x of d)x.command!=="setTransition"&&this[x.command].apply(this,x.args);return this.stylesheet=t,this._serializedLayers=null,!0}addImage(t,a){if(this.getImage(t))return this.fire(new l.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new l.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(l.y.source,`sources.${t}`,a,null,c))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const d=this.sourceCaches[t]=new di(t,a,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:t})),d.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new l.j(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const a=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],a.fire(new l.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(a),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,a,c={}){this._checkLoaded();const d=t.id;if(this.getLayer(d))return void this.fire(new l.j(new Error(`Layer "${d}" already exists on this map.`)));let f;if(t.type==="custom"){if(Gr(this,l.aF(t)))return;f=l.aC(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(d,t.source),t=l.aD(t),t=l.e(t,{source:d})),this._validate(l.y.layer,`layers.${d}`,t,{arrayIndex:-1},c))return;f=l.aC(t),this._validateLayer(f),f.setEventedParent(this,{layer:{id:d}})}const x=a?this._order.indexOf(a):this._order.length;if(a&&x===-1)this.fire(new l.j(new Error(`Cannot add layer "${d}" before non-existing layer "${a}".`)));else{if(this._order.splice(x,0,d),this._layerOrderChanged=!0,this._layers[d]=f,this._removedLayers[d]&&f.source&&f.type!=="custom"){const w=this._removedLayers[d];delete this._removedLayers[d],w.type!==f.type?this._updatedSources[f.source]="clear":(this._updatedSources[f.source]="reload",this.sourceCaches[f.source].pause())}this._updateLayer(f),f.onAdd&&f.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new l.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const c=this._order.indexOf(t);this._order.splice(c,1);const d=a?this._order.indexOf(a):this._order.length;a&&d===-1?this.fire(new l.j(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(d,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new l.j(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,c){this._checkLoaded();const d=this.getLayer(t);d?d.minzoom===a&&d.maxzoom===c||(a!=null&&(d.minzoom=a),c!=null&&(d.maxzoom=c),this._updateLayer(d)):this.fire(new l.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,c={}){this._checkLoaded();const d=this.getLayer(t);if(d){if(!l.aG(d.filter,a))return a==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(l.y.filter,`layers.${d.id}.filter`,a,null,c)||(d.filter=l.aD(a),this._updateLayer(d)))}else this.fire(new l.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return l.aD(this.getLayer(t).filter)}setLayoutProperty(t,a,c,d={}){this._checkLoaded();const f=this.getLayer(t);f?l.aG(f.getLayoutProperty(a),c)||(f.setLayoutProperty(a,c,d),this._updateLayer(f)):this.fire(new l.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const c=this.getLayer(t);if(c)return c.getLayoutProperty(a);this.fire(new l.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,c,d={}){this._checkLoaded();const f=this.getLayer(t);f?l.aG(f.getPaintProperty(a),c)||(f.setPaintProperty(a,c,d)&&this._updateLayer(f),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new l.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const c=t.source,d=t.sourceLayer,f=this.sourceCaches[c];if(f===void 0)return void this.fire(new l.j(new Error(`The source '${c}' does not exist in the map's style.`)));const x=f.getSource().type;x==="geojson"&&d?this.fire(new l.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||d?(t.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),f.setFeatureState(d,t.id,a)):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const c=t.source,d=this.sourceCaches[c];if(d===void 0)return void this.fire(new l.j(new Error(`The source '${c}' does not exist in the map's style.`)));const f=d.getSource().type,x=f==="vector"?t.sourceLayer:void 0;f!=="vector"||x?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new l.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(x,t.id,a):this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,c=t.sourceLayer,d=this.sourceCaches[a];if(d!==void 0)return d.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new l.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(c,t.id)):void this.fire(new l.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=l.aH(this.sourceCaches,f=>f.serialize()),a=this._serializeByIds(this._order),c=this.map.getTerrain()||void 0,d=this.stylesheet;return l.aI({version:d.version,name:d.name,metadata:d.metadata,light:d.light,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:t,layers:a,terrain:c},f=>f!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=x=>this._layers[x].type==="fill-extrusion",c={},d=[];for(let x=this._order.length-1;x>=0;x--){const w=this._order[x];if(a(w)){c[w]=x;for(const T of t){const E=T[w];if(E)for(const C of E)d.push(C)}}}d.sort((x,w)=>w.intersectionZ-x.intersectionZ);const f=[];for(let x=this._order.length-1;x>=0;x--){const w=this._order[x];if(a(w))for(let T=d.length-1;T>=0;T--){const E=d[T].feature;if(c[E.layer.id]<x)break;f.push(E),d.pop()}else for(const T of t){const E=T[w];if(E)for(const C of E)f.push(C.feature)}}return f}queryRenderedFeatures(t,a,c){a&&a.filter&&this._validate(l.y.filter,"queryRenderedFeatures.filter",a.filter,null,a);const d={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new l.j(new Error("parameters.layers must be an Array."))),[];for(const w of a.layers){const T=this._layers[w];if(!T)return this.fire(new l.j(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];d[T.source]=!0}}const f=[];a.availableImages=this._availableImages;const x=this._serializedAllLayers();for(const w in this.sourceCaches)a.layers&&!d[w]||f.push(_s(this.sourceCaches[w],this._layers,x,t,a,c));return this.placement&&f.push(function(w,T,E,C,P,R,Z){const $={},G=R.queryRenderedSymbols(C),U=[];for(const ne of Object.keys(G).map(Number))U.push(Z[ne]);U.sort(es);for(const ne of U){const de=ne.featureIndex.lookupSymbolFeatures(G[ne.bucketInstanceId],T,ne.bucketIndex,ne.sourceLayerIndex,P.filter,P.layers,P.availableImages,w);for(const K in de){const se=$[K]=$[K]||[],me=de[K];me.sort((ge,xe)=>{const ke=ne.featureSortOrder;if(ke){const Se=ke.indexOf(ge.featureIndex);return ke.indexOf(xe.featureIndex)-Se}return xe.featureIndex-ge.featureIndex});for(const ge of me)se.push(ge)}}for(const ne in $)$[ne].forEach(de=>{const K=de.feature,se=E[w[ne].source].getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=se});return $}(this._layers,x,this.sourceCaches,t,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(f)}querySourceFeatures(t,a){a&&a.filter&&this._validate(l.y.filter,"querySourceFeatures.filter",a.filter,null,a);const c=this.sourceCaches[t];return c?function(d,f){const x=d.getRenderableIds().map(E=>d.getTileByID(E)),w=[],T={};for(let E=0;E<x.length;E++){const C=x[E],P=C.tileID.canonical.key;T[P]||(T[P]=!0,C.querySourceFeatures(w,f))}return w}(c,a):[]}addSourceType(t,a,c){return An(t)?c(new Error(`A source type called "${t}" already exists.`)):(((d,f)=>{ja[d]=f})(t,a),a.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:a.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const c=this.light.getLight();let d=!1;for(const x in t)if(!l.aG(t[x],c[x])){d=!0;break}if(!d)return;const f={now:l.h.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(f)}_validate(t,a,c,d,f={}){return(!f||f.validate!==!1)&&Gr(this,t.call(l.y,l.e({key:a,style:this.serialize(),value:c,styleSpec:l.v},d)))}_remove(t=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const c=this.sourceCaches[a];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const a in this.sourceCaches)this.sourceCaches[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,a,c,d,f=!1){let x=!1,w=!1;const T={};for(const E of this._order){const C=this._layers[E];if(C.type!=="symbol")continue;if(!T[C.source]){const R=this.sourceCaches[C.source];T[C.source]=R.getRenderableIds(!0).map(Z=>R.getTileByID(Z)).sort((Z,$)=>$.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan($.tileID)?-1:1))}const P=this.crossTileSymbolIndex.addLayer(C,T[C.source],t.center.lng);x=x||P}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((f=f||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.h.now(),t.zoom))&&(this.pauseablePlacement=new Ys(t,this.map.terrain,this._order,f,a,c,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.h.now()),w=!0),x&&this.pauseablePlacement.placement.setStale()),w||x)for(const E of this._order){const C=this._layers[E];C.type==="symbol"&&this.placement.updateLayerOpacities(C,T[C.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.h.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,a,c){this.imageManager.getImages(a.icons,c),this._updateTilesForChangedImages();const d=this.sourceCaches[a.source];d&&d.setDependencies(a.tileID.key,a.type,a.icons)}getGlyphs(t,a,c){this.glyphManager.getGlyphs(a.stacks,c);const d=this.sourceCaches[a.source];d&&d.setDependencies(a.tileID.key,a.type,[""])}getResource(t,a,c){return l.m(a,c)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(l.y.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,a,c={},d){this._checkLoaded();const f=[{id:t,url:a}],x=[...We(this.stylesheet.sprite),...f];this._validate(l.y.sprite,"sprite",x,null,c)||(this.stylesheet.sprite=x,this._loadSprite(f,!0,d))}removeSprite(t){this._checkLoaded();const a=We(this.stylesheet.sprite);if(a.find(c=>c.id===t)){if(this._spritesImagesIds[t])for(const c of this._spritesImagesIds[t])this.imageManager.removeImage(c),this._changedImages[c]=!0;a.splice(a.findIndex(c=>c.id===t),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.k("data",{dataType:"style"}))}else this.fire(new l.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return We(this.stylesheet.sprite)}setSprite(t,a={},c){this._checkLoaded(),t&&this._validate(l.y.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,c):(this._unloadSprite(),c&&c(null)))}}Or.registerForPluginStateChange=l.aK;var Co=l.Q([{name:"a_pos",type:"Int16",components:2}]),Qs="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Yt={prelude:Pt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Pt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Pt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Pt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Pt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Pt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Pt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Pt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Pt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Pt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Pt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Pt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Pt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Pt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Pt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Pt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Pt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Pt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Pt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Pt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Pt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Pt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Pt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Pt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Pt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Pt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Pt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Qs),terrainDepth:Pt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Qs),terrainCoords:Pt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Qs)};function Pt(p,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/attribute ([\w]+) ([\w]+)/g),d=p.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),f=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=f?f.concat(d):d,w={};return{fragmentSource:p=p.replace(a,(T,E,C,P,R)=>(w[R]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${R}
varying ${C} ${P} ${R};
#else
uniform ${C} ${P} u_${R};
#endif
`:`
#ifdef HAS_UNIFORM_u_${R}
    ${C} ${P} ${R} = u_${R};
#endif
`)),vertexSource:t=t.replace(a,(T,E,C,P,R)=>{const Z=P==="float"?"vec2":"vec4",$=R.match(/color/)?"color":Z;return w[R]?E==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${C} ${Z} a_${R};
varying ${C} ${P} ${R};
#else
uniform ${C} ${P} u_${R};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = a_${R};
#else
    ${C} ${P} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${R} = unpack_mix_${$}(a_${R}, u_${R}_t);
#else
    ${C} ${P} ${R} = u_${R};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${R}
uniform lowp float u_${R}_t;
attribute ${C} ${Z} a_${R};
#else
uniform ${C} ${P} u_${R};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${R}
    ${C} ${P} ${R} = a_${R};
#else
    ${C} ${P} ${R} = u_${R};
#endif
`:`
#ifndef HAS_UNIFORM_u_${R}
    ${C} ${P} ${R} = unpack_mix_${$}(a_${R}, u_${R}_t);
#else
    ${C} ${P} ${R} = u_${R};
#endif
`}),staticAttributes:c,staticUniforms:x}}class bs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,c,d,f,x,w,T,E){this.context=t;let C=this.boundPaintVertexBuffers.length!==d.length;for(let P=0;!C&&P<d.length;P++)this.boundPaintVertexBuffers[P]!==d[P]&&(C=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==c||C||this.boundIndexBuffer!==f||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==E?this.freshBind(a,c,d,f,x,w,T,E):(t.bindVertexArray.set(this.vao),w&&w.bind(),f&&f.dynamicDraw&&f.bind(),T&&T.bind(),E&&E.bind())}freshBind(t,a,c,d,f,x,w,T){const E=t.numAttributes,C=this.context,P=C.gl;this.vao&&this.destroy(),this.vao=C.createVertexArray(),C.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=d,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,a.enableAttributes(P,t);for(const R of c)R.enableAttributes(P,t);x&&x.enableAttributes(P,t),w&&w.enableAttributes(P,t),T&&T.enableAttributes(P,t),a.bind(),a.setVertexAttribPointers(P,t,f);for(const R of c)R.bind(),R.setVertexAttribPointers(P,t,f);x&&(x.bind(),x.setVertexAttribPointers(P,t,f)),d&&d.bind(),w&&(w.bind(),w.setVertexAttribPointers(P,t,f)),T&&(T.bind(),T.setVertexAttribPointers(P,t,f)),C.currentNumAttributes=E}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ir(p){const t=[];for(let a=0;a<p.length;a++){if(p[a]===null)continue;const c=p[a].split(" ");t.push(c.pop())}return t}class Po{constructor(t,a,c,d,f,x){const w=t.gl;this.program=w.createProgram();const T=ir(a.staticAttributes),E=c?c.getBinderAttributes():[],C=T.concat(E),P=Yt.prelude.staticUniforms?ir(Yt.prelude.staticUniforms):[],R=a.staticUniforms?ir(a.staticUniforms):[],Z=c?c.getBinderUniforms():[],$=P.concat(R).concat(Z),G=[];for(const ge of $)G.indexOf(ge)<0&&G.push(ge);const U=c?c.defines():[];f&&U.push("#define OVERDRAW_INSPECTOR;"),x&&U.push("#define TERRAIN3D;");const ne=U.concat(Yt.prelude.fragmentSource,a.fragmentSource).join(`
`),de=U.concat(Yt.prelude.vertexSource,a.vertexSource).join(`
`),K=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(K,ne),w.compileShader(K),!w.getShaderParameter(K,w.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${w.getShaderInfoLog(K)}`);w.attachShader(this.program,K);const se=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(se,de),w.compileShader(se),!w.getShaderParameter(se,w.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${w.getShaderInfoLog(se)}`);w.attachShader(this.program,se),this.attributes={};const me={};this.numAttributes=C.length;for(let ge=0;ge<this.numAttributes;ge++)C[ge]&&(w.bindAttribLocation(this.program,ge,C[ge]),this.attributes[C[ge]]=ge);if(w.linkProgram(this.program),!w.getProgramParameter(this.program,w.LINK_STATUS))throw new Error(`Program failed to link: ${w.getProgramInfoLog(this.program)}`);w.deleteShader(se),w.deleteShader(K);for(let ge=0;ge<G.length;ge++){const xe=G[ge];if(xe&&!me[xe]){const ke=w.getUniformLocation(this.program,xe);ke&&(me[xe]=ke)}}this.fixedUniforms=d(t,me),this.terrainUniforms=((ge,xe)=>({u_depth:new l.aL(ge,xe.u_depth),u_terrain:new l.aL(ge,xe.u_terrain),u_terrain_dim:new l.aM(ge,xe.u_terrain_dim),u_terrain_matrix:new l.aN(ge,xe.u_terrain_matrix),u_terrain_unpack:new l.aO(ge,xe.u_terrain_unpack),u_terrain_exaggeration:new l.aM(ge,xe.u_terrain_exaggeration)}))(t,me),this.binderUniforms=c?c.getUniforms(t,me):[]}draw(t,a,c,d,f,x,w,T,E,C,P,R,Z,$,G,U,ne,de){const K=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(d),t.setColorMode(f),t.setCullFace(x),T){t.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,T.depthTexture),t.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,T.texture);for(const me in this.terrainUniforms)this.terrainUniforms[me].set(T[me])}for(const me in this.fixedUniforms)this.fixedUniforms[me].set(w[me]);G&&G.setUniforms(t,this.binderUniforms,Z,{zoom:$});let se=0;switch(a){case K.LINES:se=2;break;case K.TRIANGLES:se=3;break;case K.LINE_STRIP:se=1}for(const me of R.get()){const ge=me.vaos||(me.vaos={});(ge[E]||(ge[E]=new bs)).bind(t,this,C,G?G.getPaintVertexBuffers():[],P,me.vertexOffset,U,ne,de),K.drawElements(a,me.primitiveLength*se,K.UNSIGNED_SHORT,me.primitiveOffset*se*2)}}}function Zi(p,t,a){const c=1/te(a,1,t.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),f=a.tileSize*Math.pow(2,t.transform.tileZoom)/d,x=f*(a.tileID.canonical.x+a.tileID.wrap*d),w=f*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[c,p.fromScale,p.toScale],u_fade:p.t,u_pixel_coord_upper:[x>>16,w>>16],u_pixel_coord_lower:[65535&x,65535&w]}}const $l=(p,t,a,c)=>{const d=t.style.light,f=d.properties.get("position"),x=[f.x,f.y,f.z],w=function(){var E=new l.A(9);return l.A!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[5]=0,E[6]=0,E[7]=0),E[0]=1,E[4]=1,E[8]=1,E}();d.properties.get("anchor")==="viewport"&&function(E,C){var P=Math.sin(C),R=Math.cos(C);E[0]=R,E[1]=P,E[2]=0,E[3]=-P,E[4]=R,E[5]=0,E[6]=0,E[7]=0,E[8]=1}(w,-t.transform.angle),function(E,C,P){var R=C[0],Z=C[1],$=C[2];E[0]=R*P[0]+Z*P[3]+$*P[6],E[1]=R*P[1]+Z*P[4]+$*P[7],E[2]=R*P[2]+Z*P[5]+$*P[8]}(x,x,w);const T=d.properties.get("color");return{u_matrix:p,u_lightpos:x,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+a,u_opacity:c}},is=(p,t,a,c,d,f,x)=>l.e($l(p,t,a,c),Zi(f,t,x),{u_height_factor:-Math.pow(2,d.overscaledZ)/x.tileSize/8}),jc=p=>({u_matrix:p}),Zl=(p,t,a,c)=>l.e(jc(p),Zi(a,t,c)),zo=(p,t)=>({u_matrix:p,u_world:t}),Mo=(p,t,a,c,d)=>l.e(Zl(p,t,a,c),{u_world:d}),ns=(p,t,a,c)=>{const d=p.transform;let f,x;if(c.paint.get("circle-pitch-alignment")==="map"){const w=te(a,1,d.zoom);f=!0,x=[w,w]}else f=!1,x=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:p.translatePosMatrix(t.posMatrix,a,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+f,u_device_pixel_ratio:p.pixelRatio,u_extrude_scale:x}},ql=(p,t,a)=>{const c=te(a,1,t.zoom),d=Math.pow(2,t.zoom-a.tileID.overscaledZ),f=a.tileID.overscaleFactor();return{u_matrix:p,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[t.pixelsToGLUnits[0]/(c*d),t.pixelsToGLUnits[1]/(c*d)],u_overscale_factor:f}},$a=(p,t,a=1)=>({u_matrix:p,u_color:t,u_overlay:0,u_overlay_scale:a}),$c=p=>({u_matrix:p}),fp=(p,t,a,c)=>({u_matrix:p,u_extrude_scale:te(t,1,a),u_intensity:c});function Gl(p,t){const a=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new l.U(0,c/a).toLngLat().lat,new l.U(0,(c+1)/a).toLngLat().lat]}const Wl=(p,t,a,c)=>{const d=p.transform;return{u_matrix:Ao(p,t,a,c),u_ratio:1/te(t,1,d.zoom),u_device_pixel_ratio:p.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Zc=(p,t,a,c,d)=>l.e(Wl(p,t,a,d),{u_image:0,u_image_height:c}),mp=(p,t,a,c,d)=>{const f=p.transform,x=Gc(t,f);return{u_matrix:Ao(p,t,a,d),u_texsize:t.imageAtlasTexture.size,u_ratio:1/te(t,1,f.zoom),u_device_pixel_ratio:p.pixelRatio,u_image:0,u_scale:[x,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},qc=(p,t,a,c,d,f)=>{const x=p.lineAtlas,w=Gc(t,p.transform),T=a.layout.get("line-cap")==="round",E=x.getDash(c.from,T),C=x.getDash(c.to,T),P=E.width*d.fromScale,R=C.width*d.toScale;return l.e(Wl(p,t,a,f),{u_patternscale_a:[w/P,-E.height/2],u_patternscale_b:[w/R,-C.height/2],u_sdfgamma:x.width/(256*Math.min(P,R)*p.pixelRatio)/2,u_image:0,u_tex_y_a:E.y,u_tex_y_b:C.y,u_mix:d.t})};function Gc(p,t){return 1/te(p,1,t.tileZoom)}function Ao(p,t,a,c){return p.translatePosMatrix(c?c.posMatrix:t.tileID.posMatrix,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Wc=(p,t,a,c,d)=>{return{u_matrix:p,u_tl_parent:t,u_scale_parent:a,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(x=d.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(f=d.paint.get("raster-contrast"),f>0?1/(1-f):1+f),u_spin_weights:Hc(d.paint.get("raster-hue-rotate"))};var f,x};function Hc(p){p*=Math.PI/180;const t=Math.sin(p),a=Math.cos(p);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const Hl=(p,t,a,c,d,f,x,w,T,E)=>{const C=d.transform;return{u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:C.cameraToCenterDistance,u_pitch:C.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:C.width/C.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:f,u_label_plane_matrix:x,u_coord_matrix:w,u_is_text:+T,u_pitch_with_map:+c,u_texsize:E,u_texture:0}},Xl=(p,t,a,c,d,f,x,w,T,E,C)=>{const P=d.transform;return l.e(Hl(p,t,a,c,d,f,x,w,T,E),{u_gamma_scale:c?Math.cos(P._pitch)*P.cameraToCenterDistance:1,u_device_pixel_ratio:d.pixelRatio,u_is_halo:1})},Ss=(p,t,a,c,d,f,x,w,T,E)=>l.e(Xl(p,t,a,c,d,f,x,w,!0,T),{u_texsize_icon:E,u_texture_icon:1}),Do=(p,t,a)=>({u_matrix:p,u_opacity:t,u_color:a}),qi=(p,t,a,c,d,f)=>l.e(function(x,w,T,E){const C=T.imageManager.getPattern(x.from.toString()),P=T.imageManager.getPattern(x.to.toString()),{width:R,height:Z}=T.imageManager.getPixelSize(),$=Math.pow(2,E.tileID.overscaledZ),G=E.tileSize*Math.pow(2,T.transform.tileZoom)/$,U=G*(E.tileID.canonical.x+E.tileID.wrap*$),ne=G*E.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:C.tl,u_pattern_br_a:C.br,u_pattern_tl_b:P.tl,u_pattern_br_b:P.br,u_texsize:[R,Z],u_mix:w.t,u_pattern_size_a:C.displaySize,u_pattern_size_b:P.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/te(E,1,T.transform.tileZoom),u_pixel_coord_upper:[U>>16,ne>>16],u_pixel_coord_lower:[65535&U,65535&ne]}}(c,f,a,d),{u_matrix:p,u_opacity:t}),Lo={fillExtrusion:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_lightpos:new l.aP(p,t.u_lightpos),u_lightintensity:new l.aM(p,t.u_lightintensity),u_lightcolor:new l.aP(p,t.u_lightcolor),u_vertical_gradient:new l.aM(p,t.u_vertical_gradient),u_opacity:new l.aM(p,t.u_opacity)}),fillExtrusionPattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_lightpos:new l.aP(p,t.u_lightpos),u_lightintensity:new l.aM(p,t.u_lightintensity),u_lightcolor:new l.aP(p,t.u_lightcolor),u_vertical_gradient:new l.aM(p,t.u_vertical_gradient),u_height_factor:new l.aM(p,t.u_height_factor),u_image:new l.aL(p,t.u_image),u_texsize:new l.aQ(p,t.u_texsize),u_pixel_coord_upper:new l.aQ(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(p,t.u_pixel_coord_lower),u_scale:new l.aP(p,t.u_scale),u_fade:new l.aM(p,t.u_fade),u_opacity:new l.aM(p,t.u_opacity)}),fill:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix)}),fillPattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_image:new l.aL(p,t.u_image),u_texsize:new l.aQ(p,t.u_texsize),u_pixel_coord_upper:new l.aQ(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(p,t.u_pixel_coord_lower),u_scale:new l.aP(p,t.u_scale),u_fade:new l.aM(p,t.u_fade)}),fillOutline:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_world:new l.aQ(p,t.u_world)}),fillOutlinePattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_world:new l.aQ(p,t.u_world),u_image:new l.aL(p,t.u_image),u_texsize:new l.aQ(p,t.u_texsize),u_pixel_coord_upper:new l.aQ(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(p,t.u_pixel_coord_lower),u_scale:new l.aP(p,t.u_scale),u_fade:new l.aM(p,t.u_fade)}),circle:(p,t)=>({u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_scale_with_map:new l.aL(p,t.u_scale_with_map),u_pitch_with_map:new l.aL(p,t.u_pitch_with_map),u_extrude_scale:new l.aQ(p,t.u_extrude_scale),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_matrix:new l.aN(p,t.u_matrix)}),collisionBox:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_pixels_to_tile_units:new l.aM(p,t.u_pixels_to_tile_units),u_extrude_scale:new l.aQ(p,t.u_extrude_scale),u_overscale_factor:new l.aM(p,t.u_overscale_factor)}),collisionCircle:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_inv_matrix:new l.aN(p,t.u_inv_matrix),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_viewport_size:new l.aQ(p,t.u_viewport_size)}),debug:(p,t)=>({u_color:new l.aR(p,t.u_color),u_matrix:new l.aN(p,t.u_matrix),u_overlay:new l.aL(p,t.u_overlay),u_overlay_scale:new l.aM(p,t.u_overlay_scale)}),clippingMask:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix)}),heatmap:(p,t)=>({u_extrude_scale:new l.aM(p,t.u_extrude_scale),u_intensity:new l.aM(p,t.u_intensity),u_matrix:new l.aN(p,t.u_matrix)}),heatmapTexture:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_world:new l.aQ(p,t.u_world),u_image:new l.aL(p,t.u_image),u_color_ramp:new l.aL(p,t.u_color_ramp),u_opacity:new l.aM(p,t.u_opacity)}),hillshade:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_image:new l.aL(p,t.u_image),u_latrange:new l.aQ(p,t.u_latrange),u_light:new l.aQ(p,t.u_light),u_shadow:new l.aR(p,t.u_shadow),u_highlight:new l.aR(p,t.u_highlight),u_accent:new l.aR(p,t.u_accent)}),hillshadePrepare:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_image:new l.aL(p,t.u_image),u_dimension:new l.aQ(p,t.u_dimension),u_zoom:new l.aM(p,t.u_zoom),u_unpack:new l.aO(p,t.u_unpack)}),line:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_ratio:new l.aM(p,t.u_ratio),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(p,t.u_units_to_pixels)}),lineGradient:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_ratio:new l.aM(p,t.u_ratio),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(p,t.u_units_to_pixels),u_image:new l.aL(p,t.u_image),u_image_height:new l.aM(p,t.u_image_height)}),linePattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_texsize:new l.aQ(p,t.u_texsize),u_ratio:new l.aM(p,t.u_ratio),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_image:new l.aL(p,t.u_image),u_units_to_pixels:new l.aQ(p,t.u_units_to_pixels),u_scale:new l.aP(p,t.u_scale),u_fade:new l.aM(p,t.u_fade)}),lineSDF:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_ratio:new l.aM(p,t.u_ratio),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_units_to_pixels:new l.aQ(p,t.u_units_to_pixels),u_patternscale_a:new l.aQ(p,t.u_patternscale_a),u_patternscale_b:new l.aQ(p,t.u_patternscale_b),u_sdfgamma:new l.aM(p,t.u_sdfgamma),u_image:new l.aL(p,t.u_image),u_tex_y_a:new l.aM(p,t.u_tex_y_a),u_tex_y_b:new l.aM(p,t.u_tex_y_b),u_mix:new l.aM(p,t.u_mix)}),raster:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_tl_parent:new l.aQ(p,t.u_tl_parent),u_scale_parent:new l.aM(p,t.u_scale_parent),u_buffer_scale:new l.aM(p,t.u_buffer_scale),u_fade_t:new l.aM(p,t.u_fade_t),u_opacity:new l.aM(p,t.u_opacity),u_image0:new l.aL(p,t.u_image0),u_image1:new l.aL(p,t.u_image1),u_brightness_low:new l.aM(p,t.u_brightness_low),u_brightness_high:new l.aM(p,t.u_brightness_high),u_saturation_factor:new l.aM(p,t.u_saturation_factor),u_contrast_factor:new l.aM(p,t.u_contrast_factor),u_spin_weights:new l.aP(p,t.u_spin_weights)}),symbolIcon:(p,t)=>({u_is_size_zoom_constant:new l.aL(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(p,t.u_is_size_feature_constant),u_size_t:new l.aM(p,t.u_size_t),u_size:new l.aM(p,t.u_size),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_pitch:new l.aM(p,t.u_pitch),u_rotate_symbol:new l.aL(p,t.u_rotate_symbol),u_aspect_ratio:new l.aM(p,t.u_aspect_ratio),u_fade_change:new l.aM(p,t.u_fade_change),u_matrix:new l.aN(p,t.u_matrix),u_label_plane_matrix:new l.aN(p,t.u_label_plane_matrix),u_coord_matrix:new l.aN(p,t.u_coord_matrix),u_is_text:new l.aL(p,t.u_is_text),u_pitch_with_map:new l.aL(p,t.u_pitch_with_map),u_texsize:new l.aQ(p,t.u_texsize),u_texture:new l.aL(p,t.u_texture)}),symbolSDF:(p,t)=>({u_is_size_zoom_constant:new l.aL(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(p,t.u_is_size_feature_constant),u_size_t:new l.aM(p,t.u_size_t),u_size:new l.aM(p,t.u_size),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_pitch:new l.aM(p,t.u_pitch),u_rotate_symbol:new l.aL(p,t.u_rotate_symbol),u_aspect_ratio:new l.aM(p,t.u_aspect_ratio),u_fade_change:new l.aM(p,t.u_fade_change),u_matrix:new l.aN(p,t.u_matrix),u_label_plane_matrix:new l.aN(p,t.u_label_plane_matrix),u_coord_matrix:new l.aN(p,t.u_coord_matrix),u_is_text:new l.aL(p,t.u_is_text),u_pitch_with_map:new l.aL(p,t.u_pitch_with_map),u_texsize:new l.aQ(p,t.u_texsize),u_texture:new l.aL(p,t.u_texture),u_gamma_scale:new l.aM(p,t.u_gamma_scale),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_is_halo:new l.aL(p,t.u_is_halo)}),symbolTextAndIcon:(p,t)=>({u_is_size_zoom_constant:new l.aL(p,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.aL(p,t.u_is_size_feature_constant),u_size_t:new l.aM(p,t.u_size_t),u_size:new l.aM(p,t.u_size),u_camera_to_center_distance:new l.aM(p,t.u_camera_to_center_distance),u_pitch:new l.aM(p,t.u_pitch),u_rotate_symbol:new l.aL(p,t.u_rotate_symbol),u_aspect_ratio:new l.aM(p,t.u_aspect_ratio),u_fade_change:new l.aM(p,t.u_fade_change),u_matrix:new l.aN(p,t.u_matrix),u_label_plane_matrix:new l.aN(p,t.u_label_plane_matrix),u_coord_matrix:new l.aN(p,t.u_coord_matrix),u_is_text:new l.aL(p,t.u_is_text),u_pitch_with_map:new l.aL(p,t.u_pitch_with_map),u_texsize:new l.aQ(p,t.u_texsize),u_texsize_icon:new l.aQ(p,t.u_texsize_icon),u_texture:new l.aL(p,t.u_texture),u_texture_icon:new l.aL(p,t.u_texture_icon),u_gamma_scale:new l.aM(p,t.u_gamma_scale),u_device_pixel_ratio:new l.aM(p,t.u_device_pixel_ratio),u_is_halo:new l.aL(p,t.u_is_halo)}),background:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_opacity:new l.aM(p,t.u_opacity),u_color:new l.aR(p,t.u_color)}),backgroundPattern:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_opacity:new l.aM(p,t.u_opacity),u_image:new l.aL(p,t.u_image),u_pattern_tl_a:new l.aQ(p,t.u_pattern_tl_a),u_pattern_br_a:new l.aQ(p,t.u_pattern_br_a),u_pattern_tl_b:new l.aQ(p,t.u_pattern_tl_b),u_pattern_br_b:new l.aQ(p,t.u_pattern_br_b),u_texsize:new l.aQ(p,t.u_texsize),u_mix:new l.aM(p,t.u_mix),u_pattern_size_a:new l.aQ(p,t.u_pattern_size_a),u_pattern_size_b:new l.aQ(p,t.u_pattern_size_b),u_scale_a:new l.aM(p,t.u_scale_a),u_scale_b:new l.aM(p,t.u_scale_b),u_pixel_coord_upper:new l.aQ(p,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.aQ(p,t.u_pixel_coord_lower),u_tile_units_to_pixels:new l.aM(p,t.u_tile_units_to_pixels)}),terrain:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_texture:new l.aL(p,t.u_texture),u_ele_delta:new l.aM(p,t.u_ele_delta)}),terrainDepth:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_ele_delta:new l.aM(p,t.u_ele_delta)}),terrainCoords:(p,t)=>({u_matrix:new l.aN(p,t.u_matrix),u_texture:new l.aL(p,t.u_texture),u_terrain_coords_id:new l.aM(p,t.u_terrain_coords_id),u_ele_delta:new l.aM(p,t.u_ele_delta)})};class Ro{constructor(t,a,c){this.context=t;const d=t.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Za={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Bo{constructor(t,a,c,d){this.length=a.length,this.attributes=c,this.itemSize=a.bytesPerElement,this.dynamicDraw=d,this.context=t;const f=t.gl;this.buffer=f.createBuffer(),t.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let c=0;c<this.attributes.length;c++){const d=a.attributes[this.attributes[c].name];d!==void 0&&t.enableVertexAttribArray(d)}}setVertexAttribPointers(t,a,c){for(let d=0;d<this.attributes.length;d++){const f=this.attributes[d],x=a.attributes[f.name];x!==void 0&&t.vertexAttribPointer(x,f.components,t[Za[f.type]],!1,this.itemSize,f.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ea=new WeakMap;function ss(p){var t;if(ea.has(p))return ea.get(p);{const a=(t=p.getParameter(p.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return ea.set(p,a),a}}class St{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Fo extends St{getDefault(){return l.aT.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ii extends St{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Ci extends St{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Kl extends St{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Oo extends St{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class No extends St{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Yl extends St{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Jl extends St{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Vo extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class Ql extends St{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class eu extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class Uo extends St{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Xc extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class Kc extends St{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class ta extends St{getDefault(){return l.aT.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class gp extends St{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class yp extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class _p extends St{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class vp extends St{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class xp extends St{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class wp extends St{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class tu extends St{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class jo extends St{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class ru extends St{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class iu extends St{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class ra extends St{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Yc extends St{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Jc extends St{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const c=this.gl;ss(c)?c.bindVertexArray(t):(a=c.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class nu extends St{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Ts extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Qc extends St{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class as extends St{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class ia extends as{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class eh extends as{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class su extends as{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class zt{constructor(t,a,c,d,f){this.context=t,this.width=a,this.height=c;const x=t.gl,w=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new ia(t,w),d)this.depthAttachment=f?new su(t,w):new eh(t,w);else if(f)throw new Error("Stencil cannot be setted without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class Jt{constructor(t,a,c){this.blendFunction=t,this.blendColor=a,this.mask=c}}Jt.Replace=[1,0],Jt.disabled=new Jt(Jt.Replace,l.aT.transparent,[!1,!1,!1,!1]),Jt.unblended=new Jt(Jt.Replace,l.aT.transparent,[!0,!0,!0,!0]),Jt.alphaBlended=new Jt([1,771],l.aT.transparent,[!0,!0,!0,!0]);class bp{constructor(t){var a,c;if(this.gl=t,this.clearColor=new Fo(this),this.clearDepth=new Ii(this),this.clearStencil=new Ci(this),this.colorMask=new Kl(this),this.depthMask=new Oo(this),this.stencilMask=new No(this),this.stencilFunc=new Yl(this),this.stencilOp=new Jl(this),this.stencilTest=new Vo(this),this.depthRange=new Ql(this),this.depthTest=new eu(this),this.depthFunc=new Uo(this),this.blend=new Xc(this),this.blendFunc=new Kc(this),this.blendColor=new ta(this),this.blendEquation=new gp(this),this.cullFace=new yp(this),this.cullFaceSide=new _p(this),this.frontFace=new vp(this),this.program=new xp(this),this.activeTexture=new wp(this),this.viewport=new tu(this),this.bindFramebuffer=new jo(this),this.bindRenderbuffer=new ru(this),this.bindTexture=new iu(this),this.bindVertexBuffer=new ra(this),this.bindElementBuffer=new Yc(this),this.bindVertexArray=new Jc(this),this.pixelStoreUnpack=new nu(this),this.pixelStoreUnpackPremultiplyAlpha=new Ts(this),this.pixelStoreUnpackFlipY=new Qc(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),ss(t)){this.HALF_FLOAT=t.HALF_FLOAT;const d=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(c=t.RGB16F)!==null&&c!==void 0?c:d==null?void 0:d.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const d=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new Ro(this,t,a)}createVertexBuffer(t,a,c){return new Bo(this,t,a,c)}createRenderbuffer(t,a,c){const d=this.gl,f=d.createRenderbuffer();return this.bindRenderbuffer.set(f),d.renderbufferStorage(d.RENDERBUFFER,t,a,c),this.bindRenderbuffer.set(null),f}createFramebuffer(t,a,c,d){return new zt(this,t,a,c,d)}clear({color:t,depth:a,stencil:c}){const d=this.gl;let f=0;t&&(f|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(f|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),c!==void 0&&(f|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),d.clear(f)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){l.aG(t.blendFunction,Jt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return ss(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return ss(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class Tt{constructor(t,a,c){this.func=t,this.mask=a,this.range=c}}Tt.ReadOnly=!1,Tt.ReadWrite=!0,Tt.disabled=new Tt(519,Tt.ReadOnly,[0,1]);const ks=7680;class Qt{constructor(t,a,c,d,f,x){this.test=t,this.ref=a,this.mask=c,this.fail=d,this.depthFail=f,this.pass=x}}Qt.disabled=new Qt({func:519,mask:0},0,0,ks,ks,ks);class Xt{constructor(t,a,c){this.enable=t,this.mode=a,this.frontFace=c}}let qa;function th(p,t,a,c,d,f,x){const w=p.context,T=w.gl,E=p.useProgram("collisionBox"),C=[];let P=0,R=0;for(let K=0;K<c.length;K++){const se=c[K],me=t.getTile(se),ge=me.getBucket(a);if(!ge)continue;let xe=se.posMatrix;d[0]===0&&d[1]===0||(xe=p.translatePosMatrix(se.posMatrix,me,d,f));const ke=x?ge.textCollisionBox:ge.iconCollisionBox,Se=ge.collisionCircleArray;if(Se.length>0){const ze=l.Z(),Xe=xe;l.aU(ze,ge.placementInvProjMatrix,p.transform.glCoordMatrix),l.aU(ze,ze,ge.placementViewportMatrix),C.push({circleArray:Se,circleOffset:R,transform:Xe,invTransform:ze,coord:se}),P+=Se.length/4,R=P}ke&&E.draw(w,T.LINES,Tt.disabled,Qt.disabled,p.colorModeForRenderPass(),Xt.disabled,ql(xe,p.transform,me),p.style.map.terrain&&p.style.map.terrain.getTerrainData(se),a.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,null,p.transform.zoom,null,null,ke.collisionVertexBuffer)}if(!x||!C.length)return;const Z=p.useProgram("collisionCircle"),$=new l.aV;$.resize(4*P),$._trim();let G=0;for(const K of C)for(let se=0;se<K.circleArray.length/4;se++){const me=4*se,ge=K.circleArray[me+0],xe=K.circleArray[me+1],ke=K.circleArray[me+2],Se=K.circleArray[me+3];$.emplace(G++,ge,xe,ke,Se,0),$.emplace(G++,ge,xe,ke,Se,1),$.emplace(G++,ge,xe,ke,Se,2),$.emplace(G++,ge,xe,ke,Se,3)}(!qa||qa.length<2*P)&&(qa=function(K){const se=2*K,me=new l.aX;me.resize(se),me._trim();for(let ge=0;ge<se;ge++){const xe=6*ge;me.uint16[xe+0]=4*ge+0,me.uint16[xe+1]=4*ge+1,me.uint16[xe+2]=4*ge+2,me.uint16[xe+3]=4*ge+2,me.uint16[xe+4]=4*ge+3,me.uint16[xe+5]=4*ge+0}return me}(P));const U=w.createIndexBuffer(qa,!0),ne=w.createVertexBuffer($,l.aW.members,!0);for(const K of C){const se={u_matrix:K.transform,u_inv_matrix:K.invTransform,u_camera_to_center_distance:(de=p.transform).cameraToCenterDistance,u_viewport_size:[de.width,de.height]};Z.draw(w,T.TRIANGLES,Tt.disabled,Qt.disabled,p.colorModeForRenderPass(),Xt.disabled,se,p.style.map.terrain&&p.style.map.terrain.getTerrainData(K.coord),a.id,ne,U,l.S.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,p.transform.zoom,null,null,null)}var de;ne.destroy(),U.destroy()}Xt.disabled=new Xt(!1,1029,2305),Xt.backCCW=new Xt(!0,1029,2305);const au=l.ao(new Float32Array(16));function $o(p,t,a,c,d,f){const{horizontalAlign:x,verticalAlign:w}=l.au(p);return new l.P((-(x-.5)*t/d+c[0])*f,(-(w-.5)*a/d+c[1])*f)}function Zo(p,t,a,c,d,f,x,w,T,E,C){const P=p.text.placedSymbolArray,R=p.text.dynamicLayoutVertexArray,Z=p.icon.dynamicLayoutVertexArray,$={};R.clear();for(let G=0;G<P.length;G++){const U=P.get(G),ne=U.hidden||!U.crossTileID||p.allowVerticalPlacement&&!U.placedOrientation?null:c[U.crossTileID];if(ne){const de=new l.P(U.anchorX,U.anchorY),K=rr(de,a?x:f,C),se=ws(d.cameraToCenterDistance,K.signedDistanceFromCamera);let me=l.aj(p.textSizeData,T,U)*se/l.ap;a&&(me*=p.tilePixelRatio/w);const{width:ge,height:xe,anchor:ke,textOffset:Se,textBoxScale:ze}=ne,Xe=$o(ke,ge,xe,Se,ze,me),xt=a?rr(de.add(Xe),f,C).point:K.point.add(t?Xe.rotate(-d.angle):Xe),Fe=p.allowVerticalPlacement&&U.placedOrientation===l.ai.vertical?Math.PI/2:0;for(let ut=0;ut<U.numGlyphs;ut++)l.ak(R,xt,Fe);E&&U.associatedIconIndex>=0&&($[U.associatedIconIndex]={shiftedAnchor:xt,angle:Fe})}else V(U.numGlyphs,R)}if(E){Z.clear();const G=p.icon.placedSymbolArray;for(let U=0;U<G.length;U++){const ne=G.get(U);if(ne.hidden)V(ne.numGlyphs,Z);else{const de=$[U];if(de)for(let K=0;K<ne.numGlyphs;K++)l.ak(Z,de.shiftedAnchor,de.angle);else V(ne.numGlyphs,Z)}}p.icon.dynamicLayoutVertexBuffer.updateData(Z)}p.text.dynamicLayoutVertexBuffer.updateData(R)}function ou(p,t,a){return a.iconsInText&&t?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function qo(p,t,a,c,d,f,x,w,T,E,C,P){const R=p.context,Z=R.gl,$=p.transform,G=w==="map",U=T==="map",ne=w!=="viewport"&&a.layout.get("symbol-placement")!=="point",de=G&&!U&&!ne,K=!a.layout.get("symbol-sort-key").isConstant();let se=!1;const me=p.depthModeForSublayer(0,Tt.ReadOnly),ge=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),xe=[];for(const ke of c){const Se=t.getTile(ke),ze=Se.getBucket(a);if(!ze)continue;const Xe=d?ze.text:ze.icon;if(!Xe||!Xe.segments.get().length||!Xe.hasVisibleVertices)continue;const xt=Xe.programConfigurations.get(a.id),Fe=d||ze.sdfIcons,ut=d?ze.textSizeData:ze.iconSizeData,Je=U||$.pitch!==0,Bt=p.useProgram(ou(Fe,d,ze),xt),vt=l.ah(ut,$.zoom),mt=p.style.map.terrain&&p.style.map.terrain.getTerrainData(ke);let wt,ur,$t,Nr,Sr=[0,0],fr=null;if(d)ur=Se.glyphAtlasTexture,$t=Z.LINEAR,wt=Se.glyphAtlasTexture.size,ze.iconsInText&&(Sr=Se.imageAtlasTexture.size,fr=Se.imageAtlasTexture,Nr=Je||p.options.rotating||p.options.zooming||ut.kind==="composite"||ut.kind==="camera"?Z.LINEAR:Z.NEAREST);else{const cr=a.layout.get("icon-size").constantOr(0)!==1||ze.iconsNeedLinear;ur=Se.imageAtlasTexture,$t=Fe||p.options.rotating||p.options.zooming||cr||Je?Z.LINEAR:Z.NEAREST,wt=Se.imageAtlasTexture.size}const Mi=te(Se,1,p.transform.zoom),Wt=De(ke.posMatrix,U,G,p.transform,Mi),vn=gn(ke.posMatrix,U,G,p.transform,Mi),xn=ge&&ze.hasTextData(),cs=a.layout.get("icon-text-fit")!=="none"&&xn&&ze.hasIconData();if(ne){const cr=p.style.map.terrain?(mi,hr)=>p.style.map.terrain.getElevation(ke,mi,hr):null,Tr=a.layout.get("text-rotation-alignment")==="map";Be(ze,ke.posMatrix,p,d,Wt,vn,U,E,Tr,cr)}const zs=p.translatePosMatrix(ke.posMatrix,Se,f,x),ca=ne||d&&ge||cs?au:Wt,Wr=p.translatePosMatrix(vn,Se,f,x,!0),Vr=Fe&&a.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ri;ri=Fe?ze.iconsInText?Ss(ut.kind,vt,de,U,p,zs,ca,Wr,wt,Sr):Xl(ut.kind,vt,de,U,p,zs,ca,Wr,d,wt):Hl(ut.kind,vt,de,U,p,zs,ca,Wr,d,wt);const Ms={program:Bt,buffers:Xe,uniformValues:ri,atlasTexture:ur,atlasTextureIcon:fr,atlasInterpolation:$t,atlasInterpolationIcon:Nr,isSDF:Fe,hasHalo:Vr};if(K&&ze.canOverlap){se=!0;const cr=Xe.segments.get();for(const Tr of cr)xe.push({segments:new l.S([Tr]),sortKey:Tr.sortKey,state:Ms,terrainData:mt})}else xe.push({segments:Xe.segments,sortKey:0,state:Ms,terrainData:mt})}se&&xe.sort((ke,Se)=>ke.sortKey-Se.sortKey);for(const ke of xe){const Se=ke.state;if(R.activeTexture.set(Z.TEXTURE0),Se.atlasTexture.bind(Se.atlasInterpolation,Z.CLAMP_TO_EDGE),Se.atlasTextureIcon&&(R.activeTexture.set(Z.TEXTURE1),Se.atlasTextureIcon&&Se.atlasTextureIcon.bind(Se.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),Se.isSDF){const ze=Se.uniformValues;Se.hasHalo&&(ze.u_is_halo=1,lu(Se.buffers,ke.segments,a,p,Se.program,me,C,P,ze,ke.terrainData)),ze.u_is_halo=0}lu(Se.buffers,ke.segments,a,p,Se.program,me,C,P,Se.uniformValues,ke.terrainData)}}function lu(p,t,a,c,d,f,x,w,T,E){const C=c.context;d.draw(C,C.gl.TRIANGLES,f,x,w,Xt.disabled,T,E,a.id,p.layoutVertexBuffer,p.indexBuffer,t,a.paint,c.transform.zoom,p.programConfigurations.get(a.id),p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer)}function Ga(p,t,a,c,d){if(!a||!c||!c.imageAtlas)return;const f=c.imageAtlas.patternPositions;let x=f[a.to.toString()],w=f[a.from.toString()];if(!x&&w&&(x=w),!w&&x&&(w=x),!x||!w){const T=d.getPaintProperty(t);x=f[T],w=f[T]}x&&w&&p.setConstantPatternPositions(x,w)}function Wa(p,t,a,c,d,f,x){const w=p.context.gl,T="fill-pattern",E=a.paint.get(T),C=E&&E.constantOr(1),P=a.getCrossfadeParameters();let R,Z,$,G,U;x?(Z=C&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=w.LINES):(Z=C?"fillPattern":"fill",R=w.TRIANGLES);const ne=E.constantOr(null);for(const de of c){const K=t.getTile(de);if(C&&!K.patternsLoaded())continue;const se=K.getBucket(a);if(!se)continue;const me=se.programConfigurations.get(a.id),ge=p.useProgram(Z,me),xe=p.style.map.terrain&&p.style.map.terrain.getTerrainData(de);C&&(p.context.activeTexture.set(w.TEXTURE0),K.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),me.updatePaintBuffers(P)),Ga(me,T,ne,K,a);const ke=xe?de:null,Se=p.translatePosMatrix(ke?ke.posMatrix:de.posMatrix,K,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(x){G=se.indexBuffer2,U=se.segments2;const ze=[w.drawingBufferWidth,w.drawingBufferHeight];$=Z==="fillOutlinePattern"&&C?Mo(Se,p,P,K,ze):zo(Se,ze)}else G=se.indexBuffer,U=se.segments,$=C?Zl(Se,p,P,K):jc(Se);ge.draw(p.context,R,d,p.stencilModeForClipping(de),f,Xt.disabled,$,xe,a.id,se.layoutVertexBuffer,G,U,a.paint,p.transform.zoom,me)}}function Ha(p,t,a,c,d,f,x){const w=p.context,T=w.gl,E="fill-extrusion-pattern",C=a.paint.get(E),P=C.constantOr(1),R=a.getCrossfadeParameters(),Z=a.paint.get("fill-extrusion-opacity"),$=C.constantOr(null);for(const G of c){const U=t.getTile(G),ne=U.getBucket(a);if(!ne)continue;const de=p.style.map.terrain&&p.style.map.terrain.getTerrainData(G),K=ne.programConfigurations.get(a.id),se=p.useProgram(P?"fillExtrusionPattern":"fillExtrusion",K);P&&(p.context.activeTexture.set(T.TEXTURE0),U.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),K.updatePaintBuffers(R)),Ga(K,E,$,U,a);const me=p.translatePosMatrix(G.posMatrix,U,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),ge=a.paint.get("fill-extrusion-vertical-gradient"),xe=P?is(me,p,ge,Z,G,R,U):$l(me,p,ge,Z);se.draw(w,w.gl.TRIANGLES,d,f,x,Xt.backCCW,xe,de,a.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,a.paint,p.transform.zoom,K,p.style.map.terrain&&ne.centroidVertexBuffer)}}function Sp(p,t,a,c,d,f,x){const w=p.context,T=w.gl,E=a.fbo;if(!E)return;const C=p.useProgram("hillshade"),P=p.style.map.terrain&&p.style.map.terrain.getTerrainData(t);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,E.colorAttachment.get()),C.draw(w,T.TRIANGLES,d,f,x,Xt.disabled,((R,Z,$,G)=>{const U=$.paint.get("hillshade-shadow-color"),ne=$.paint.get("hillshade-highlight-color"),de=$.paint.get("hillshade-accent-color");let K=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=R.transform.angle);const se=!R.options.moving;return{u_matrix:G?G.posMatrix:R.transform.calculatePosMatrix(Z.tileID.toUnwrapped(),se),u_image:0,u_latrange:Gl(0,Z.tileID),u_light:[$.paint.get("hillshade-exaggeration"),K],u_shadow:U,u_highlight:ne,u_accent:de}})(p,a,c,P?t:null),P,c.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments)}function uu(p,t,a,c,d,f){const x=p.context,w=x.gl,T=t.dem;if(T&&T.data){const E=T.dim,C=T.stride,P=T.getPixels();if(x.activeTexture.set(w.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||p.getTileTexture(C),t.demTexture){const Z=t.demTexture;Z.update(P,{premultiply:!1}),Z.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else t.demTexture=new at(x,P,w.RGBA,{premultiply:!1}),t.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);x.activeTexture.set(w.TEXTURE0);let R=t.fbo;if(!R){const Z=new at(x,{width:E,height:E,data:null},w.RGBA);Z.bind(w.LINEAR,w.CLAMP_TO_EDGE),R=t.fbo=x.createFramebuffer(E,E,!0,!1),R.colorAttachment.set(Z.texture)}x.bindFramebuffer.set(R.framebuffer),x.viewport.set([0,0,E,E]),p.useProgram("hillshadePrepare").draw(x,w.TRIANGLES,c,d,f,Xt.disabled,((Z,$)=>{const G=$.stride,U=l.Z();return l.aS(U,0,l.N,-l.N,0,0,1),l.$(U,U,[0,-l.N,0]),{u_matrix:U,u_image:1,u_dimension:[G,G],u_zoom:Z.overscaledZ,u_unpack:$.getUnpackVector()}})(t.tileID,T),null,a.id,p.rasterBoundsBuffer,p.quadTriangleIndexBuffer,p.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function Tp(p,t,a,c,d,f){const x=c.paint.get("raster-fade-duration");if(!f&&x>0){const w=l.h.now(),T=(w-p.timeAdded)/x,E=t?(w-t.timeAdded)/x:-1,C=a.getSource(),P=d.coveringZoomLevel({tileSize:C.tileSize,roundZoom:C.roundZoom}),R=!t||Math.abs(t.tileID.overscaledZ-P)>Math.abs(p.tileID.overscaledZ-P),Z=R&&p.refreshedUponExpiration?1:l.ad(R?T:1-E,0,1);return p.refreshedUponExpiration&&T>=1&&(p.refreshedUponExpiration=!1),t?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}const rh=new l.aT(1,0,0,1),Go=new l.aT(0,1,0,1),cu=new l.aT(0,0,1,1),ih=new l.aT(1,0,1,1),nh=new l.aT(0,1,1,1);function Xa(p,t,a,c){Ho(p,0,t+a/2,p.transform.width,a,c)}function Wo(p,t,a,c){Ho(p,t-a/2,0,a,p.transform.height,c)}function Ho(p,t,a,c,d,f){const x=p.context,w=x.gl;w.enable(w.SCISSOR_TEST),w.scissor(t*p.pixelRatio,a*p.pixelRatio,c*p.pixelRatio,d*p.pixelRatio),x.clear({color:f}),w.disable(w.SCISSOR_TEST)}function sh(p,t,a){const c=p.context,d=c.gl,f=a.posMatrix,x=p.useProgram("debug"),w=Tt.disabled,T=Qt.disabled,E=p.colorModeForRenderPass(),C="$debug",P=p.style.map.terrain&&p.style.map.terrain.getTerrainData(a);c.activeTexture.set(d.TEXTURE0);const R=t.getTileByID(a.key).latestRawTileData,Z=Math.floor((R&&R.byteLength||0)/1024),$=t.getTile(a).tileSize,G=512/Math.min($,512)*(a.overscaledZ/p.transform.zoom)*.5;let U=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(U+=` => ${a.overscaledZ}`),function(ne,de){ne.initDebugOverlayCanvas();const K=ne.debugOverlayCanvas,se=ne.context.gl,me=ne.debugOverlayCanvas.getContext("2d");me.clearRect(0,0,K.width,K.height),me.shadowColor="white",me.shadowBlur=2,me.lineWidth=1.5,me.strokeStyle="white",me.textBaseline="top",me.font="bold 36px Open Sans, sans-serif",me.fillText(de,5,5),me.strokeText(de,5,5),ne.debugOverlayTexture.update(K),ne.debugOverlayTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE)}(p,`${U} ${Z}kB`),x.draw(c,d.TRIANGLES,w,T,Jt.alphaBlended,Xt.disabled,$a(f,l.aT.transparent,G),null,C,p.debugBuffer,p.quadTriangleIndexBuffer,p.debugSegments),x.draw(c,d.LINE_STRIP,w,T,E,Xt.disabled,$a(f,l.aT.red),P,C,p.debugBuffer,p.tileBorderIndexBuffer,p.debugSegments)}function nr(p,t,a){const c=p.context,d=c.gl,f=p.colorModeForRenderPass(),x=new Tt(d.LEQUAL,Tt.ReadWrite,p.depthRangeFor3D),w=p.useProgram("terrain"),T=t.getTerrainMesh();c.bindFramebuffer.set(null),c.viewport.set([0,0,p.width,p.height]);for(const E of a){const C=p.renderToTexture.getTexture(E),P=t.getTerrainData(E.tileID);c.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,C.texture);const R={u_matrix:p.transform.calculatePosMatrix(E.tileID.toUnwrapped()),u_texture:0,u_ele_delta:t.getMeshFrameDelta(p.transform.zoom)};w.draw(c,d.TRIANGLES,x,Qt.disabled,f,Xt.backCCW,R,P,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class Es{constructor(t,a){this.context=new bp(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.Z(),renderTime:0},this.setup(),this.numSublayers=di.maxUnderzooming+di.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Io}resize(t,a,c){if(this.width=Math.floor(t*c),this.height=Math.floor(a*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const t=this.context,a=new l.a_;a.emplaceBack(0,0),a.emplaceBack(l.N,0),a.emplaceBack(0,l.N),a.emplaceBack(l.N,l.N),this.tileExtentBuffer=t.createVertexBuffer(a,Co.members),this.tileExtentSegments=l.S.simpleSegment(0,0,4,2);const c=new l.a_;c.emplaceBack(0,0),c.emplaceBack(l.N,0),c.emplaceBack(0,l.N),c.emplaceBack(l.N,l.N),this.debugBuffer=t.createVertexBuffer(c,Co.members),this.debugSegments=l.S.simpleSegment(0,0,4,5);const d=new l.V;d.emplaceBack(0,0,0,0),d.emplaceBack(l.N,0,l.N,0),d.emplaceBack(0,l.N,0,l.N),d.emplaceBack(l.N,l.N,l.N,l.N),this.rasterBoundsBuffer=t.createVertexBuffer(d,nn.members),this.rasterBoundsSegments=l.S.simpleSegment(0,0,4,2);const f=new l.a_;f.emplaceBack(0,0),f.emplaceBack(1,0),f.emplaceBack(0,1),f.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(f,Co.members),this.viewportSegments=l.S.simpleSegment(0,0,4,2);const x=new l.a$;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(x);const w=new l.b0;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(w);const T=this.context.gl;this.stencilClearMode=new Qt({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=l.Z();l.aS(c,0,this.width,this.height,0,0,1),l.a0(c,c,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,a.TRIANGLES,Tt.disabled,this.stencilClearMode,Jt.disabled,Xt.disabled,$c(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source;const c=this.context,d=c.gl;this.nextStencilID+a.length>256&&this.clearStencil(),c.setColorMode(Jt.disabled),c.setDepthMode(Tt.disabled);const f=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of a){const w=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(x);f.draw(c,d.TRIANGLES,Tt.disabled,new Qt({func:d.ALWAYS,mask:0},w,255,d.KEEP,d.KEEP,d.REPLACE),Jt.disabled,Xt.disabled,$c(x.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new Qt({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new Qt({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(t){const a=this.context.gl,c=t.sort((x,w)=>w.overscaledZ-x.overscaledZ),d=c[c.length-1].overscaledZ,f=c[0].overscaledZ-d+1;if(f>1){this.currentStencilSource=void 0,this.nextStencilID+f>256&&this.clearStencil();const x={};for(let w=0;w<f;w++)x[w+d]=new Qt({func:a.GEQUAL,mask:255},w+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=f,[x,c]}return[{[d]:Qt.disabled},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Jt([t.CONSTANT_COLOR,t.ONE],new l.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Jt.unblended:Jt.alphaBlended}depthModeForSublayer(t,a,c){if(!this.opaquePassEnabledForLayer())return Tt.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Tt(c||this.context.gl.LEQUAL,a,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(l.h.now()),this.imageManager.beginFrame();const c=this.style._order,d=this.style.sourceCaches,f={},x={},w={};for(const T in d){const E=d[T];E.used&&E.prepare(this.context),f[T]=E.getVisibleCoordinates(),x[T]=f[T].slice().reverse(),w[T]=E.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<c.length;T++)if(this.style._layers[c[T]].is3D()){this.opaquePassCutoff=T;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const T=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!l.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||T.length)&&(l.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(E,C){const P=E.context,R=P.gl,Z=Jt.unblended,$=new Tt(R.LEQUAL,Tt.ReadWrite,[0,1]),G=C.getTerrainMesh(),U=C.sourceCache.getRenderableTiles(),ne=E.useProgram("terrainDepth");P.bindFramebuffer.set(C.getFramebuffer("depth").framebuffer),P.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),P.clear({color:l.aT.transparent,depth:1});for(const de of U){const K=C.getTerrainData(de.tileID),se={u_matrix:E.transform.calculatePosMatrix(de.tileID.toUnwrapped()),u_ele_delta:C.getMeshFrameDelta(E.transform.zoom)};ne.draw(P,R.TRIANGLES,$,Qt.disabled,Z,Xt.backCCW,se,K,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}P.bindFramebuffer.set(null),P.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain),function(E,C){const P=E.context,R=P.gl,Z=Jt.unblended,$=new Tt(R.LEQUAL,Tt.ReadWrite,[0,1]),G=C.getTerrainMesh(),U=C.getCoordsTexture(),ne=C.sourceCache.getRenderableTiles(),de=E.useProgram("terrainCoords");P.bindFramebuffer.set(C.getFramebuffer("coords").framebuffer),P.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),P.clear({color:l.aT.transparent,depth:1}),C.coordsIndex=[];for(const K of ne){const se=C.getTerrainData(K.tileID);P.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,U.texture);const me={u_matrix:E.transform.calculatePosMatrix(K.tileID.toUnwrapped()),u_terrain_coords_id:(255-C.coordsIndex.length)/255,u_texture:0,u_ele_delta:C.getMeshFrameDelta(E.transform.zoom)};de.draw(P,R.TRIANGLES,$,Qt.disabled,Z,Xt.backCCW,me,se,"terrain",G.vertexBuffer,G.indexBuffer,G.segments),C.coordsIndex.push(K.tileID.key)}P.bindFramebuffer.set(null),P.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const T of c){const E=this.style._layers[T];if(!E.hasOffscreenPass()||E.isHidden(this.transform.zoom))continue;const C=x[E.source];(E.type==="custom"||C.length)&&this.renderLayer(this,d[E.source],E,C)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?l.aT.black:l.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[c[this.currentLayer]],E=d[T.source],C=f[T.source];this._renderTileClippingMasks(T,C),this.renderLayer(this,E,T,C)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const T=this.style._layers[c[this.currentLayer]],E=d[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const C=(T.type==="symbol"?w:x)[T.source];this._renderTileClippingMasks(T,f[T.source]),this.renderLayer(this,E,T,C)}if(this.options.showTileBoundaries){const T=function(E,C){let P=null;const R=Object.values(E._layers).flatMap(U=>U.source&&!U.isHidden(C)?[E.sourceCaches[U.source]]:[]),Z=R.filter(U=>U.getSource().type==="vector"),$=R.filter(U=>U.getSource().type!=="vector"),G=U=>{(!P||P.getSource().maxzoom<U.getSource().maxzoom)&&(P=U)};return Z.forEach(U=>G(U)),P||$.forEach(U=>G(U)),P}(this.style,this.transform.zoom);T&&function(E,C,P){for(let R=0;R<P.length;R++)sh(E,C,P[R])}(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const E=T.transform.padding;Xa(T,T.transform.height-(E.top||0),3,rh),Xa(T,E.bottom||0,3,Go),Wo(T,E.left||0,3,cu),Wo(T,T.transform.width-(E.right||0),3,ih);const C=T.transform.centerPoint;(function(P,R,Z,$){Ho(P,R-1,Z-10,2,20,$),Ho(P,R-10,Z-1,20,2,$)})(T,C.x,T.transform.height-C.y,nh)}(this),this.context.setDefault()}renderLayer(t,a,c,d){if(!c.isHidden(this.transform.zoom)&&(c.type==="background"||c.type==="custom"||(d||[]).length))switch(this.id=c.id,c.type){case"symbol":(function(f,x,w,T,E){if(f.renderPass!=="translucent")return;const C=Qt.disabled,P=f.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(R,Z,$,G,U,ne,de){const K=Z.transform,se=U==="map",me=ne==="map";for(const ge of R){const xe=G.getTile(ge),ke=xe.getBucket($);if(!ke||!ke.text||!ke.text.segments.get().length)continue;const Se=l.ah(ke.textSizeData,K.zoom),ze=te(xe,1,Z.transform.zoom),Xe=De(ge.posMatrix,me,se,Z.transform,ze),xt=$.layout.get("icon-text-fit")!=="none"&&ke.hasIconData();if(Se){const Fe=Math.pow(2,K.zoom-xe.tileID.overscaledZ);Zo(ke,se,me,de,K,Xe,ge.posMatrix,Fe,Se,xt,Z.style.map.terrain?(ut,Je)=>Z.style.map.terrain.getElevation(ge,ut,Je):null)}}}(T,f,w,x,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),E),w.paint.get("icon-opacity").constantOr(1)!==0&&qo(f,x,w,T,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),C,P),w.paint.get("text-opacity").constantOr(1)!==0&&qo(f,x,w,T,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),C,P),x.map.showCollisionBoxes&&(th(f,x,w,T,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),!0),th(f,x,w,T,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),!1))})(t,a,c,d,this.style.placement.variableOffsets);break;case"circle":(function(f,x,w,T){if(f.renderPass!=="translucent")return;const E=w.paint.get("circle-opacity"),C=w.paint.get("circle-stroke-width"),P=w.paint.get("circle-stroke-opacity"),R=!w.layout.get("circle-sort-key").isConstant();if(E.constantOr(1)===0&&(C.constantOr(1)===0||P.constantOr(1)===0))return;const Z=f.context,$=Z.gl,G=f.depthModeForSublayer(0,Tt.ReadOnly),U=Qt.disabled,ne=f.colorModeForRenderPass(),de=[];for(let K=0;K<T.length;K++){const se=T[K],me=x.getTile(se),ge=me.getBucket(w);if(!ge)continue;const xe=ge.programConfigurations.get(w.id),ke=f.useProgram("circle",xe),Se=ge.layoutVertexBuffer,ze=ge.indexBuffer,Xe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(se),xt={programConfiguration:xe,program:ke,layoutVertexBuffer:Se,indexBuffer:ze,uniformValues:ns(f,se,me,w),terrainData:Xe};if(R){const Fe=ge.segments.get();for(const ut of Fe)de.push({segments:new l.S([ut]),sortKey:ut.sortKey,state:xt})}else de.push({segments:ge.segments,sortKey:0,state:xt})}R&&de.sort((K,se)=>K.sortKey-se.sortKey);for(const K of de){const{programConfiguration:se,program:me,layoutVertexBuffer:ge,indexBuffer:xe,uniformValues:ke,terrainData:Se}=K.state;me.draw(Z,$.TRIANGLES,G,U,ne,Xt.disabled,ke,Se,w.id,ge,xe,K.segments,w.paint,f.transform.zoom,se)}})(t,a,c,d);break;case"heatmap":(function(f,x,w,T){if(w.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const E=f.context,C=E.gl,P=Qt.disabled,R=new Jt([C.ONE,C.ONE],l.aT.transparent,[!0,!0,!0,!0]);(function(Z,$,G){const U=Z.gl;Z.activeTexture.set(U.TEXTURE1),Z.viewport.set([0,0,$.width/4,$.height/4]);let ne=G.heatmapFbo;if(ne)U.bindTexture(U.TEXTURE_2D,ne.colorAttachment.get()),Z.bindFramebuffer.set(ne.framebuffer);else{const de=U.createTexture();U.bindTexture(U.TEXTURE_2D,de),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_S,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_T,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MAG_FILTER,U.LINEAR),ne=G.heatmapFbo=Z.createFramebuffer($.width/4,$.height/4,!1,!1),function(K,se,me,ge){var xe,ke;const Se=K.gl,ze=(xe=K.HALF_FLOAT)!==null&&xe!==void 0?xe:Se.UNSIGNED_BYTE,Xe=(ke=K.RGBA16F)!==null&&ke!==void 0?ke:Se.RGBA;Se.texImage2D(Se.TEXTURE_2D,0,Xe,se.width/4,se.height/4,0,Se.RGBA,ze,null),ge.colorAttachment.set(me)}(Z,$,de,ne)}})(E,f,w),E.clear({color:l.aT.transparent});for(let Z=0;Z<T.length;Z++){const $=T[Z];if(x.hasRenderableParent($))continue;const G=x.getTile($),U=G.getBucket(w);if(!U)continue;const ne=U.programConfigurations.get(w.id),de=f.useProgram("heatmap",ne),{zoom:K}=f.transform;de.draw(E,C.TRIANGLES,Tt.disabled,P,R,Xt.disabled,fp($.posMatrix,G,K,w.paint.get("heatmap-intensity")),null,w.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,w.paint,f.transform.zoom,ne)}E.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(E,C){const P=E.context,R=P.gl,Z=C.heatmapFbo;if(!Z)return;P.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,Z.colorAttachment.get()),P.activeTexture.set(R.TEXTURE1);let $=C.colorRampTexture;$||($=C.colorRampTexture=new at(P,C.colorRamp,R.RGBA)),$.bind(R.LINEAR,R.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(P,R.TRIANGLES,Tt.disabled,Qt.disabled,E.colorModeForRenderPass(),Xt.disabled,((G,U,ne,de)=>{const K=l.Z();l.aS(K,0,G.width,G.height,0,0,1);const se=G.context.gl;return{u_matrix:K,u_world:[se.drawingBufferWidth,se.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:U.paint.get("heatmap-opacity")}})(E,C),null,C.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,C.paint,E.transform.zoom)}(f,w))})(t,a,c,d);break;case"line":(function(f,x,w,T){if(f.renderPass!=="translucent")return;const E=w.paint.get("line-opacity"),C=w.paint.get("line-width");if(E.constantOr(1)===0||C.constantOr(1)===0)return;const P=f.depthModeForSublayer(0,Tt.ReadOnly),R=f.colorModeForRenderPass(),Z=w.paint.get("line-dasharray"),$=w.paint.get("line-pattern"),G=$.constantOr(1),U=w.paint.get("line-gradient"),ne=w.getCrossfadeParameters(),de=G?"linePattern":Z?"lineSDF":U?"lineGradient":"line",K=f.context,se=K.gl;let me=!0;for(const ge of T){const xe=x.getTile(ge);if(G&&!xe.patternsLoaded())continue;const ke=xe.getBucket(w);if(!ke)continue;const Se=ke.programConfigurations.get(w.id),ze=f.context.program.get(),Xe=f.useProgram(de,Se),xt=me||Xe.program!==ze,Fe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ge),ut=$.constantOr(null);if(ut&&xe.imageAtlas){const vt=xe.imageAtlas,mt=vt.patternPositions[ut.to.toString()],wt=vt.patternPositions[ut.from.toString()];mt&&wt&&Se.setConstantPatternPositions(mt,wt)}const Je=Fe?ge:null,Bt=G?mp(f,xe,w,ne,Je):Z?qc(f,xe,w,Z,ne,Je):U?Zc(f,xe,w,ke.lineClipsArray.length,Je):Wl(f,xe,w,Je);if(G)K.activeTexture.set(se.TEXTURE0),xe.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),Se.updatePaintBuffers(ne);else if(Z&&(xt||f.lineAtlas.dirty))K.activeTexture.set(se.TEXTURE0),f.lineAtlas.bind(K);else if(U){const vt=ke.gradients[w.id];let mt=vt.texture;if(w.gradientVersion!==vt.version){let wt=256;if(w.stepInterpolant){const ur=x.getSource().maxzoom,$t=ge.canonical.z===ur?Math.ceil(1<<f.transform.maxZoom-ge.canonical.z):1;wt=l.ad(l.aY(ke.maxLineLength/l.N*1024*$t),256,K.maxTextureSize)}vt.gradient=l.aZ({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:wt,image:vt.gradient||void 0,clips:ke.lineClipsArray}),vt.texture?vt.texture.update(vt.gradient):vt.texture=new at(K,vt.gradient,se.RGBA),vt.version=w.gradientVersion,mt=vt.texture}K.activeTexture.set(se.TEXTURE0),mt.bind(w.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}Xe.draw(K,se.TRIANGLES,P,f.stencilModeForClipping(ge),R,Xt.disabled,Bt,Fe,w.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,w.paint,f.transform.zoom,Se,ke.layoutVertexBuffer2),me=!1}})(t,a,c,d);break;case"fill":(function(f,x,w,T){const E=w.paint.get("fill-color"),C=w.paint.get("fill-opacity");if(C.constantOr(1)===0)return;const P=f.colorModeForRenderPass(),R=w.paint.get("fill-pattern"),Z=f.opaquePassEnabledForLayer()&&!R.constantOr(1)&&E.constantOr(l.aT.transparent).a===1&&C.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===Z){const $=f.depthModeForSublayer(1,f.renderPass==="opaque"?Tt.ReadWrite:Tt.ReadOnly);Wa(f,x,w,T,$,P,!1)}if(f.renderPass==="translucent"&&w.paint.get("fill-antialias")){const $=f.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,Tt.ReadOnly);Wa(f,x,w,T,$,P,!0)}})(t,a,c,d);break;case"fill-extrusion":(function(f,x,w,T){const E=w.paint.get("fill-extrusion-opacity");if(E!==0&&f.renderPass==="translucent"){const C=new Tt(f.context.gl.LEQUAL,Tt.ReadWrite,f.depthRangeFor3D);if(E!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))Ha(f,x,w,T,C,Qt.disabled,Jt.disabled),Ha(f,x,w,T,C,f.stencilModeFor3D(),f.colorModeForRenderPass());else{const P=f.colorModeForRenderPass();Ha(f,x,w,T,C,Qt.disabled,P)}}})(t,a,c,d);break;case"hillshade":(function(f,x,w,T){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const E=f.context,C=f.depthModeForSublayer(0,Tt.ReadOnly),P=f.colorModeForRenderPass(),[R,Z]=f.renderPass==="translucent"?f.stencilConfigForOverlap(T):[{},T];for(const $ of Z){const G=x.getTile($);G.needsHillshadePrepare!==void 0&&G.needsHillshadePrepare&&f.renderPass==="offscreen"?uu(f,G,w,C,Qt.disabled,P):f.renderPass==="translucent"&&Sp(f,$,G,w,C,R[$.overscaledZ],P)}E.viewport.set([0,0,f.width,f.height])})(t,a,c,d);break;case"raster":(function(f,x,w,T){if(f.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!T.length)return;const E=f.context,C=E.gl,P=x.getSource(),R=f.useProgram("raster"),Z=f.colorModeForRenderPass(),[$,G]=P instanceof Vi?[{},T]:f.stencilConfigForOverlap(T),U=G[G.length-1].overscaledZ,ne=!f.options.moving;for(const de of G){const K=f.depthModeForSublayer(de.overscaledZ-U,w.paint.get("raster-opacity")===1?Tt.ReadWrite:Tt.ReadOnly,C.LESS),se=x.getTile(de);se.registerFadeDuration(w.paint.get("raster-fade-duration"));const me=x.findLoadedParent(de,0),ge=Tp(se,me,x,w,f.transform,f.style.map.terrain);let xe,ke;const Se=w.paint.get("raster-resampling")==="nearest"?C.NEAREST:C.LINEAR;E.activeTexture.set(C.TEXTURE0),se.texture.bind(Se,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(C.TEXTURE1),me?(me.texture.bind(Se,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),xe=Math.pow(2,me.tileID.overscaledZ-se.tileID.overscaledZ),ke=[se.tileID.canonical.x*xe%1,se.tileID.canonical.y*xe%1]):se.texture.bind(Se,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST);const ze=f.style.map.terrain&&f.style.map.terrain.getTerrainData(de),Xe=ze?de:null,xt=Xe?Xe.posMatrix:f.transform.calculatePosMatrix(de.toUnwrapped(),ne),Fe=Wc(xt,ke||[0,0],xe||1,ge,w);P instanceof Vi?R.draw(E,C.TRIANGLES,K,Qt.disabled,Z,Xt.disabled,Fe,ze,w.id,P.boundsBuffer,f.quadTriangleIndexBuffer,P.boundsSegments):R.draw(E,C.TRIANGLES,K,$[de.overscaledZ],Z,Xt.disabled,Fe,ze,w.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}})(t,a,c,d);break;case"background":(function(f,x,w,T){const E=w.paint.get("background-color"),C=w.paint.get("background-opacity");if(C===0)return;const P=f.context,R=P.gl,Z=f.transform,$=Z.tileSize,G=w.paint.get("background-pattern");if(f.isPatternMissing(G))return;const U=!G&&E.a===1&&C===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==U)return;const ne=Qt.disabled,de=f.depthModeForSublayer(0,U==="opaque"?Tt.ReadWrite:Tt.ReadOnly),K=f.colorModeForRenderPass(),se=f.useProgram(G?"backgroundPattern":"background"),me=T||Z.coveringTiles({tileSize:$,terrain:f.style.map.terrain});G&&(P.activeTexture.set(R.TEXTURE0),f.imageManager.bind(f.context));const ge=w.getCrossfadeParameters();for(const xe of me){const ke=T?xe.posMatrix:f.transform.calculatePosMatrix(xe.toUnwrapped()),Se=G?qi(ke,C,f,G,{tileID:xe,tileSize:$},ge):Do(ke,C,E),ze=f.style.map.terrain&&f.style.map.terrain.getTerrainData(xe);se.draw(P,R.TRIANGLES,de,ne,K,Xt.disabled,Se,ze,w.id,f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}})(t,0,c,d);break;case"custom":(function(f,x,w){const T=f.context,E=w.implementation;if(f.renderPass==="offscreen"){const C=E.prerender;C&&(f.setCustomLayerDefaults(),T.setColorMode(f.colorModeForRenderPass()),C.call(E,T.gl,f.transform.customLayerMatrix()),T.setDirty(),f.setBaseState())}else if(f.renderPass==="translucent"){f.setCustomLayerDefaults(),T.setColorMode(f.colorModeForRenderPass()),T.setStencilMode(Qt.disabled);const C=E.renderingMode==="3d"?new Tt(f.context.gl.LEQUAL,Tt.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,Tt.ReadOnly);T.setDepthMode(C),E.render(T.gl,f.transform.customLayerMatrix()),T.setDirty(),f.setBaseState(),T.bindFramebuffer.set(null)}})(t,0,c)}}translatePosMatrix(t,a,c,d,f){if(!c[0]&&!c[1])return t;const x=f?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(x){const E=Math.sin(x),C=Math.cos(x);c=[c[0]*C-c[1]*E,c[0]*E+c[1]*C]}const w=[f?c[0]:te(a,c[0],this.transform.zoom),f?c[1]:te(a,c[1],this.transform.zoom),0],T=new Float32Array(16);return l.$(T,t,w),T}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!a||!c}useProgram(t,a){this.cache=this.cache||{};const c=t+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new Po(this.context,Yt[t],a,Lo[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new at(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}class pi{constructor(t,a){this.points=t,this.planes=a}static fromInvProjectionMatrix(t,a,c){const d=Math.pow(2,c),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const T=1/(w=l.ag([],w,t))[3]/a*d;return l.b3(w,w,[T,T,1/w[3],T])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const T=function(R,Z){var $=Z[0],G=Z[1],U=Z[2],ne=$*$+G*G+U*U;return ne>0&&(ne=1/Math.sqrt(ne)),R[0]=Z[0]*ne,R[1]=Z[1]*ne,R[2]=Z[2]*ne,R}([],function(R,Z,$){var G=Z[0],U=Z[1],ne=Z[2],de=$[0],K=$[1],se=$[2];return R[0]=U*se-ne*K,R[1]=ne*de-G*se,R[2]=G*K-U*de,R}([],Ye([],f[w[0]],f[w[1]]),Ye([],f[w[2]],f[w[1]]))),E=-((C=T)[0]*(P=f[w[1]])[0]+C[1]*P[1]+C[2]*P[2]);var C,P;return T.concat(E)});return new pi(f,x)}}class na{constructor(t,a){this.min=t,this.max=a,this.center=function(c,d,f){return c[0]=.5*d[0],c[1]=.5*d[1],c[2]=.5*d[2],c}([],function(c,d,f){return c[0]=d[0]+f[0],c[1]=d[1]+f[1],c[2]=d[2]+f[2],c}([],this.min,this.max))}quadrant(t){const a=[t%2==0,t<2],c=Te(this.min),d=Te(this.max);for(let f=0;f<a.length;f++)c[f]=a[f]?this.min[f]:this.center[f],d[f]=a[f]?this.center[f]:this.max[f];return d[2]=this.max[2],new na(c,d)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let d=0;d<t.planes.length;d++){const f=t.planes[d];let x=0;for(let w=0;w<a.length;w++)l.b4(f,a[w])>=0&&x++;if(x===0)return 0;x!==a.length&&(c=!1)}if(c)return 2;for(let d=0;d<3;d++){let f=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let w=0;w<t.points.length;w++){const T=t.points[w][d]-this.min[d];f=Math.min(f,T),x=Math.max(x,T)}if(x<0||f>this.max[d]-this.min[d])return 0}return 1}}class Ka{constructor(t=0,a=0,c=0,d=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(c)||c<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=c,this.right=d}interpolate(t,a,c){return a.top!=null&&t.top!=null&&(this.top=l.B.number(t.top,a.top,c)),a.bottom!=null&&t.bottom!=null&&(this.bottom=l.B.number(t.bottom,a.bottom,c)),a.left!=null&&t.left!=null&&(this.left=l.B.number(t.left,a.left,c)),a.right!=null&&t.right!=null&&(this.right=l.B.number(t.right,a.right,c)),this}getCenter(t,a){const c=l.ad((this.left+t-this.right)/2,0,t),d=l.ad((this.top+a-this.bottom)/2,0,a);return new l.P(c,d)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Ka(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Xo{constructor(t,a,c,d,f){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=f===void 0||!!f,this._minZoom=t||0,this._maxZoom=a||22,this._minPitch=c??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ka,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const t=new Xo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this._minEleveationForCurrentTile=t._minEleveationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const a=-l.b5(t,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var c=new l.A(4);return l.A!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c}(),function(c,d,f){var x=d[0],w=d[1],T=d[2],E=d[3],C=Math.sin(f),P=Math.cos(f);c[0]=x*P+T*C,c[1]=w*P+E*C,c[2]=x*-C+T*P,c[3]=w*-C+E*P}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const a=l.ad(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const a=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,c){this._unmodified=!1,this._edgeInsets.interpolate(t,a,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const a=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(t){const a=[new l.b6(0,t)];if(this._renderWorldCopies){const c=this.pointCoordinate(new l.P(0,0)),d=this.pointCoordinate(new l.P(this.width,0)),f=this.pointCoordinate(new l.P(this.width,this.height)),x=this.pointCoordinate(new l.P(0,this.height)),w=Math.floor(Math.min(c.x,d.x,f.x,x.x)),T=Math.floor(Math.max(c.x,d.x,f.x,x.x)),E=1;for(let C=w-E;C<=T+E;C++)C!==0&&a.push(new l.b6(C,t))}return a}coveringTiles(t){var a,c;let d=this.coveringZoomLevel(t);const f=d;if(t.minzoom!==void 0&&d<t.minzoom)return[];t.maxzoom!==void 0&&d>t.maxzoom&&(d=t.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),w=l.U.fromLngLat(this.center),T=Math.pow(2,d),E=[T*x.x,T*x.y,0],C=[T*w.x,T*w.y,0],P=pi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d);let R=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(R=d);const Z=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,$=K=>({aabb:new na([K*T,0,0],[(K+1)*T,T,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),G=[],U=[],ne=d,de=t.reparseOverscaled?f:d;if(this._renderWorldCopies)for(let K=1;K<=3;K++)G.push($(-K)),G.push($(K));for(G.push($(0));G.length>0;){const K=G.pop(),se=K.x,me=K.y;let ge=K.fullyVisible;if(!ge){const Xe=K.aabb.intersects(P);if(Xe===0)continue;ge=Xe===2}const xe=t.terrain?E:C,ke=K.aabb.distanceX(xe),Se=K.aabb.distanceY(xe),ze=Math.max(Math.abs(ke),Math.abs(Se));if(K.zoom===ne||ze>Z+(1<<ne-K.zoom)-2&&K.zoom>=R){const Xe=ne-K.zoom,xt=E[0]-.5-(se<<Xe),Fe=E[1]-.5-(me<<Xe);U.push({tileID:new l.O(K.zoom===ne?de:K.zoom,K.wrap,K.zoom,se,me),distanceSq:it([C[0]-.5-se,C[1]-.5-me]),tileDistanceToCamera:Math.sqrt(xt*xt+Fe*Fe)})}else for(let Xe=0;Xe<4;Xe++){const xt=(se<<1)+Xe%2,Fe=(me<<1)+(Xe>>1),ut=K.zoom+1;let Je=K.aabb.quadrant(Xe);if(t.terrain){const Bt=new l.O(ut,K.wrap,ut,xt,Fe),vt=t.terrain.getMinMaxElevation(Bt),mt=(a=vt.minElevation)!==null&&a!==void 0?a:this.elevation,wt=(c=vt.maxElevation)!==null&&c!==void 0?c:this.elevation;Je=new na([Je.min[0],Je.min[1],mt],[Je.max[0],Je.max[1],wt])}G.push({aabb:Je,zoom:ut,x:xt,y:Fe,wrap:K.wrap,fullyVisible:ge})}}return U.sort((K,se)=>K.distanceSq-se.distanceSq).map(K=>K.tileID)}resize(t,a){this.width=t,this.height=a,this.pixelsToGLUnits=[2/t,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const a=l.ad(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.P(l.G(t.lng)*this.worldSize,l.H(a)*this.worldSize)}unproject(t){return new l.U(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const a=this.pointLocation(this.centerPoint,t),c=t.getElevationForLngLatZoom(a,this.tileZoom);if(!(this.elevation-c))return;const d=this.getCameraPosition(),f=l.U.fromLngLat(d.lngLat,d.altitude),x=l.U.fromLngLat(a,c),w=f.x-x.x,T=f.y-x.y,E=f.z-x.z,C=Math.sqrt(w*w+T*T+E*E),P=this.scaleZoom(this.cameraToCenterDistance/C/this.tileSize);this._elevation=c,this._center=a,this.zoom=P}setLocationAtPoint(t,a){const c=this.pointCoordinate(a),d=this.pointCoordinate(this.centerPoint),f=this.locationCoordinate(t),x=new l.U(f.x-(c.x-d.x),f.y-(c.y-d.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,a){return a?this.coordinatePoint(this.locationCoordinate(t),a.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,a){return this.coordinateLocation(this.pointCoordinate(t,a))}locationCoordinate(t){return l.U.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,a){if(a){const R=a.pointCoordinate(t);if(R!=null)return R}const c=[t.x,t.y,0,1],d=[t.x,t.y,1,1];l.ag(c,c,this.pixelMatrixInverse),l.ag(d,d,this.pixelMatrixInverse);const f=c[3],x=d[3],w=c[1]/f,T=d[1]/x,E=c[2]/f,C=d[2]/x,P=E===C?0:(0-E)/(C-E);return new l.U(l.B.number(c[0]/f,d[0]/x,P)/this.worldSize,l.B.number(w,T,P)/this.worldSize)}coordinatePoint(t,a=0,c=this.pixelMatrix){const d=[t.x*this.worldSize,t.y*this.worldSize,a,1];return l.ag(d,d,c),new l.P(d[0]/d[3],d[1]/d[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Dt().extend(this.pointLocation(new l.P(0,t))).extend(this.pointLocation(new l.P(this.width,t))).extend(this.pointLocation(new l.P(this.width,this.height))).extend(this.pointLocation(new l.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Dt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,a=!1){const c=t.key,d=a?this._alignedPosMatrixCache:this._posMatrixCache;if(d[c])return d[c];const f=t.canonical,x=this.worldSize/this.zoomScale(f.z),w=f.x+Math.pow(2,f.z)*t.wrap,T=l.ao(new Float64Array(16));return l.$(T,T,[w*x,f.y*x,0]),l.a0(T,T,[x/l.N,x/l.N,1]),l.a1(T,a?this.alignedProjMatrix:this.projMatrix,T),d[c]=new Float32Array(T),d[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,a,c,d,f=-90,x=90,w=-180,T=180;const E=this.size,C=this._unmodified;if(this.latRange){const Z=this.latRange;f=l.H(Z[1])*this.worldSize,x=l.H(Z[0])*this.worldSize,t=x-f<E.y?E.y/(x-f):0}if(this.lngRange){const Z=this.lngRange;w=l.b5(l.G(Z[0])*this.worldSize,0,this.worldSize),T=l.b5(l.G(Z[1])*this.worldSize,0,this.worldSize),T<w&&(T+=this.worldSize),a=T-w<E.x?E.x/(T-w):0}const P=this.point,R=Math.max(a||0,t||0);if(R)return this.center=this.unproject(new l.P(a?(T+w)/2:P.x,t?(x+f)/2:P.y)),this.zoom+=this.scaleZoom(R),this._unmodified=C,void(this._constraining=!1);if(this.latRange){const Z=P.y,$=E.y/2;Z-$<f&&(d=f+$),Z+$>x&&(d=x-$)}if(this.lngRange){const Z=(w+T)/2,$=l.b5(P.x,Z-this.worldSize/2,Z+this.worldSize/2),G=E.x/2;$-G<w&&(c=w+G),$+G>T&&(c=T-G)}c===void 0&&d===void 0||(this.center=this.unproject(new l.P(c!==void 0?c:P.x,d!==void 0?d:P.y)).wrap()),this._unmodified=C,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,a=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=l.b7(1,this.center.lat)*this.worldSize;let d=l.ao(new Float64Array(16));l.a0(d,d,[this.width/2,-this.height/2,1]),l.$(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=l.ao(new Float64Array(16)),l.a0(d,d,[1,-1,1]),l.$(d,d,[-1,-1,0]),l.a0(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const f=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),x=Math.min(this.elevation,this._minEleveationForCurrentTile),w=f-x*this._pixelPerMeter/Math.cos(this._pitch),T=x<0?w:f,E=Math.PI/2+this._pitch,C=this._fov*(.5+t.y/this.height),P=Math.sin(C)*T/Math.sin(l.ad(Math.PI-E-C,.01,Math.PI-.01)),R=this.getHorizon(),Z=2*Math.atan(R/this.cameraToCenterDistance)*(.5+t.y/(2*R)),$=Math.sin(Z)*T/Math.sin(l.ad(Math.PI-E-Z,.01,Math.PI-.01)),G=Math.min(P,$),U=1.01*(Math.cos(Math.PI/2-this._pitch)*G+T),ne=this.height/50;d=new Float64Array(16),l.b8(d,this._fov,this.width/this.height,ne,U),d[8]=2*-t.x/this.width,d[9]=2*t.y/this.height,l.a0(d,d,[1,-1,1]),l.$(d,d,[0,0,-this.cameraToCenterDistance]),l.b9(d,d,this._pitch),l.ae(d,d,this.angle),l.$(d,d,[-a,-c,0]),this.mercatorMatrix=l.a0([],d,[this.worldSize,this.worldSize,this.worldSize]),l.a0(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=l.a1(new Float64Array(16),this.labelPlaneMatrix,d),l.$(d,d,[0,0,-this.elevation]),this.projMatrix=d,this.invProjMatrix=l.as([],d),this.pixelMatrix3D=l.a1(new Float64Array(16),this.labelPlaneMatrix,d);const de=this.width%2/2,K=this.height%2/2,se=Math.cos(this.angle),me=Math.sin(this.angle),ge=a-Math.round(a)+se*de+me*K,xe=c-Math.round(c)+se*K+me*de,ke=new Float64Array(d);if(l.$(ke,ke,[ge>.5?ge-1:ge,xe>.5?xe-1:xe,0]),this.alignedProjMatrix=ke,d=l.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new l.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return l.ag(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(0,t))}getCameraQueryGeometry(t){const a=this.getCameraPoint();if(t.length===1)return[t[0],a];{let c=a.x,d=a.y,f=a.x,x=a.y;for(const w of t)c=Math.min(c,w.x),d=Math.min(d,w.y),f=Math.max(f,w.x),x=Math.max(x,w.y);return[new l.P(c,d),new l.P(f,d),new l.P(f,x),new l.P(c,x),new l.P(c,d)]}}}function Is(p,t){let a,c=!1,d=null,f=null;const x=()=>{d=null,c&&(p.apply(f,a),d=setTimeout(x,t),c=!1)};return(...w)=>(c=!0,f=this,a=w,d||x(),d)}class Ya{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let c;return a.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(c=d)}),(c&&c[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:c,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,a)}catch{}},this._updateHash=Is(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const a=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,d),x=Math.round(a.lng*f)/f,w=Math.round(a.lat*f)/f,T=this._map.getBearing(),E=this._map.getPitch();let C="";if(C+=t?`/${x}/${w}/${c}`:`${c}/${w}/${x}`,(T||E)&&(C+="/"+Math.round(10*T)/10),E&&(C+=`/${Math.round(E)}`),this._hashName){const P=this._hashName;let R=!1;const Z=window.location.hash.slice(1).split("&").map($=>{const G=$.split("=")[0];return G===P?(R=!0,`${G}=${C}`):$}).filter($=>$);return R||Z.push(`${P}=${C}`),`#${Z.join("&")}`}return`#${C}`}}const sa={linearity:.3,easing:l.ba(0,0,.3,1)},ah=l.e({deceleration:2500,maxSpeed:1400},sa),oh=l.e({deceleration:20,maxSpeed:1400},sa),lh=l.e({deceleration:1e3,maxSpeed:360},sa),uh=l.e({deceleration:1e3,maxSpeed:90},sa);class ch{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.h.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=l.h.now();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:f}of this._inertiaBuffer)a.zoom+=f.zoomDelta||0,a.bearing+=f.bearingDelta||0,a.pitch+=f.pitchDelta||0,f.panDelta&&a.pan._add(f.panDelta),f.around&&(a.around=f.around),f.pinchAround&&(a.pinchAround=f.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){const f=Ja(a.pan.mag(),c,l.e({},ah,t||{}));d.offset=a.pan.mult(f.amount/a.pan.mag()),d.center=this._map.transform.center,_n(d,f)}if(a.zoom){const f=Ja(a.zoom,c,oh);d.zoom=this._map.transform.zoom+f.amount,_n(d,f)}if(a.bearing){const f=Ja(a.bearing,c,lh);d.bearing=this._map.transform.bearing+l.ad(f.amount,-179,179),_n(d,f)}if(a.pitch){const f=Ja(a.pitch,c,uh);d.pitch=this._map.transform.pitch+f.amount,_n(d,f)}if(d.zoom||d.bearing){const f=a.pinchAround===void 0?a.around:a.pinchAround;d.around=f?this._map.unproject(f):this._map.getCenter()}return this.clear(),l.e(d,{noMoveStart:!0})}}function _n(p,t){(!p.duration||p.duration<t.duration)&&(p.duration=t.duration,p.easing=t.easing)}function Ja(p,t,a){const{maxSpeed:c,linearity:d,deceleration:f}=a,x=l.ad(p*d/(t/1e3),-c,c),w=Math.abs(x)/(f*d);return{easing:a.easing,duration:1e3*w,amount:x*(w/2)}}class Pi extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,c,d={}){const f=F.mousePos(a.getCanvasContainer(),c),x=a.unproject(f);super(t,l.e({point:f,lngLat:x,originalEvent:c},d)),this._defaultPrevented=!1,this.target=a}}class Qa extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,c){const d=t==="touchend"?c.changedTouches:c.touches,f=F.touchPos(a.getCanvasContainer(),d),x=f.map(T=>a.unproject(T)),w=f.reduce((T,E,C,P)=>T.add(E.div(P.length)),new l.P(0,0));super(t,{points:f,point:w,lngLats:x,lngLat:a.unproject(w),originalEvent:c}),this._defaultPrevented=!1}}class hh extends l.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class dh{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new hh(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new Pi(t.type,this._map,t))}mouseup(t){this._map.fire(new Pi(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Pi(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Pi(t.type,this._map,t))}mouseover(t){this._map.fire(new Pi(t.type,this._map,t))}mouseout(t){this._map.fire(new Pi(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Qa(t.type,this._map,t))}touchmove(t){this._map.fire(new Qa(t.type,this._map,t))}touchend(t){this._map.fire(new Qa(t.type,this._map,t))}touchcancel(t){this._map.fire(new Qa(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ph{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Pi(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Pi(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class os{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(l.P.convert(t),this._map.terrain)}}class fh{constructor(t,a){this._map=t,this._tr=new os(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(F.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const c=a;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=c,this._box||(this._box=F.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const f=Math.min(d.x,c.x),x=Math.max(d.x,c.x),w=Math.min(d.y,c.y),T=Math.max(d.y,c.y);F.setTransform(this._box,`translate(${f}px,${w}px)`),this._box.style.width=x-f+"px",this._box.style.height=T-w+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const c=this._startPos,d=a;if(this.reset(),F.suppressClick(),c.x!==d.x||c.y!==d.y)return this._map.fire(new l.k("boxzoomend",{originalEvent:t})),{cameraAnimation:f=>f.fitScreenCoordinates(c,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(F.remove(this._box),this._box=null),F.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new l.k(t,{originalEvent:a}))}}function Gi(p,t){if(p.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${p.length}, points ${t.length}`);const a={};for(let c=0;c<p.length;c++)a[p[c].identifier]=t[c];return a}class Bn{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(d){const f=new l.P(0,0);for(const x of d)f._add(x);return f.div(d.length)}(a),this.touches=Gi(c,a)))}touchmove(t,a,c){if(this.aborted||!this.centroid)return;const d=Gi(c,a);for(const f in this.touches){const x=d[f];(!x||x.dist(this.touches[f])>30)&&(this.aborted=!0)}}touchend(t,a,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Ko{constructor(t){this.singleTap=new Bn(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,c){this.singleTap.touchstart(t,a,c)}touchmove(t,a,c){this.singleTap.touchmove(t,a,c)}touchend(t,a,c){const d=this.singleTap.touchend(t,a,c);if(d){const f=t.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(d)<30;if(f&&x||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class Fn{constructor(t){this._tr=new os(t),this._zoomIn=new Ko({numTouches:1,numTaps:2}),this._zoomOut=new Ko({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,c){this._zoomIn.touchstart(t,a,c),this._zoomOut.touchstart(t,a,c)}touchmove(t,a,c){this._zoomIn.touchmove(t,a,c),this._zoomOut.touchmove(t,a,c)}touchend(t,a,c){const d=this._zoomIn.touchend(t,a,c),f=this._zoomOut.touchend(t,a,c),x=this._tr;return d?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(d)},{originalEvent:t})}):f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(f)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class On{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const d=a.length?a[0]:a;return!this._moved&&d.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(c,d))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&F.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const kp={0:1,2:2};class hu{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=F.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(a,c){const d=kp[c];return a.buttons===void 0||(a.buttons&d)!==d}(t,this._eventButton)}isValidEndEvent(t){return F.mouseButton(t)===this._eventButton}}class mh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const Yo=p=>{p.mousedown=p.dragStart,p.mousemoveWindow=p.dragMove,p.mouseup=p.dragEnd,p.contextmenu=function(t){t.preventDefault()}},aa=({enable:p,clickTolerance:t,bearingDegreesPerPixelMoved:a=.8})=>{const c=new hu({checkCorrectEvent:d=>F.mouseButton(d)===0&&d.ctrlKey||F.mouseButton(d)===2});return new On({clickTolerance:t,move:(d,f)=>({bearingDelta:(f.x-d.x)*a}),moveStateManager:c,enable:p,assignEvents:Yo})},Nn=({enable:p,clickTolerance:t,pitchDegreesPerPixelMoved:a=-.5})=>{const c=new hu({checkCorrectEvent:d=>F.mouseButton(d)===0&&d.ctrlKey||F.mouseButton(d)===2});return new On({clickTolerance:t,move:(d,f)=>({pitchDelta:(f.y-d.y)*a}),moveStateManager:c,enable:p,assignEvents:Yo})};class Ze{constructor(t,a){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(t,a,c){return this._calculateTransform(t,a,c)}touchmove(t,a,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,a,c)}touchend(t,a,c){this._calculateTransform(t,a,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,c){c.length>0&&(this._active=!0);const d=Gi(c,a),f=new l.P(0,0),x=new l.P(0,0);let w=0;for(const E in d){const C=d[E],P=this._touches[E];P&&(f._add(C),x._add(C.sub(P)),w++,d[E]=C)}if(this._touches=d,w<this._minTouches||!x.mag())return;const T=x.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:f.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,c){if(!this._firstTwoTouches)return;t.preventDefault();const[d,f]=this._firstTwoTouches,x=ls(c,a,d),w=ls(c,a,f);if(!x||!w)return;const T=this._aroundCenter?null:x.add(w).div(2);return this._move([x,w],T,t)}touchend(t,a,c){if(!this._firstTwoTouches)return;const[d,f]=this._firstTwoTouches,x=ls(c,a,d),w=ls(c,a,f);x&&w||(this._active&&F.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ls(p,t,a){for(let c=0;c<p.length;c++)if(p[c].identifier===a)return t[c]}function oa(p,t){return Math.log(p/t)/Math.LN2}class gh extends Jo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(oa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:oa(this._distance,c),pinchAround:a}}}function Ue(p,t){return 180*p.angleWith(t)/Math.PI}class du extends Jo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a){const c=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ue(this._vector,c),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,c=Ue(t,this._startVector);return Math.abs(c)<a}}function pu(p){return Math.abs(p.y)>Math.abs(p.x)}class Ep extends Jo{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,c){super.touchstart(t,a,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,pu(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const d=t[0].sub(this._lastPoints[0]),f=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,f,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+f.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,c){if(this._valid!==void 0)return this._valid;const d=t.mag()>=2,f=a.mag()>=2;if(!d&&!f)return;if(!d||!f)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const x=t.y>0==a.y>0;return pu(t)&&pu(a)&&x}}const fu={panStep:100,bearingStep:15,pitchStep:10};class yh{constructor(t){this._tr=new os(t);const a=fu;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,c=0,d=0,f=0,x=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),f=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),f=1);break;case 38:t.shiftKey?d=1:(t.preventDefault(),x=-1);break;case 40:t.shiftKey?d=-1:(t.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(c=0,d=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:_h,zoom:a?Math.round(T.zoom)+a*(t.shiftKey?2:1):T.zoom,bearing:T.bearing+c*this._bearingStep,pitch:T.pitch+d*this._pitchStep,offset:[-f*this._panStep,-x*this._panStep],center:T.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _h(p){return p*(2-p)}const vh=4.000244140625;class Ip{constructor(t,a){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=t,this._tr=new os(t),this._el=t.getCanvasContainer(),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!t[this._map._metaKey])return;t.preventDefault()}let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=l.h.now(),d=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,a!==0&&a%vh==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(d*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=F.mousePos(this._el,t),c=this._tr;this._around=l.L.convert(this._aroundCenter?c.center:c.unproject(a)),this._aroundPoint=c.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>vh?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const E=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(E*T))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,c=this._startZoom,d=this._easing;let f,x=!1;if(this._type==="wheel"&&c&&d){const w=Math.min((l.h.now()-this._lastWheelEventTime)/200,1),T=d(w);f=l.B.number(c,a,T),w<1?this._frameId||(this._frameId=!0):x=!0}else f=a,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:f-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=l.bb;if(this._prevEase){const c=this._prevEase,d=(l.h.now()-c.start)/c.duration,f=c.easing(d+.01)-c.easing(d),x=.27/Math.sqrt(f*f+1e-4)*.01,w=Math.sqrt(.0729-x*x);a=l.ba(x,w,.25,1)}return this._prevEase={start:l.h.now(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class mu{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class gu{constructor(t){this._tr=new os(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yu{constructor(){this._tap=new Ko({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,c){if(!this._swipePoint)if(this._tapTime){const d=a[0],f=t.timeStamp-this._tapTime<500,x=this._tapPoint.dist(d)<30;f&&x?c.length>0&&(this._swipePoint=d,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(t,a,c)}touchmove(t,a,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const d=a[0],f=d.y-this._swipePoint.y;return this._swipePoint=d,t.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(t,a,c)}touchend(t,a,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const d=this._tap.touchend(t,a,c);d&&(this._tapTime=t.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _u{constructor(t,a,c){this._el=t,this._mousePan=a,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class fi{constructor(t,a,c){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=a,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class us{constructor(t,a,c,d){this._el=t,this._touchZoom=a,this._touchRotate=c,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const eo=p=>p.zoom||p.drag||p.pitch||p.rotate;class vu extends l.k{}function to(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class xu{constructor(t,a){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,f)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=d.type==="renderFrame"?void 0:d,w={needsRenderFrame:!1},T={},E={},C=d.touches,P=C?this._getMapTouches(C):void 0,R=P?F.touchPos(this._el,P):F.mousePos(this._el,d);for(const{handlerName:G,handler:U,allowed:ne}of this._handlers){if(!U.isEnabled())continue;let de;this._blockedByActive(E,ne,G)?U.reset():U[f||d.type]&&(de=U[f||d.type](d,R,P),this.mergeHandlerResult(w,T,de,G,x),de&&de.needsRenderFrame&&this._triggerRenderFrame()),(de||U.isActive())&&(E[G]=U)}const Z={};for(const G in this._previousActiveHandlers)E[G]||(Z[G]=x);this._previousActiveHandlers=E,(Object.keys(Z).length||to(w))&&(this._changes.push([w,T,Z]),this._triggerRenderFrame()),(Object.keys(E).length||to(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=w;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ch(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,f,x]of this._listeners)F.addEventListener(d,f,d===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[t,a,c]of this._listeners)F.removeEventListener(t,a,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const a=this._map,c=a.getCanvasContainer();this._add("mapEvent",new dh(a,t));const d=a.boxZoom=new fh(a,t);this._add("boxZoom",d),t.interactive&&t.boxZoom&&d.enable();const f=new Fn(a),x=new gu(a);a.doubleClickZoom=new mu(x,f),this._add("tapZoom",f),this._add("clickZoom",x),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const w=new yu;this._add("tapDragZoom",w);const T=a.touchPitch=new Ep(a);this._add("touchPitch",T),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const E=aa(t),C=Nn(t);a.dragRotate=new fi(t,E,C),this._add("mouseRotate",E,["mousePitch"]),this._add("mousePitch",C,["mouseRotate"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const P=(({enable:ne,clickTolerance:de})=>{const K=new hu({checkCorrectEvent:se=>F.mouseButton(se)===0&&!se.ctrlKey});return new On({clickTolerance:de,move:(se,me)=>({around:me,panDelta:me.sub(se)}),activateOnStart:!0,moveStateManager:K,enable:ne,assignEvents:Yo})})(t),R=new Ze(t,a);a.dragPan=new _u(c,P,R),this._add("mousePan",P),this._add("touchPan",R,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const Z=new du,$=new gh;a.touchZoomRotate=new us(c,$,Z,w),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",$,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate);const G=a.scrollZoom=new Ip(a,()=>this._triggerRenderFrame());this._add("scrollZoom",G,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const U=a.keyboard=new yh(a);this._add("keyboard",U),t.interactive&&t.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new ph(a))}_add(t,a,c){this._handlers.push({handlerName:t,handler:a,allowed:c}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!eo(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,c){for(const d in t)if(d!==c&&(!a||a.indexOf(d)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const c of t)this._el.contains(c.target)&&a.push(c);return a}mergeHandlerResult(t,a,c,d,f){if(!c)return;l.e(t,c);const x={handlerName:d,originalEvent:c.originalEvent||f};c.zoomDelta!==void 0&&(a.zoom=x),c.panDelta!==void 0&&(a.drag=x),c.pitchDelta!==void 0&&(a.pitch=x),c.bearingDelta!==void 0&&(a.rotate=x)}_applyChanges(){const t={},a={},c={};for(const[d,f,x]of this._changes)d.panDelta&&(t.panDelta=(t.panDelta||new l.P(0,0))._add(d.panDelta)),d.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(t.around=d.around),d.pinchAround!==void 0&&(t.pinchAround=d.pinchAround),d.noInertia&&(t.noInertia=d.noInertia),l.e(a,f),l.e(c,x);this._updateMapTransform(t,a,c),this._changes=[]}_updateMapTransform(t,a,c){const d=this._map,f=d._getTransformForUpdate(),x=d.terrain;if(!(to(t)||x&&this._terrainMovement))return this._fireEvents(a,c,!0);let{panDelta:w,zoomDelta:T,bearingDelta:E,pitchDelta:C,around:P,pinchAround:R}=t;R!==void 0&&(P=R),d._stop(!0),P=P||d.transform.centerPoint;const Z=f.pointLocation(w?P.sub(w):P);E&&(f.bearing+=E),C&&(f.pitch+=C),T&&(f.zoom+=T),x?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?f.center=f.pointLocation(f.centerPoint.sub(w)):f.setLocationAtPoint(Z,P):(this._terrainMovement=!0,this._map._elevationFreeze=!0,f.setLocationAtPoint(Z,P),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,f.recalculateZoom(d.terrain)})):f.setLocationAtPoint(Z,P),d._applyUpdatedTransform(f),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,c,!0)}_fireEvents(t,a,c){const d=eo(this._eventsInProgress),f=eo(t),x={};for(const C in t){const{originalEvent:P}=t[C];this._eventsInProgress[C]||(x[`${C}start`]=P),this._eventsInProgress[C]=t[C]}!d&&f&&this._fireEvent("movestart",f.originalEvent);for(const C in x)this._fireEvent(C,x[C]);f&&this._fireEvent("move",f.originalEvent);for(const C in t){const{originalEvent:P}=t[C];this._fireEvent(C,P)}const w={};let T;for(const C in this._eventsInProgress){const{handlerName:P,originalEvent:R}=this._eventsInProgress[C];this._handlersById[P].isActive()||(delete this._eventsInProgress[C],T=a[P]||R,w[`${C}end`]=T)}for(const C in w)this._fireEvent(C,w[C]);const E=eo(this._eventsInProgress);if(c&&(d||f)&&!E){this._updatingCamera=!0;const C=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),P=R=>R!==0&&-this._bearingSnap<R&&R<this._bearingSnap;!C||!C.essential&&l.h.prefersReducedMotion?(this._map.fire(new l.k("moveend",{originalEvent:T})),P(this._map.getBearing())&&this._map.resetNorth()):(P(C.bearing||this._map.getBearing())&&(C.bearing=0),C.freezeElevation=!0,this._map.easeTo(C,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new l.k(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new vu("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class xh extends l.E{constructor(t,a){super(),this._renderFrameCallback=()=>{const c=Math.min((l.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new l.L(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}panBy(t,a,c){return t=l.P.convert(t).mult(-1),this.panTo(this.transform.center,l.e({offset:t},a),c)}panTo(t,a,c){return this.easeTo(l.e({center:t},a),c)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,c){return this.easeTo(l.e({zoom:t},a),c)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,c){return this.easeTo(l.e({bearing:t},a),c)}resetNorth(t,a){return this.rotateTo(0,l.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(l.e({bearing:0,pitch:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}cameraForBounds(t,a){t=Dt.convert(t);const c=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,a)}_cameraForBoxAndBearing(t,a,c,d){const f={top:0,bottom:0,right:0,left:0};if(typeof(d=l.e({padding:f,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const me=d.padding;d.padding={top:me,bottom:me,right:me,left:me}}d.padding=l.e(f,d.padding);const x=this.transform,w=x.padding,T=x.project(l.L.convert(t)),E=x.project(l.L.convert(a)),C=T.rotate(-c*Math.PI/180),P=E.rotate(-c*Math.PI/180),R=new l.P(Math.max(C.x,P.x),Math.max(C.y,P.y)),Z=new l.P(Math.min(C.x,P.x),Math.min(C.y,P.y)),$=R.sub(Z),G=(x.width-(w.left+w.right+d.padding.left+d.padding.right))/$.x,U=(x.height-(w.top+w.bottom+d.padding.top+d.padding.bottom))/$.y;if(U<0||G<0)return void l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ne=Math.min(x.scaleZoom(x.scale*Math.min(G,U)),d.maxZoom),de=l.P.convert(d.offset),K=new l.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(c*Math.PI/180),se=de.add(K).mult(x.scale/x.zoomScale(ne));return{center:x.unproject(T.add(E).div(2).sub(se)),zoom:ne,bearing:c}}fitBounds(t,a,c){return this._fitInternal(this.cameraForBounds(t,a),a,c)}fitScreenCoordinates(t,a,c,d,f){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.P.convert(t)),this.transform.pointLocation(l.P.convert(a)),c,d),d,f)}_fitInternal(t,a,c){return t?(delete(a=l.e(t,a)).padding,a.linear?this.easeTo(a,c):this.flyTo(a,c)):this}jumpTo(t,a){this.stop();const c=this._getTransformForUpdate();let d=!1,f=!1,x=!1;return"zoom"in t&&c.zoom!==+t.zoom&&(d=!0,c.zoom=+t.zoom),t.center!==void 0&&(c.center=l.L.convert(t.center)),"bearing"in t&&c.bearing!==+t.bearing&&(f=!0,c.bearing=+t.bearing),"pitch"in t&&c.pitch!==+t.pitch&&(x=!0,c.pitch=+t.pitch),t.padding==null||c.isPaddingEqual(t.padding)||(c.padding=t.padding),this._applyUpdatedTransform(c),this.fire(new l.k("movestart",a)).fire(new l.k("move",a)),d&&this.fire(new l.k("zoomstart",a)).fire(new l.k("zoom",a)).fire(new l.k("zoomend",a)),f&&this.fire(new l.k("rotatestart",a)).fire(new l.k("rotate",a)).fire(new l.k("rotateend",a)),x&&this.fire(new l.k("pitchstart",a)).fire(new l.k("pitch",a)).fire(new l.k("pitchend",a)),this.fire(new l.k("moveend",a))}calculateCameraOptionsFromTo(t,a,c,d=0){const f=l.U.fromLngLat(t,a),x=l.U.fromLngLat(c,d),w=x.x-f.x,T=x.y-f.y,E=x.z-f.z,C=Math.hypot(w,T,E);if(C===0)throw new Error("Can't calculate camera options with same From and To");const P=Math.hypot(w,T),R=this.transform.scaleZoom(this.transform.cameraToCenterDistance/C/this.transform.tileSize),Z=180*Math.atan2(w,-T)/Math.PI;let $=180*Math.acos(P/C)/Math.PI;return $=E<0?90-$:90+$,{center:x.toLngLat(),zoom:R,pitch:$,bearing:Z}}easeTo(t,a){this._stop(!1,t.easeId),((t=l.e({offset:[0,0],duration:500,easing:l.bb},t)).animate===!1||!t.essential&&l.h.prefersReducedMotion)&&(t.duration=0);const c=this._getTransformForUpdate(),d=this.getZoom(),f=this.getBearing(),x=this.getPitch(),w=this.getPadding(),T="zoom"in t?+t.zoom:d,E="bearing"in t?this._normalizeBearing(t.bearing,f):f,C="pitch"in t?+t.pitch:x,P="padding"in t?t.padding:c.padding,R=l.P.convert(t.offset);let Z=c.centerPoint.add(R);const $=c.pointLocation(Z),G=l.L.convert(t.center||$);this._normalizeCenter(G);const U=c.project($),ne=c.project(G).sub(U),de=c.zoomScale(T-d);let K,se;t.around&&(K=l.L.convert(t.around),se=c.locationPoint(K));const me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||T!==d,this._rotating=this._rotating||f!==E,this._pitching=this._pitching||C!==x,this._padding=!c.isPaddingEqual(P),this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,me),this.terrain&&this._prepareElevation(G),this._ease(ge=>{if(this._zooming&&(c.zoom=l.B.number(d,T,ge)),this._rotating&&(c.bearing=l.B.number(f,E,ge)),this._pitching&&(c.pitch=l.B.number(x,C,ge)),this._padding&&(c.interpolatePadding(w,P,ge),Z=c.centerPoint.add(R)),this.terrain&&!t.freezeElevation&&this._updateElevation(ge),K)c.setLocationAtPoint(K,se);else{const xe=c.zoomScale(c.zoom-d),ke=T>d?Math.min(2,de):Math.max(.5,de),Se=Math.pow(ke,1-ge),ze=c.unproject(U.add(ne.mult(ge*Se)).mult(xe));c.setLocationAtPoint(c.renderWorldCopies?ze.wrap():ze,Z)}this._applyUpdatedTransform(c),this._fireMoveEvents(a)},ge=>{this.terrain&&this._finalizeElevation(),this._afterEase(a,ge)},t),this}_prepareEase(t,a,c={}){this._moving=!0,a||c.moving||this.fire(new l.k("movestart",t)),this._zooming&&!c.zooming&&this.fire(new l.k("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new l.k("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new l.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(c-(a-(c*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.elevation=l.B.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const a=t.clone(),{center:c,zoom:d,pitch:f,bearing:x,elevation:w}=this.transformCameraUpdate(a);c&&(a.center=c),d!==void 0&&(a.zoom=d),f!==void 0&&(a.pitch=f),x!==void 0&&(a.bearing=x),w!==void 0&&(a.elevation=w),this.transform.apply(a)}_fireMoveEvents(t){this.fire(new l.k("move",t)),this._zooming&&this.fire(new l.k("zoom",t)),this._rotating&&this.fire(new l.k("rotate",t)),this._pitching&&this.fire(new l.k("pitch",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const c=this._zooming,d=this._rotating,f=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new l.k("zoomend",t)),d&&this.fire(new l.k("rotateend",t)),f&&this.fire(new l.k("pitchend",t)),this.fire(new l.k("moveend",t))}flyTo(t,a){if(!t.essential&&l.h.prefersReducedMotion){const Je=l.F(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Je,a)}this.stop(),t=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.bb},t);const c=this._getTransformForUpdate(),d=this.getZoom(),f=this.getBearing(),x=this.getPitch(),w=this.getPadding(),T="zoom"in t?l.ad(+t.zoom,c.minZoom,c.maxZoom):d,E="bearing"in t?this._normalizeBearing(t.bearing,f):f,C="pitch"in t?+t.pitch:x,P="padding"in t?t.padding:c.padding,R=c.zoomScale(T-d),Z=l.P.convert(t.offset);let $=c.centerPoint.add(Z);const G=c.pointLocation($),U=l.L.convert(t.center||G);this._normalizeCenter(U);const ne=c.project(G),de=c.project(U).sub(ne);let K=t.curve;const se=Math.max(c.width,c.height),me=se/R,ge=de.mag();if("minZoom"in t){const Je=l.ad(Math.min(t.minZoom,d,T),c.minZoom,c.maxZoom),Bt=se/c.zoomScale(Je-d);K=Math.sqrt(Bt/ge*2)}const xe=K*K;function ke(Je){const Bt=(me*me-se*se+(Je?-1:1)*xe*xe*ge*ge)/(2*(Je?me:se)*xe*ge);return Math.log(Math.sqrt(Bt*Bt+1)-Bt)}function Se(Je){return(Math.exp(Je)-Math.exp(-Je))/2}function ze(Je){return(Math.exp(Je)+Math.exp(-Je))/2}const Xe=ke(!1);let xt=function(Je){return ze(Xe)/ze(Xe+K*Je)},Fe=function(Je){return se*((ze(Xe)*(Se(Bt=Xe+K*Je)/ze(Bt))-Se(Xe))/xe)/ge;var Bt},ut=(ke(!0)-Xe)/K;if(Math.abs(ge)<1e-6||!isFinite(ut)){if(Math.abs(se-me)<1e-6)return this.easeTo(t,a);const Je=me<se?-1:1;ut=Math.abs(Math.log(me/se))/K,Fe=function(){return 0},xt=function(Bt){return Math.exp(Je*K*Bt)}}return t.duration="duration"in t?+t.duration:1e3*ut/("screenSpeed"in t?+t.screenSpeed/K:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=f!==E,this._pitching=C!==x,this._padding=!c.isPaddingEqual(P),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(U),this._ease(Je=>{const Bt=Je*ut,vt=1/xt(Bt);c.zoom=Je===1?T:d+c.scaleZoom(vt),this._rotating&&(c.bearing=l.B.number(f,E,Je)),this._pitching&&(c.pitch=l.B.number(x,C,Je)),this._padding&&(c.interpolatePadding(w,P,Je),$=c.centerPoint.add(Z)),this.terrain&&!t.freezeElevation&&this._updateElevation(Je);const mt=Je===1?U:c.unproject(ne.add(de.mult(Fe(Bt))).mult(vt));c.setLocationAtPoint(c.renderWorldCopies?mt.wrap():mt,$),this._applyUpdatedTransform(c),this._fireMoveEvents(a)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(a)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,a)}if(!t){const c=this.handlers;c&&c.stop(!1)}return this}_ease(t,a,c){c.animate===!1||c.duration===0?(t(1),a()):(this._easeStart=l.h.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=l.b5(t,-180,180);const c=Math.abs(t-a);return Math.abs(t-360-a)<c&&(t-=360),Math.abs(t+360-a)<c&&(t+=360),t}_normalizeCenter(t){const a=this.transform;if(!a.renderWorldCopies||a.lngRange)return;const c=t.lng-a.center.lng;t.lng+=c>180?-360:c<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(l.L.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}class zi{constructor(t={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=F.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=F.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){F.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const c=this._map._getUIString(`AttributionControl.${a}`);t.title=c,t.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const a=this._map.style.sourceCaches;for(const d in a){const f=a[d];if(f.used||f.usedForTerrain){const x=f.getSource();x.attribution&&t.indexOf(x.attribution)<0&&t.push(x.attribution)}}t=t.filter(d=>String(d).trim()),t.sort((d,f)=>d.length-f.length),t=t.filter((d,f)=>{for(let x=f+1;x<t.length;x++)if(t[x].indexOf(d)>=0)return!1;return!0});const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Gt{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const c=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=F.create("div","maplibregl-ctrl");const a=F.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){F.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Qo{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,c=a?this._queue.concat(a):this._queue;for(const d of c)if(d.id===t)return void(d.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const c of a)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const wu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var wh=l.Q([{name:"a_pos3d",type:"Int16",components:3}]);class bh extends l.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,a){this.sourceCache.update(t,a),this._renderableTilesKeys=[];const c={};for(const d of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))c[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),l.aS(d.posMatrix,0,l.N,0,l.N,0,1),this._tiles[d.key]=new ts(d,this.tileSize));for(const d in this._tiles)c[d]||delete this._tiles[d]}freeRtt(t){for(const a in this._tiles){const c=this._tiles[a];(!t||c.tileID.equals(t)||c.tileID.isChildOf(t)||t.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const a={};for(const c of this._renderableTilesKeys){const d=this._tiles[c].tileID;if(d.canonical.equals(t.canonical)){const f=t.clone();f.posMatrix=new Float64Array(16),l.aS(f.posMatrix,0,l.N,0,l.N,0,1),a[c]=f}else if(d.canonical.isChildOf(t.canonical)){const f=t.clone();f.posMatrix=new Float64Array(16);const x=d.canonical.z-t.canonical.z,w=d.canonical.x-(d.canonical.x>>x<<x),T=d.canonical.y-(d.canonical.y>>x<<x),E=l.N>>x;l.aS(f.posMatrix,0,E,0,E,0,1),l.$(f.posMatrix,f.posMatrix,[-w*E,-T*E,0]),a[c]=f}else if(t.canonical.isChildOf(d.canonical)){const f=t.clone();f.posMatrix=new Float64Array(16);const x=t.canonical.z-d.canonical.z,w=t.canonical.x-(t.canonical.x>>x<<x),T=t.canonical.y-(t.canonical.y>>x<<x),E=l.N>>x;l.aS(f.posMatrix,0,l.N,0,l.N,0,1),l.$(f.posMatrix,f.posMatrix,[w*E,T*E,0]),l.a0(f.posMatrix,f.posMatrix,[1/2**x,1/2**x,0]),a[c]=f}}return a}getSourceTile(t,a){const c=this.sourceCache._source;let d=t.overscaledZ-this.deltaZoom;if(d>c.maxzoom&&(d=c.maxzoom),d<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(d).key);let f=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!f||!f.dem)&&a)for(;d>=c.minzoom&&(!f||!f.dem);)f=this.sourceCache.getTileByID(t.scaledTo(d--).key);return f}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=t)}}class Sh{constructor(t,a,c){this.painter=t,this.sourceCache=new bh(a),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,c,d=l.N){var f;if(!(a>=0&&a<d&&c>=0&&c<d))return 0;const x=this.getTerrainData(t),w=(f=x.tile)===null||f===void 0?void 0:f.dem;if(!w)return 0;const T=function($,G,U){var ne=G[0],de=G[1];return $[0]=U[0]*ne+U[4]*de+U[12],$[1]=U[1]*ne+U[5]*de+U[13],$}([],[a/d*l.N,c/d*l.N],x.u_terrain_matrix),E=[T[0]*w.dim,T[1]*w.dim],C=Math.floor(E[0]),P=Math.floor(E[1]),R=E[0]-C,Z=E[1]-P;return w.get(C,P)*(1-R)*(1-Z)+w.get(C+1,P)*R*(1-Z)+w.get(C,P+1)*(1-R)*Z+w.get(C+1,P+1)*R*Z}getElevationForLngLatZoom(t,a){const{tileID:c,mercatorX:d,mercatorY:f}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(c,d%l.N,f%l.N,l.N)}getElevation(t,a,c,d=l.N){return this.getDEMElevation(t,a,c,d)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const d=this.painter.context,f=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new at(d,f,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new at(d,new l.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ao([])}const a=this.sourceCache.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const d=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new at(d,a.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),a.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const c=a&&a+a.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const d=this.sourceCache.sourceCache._source.maxzoom;let f=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=d?f=t.canonical.z-d:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=t.canonical.x-(t.canonical.x>>f<<f),w=t.canonical.y-(t.canonical.y>>f<<f),T=l.bc(new Float64Array(16),[1/(l.N<<f),1/(l.N<<f),0]);l.$(T,T,[x*l.N,w*l.N,0]),this._demMatrixCache[t.key]={matrix:T,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,c=a.width/devicePixelRatio,d=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new at(a.context,{width:c,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new at(a.context,{width:c,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(c,d,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,c,d))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let f=0,x=0;f<this._coordsTextureSize;f++)for(let w=0;w<this._coordsTextureSize;w++,x+=4)a[x+0]=255&w,a[x+1]=255&f,a[x+2]=w>>8<<4|f>>8,a[x+3]=0;const c=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),d=new at(t,c,t.gl.RGBA,{premultiply:!1});return d.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(t){const a=new Uint8Array(4),c=this.painter.context,d=c.gl;c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),c.bindFramebuffer.set(null);const f=a[0]+(a[2]>>4<<8),x=a[1]+((15&a[2])<<8),w=this.coordsIndex[255-a[3]],T=w&&this.sourceCache.getTileByID(w);if(!T)return null;const E=this._coordsTextureSize,C=(1<<T.tileID.canonical.z)*E;return new l.U(this._allowMercatorOverflow(t,(T.tileID.canonical.x*E+f)/C),(T.tileID.canonical.y*E+x)/C,this.getElevation(T.tileID,f,x,E))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,a=new l.bd,c=new l.b0,d=this.meshSize,f=l.N/d,x=d*d;for(let P=0;P<=d;P++)for(let R=0;R<=d;R++)a.emplaceBack(R*f,P*f,0);for(let P=0;P<x;P+=d+1)for(let R=0;R<d;R++)c.emplaceBack(R+P,d+R+P+1,d+R+P+2),c.emplaceBack(R+P,d+R+P+2,R+P+1);const w=a.length,T=w+2*(d+1);for(const P of[0,1])for(let R=0;R<=d;R++)for(const Z of[0,1])a.emplaceBack(R*f,P*l.N,Z);for(let P=0;P<2*d;P+=2)c.emplaceBack(T+P,T+P+1,T+P+3),c.emplaceBack(T+P,T+P+3,T+P+2),c.emplaceBack(w+P,w+P+3,w+P+1),c.emplaceBack(w+P,w+P+2,w+P+3);const E=a.length,C=E+2*(d+1);for(const P of[0,1])for(let R=0;R<=d;R++)for(const Z of[0,1])a.emplaceBack(P*l.N,R*f,Z);for(let P=0;P<2*d;P+=2)c.emplaceBack(E+P,E+P+1,E+P+3),c.emplaceBack(E+P,E+P+3,E+P+2),c.emplaceBack(C+P,C+P+3,C+P+1),c.emplaceBack(C+P,C+P+2,C+P+3);return this._mesh={indexBuffer:t.createIndexBuffer(c),vertexBuffer:t.createVertexBuffer(a,wh.members),segments:l.S.simpleSegment(0,0,a.length,c.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*l.be/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,a){var c;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(c=this.getMinMaxElevation(d).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return a&&a.dem&&(c.minElevation=a.dem.min*this.exaggeration,c.maxElevation=a.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(t,a){const c=l.U.fromLngLat(t.wrap()),d=(1<<a)*l.N,f=c.x*d,x=c.y*d,w=Math.floor(f/l.N),T=Math.floor(x/l.N);return{tileID:new l.O(a,0,a,w,T),mercatorX:f,mercatorY:x}}_allowMercatorOverflow(t,a){const c=t.x<this.painter.width/2;let d=l.bf(a);const f=this.painter.transform.center.lng;return c&&Math.sign(d)>0&&Math.sign(f)<0||!c&&Math.sign(d)<0&&Math.sign(f)>0?(d=360*Math.sign(f)+d,l.G(d)):a}}class Cp{constructor(t,a,c){this._context=t,this._size=a,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new at(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(c.texture),{id:t,fbo:a,texture:c,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>t.id!==a),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const ti={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class el{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new Cp(t.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(c=>!t._layers[c].isHidden(a)),this._coordsDescendingInv={};for(const c in t.sourceCaches){this._coordsDescendingInv[c]={};const d=t.sourceCaches[c].getVisibleCoordinates();for(const f of d){const x=this.terrain.sourceCache.getTerrainCoords(f);for(const w in x)this._coordsDescendingInv[c][w]||(this._coordsDescendingInv[c][w]=[]),this._coordsDescendingInv[c][w].push(x[w])}}this._coordsDescendingInvStr={};for(const c of t._order){const d=t._layers[c],f=d.source;if(ti[d.type]&&!this._coordsDescendingInvStr[f]){this._coordsDescendingInvStr[f]={};for(const x in this._coordsDescendingInv[f])this._coordsDescendingInvStr[f][x]=this._coordsDescendingInv[f][x].map(w=>w.key).sort().join()}}for(const c of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const f=this._coordsDescendingInvStr[d][c.tileID.key];f&&f!==c.rttCoords[d]&&(c.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const a=t.type,c=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(ti[a]&&(this._prevType&&ti[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(t.id),!d))return!0;if(ti[this._prevType]||ti[a]&&d){this._prevType=a;const f=this._stacks.length-1,x=this._stacks[f]||[];for(const w of this._renderableTiles){if(this.pool.isFull()&&(nr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(w),w.rtt[f]){const E=this.pool.getObjectForId(w.rtt[f].id);if(E.stamp===w.rtt[f].stamp){this.pool.useObject(E);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),w.rtt[f]={id:T.id,stamp:T.stamp},c.context.bindFramebuffer.set(T.fbo.framebuffer),c.context.clear({color:l.aT.transparent,stencil:0}),c.currentStencilSource=void 0;for(let E=0;E<x.length;E++){const C=c.style._layers[x[E]],P=C.source?this._coordsDescendingInv[C.source][w.tileID.key]:[w.tileID];c.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),c._renderTileClippingMasks(C,P),c.renderLayer(c,c.style.sourceCaches[C.source],C,P),C.source&&(w.rttCoords[C.source]=this._coordsDescendingInvStr[C.source][w.tileID.key])}}return nr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ti[a]}return!1}}const tt=N,lt={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},ro=p=>{p.touchstart=p.dragStart,p.touchmoveWindow=p.dragMove,p.touchend=p.dragEnd},bu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Su{constructor(t,a,c=!1){this.mousedown=x=>{this.startMouse(l.e({},x,{ctrlKey:!0,preventDefault:()=>x.preventDefault()}),F.mousePos(this.element,x)),F.addEventListener(window,"mousemove",this.mousemove),F.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.moveMouse(x,F.mousePos(this.element,x))},this.mouseup=x=>{this.mouseRotate.dragEnd(x),this.mousePitch&&this.mousePitch.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=F.touchPos(this.element,x.targetTouches)[0],this.startTouch(x,this._startPos),F.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),F.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=F.touchPos(this.element,x.targetTouches)[0],this.moveTouch(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=t.dragRotate._mouseRotate.getClickTolerance(),f=t.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=aa({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:x,clickTolerance:w,bearingDegreesPerPixelMoved:T=.8})=>{const E=new mh;return new On({clickTolerance:w,move:(C,P)=>({bearingDelta:(P.x-C.x)*T}),moveStateManager:E,enable:x,assignEvents:ro})})({clickTolerance:d,enable:!0}),this.map=t,c&&(this.mousePitch=Nn({clickTolerance:f,enable:!0}),this.touchPitch=(({enable:x,clickTolerance:w,pitchDegreesPerPixelMoved:T=-.5})=>{const E=new mh;return new On({clickTolerance:w,move:(C,P)=>({pitchDelta:(P.y-C.y)*T}),moveStateManager:E,enable:x,assignEvents:ro})})({clickTolerance:f,enable:!0})),F.addEventListener(a,"mousedown",this.mousedown),F.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),F.addEventListener(a,"touchcancel",this.reset)}startMouse(t,a){this.mouseRotate.dragStart(t,a),this.mousePitch&&this.mousePitch.dragStart(t,a),F.disableDrag()}startTouch(t,a){this.touchRotate.dragStart(t,a),this.touchPitch&&this.touchPitch.dragStart(t,a),F.disableDrag()}moveMouse(t,a){const c=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(t,a)||{};if(d&&c.setBearing(c.getBearing()+d),this.mousePitch){const{pitchDelta:f}=this.mousePitch.dragMove(t,a)||{};f&&c.setPitch(c.getPitch()+f)}}moveTouch(t,a){const c=this.map,{bearingDelta:d}=this.touchRotate.dragMove(t,a)||{};if(d&&c.setBearing(c.getBearing()+d),this.touchPitch){const{pitchDelta:f}=this.touchPitch.dragMove(t,a)||{};f&&c.setPitch(c.getPitch()+f)}}off(){const t=this.element;F.removeEventListener(t,"mousedown",this.mousedown),F.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),F.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),F.removeEventListener(window,"touchend",this.touchend),F.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){F.enableDrag(),F.removeEventListener(window,"mousemove",this.mousemove),F.removeEventListener(window,"mouseup",this.mouseup),F.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),F.removeEventListener(window,"touchend",this.touchend)}}let pr;function Tu(p,t,a){if(p=new l.L(p.lng,p.lat),t){const c=new l.L(p.lng-360,p.lat),d=new l.L(p.lng+360,p.lat),f=a.locationPoint(p).distSqr(t);a.locationPoint(c).distSqr(t)<f?p=c:a.locationPoint(d).distSqr(t)<f&&(p=d)}for(;Math.abs(p.lng-a.center.lng)>180;){const c=a.locationPoint(p);if(c.x>=0&&c.y>=0&&c.x<=a.width&&c.y<=a.height)break;p.lng>a.center.lng?p.lng-=360:p.lng+=360}return p}const Wi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Th(p,t,a){const c=p.classList;for(const d in Wi)c.remove(`maplibregl-${a}-anchor-${d}`);c.add(`maplibregl-${a}-anchor-${t}`)}class Cs extends l.E{constructor(t){if(super(),this._onKeyPress=a=>{const c=a.code,d=a.charCode||a.keyCode;c!=="Space"&&c!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=a=>{const c=a.originalEvent.target,d=this._element;this._popup&&(c===d||d.contains(c))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!c)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Tu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let f="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?f="rotateX(0deg)":this._pitchAlignment==="map"&&(f=`rotateX(${this._map.getPitch()}deg)`),a&&a.type!=="moveend"||(this._pos=this._pos.round()),F.setTransform(this._element,`${Wi[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${f} ${d}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const x=this._map.unproject(this._pos),w=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=x.distanceTo(this._lngLat)>20*w?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=a=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.k("dragstart"))),this.fire(new l.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=l.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=F.create("div"),this._element.setAttribute("aria-label","Map marker");const a=F.createNS("http://www.w3.org/2000/svg","svg"),c=41,d=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${c}px`),a.setAttributeNS(null,"width",`${d}px`),a.setAttributeNS(null,"viewBox",`0 0 ${d} ${c}`);const f=F.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"stroke","none"),f.setAttributeNS(null,"stroke-width","1"),f.setAttributeNS(null,"fill","none"),f.setAttributeNS(null,"fill-rule","evenodd");const x=F.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const w=F.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ne of T){const de=F.createNS("http://www.w3.org/2000/svg","ellipse");de.setAttributeNS(null,"opacity","0.04"),de.setAttributeNS(null,"cx","10.5"),de.setAttributeNS(null,"cy","5.80029008"),de.setAttributeNS(null,"rx",ne.rx),de.setAttributeNS(null,"ry",ne.ry),w.appendChild(de)}const E=F.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill",this._color);const C=F.createNS("http://www.w3.org/2000/svg","path");C.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),E.appendChild(C);const P=F.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"opacity","0.25"),P.setAttributeNS(null,"fill","#000000");const R=F.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),P.appendChild(R);const Z=F.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Z.setAttributeNS(null,"fill","#FFFFFF");const $=F.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(8.0, 8.0)");const G=F.createNS("http://www.w3.org/2000/svg","circle");G.setAttributeNS(null,"fill","#000000"),G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"cx","5.5"),G.setAttributeNS(null,"cy","5.5"),G.setAttributeNS(null,"r","5.4999962");const U=F.createNS("http://www.w3.org/2000/svg","circle");U.setAttributeNS(null,"fill","#FFFFFF"),U.setAttributeNS(null,"cx","5.5"),U.setAttributeNS(null,"cy","5.5"),U.setAttributeNS(null,"r","5.4999962"),$.appendChild(G),$.appendChild(U),x.appendChild(w),x.appendChild(E),x.appendChild(P),x.appendChild(Z),x.appendChild($),a.appendChild(x),a.setAttributeNS(null,"height",c*this._scale+"px"),a.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(a),this._offset=l.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),Th(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),F.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=l.L.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const d=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(t){return this._offset=l.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const sr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let er=0,la=!1;const io={maxWidth:100,unit:"metric"};function no(p,t,a){const c=a&&a.maxWidth||100,d=p._container.clientHeight/2,f=p.unproject([0,d]),x=p.unproject([c,d]),w=f.distanceTo(x);if(a&&a.unit==="imperial"){const T=3.2808*w;T>5280?Ps(t,c,T/5280,p._getUIString("ScaleControl.Miles")):Ps(t,c,T,p._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Ps(t,c,w/1852,p._getUIString("ScaleControl.NauticalMiles")):w>=1e3?Ps(t,c,w/1e3,p._getUIString("ScaleControl.Kilometers")):Ps(t,c,w,p._getUIString("ScaleControl.Meters"))}function Ps(p,t,a,c){const d=function(f){const x=Math.pow(10,`${Math.floor(f)}`.length-1);let w=f/x;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){const E=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*E)/E}(w),x*w}(a);p.style.width=t*(d/a)+"px",p.innerHTML=`${d}&nbsp;${c}`}const ku={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Eu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ua(p){if(p){if(typeof p=="number"){const t=Math.round(Math.abs(p)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,p),"top-left":new l.P(t,t),"top-right":new l.P(-t,t),bottom:new l.P(0,-p),"bottom-left":new l.P(t,-t),"bottom-right":new l.P(-t,-t),left:new l.P(p,0),right:new l.P(-p,0)}}if(p instanceof l.P||Array.isArray(p)){const t=l.P.convert(p);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:l.P.convert(p.center||[0,0]),top:l.P.convert(p.top||[0,0]),"top-left":l.P.convert(p["top-left"]||[0,0]),"top-right":l.P.convert(p["top-right"]||[0,0]),bottom:l.P.convert(p.bottom||[0,0]),"bottom-left":l.P.convert(p["bottom-left"]||[0,0]),"bottom-right":l.P.convert(p["bottom-right"]||[0,0]),left:l.P.convert(p.left||[0,0]),right:l.P.convert(p.right||[0,0])}}return ua(new l.P(0,0))}const Iu={extend:(p,...t)=>l.e(p,...t),run(p){p()},logToElement(p,t=!1,a="log"){const c=window.document.getElementById(a);c&&(t&&(c.innerHTML=""),c.innerHTML+=`<br>${p}`)}},Cu=N;class Mt{static get version(){return Cu}static get workerCount(){return mn.workerCount}static set workerCount(t){mn.workerCount=t}static get maxParallelImageRequests(){return l.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(t){l.c.MAX_PARALLEL_IMAGE_REQUESTS=t}static get workerUrl(){return l.c.WORKER_URL}static set workerUrl(t){l.c.WORKER_URL=t}static addProtocol(t,a){l.c.REGISTERED_PROTOCOLS[t]=a}static removeProtocol(t){delete l.c.REGISTERED_PROTOCOLS[t]}}return Mt.Map=class extends xh{constructor(p){if(l.bg.mark(l.bh.create),(p=l.e({},lt,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Xo(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),{bearingSnap:p.bearingSnap}),this._cooperativeGesturesOnWheel=t=>{this._onCooperativeGesture(t,t[this._metaKey],1)},this._contextLost=t=>{t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.k("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.k("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._cooperativeGestures=p.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._renderTaskQueue=new Qo,this._controls=[],this._mapId=l.a2(),this._locale=l.e({},wu,p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this._imageQueueHandle=Ne.addThrottleControl(()=>this.isMoving()),this._requestManager=new ee(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let t=!1;const a=Is(c=>{this._trackResize&&!this._removed&&this.resize(c)._update()},50);this._resizeObserver=new ResizeObserver(c=>{t?a(c):t=!0}),this._resizeObserver.observe(this._container)}this.handlers=new xu(this,p),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=p.hash&&new Ya(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,l.e({},p.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new zi({customAttribution:p.customAttribution})),p.maplibreLogo&&this.addControl(new Gt,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new l.k(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new l.k(`${t.dataType}dataloading`,t))}),this.on("dataabort",t=>{this.fire(new l.k("sourcedataabort",t))})}_getMapId(){return this._mapId}addControl(p,t){if(t===void 0&&(t=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new l.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=p.onAdd(this);this._controls.push(p);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(a,c.firstChild):c.appendChild(a),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new l.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(p);return t>-1&&this._controls.splice(t,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}calculateCameraOptionsFromTo(p,t,a,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(p,t,a,c)}resize(p){var t;const a=this._containerDimensions(),c=a[0],d=a[1],f=this._getClampedPixelRatio(c,d);if(this._resizeCanvas(c,d,f),this.painter.resize(c,d,f),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const T=this._getClampedPixelRatio(c,d);this._resizeCanvas(c,d,T),this.painter.resize(c,d,T)}this.transform.resize(c,d),(t=this._requestedCameraState)===null||t===void 0||t.resize(c,d);const x=!this._moving;return x&&(this.stop(),this.fire(new l.k("movestart",p)).fire(new l.k("move",p))),this.fire(new l.k("resize",p)),x&&this.fire(new l.k("moveend",p)),this}_getClampedPixelRatio(p,t){const{0:a,1:c}=this._maxCanvasSize,d=this.getPixelRatio(),f=p*d,x=t*d;return Math.min(f>a?a/f:1,x>c?c/x:1)*d}getPixelRatio(){var p;return(p=this._overridePixelRatio)!==null&&p!==void 0?p:devicePixelRatio}setPixelRatio(p){this._overridePixelRatio=p,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(p){return this.transform.setMaxBounds(Dt.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(p){return this._cooperativeGestures=p,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(p){return this.transform.locationPoint(l.L.convert(p),this.style&&this.terrain)}unproject(p){return this.transform.pointLocation(l.P.convert(p),this.terrain)}isMoving(){var p;return this._moving||((p=this.handlers)===null||p===void 0?void 0:p.isMoving())}isZooming(){var p;return this._zooming||((p=this.handlers)===null||p===void 0?void 0:p.isZooming())}isRotating(){var p;return this._rotating||((p=this.handlers)===null||p===void 0?void 0:p.isRotating())}_createDelegatedListener(p,t,a){if(p==="mouseenter"||p==="mouseover"){let c=!1;return{layer:t,listener:a,delegates:{mousemove:f=>{const x=this.getLayer(t)?this.queryRenderedFeatures(f.point,{layers:[t]}):[];x.length?c||(c=!0,a.call(this,new Pi(p,this,f.originalEvent,{features:x}))):c=!1},mouseout:()=>{c=!1}}}}if(p==="mouseleave"||p==="mouseout"){let c=!1;return{layer:t,listener:a,delegates:{mousemove:x=>{(this.getLayer(t)?this.queryRenderedFeatures(x.point,{layers:[t]}):[]).length?c=!0:c&&(c=!1,a.call(this,new Pi(p,this,x.originalEvent)))},mouseout:x=>{c&&(c=!1,a.call(this,new Pi(p,this,x.originalEvent)))}}}}{const c=d=>{const f=this.getLayer(t)?this.queryRenderedFeatures(d.point,{layers:[t]}):[];f.length&&(d.features=f,a.call(this,d),delete d.features)};return{layer:t,listener:a,delegates:{[p]:c}}}}on(p,t,a){if(a===void 0)return super.on(p,t);const c=this._createDelegatedListener(p,t,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(c);for(const d in c.delegates)this.on(d,c.delegates[d]);return this}once(p,t,a){if(a===void 0)return super.once(p,t);const c=this._createDelegatedListener(p,t,a);for(const d in c.delegates)this.once(d,c.delegates[d]);return this}off(p,t,a){return a===void 0?super.off(p,t):(this._delegatedListeners&&this._delegatedListeners[p]&&(c=>{const d=this._delegatedListeners[p];for(let f=0;f<d.length;f++){const x=d[f];if(x.layer===t&&x.listener===a){for(const w in x.delegates)this.off(w,x.delegates[w]);return d.splice(f,1),this}}})(),this)}queryRenderedFeatures(p,t){if(!this.style)return[];let a;const c=p instanceof l.P||Array.isArray(p),d=c?p:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(c?{}:p)||{},d instanceof l.P||typeof d[0]=="number")a=[l.P.convert(d)];else{const f=l.P.convert(d[0]),x=l.P.convert(d[1]);a=[f,new l.P(x.x,f.y),x,new l.P(f.x,x.y),f]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(p,t){return this.style.querySourceFeatures(p,t)}setStyle(p,t){return(t=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(p,t))}setTransformRequest(p){return this._requestManager.setTransformRequest(p),this}_getUIString(p){const t=this._locale[p];if(t==null)throw new Error(`Missing UI string '${p}'`);return t}_updateStyle(p,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(p,t));const a=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!p)),p?(this.style=new Or(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p,t,a):this.style.loadJSON(p,t,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Or(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,t){if(typeof p=="string"){const a=this._requestManager.transformRequest(p,re.Style);l.f(a,(c,d)=>{c?this.fire(new l.j(c)):d&&this._updateDiff(d,t)})}else typeof p=="object"&&this._updateDiff(p,t)}_updateDiff(p,t){try{this.style.setState(p,t)&&this._update(!0)}catch(a){l.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(p,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(p,t){return this._lazyInitEmptyStyle(),this.style.addSource(p,t),this._update(!0)}isSourceLoaded(p){const t=this.style&&this.style.sourceCaches[p];if(t!==void 0)return t.loaded();this.fire(new l.j(new Error(`There is no source with ID '${p}'`)))}setTerrain(p){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),p){const t=this.style.sourceCaches[p.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${p.source}`);for(const a in this.style._layers){const c=this.style._layers[a];c.type==="hillshade"&&c.source===p.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Sh(this.painter,t,p),this.painter.renderToTexture=new el(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==p.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new l.k("terrain",{terrain:p})),this}getTerrain(){var p,t;return(t=(p=this.terrain)===null||p===void 0?void 0:p.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const p=this.style&&this.style.sourceCaches;for(const t in p){const a=p[t]._tiles;for(const c in a){const d=a[c];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}addSourceType(p,t,a){return this._lazyInitEmptyStyle(),this.style.addSourceType(p,t,a)}removeSource(p){return this.style.removeSource(p),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,t,a={}){const{pixelRatio:c=1,sdf:d=!1,stretchX:f,stretchY:x,content:w}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||l.a(t))){if(t.width===void 0||t.height===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:E,data:C}=t,P=t;return this.style.addImage(p,{data:new l.R({width:T,height:E},new Uint8Array(C)),pixelRatio:c,stretchX:f,stretchY:x,content:w,sdf:d,version:0,userImage:P}),P.onAdd&&P.onAdd(this,p),this}}{const{width:T,height:E,data:C}=l.h.getImageData(t);this.style.addImage(p,{data:new l.R({width:T,height:E},C),pixelRatio:c,stretchX:f,stretchY:x,content:w,sdf:d,version:0})}}updateImage(p,t){const a=this.style.getImage(p);if(!a)return this.fire(new l.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||l.a(t)?l.h.getImageData(t):t,{width:d,height:f,data:x}=c;if(d===void 0||f===void 0)return this.fire(new l.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==a.data.width||f!==a.data.height)return this.fire(new l.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(t instanceof HTMLImageElement||l.a(t));return a.data.replace(x,w),this.style.updateImage(p,a),this}getImage(p){return this.style.getImage(p)}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new l.j(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,t){Ne.getImage(this._requestManager.transformRequest(p,re.Image),t)}listImages(){return this.style.listImages()}addLayer(p,t){return this._lazyInitEmptyStyle(),this.style.addLayer(p,t),this._update(!0)}moveLayer(p,t){return this.style.moveLayer(p,t),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(p,t,a){return this.style.setLayerZoomRange(p,t,a),this._update(!0)}setFilter(p,t,a={}){return this.style.setFilter(p,t,a),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,t,a,c={}){return this.style.setPaintProperty(p,t,a,c),this._update(!0)}getPaintProperty(p,t){return this.style.getPaintProperty(p,t)}setLayoutProperty(p,t,a,c={}){return this.style.setLayoutProperty(p,t,a,c),this._update(!0)}getLayoutProperty(p,t){return this.style.getLayoutProperty(p,t)}setGlyphs(p,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(p,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(p,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(p,t,a,c=>{c||this._update(!0)}),this}removeSprite(p){return this._lazyInitEmptyStyle(),this.style.removeSprite(p),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(p,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(p,t,a=>{a||this._update(!0)}),this}setLight(p,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(p,t){return this.style.setFeatureState(p,t),this._update()}removeFeatureState(p,t){return this.style.removeFeatureState(p,t),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let p=0,t=0;return this._container&&(p=this._container.clientWidth||400,t=this._container.clientHeight||300),[p,t]}_setupContainer(){const p=this._container;p.classList.add("maplibregl-map");const t=this._canvasContainer=F.create("div","maplibregl-canvas-container",p);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=F.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),c=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],c);const d=this._controlContainer=F.create("div","maplibregl-control-container",p),f=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{f[x]=F.create("div",`maplibregl-ctrl-${x} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=F.create("div","maplibregl-cooperative-gesture-screen",this._container);let p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(p=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${p}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){F.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(p,t,a){this._canvas.width=Math.floor(a*p),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const p={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{t={requestedAttributes:p},c&&(t.statusMessage=c.statusMessage,t.type=c.type)},{once:!0});const a=this._canvas.getContext("webgl2",p)||this._canvas.getContext("webgl",p);if(!a){const c="Failed to initialize WebGL";throw t?(t.message=c,new Error(JSON.stringify(t))):new Error(c)}this.painter=new Es(a,this.transform),pe.testSupport(a)}_onCooperativeGesture(p,t,a){return!t&&a<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_render(p){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,f=l.h.now();this.style.zoomHistory.update(d,f);const x=new l.a8(d,{now:f,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),w=x.crossFadingFactor();w===1&&w===this._crossFadingFactor||(a=!0,this._crossFadingFactor=w),this.style.update(x)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new l.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.bg.mark(l.bh.load),this.fire(new l.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const c=this._sourcesDirty||this._styleDirty||this._placementDirty;return c||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.k("idle")),!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,l.bg.mark(l.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var p;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Ne.removeThrottleControl(this._imageQueueHandle),(p=this._resizeObserver)===null||p===void 0||p.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),F.remove(this._canvasContainer),F.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),l.bg.clearMetrics(),this._removed=!0,this.fire(new l.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=l.h.frame(p=>{l.bg.frame(p),this._frame=null,this._render(p)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get version(){return tt}getCameraTargetElevation(){return this.transform.elevation}},Mt.NavigationControl=class{constructor(p){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),c=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,a)=>{const c=this._map._getUIString(`NavigationControl.${a}`);t.title=c,t.setAttribute("aria-label",c)},this.options=l.e({},bu,p),this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),F.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),F.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=F.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Su(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){F.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(p,t){const a=F.create("button",p,this._container);return a.type="button",a.addEventListener("click",t),a}},Mt.GeolocateControl=class extends l.E{constructor(p){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new l.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new l.L(t.coords.longitude,t.coords.latitude),c=t.coords.accuracy,d=this._map.getBearing(),f=l.e({bearing:d},this.options.fitBoundsOptions),x=Dt.fromLngLat(a,c);this._map.fitBounds(x,f,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new l.L(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&la)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=F.create("button","maplibregl-ctrl-geolocate",this._container),F.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Cs({element:this._dotElement}),this._circleElement=F.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Cs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.k("trackuserlocationend")))})}},this.options=l.e({},sr,p)}onAdd(p){return this._map=p,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(t,a=!1){pr===void 0||a?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(c=>{pr=c.state!=="denied",t(pr)}).catch(()=>{pr=!!window.navigator.geolocation,t(pr)}):(pr=!!window.navigator.geolocation,t(pr)):t(pr)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),F.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,er=0,la=!1}_isOutOfMapMaxBounds(p){const t=this._map.getMaxBounds(),a=p.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const p=this._map.getBounds(),t=p.getSouthEast(),a=p.getNorthEast(),c=t.distanceTo(a),d=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":er--,la=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),er++,er>1?(p={maximumAge:6e5,timeout:0},la=!0):(p=this.options.positionOptions,la=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,p)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},Mt.AttributionControl=zi,Mt.LogoControl=Gt,Mt.ScaleControl=class{constructor(p){this._onMove=()=>{no(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,no(this._map,this._container,this.options)},this.options=l.e({},io,p)}getDefaultPosition(){return"bottom-left"}onAdd(p){return this._map=p,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-scale",p.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){F.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},Mt.FullscreenControl=class extends l.E{constructor(p={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){F.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const p=this._fullscreenButton=F.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);F.create("span","maplibregl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.title=p}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new l.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},Mt.TerrainControl=class{constructor(p){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=p}onAdd(p){return this._map=p,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=F.create("button","maplibregl-ctrl-terrain",this._container),F.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){F.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},Mt.Popup=class extends l.E{constructor(p){super(),this.remove=()=>(this._content&&F.remove(this._content),this._container&&(F.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.k("close")),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=F.create("div","maplibregl-popup",this._map.getContainer()),this._tip=F.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Tu(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const a=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let c=this.options.anchor;const d=ua(this.options.offset);if(!c){const x=this._container.offsetWidth,w=this._container.offsetHeight;let T;T=a.y+d.bottom.y<w?["top"]:a.y>this._map.transform.height-w?["bottom"]:[],a.x<x/2?T.push("left"):a.x>this._map.transform.width-x/2&&T.push("right"),c=T.length===0?"bottom":T.join("-")}const f=a.add(d[c]).round();F.setTransform(this._container,`${Wi[c]} translate(${f.x}px,${f.y}px)`),Th(this._container,c,"popup")},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(ku),p)}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(p){return this._lngLat=l.L.convert(p),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const t=document.createDocumentFragment(),a=document.createElement("body");let c;for(a.innerHTML=p;c=a.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){var p;return(p=this._container)===null||p===void 0?void 0:p.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=F.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(p),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(p){this._container&&this._container.classList.add(p)}removeClassName(p){this._container&&this._container.classList.remove(p)}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){if(this._container)return this._container.classList.toggle(p)}_createCloseButton(){this.options.closeButton&&(this._closeButton=F.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Eu);p&&p.focus()}},Mt.Marker=Cs,Mt.Style=Or,Mt.LngLat=l.L,Mt.LngLatBounds=Dt,Mt.Point=l.P,Mt.MercatorCoordinate=l.U,Mt.Evented=l.E,Mt.AJAXError=l.bi,Mt.config=l.c,Mt.CanvasSource=Qn,Mt.GeoJSONSource=Jn,Mt.ImageSource=Vi,Mt.RasterDEMTileSource=rn,Mt.RasterTileSource=hi,Mt.VectorTileSource=tn,Mt.VideoSource=Ua,Mt.setRTLTextPlugin=l.bj,Mt.getRTLTextPluginStatus=l.bk,Mt.prewarm=function(){Eo().acquire(Ct)},Mt.clearPrewarmedResources=function(){const p=Dn;p&&(p.isPreloaded()&&p.numActive()===1?(p.release(Ct),Dn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Iu.extend(Mt,{isSafari:l.ac,getPerformanceMetrics:l.bg.getPerformanceMetrics}),Mt});var z=_;return z})})(l1);var OT=l1.exports;const NT=Rv(OT);function VT(){const{id:r}=uT(),s=et.useRef(null),u=et.useRef(null);return et.useEffect(()=>{if(s.current&&!u.current)return u.current=new NT.Map({container:s.current,style:"https://demotiles.maplibre.org/style.json",center:[11.576124,48.137154],zoom:10}),()=>{var g;(g=u.current)==null||g.remove(),u.current=null}},[]),Me.jsxs("div",{children:[Me.jsxs("h2",{children:["Trail ",r]}),Me.jsx("div",{style:{height:240,borderRadius:8,overflow:"hidden",margin:"12px 0"},children:Me.jsx("div",{ref:s,style:{height:"100%"}})}),Me.jsx("div",{children:"Difficulty: Moderate  Est. time: 2h 30m"}),Me.jsx("p",{children:"A scenic loop with forests and viewpoints. Remember Leave No Trace."}),Me.jsx("button",{style:{padding:"10px 14px",background:"#0B5D4F",color:"white",border:"none",borderRadius:6},children:"Download offline map"}),Me.jsx("h3",{style:{marginTop:16},children:"Reviews"}),Me.jsxs("ul",{children:[Me.jsx("li",{children:"Great trail!  5"}),Me.jsx("li",{children:"Nice views.  4"})]})]})}function UT(){return Me.jsxs("div",{children:[Me.jsx("h2",{children:"Offline downloads"}),Me.jsx("p",{children:"No downloads yet. Choose a trail to download its map for offline use."}),Me.jsx("ul",{children:Me.jsx("li",{children:"Example Trail  120 MB  Up to date"})})]})}function jT(){return Me.jsxs("div",{children:[Me.jsx("h2",{children:"Community"}),Me.jsx("div",{style:{display:"grid",gap:12},children:Array.from({length:5}).map((r,s)=>Me.jsxs("div",{style:{border:"1px solid #eee",borderRadius:8,padding:12},children:[Me.jsxs("strong",{children:["User ",s+1]}),Me.jsxs("p",{children:["Just completed Trail ",s+2,"! Stunning views and well marked paths."]}),Me.jsx("div",{style:{fontSize:12,color:"#666"},children:"12 likes  3 comments"})]},s))})]})}function $T(){return Me.jsxs("div",{children:[Me.jsx("h2",{children:"Your profile"}),Me.jsx("div",{children:"Name: Hiker"}),Me.jsx("div",{children:"Language: English"}),Me.jsx("div",{children:"Saved trails: 3"})]})}function ZT(){return Me.jsxs("div",{children:[Me.jsx("h2",{children:"Settings"}),Me.jsx("div",{children:Me.jsxs("label",{children:[Me.jsx("input",{type:"checkbox",defaultChecked:!0})," Enable notifications"]})}),Me.jsx("div",{children:Me.jsxs("label",{children:[Me.jsx("input",{type:"checkbox",defaultChecked:!0})," Allow location access"]})}),Me.jsx("div",{children:Me.jsxs("label",{children:["Language",Me.jsxs("select",{defaultValue:"en",children:[Me.jsx("option",{value:"en",children:"English"}),Me.jsx("option",{value:"de",children:"Deutsch"})]})]})})]})}function qT(){const r=Vc(),s=[{to:"/",label:"Home"},{to:"/trails",label:"Trails"},{to:"/downloads",label:"Downloads"},{to:"/community",label:"Community"},{to:"/profile",label:"Profile"}];return Me.jsx("nav",{style:{position:"fixed",bottom:0,left:0,right:0,height:56,display:"flex",background:"#0B5D4F",color:"white"},children:s.map(u=>Me.jsx(hp,{to:u.to,style:{flex:1,textAlign:"center",alignSelf:"center",color:r.pathname===u.to?"#FFE082":"white",textDecoration:"none"},children:u.label},u.to))})}function GT(){return Me.jsxs("div",{style:{minHeight:"100vh",paddingBottom:56},children:[Me.jsx("header",{style:{padding:"12px 16px",background:"#0B5D4F",color:"white"},children:Me.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Me.jsx("strong",{children:"WanderFreund"}),Me.jsx(hp,{to:"/settings",style:{color:"white",textDecoration:"none"},children:"Settings"})]})}),Me.jsx("main",{style:{padding:16},children:Me.jsxs(kT,{children:[Me.jsx(_a,{path:"/",element:Me.jsx(BT,{})}),Me.jsx(_a,{path:"/trails",element:Me.jsx(FT,{})}),Me.jsx(_a,{path:"/trails/:id",element:Me.jsx(VT,{})}),Me.jsx(_a,{path:"/downloads",element:Me.jsx(UT,{})}),Me.jsx(_a,{path:"/community",element:Me.jsx(jT,{})}),Me.jsx(_a,{path:"/profile",element:Me.jsx($T,{})}),Me.jsx(_a,{path:"/settings",element:Me.jsx(ZT,{})})]})}),Me.jsx(qT,{})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{});X0(document.getElementById("root")).render(Me.jsx(Gv.StrictMode,{children:Me.jsx(AT,{children:Me.jsx(GT,{})})}));
